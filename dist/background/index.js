(()=>{var Vn=Object.defineProperty;var Js=(l,i,t)=>i in l?Vn(l,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[i]=t;var Jr=(l,i)=>()=>(l&&(i=l(l=0)),i);var Kn=(l,i)=>{for(var t in i)Vn(l,t,{get:i[t],enumerable:!0})};var Zr=(l,i,t)=>(Js(l,typeof i!="symbol"?i+"":i,t),t);var vn={};Kn(vn,{Certificate:()=>Di,Cipher:()=>Oi,Cipheriv:()=>Vi,Decipher:()=>Ki,Decipheriv:()=>Hi,DiffieHellman:()=>Mi,DiffieHellmanGroup:()=>Fi,ECDH:()=>Gi,Hash:()=>qi,Hmac:()=>ji,KeyObject:()=>zi,Sign:()=>Qi,Verify:()=>Wi,X509Certificate:()=>Yi,checkPrime:()=>Ha,checkPrimeSync:()=>Ma,constants:()=>$i,createCipher:()=>Fa,createCipheriv:()=>ja,createDecipher:()=>Ga,createDecipheriv:()=>za,createDiffieHellman:()=>Qa,createDiffieHellmanGroup:()=>Wa,createECDH:()=>Ya,createHash:()=>Xa,createHmac:()=>$a,createPrivateKey:()=>Ja,createPublicKey:()=>Za,createSecretKey:()=>ei,createSign:()=>ti,createVerify:()=>ri,default:()=>Jo,diffieHellman:()=>ni,fips:()=>Ka,generateKey:()=>mi,generateKeyPair:()=>yi,generateKeyPairSync:()=>gi,generateKeySync:()=>vi,generatePrime:()=>ai,generatePrimeSync:()=>ii,getCipherInfo:()=>oi,getCiphers:()=>si,getCurves:()=>ci,getDiffieHellman:()=>ui,getFips:()=>Li,getHashes:()=>li,getRandomValues:()=>mn,hash:()=>Pi,hkdf:()=>pi,hkdfSync:()=>hi,pbkdf2:()=>fi,pbkdf2Sync:()=>di,privateDecrypt:()=>Ei,privateEncrypt:()=>Ci,pseudoRandomBytes:()=>qa,publicDecrypt:()=>Ti,publicEncrypt:()=>Si,randomBytes:()=>Va,randomFill:()=>bi,randomFillSync:()=>Ai,randomInt:()=>Ii,randomUUID:()=>Pa,scrypt:()=>Bi,scryptSync:()=>wi,secureHeapUsed:()=>Ui,setEngine:()=>Ni,setFips:()=>ki,sign:()=>_i,subtle:()=>Ua,timingSafeEqual:()=>Ri,verify:()=>xi,webcrypto:()=>Oa});function Yo(l){return new Error(`[unenv] ${l} is not implemented yet!`)}function ce(l){return Object.assign(()=>{throw Yo(l)},{__unenv__:!0})}function et(l){return class{__unenv__=!0;constructor(){throw new Error(`[unenv] ${l} is not implemented yet!`)}}}var Xo,ka,xa,Ua,Pa,mn,Da,La,Oa,Va,Ka,$o,Ha,Ma,Fa,Ga,qa,ja,za,Qa,Wa,Ya,Xa,$a,Ja,Za,ei,ti,ri,ni,ai,ii,si,oi,ci,ui,li,pi,hi,fi,di,yi,gi,mi,vi,Ei,Ci,Ti,Si,bi,Ai,Ii,Bi,wi,_i,Ni,Ri,Li,ki,xi,Ui,Pi,Di,Oi,Vi,Ki,Hi,Mi,Fi,Gi,qi,ji,zi,Qi,Wi,Yi,Xi,$i,Jo,En=Jr(()=>{Xo=Object.defineProperty,ka=(l,i)=>{for(var t in i)Xo(l,t,{get:i[t],enumerable:!0})},xa={};ka(xa,{getRandomValues:()=>mn,randomUUID:()=>Pa,subtle:()=>Ua});Ua=globalThis.crypto?.subtle,Pa=()=>globalThis.crypto?.randomUUID(),mn=l=>globalThis.crypto?.getRandomValues(l),Da={};ka(Da,{Certificate:()=>Di,Cipher:()=>Oi,Cipheriv:()=>Vi,Decipher:()=>Ki,Decipheriv:()=>Hi,DiffieHellman:()=>Mi,DiffieHellmanGroup:()=>Fi,ECDH:()=>Gi,Hash:()=>qi,Hmac:()=>ji,KeyObject:()=>zi,Sign:()=>Qi,Verify:()=>Wi,X509Certificate:()=>Yi,checkPrime:()=>Ha,checkPrimeSync:()=>Ma,constants:()=>$o,createCipher:()=>Fa,createCipheriv:()=>ja,createDecipher:()=>Ga,createDecipheriv:()=>za,createDiffieHellman:()=>Qa,createDiffieHellmanGroup:()=>Wa,createECDH:()=>Ya,createHash:()=>Xa,createHmac:()=>$a,createPrivateKey:()=>Ja,createPublicKey:()=>Za,createSecretKey:()=>ei,createSign:()=>ti,createVerify:()=>ri,diffieHellman:()=>ni,fips:()=>Ka,generateKey:()=>mi,generateKeyPair:()=>yi,generateKeyPairSync:()=>gi,generateKeySync:()=>vi,generatePrime:()=>ai,generatePrimeSync:()=>ii,getCipherInfo:()=>oi,getCiphers:()=>si,getCurves:()=>ci,getDiffieHellman:()=>ui,getFips:()=>Li,getHashes:()=>li,hash:()=>Pi,hkdf:()=>pi,hkdfSync:()=>hi,pbkdf2:()=>fi,pbkdf2Sync:()=>di,privateDecrypt:()=>Ei,privateEncrypt:()=>Ci,pseudoRandomBytes:()=>qa,publicDecrypt:()=>Ti,publicEncrypt:()=>Si,randomBytes:()=>Va,randomFill:()=>bi,randomFillSync:()=>Ai,randomInt:()=>Ii,scrypt:()=>Bi,scryptSync:()=>wi,secureHeapUsed:()=>Ui,setEngine:()=>Ni,setFips:()=>ki,sign:()=>_i,timingSafeEqual:()=>Ri,verify:()=>xi,webcrypto:()=>Oa});La=65536,Oa=new Proxy(globalThis.crypto,{get(l,i){return i==="CryptoKey"?globalThis.CryptoKey:typeof globalThis.crypto[i]=="function"?globalThis.crypto[i].bind(globalThis.crypto):globalThis.crypto[i]}}),Va=(l,i)=>{let t=Buffer.alloc(l,0,void 0);for(let e=0;e<l;e+=La)mn(Uint8Array.prototype.slice.call(t,e,e+La));if(typeof i=="function"){i(null,t);return}return t},Ka=!1,$o={},Ha=ce("crypto.checkPrime"),Ma=ce("crypto.checkPrimeSync"),Fa=ce("crypto.createCipher"),Ga=ce("crypto.createDecipher"),qa=ce("crypto.pseudoRandomBytes"),ja=ce("crypto.createCipheriv"),za=ce("crypto.createDecipheriv"),Qa=ce("crypto.createDiffieHellman"),Wa=ce("crypto.createDiffieHellmanGroup"),Ya=ce("crypto.createECDH"),Xa=ce("crypto.createHash"),$a=ce("crypto.createHmac"),Ja=ce("crypto.createPrivateKey"),Za=ce("crypto.createPublicKey"),ei=ce("crypto.createSecretKey"),ti=ce("crypto.createSign"),ri=ce("crypto.createVerify"),ni=ce("crypto.diffieHellman"),ai=ce("crypto.generatePrime"),ii=ce("crypto.generatePrimeSync"),si=ce("crypto.getCiphers"),oi=ce("crypto.getCipherInfo"),ci=ce("crypto.getCurves"),ui=ce("crypto.getDiffieHellman"),li=ce("crypto.getHashes"),pi=ce("crypto.hkdf"),hi=ce("crypto.hkdfSync"),fi=ce("crypto.pbkdf2"),di=ce("crypto.pbkdf2Sync"),yi=ce("crypto.generateKeyPair"),gi=ce("crypto.generateKeyPairSync"),mi=ce("crypto.generateKey"),vi=ce("crypto.generateKeySync"),Ei=ce("crypto.privateDecrypt"),Ci=ce("crypto.privateEncrypt"),Ti=ce("crypto.publicDecrypt"),Si=ce("crypto.publicEncrypt"),bi=ce("crypto.randomFill"),Ai=ce("crypto.randomFillSync"),Ii=ce("crypto.randomInt"),Bi=ce("crypto.scrypt"),wi=ce("crypto.scryptSync"),_i=ce("crypto.sign"),Ni=ce("crypto.setEngine"),Ri=ce("crypto.timingSafeEqual"),Li=ce("crypto.getFips"),ki=ce("crypto.setFips"),xi=ce("crypto.verify"),Ui=ce("crypto.secureHeapUsed"),Pi=ce("crypto.hash"),Di=et("crypto.Certificate"),Oi=et("crypto.Cipher"),Vi=et("crypto.Cipheriv"),Ki=et("crypto.Decipher"),Hi=et("crypto.Decipheriv"),Mi=et("crypto.DiffieHellman"),Fi=et("crypto.DiffieHellmanGroup"),Gi=et("crypto.ECDH"),qi=et("crypto.Hash"),ji=et("crypto.Hmac"),zi=et("crypto.KeyObject"),Qi=et("crypto.Sign"),Wi=et("crypto.Verify"),Yi=et("crypto.X509Certificate"),Xi={ALPN_ENABLED:1,DH_CHECK_P_NOT_PRIME:1,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_NOT_SUITABLE_GENERATOR:8,DH_UNABLE_TO_CHECK_GENERATOR:4,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DH:4,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_DSA:2,ENGINE_METHOD_EC:2048,ENGINE_METHOD_NONE:0,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_RAND:8,ENGINE_METHOD_RSA:1,OPENSSL_VERSION_NUMBER:0,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_HYBRID:6,POINT_CONVERSION_UNCOMPRESSED:4,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_PKCS1_PADDING:1,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_AUTO:-2,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_X931_PADDING:5,SSL_OP_ALL:2147485776,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_NO_TLSv1:67108864,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,TLS1_1_VERSION:0,TLS1_2_VERSION:0,TLS1_3_VERSION:0,TLS1_VERSION:0,defaultCoreCipherList:"",get defaultCipherList(){return Xi.defaultCoreCipherList},set defaultCipherList(l){}},$i=Xi,Jo={...xa,...Da,constants:$i}});var mr,er,Zo,Ji,ec,tc,rc,nc,Tn,pe,ac,ic,fe,sc,ve,Sn,Zi,Ft,Gt,Tt,wt,vr,bn,tr,Kr,An,es,ts,yt,rs,Hr,Er,ns,as,Mr,is,ss,os,oc,In,Bn,cs,us,ls,cc,ps,uc,lc,pc,hc,fc,dc,yc,gc,Cn,mc,hs,wn=Jr(()=>{En();mr=(l,...i)=>({$t:setTimeout(l,0,...i),[Symbol.dispose](){clearTimeout(this.t)}}),er=l=>{let i=e=>typeof e.default<"u"?e.default:e,t=e=>Object.assign({__esModule:!0},e);switch(l){case"node:crypto":return i(vn);default:return console.error('module "'+l+'" not found'),null}},Zo=Object.create,Ji=Object.defineProperty,ec=Object.getOwnPropertyDescriptor,tc=Object.getOwnPropertyNames,rc=Object.getPrototypeOf,nc=Object.prototype.hasOwnProperty,Tn=(l=>typeof er<"u"?er:typeof Proxy<"u"?new Proxy(l,{get:(i,t)=>(typeof er<"u"?er:i)[t]}):l)(function(l){if(typeof er<"u")return er.apply(this,arguments);throw Error('Dynamic require of "'+l+'" is not supported')}),pe=(l,i)=>()=>(i||l((i={exports:{}}).exports,i),i.exports),ac=(l,i,t,e)=>{if(i&&typeof i=="object"||typeof i=="function")for(let r of tc(i))!nc.call(l,r)&&r!==t&&Ji(l,r,{get:()=>i[r],enumerable:!(e=ec(i,r))||e.enumerable});return l},ic=(l,i,t)=>(t=l!=null?Zo(rc(l)):{},ac(i||!l||!l.__esModule?Ji(t,"default",{value:l,enumerable:!0}):t,l)),fe=pe((l,i)=>{i.exports={options:{usePureJavaScript:!1}}}),sc=pe((l,i)=>{var t={};i.exports=t;var e={};t.encode=function(u,f,d){if(typeof f!="string")throw new TypeError('"alphabet" must be a string.');if(d!==void 0&&typeof d!="number")throw new TypeError('"maxline" must be a number.');var c="";if(!(u instanceof Uint8Array))c=r(u,f);else{var n=0,m=f.length,h=f.charAt(0),I=[0];for(n=0;n<u.length;++n){for(var x=0,A=u[n];x<I.length;++x)A+=I[x]<<8,I[x]=A%m,A=A/m|0;for(;A>0;)I.push(A%m),A=A/m|0}for(n=0;u[n]===0&&n<u.length-1;++n)c+=h;for(n=I.length-1;n>=0;--n)c+=f[I[n]]}if(d){var y=new RegExp(".{1,"+d+"}","g");c=c.match(y).join(`\r
`)}return c},t.decode=function(u,f){if(typeof u!="string")throw new TypeError('"input" must be a string.');if(typeof f!="string")throw new TypeError('"alphabet" must be a string.');var d=e[f];if(!d){d=e[f]=[];for(var c=0;c<f.length;++c)d[f.charCodeAt(c)]=c}u=u.replace(/\s/g,"");for(var n=f.length,m=f.charAt(0),h=[0],c=0;c<u.length;c++){var I=d[u.charCodeAt(c)];if(I===void 0)return;for(var x=0,A=I;x<h.length;++x)A+=h[x]*n,h[x]=A&255,A>>=8;for(;A>0;)h.push(A&255),A>>=8}for(var y=0;u[y]===m&&y<u.length-1;++y)h.push(0);return typeof __Buffer$<"u"?__Buffer$.from(h.reverse()):new Uint8Array(h.reverse())};function r(u,f){var d=0,c=f.length,n=f.charAt(0),m=[0];for(d=0;d<u.length();++d){for(var h=0,I=u.at(d);h<m.length;++h)I+=m[h]<<8,m[h]=I%c,I=I/c|0;for(;I>0;)m.push(I%c),I=I/c|0}var x="";for(d=0;u.at(d)===0&&d<u.length()-1;++d)x+=n;for(d=m.length-1;d>=0;--d)x+=f[m[d]];return x}}),ve=pe((l,i)=>{var t=fe(),e=sc(),r=i.exports=t.util=t.util||{};(function(){if(typeof __Process$<"u"&&__Process$.nextTick&&!__Process$.browser){r.nextTick=__Process$.nextTick,typeof mr=="function"?r.setImmediate=mr:r.setImmediate=r.nextTick;return}if(typeof mr=="function"){r.setImmediate=function(){return mr.apply(void 0,arguments)},r.nextTick=function(a){return mr(a)};return}if(r.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(w){if(w.source===window&&w.data===E){w.stopPropagation();var P=C.slice();C.length=0,P.forEach(function(K){K()})}};var s=a,E="forge.setImmediate",C=[];r.setImmediate=function(w){C.push(w),C.length===1&&window.postMessage(E,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var _=Date.now(),k=!0,v=document.createElement("div"),C=[];new MutationObserver(function(){var w=C.slice();C.length=0,w.forEach(function(P){P()})}).observe(v,{attributes:!0});var o=r.setImmediate;r.setImmediate=function(w){Date.now()-_>15?(_=Date.now(),o(w)):(C.push(w),C.length===1&&v.setAttribute("a",k=!k))}}r.nextTick=r.setImmediate})(),r.isNodejs=typeof __Process$<"u"&&__Process$.versions&&__Process$.versions.node,r.globalScope=function(){return r.isNodejs?globalThis:typeof self>"u"?window:self}(),r.isArray=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"},r.isArrayBuffer=function(s){return typeof ArrayBuffer<"u"&&s instanceof ArrayBuffer},r.isArrayBufferView=function(s){return s&&r.isArrayBuffer(s.buffer)&&s.byteLength!==void 0};function u(s){if(!(s===8||s===16||s===24||s===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+s)}r.ByteBuffer=f;function f(s){if(this.data="",this.read=0,typeof s=="string")this.data=s;else if(r.isArrayBuffer(s)||r.isArrayBufferView(s))if(typeof __Buffer$<"u"&&s instanceof __Buffer$)this.data=s.toString("binary");else{var E=new Uint8Array(s);try{this.data=String.fromCharCode.apply(null,E)}catch{for(var C=0;C<E.length;++C)this.putByte(E[C])}}else(s instanceof f||typeof s=="object"&&typeof s.data=="string"&&typeof s.read=="number")&&(this.data=s.data,this.read=s.read);this._constructedStringLength=0}r.ByteStringBuffer=f;var d=4096;r.ByteStringBuffer.prototype._optimizeConstructedString=function(s){this._constructedStringLength+=s,this._constructedStringLength>d&&(this.data.substr(0,1),this._constructedStringLength=0)},r.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},r.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},r.ByteStringBuffer.prototype.putByte=function(s){return this.putBytes(String.fromCharCode(s))},r.ByteStringBuffer.prototype.fillWithByte=function(s,E){s=String.fromCharCode(s);for(var C=this.data;E>0;)E&1&&(C+=s),E>>>=1,E>0&&(s+=s);return this.data=C,this._optimizeConstructedString(E),this},r.ByteStringBuffer.prototype.putBytes=function(s){return this.data+=s,this._optimizeConstructedString(s.length),this},r.ByteStringBuffer.prototype.putString=function(s){return this.putBytes(r.encodeUtf8(s))},r.ByteStringBuffer.prototype.putInt16=function(s){return this.putBytes(String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))},r.ByteStringBuffer.prototype.putInt24=function(s){return this.putBytes(String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))},r.ByteStringBuffer.prototype.putInt32=function(s){return this.putBytes(String.fromCharCode(s>>24&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))},r.ByteStringBuffer.prototype.putInt16Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255))},r.ByteStringBuffer.prototype.putInt24Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s>>16&255))},r.ByteStringBuffer.prototype.putInt32Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>24&255))},r.ByteStringBuffer.prototype.putInt=function(s,E){u(E);var C="";do E-=8,C+=String.fromCharCode(s>>E&255);while(E>0);return this.putBytes(C)},r.ByteStringBuffer.prototype.putSignedInt=function(s,E){return s<0&&(s+=2<<E-1),this.putInt(s,E)},r.ByteStringBuffer.prototype.putBuffer=function(s){return this.putBytes(s.getBytes())},r.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},r.ByteStringBuffer.prototype.getInt16=function(){var s=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,s},r.ByteStringBuffer.prototype.getInt24=function(){var s=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,s},r.ByteStringBuffer.prototype.getInt32=function(){var s=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,s},r.ByteStringBuffer.prototype.getInt16Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,s},r.ByteStringBuffer.prototype.getInt24Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,s},r.ByteStringBuffer.prototype.getInt32Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,s},r.ByteStringBuffer.prototype.getInt=function(s){u(s);var E=0;do E=(E<<8)+this.data.charCodeAt(this.read++),s-=8;while(s>0);return E},r.ByteStringBuffer.prototype.getSignedInt=function(s){var E=this.getInt(s),C=2<<s-2;return E>=C&&(E-=C<<1),E},r.ByteStringBuffer.prototype.getBytes=function(s){var E;return s?(s=Math.min(this.length(),s),E=this.data.slice(this.read,this.read+s),this.read+=s):s===0?E="":(E=this.read===0?this.data:this.data.slice(this.read),this.clear()),E},r.ByteStringBuffer.prototype.bytes=function(s){return typeof s>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+s)},r.ByteStringBuffer.prototype.at=function(s){return this.data.charCodeAt(this.read+s)},r.ByteStringBuffer.prototype.setAt=function(s,E){return this.data=this.data.substr(0,this.read+s)+String.fromCharCode(E)+this.data.substr(this.read+s+1),this},r.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},r.ByteStringBuffer.prototype.copy=function(){var s=r.createBuffer(this.data);return s.read=this.read,s},r.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},r.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},r.ByteStringBuffer.prototype.truncate=function(s){var E=Math.max(0,this.length()-s);return this.data=this.data.substr(this.read,E),this.read=0,this},r.ByteStringBuffer.prototype.toHex=function(){for(var s="",E=this.read;E<this.data.length;++E){var C=this.data.charCodeAt(E);C<16&&(s+="0"),s+=C.toString(16)}return s},r.ByteStringBuffer.prototype.toString=function(){return r.decodeUtf8(this.bytes())};function c(s,E){E=E||{},this.read=E.readOffset||0,this.growSize=E.growSize||1024;var C=r.isArrayBuffer(s),_=r.isArrayBufferView(s);if(C||_){C?this.data=new DataView(s):this.data=new DataView(s.buffer,s.byteOffset,s.byteLength),this.write="writeOffset"in E?E.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,s!=null&&this.putBytes(s),"writeOffset"in E&&(this.write=E.writeOffset)}r.DataBuffer=c,r.DataBuffer.prototype.length=function(){return this.write-this.read},r.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},r.DataBuffer.prototype.accommodate=function(s,E){if(this.length()>=s)return this;E=Math.max(E||this.growSize,s);var C=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),_=new Uint8Array(this.length()+E);return _.set(C),this.data=new DataView(_.buffer),this},r.DataBuffer.prototype.putByte=function(s){return this.accommodate(1),this.data.setUint8(this.write++,s),this},r.DataBuffer.prototype.fillWithByte=function(s,E){this.accommodate(E);for(var C=0;C<E;++C)this.data.setUint8(s);return this},r.DataBuffer.prototype.putBytes=function(s,E){if(r.isArrayBufferView(s)){var C=new Uint8Array(s.buffer,s.byteOffset,s.byteLength),_=C.byteLength-C.byteOffset;this.accommodate(_);var k=new Uint8Array(this.data.buffer,this.write);return k.set(C),this.write+=_,this}if(r.isArrayBuffer(s)){var C=new Uint8Array(s);this.accommodate(C.byteLength);var k=new Uint8Array(this.data.buffer);return k.set(C,this.write),this.write+=C.byteLength,this}if(s instanceof r.DataBuffer||typeof s=="object"&&typeof s.read=="number"&&typeof s.write=="number"&&r.isArrayBufferView(s.data)){var C=new Uint8Array(s.data.byteLength,s.read,s.length());this.accommodate(C.byteLength);var k=new Uint8Array(s.data.byteLength,this.write);return k.set(C),this.write+=C.byteLength,this}if(s instanceof r.ByteStringBuffer&&(s=s.data,E="binary"),E=E||"binary",typeof s=="string"){var v;if(E==="hex")return this.accommodate(Math.ceil(s.length/2)),v=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.hex.decode(s,v,this.write),this;if(E==="base64")return this.accommodate(Math.ceil(s.length/4)*3),v=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.base64.decode(s,v,this.write),this;if(E==="utf8"&&(s=r.encodeUtf8(s),E="binary"),E==="binary"||E==="raw")return this.accommodate(s.length),v=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.raw.decode(v),this;if(E==="utf16")return this.accommodate(s.length*2),v=new Uint16Array(this.data.buffer,this.write),this.write+=r.text.utf16.encode(v),this;throw new Error("Invalid encoding: "+E)}throw Error("Invalid parameter: "+s)},r.DataBuffer.prototype.putBuffer=function(s){return this.putBytes(s),s.clear(),this},r.DataBuffer.prototype.putString=function(s){return this.putBytes(s,"utf16")},r.DataBuffer.prototype.putInt16=function(s){return this.accommodate(2),this.data.setInt16(this.write,s),this.write+=2,this},r.DataBuffer.prototype.putInt24=function(s){return this.accommodate(3),this.data.setInt16(this.write,s>>8&65535),this.data.setInt8(this.write,s>>16&255),this.write+=3,this},r.DataBuffer.prototype.putInt32=function(s){return this.accommodate(4),this.data.setInt32(this.write,s),this.write+=4,this},r.DataBuffer.prototype.putInt16Le=function(s){return this.accommodate(2),this.data.setInt16(this.write,s,!0),this.write+=2,this},r.DataBuffer.prototype.putInt24Le=function(s){return this.accommodate(3),this.data.setInt8(this.write,s>>16&255),this.data.setInt16(this.write,s>>8&65535,!0),this.write+=3,this},r.DataBuffer.prototype.putInt32Le=function(s){return this.accommodate(4),this.data.setInt32(this.write,s,!0),this.write+=4,this},r.DataBuffer.prototype.putInt=function(s,E){u(E),this.accommodate(E/8);do E-=8,this.data.setInt8(this.write++,s>>E&255);while(E>0);return this},r.DataBuffer.prototype.putSignedInt=function(s,E){return u(E),this.accommodate(E/8),s<0&&(s+=2<<E-1),this.putInt(s,E)},r.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},r.DataBuffer.prototype.getInt16=function(){var s=this.data.getInt16(this.read);return this.read+=2,s},r.DataBuffer.prototype.getInt24=function(){var s=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,s},r.DataBuffer.prototype.getInt32=function(){var s=this.data.getInt32(this.read);return this.read+=4,s},r.DataBuffer.prototype.getInt16Le=function(){var s=this.data.getInt16(this.read,!0);return this.read+=2,s},r.DataBuffer.prototype.getInt24Le=function(){var s=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,s},r.DataBuffer.prototype.getInt32Le=function(){var s=this.data.getInt32(this.read,!0);return this.read+=4,s},r.DataBuffer.prototype.getInt=function(s){u(s);var E=0;do E=(E<<8)+this.data.getInt8(this.read++),s-=8;while(s>0);return E},r.DataBuffer.prototype.getSignedInt=function(s){var E=this.getInt(s),C=2<<s-2;return E>=C&&(E-=C<<1),E},r.DataBuffer.prototype.getBytes=function(s){var E;return s?(s=Math.min(this.length(),s),E=this.data.slice(this.read,this.read+s),this.read+=s):s===0?E="":(E=this.read===0?this.data:this.data.slice(this.read),this.clear()),E},r.DataBuffer.prototype.bytes=function(s){return typeof s>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+s)},r.DataBuffer.prototype.at=function(s){return this.data.getUint8(this.read+s)},r.DataBuffer.prototype.setAt=function(s,E){return this.data.setUint8(s,E),this},r.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},r.DataBuffer.prototype.copy=function(){return new r.DataBuffer(this)},r.DataBuffer.prototype.compact=function(){if(this.read>0){var s=new Uint8Array(this.data.buffer,this.read),E=new Uint8Array(s.byteLength);E.set(s),this.data=new DataView(E),this.write-=this.read,this.read=0}return this},r.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},r.DataBuffer.prototype.truncate=function(s){return this.write=Math.max(0,this.length()-s),this.read=Math.min(this.read,this.write),this},r.DataBuffer.prototype.toHex=function(){for(var s="",E=this.read;E<this.data.byteLength;++E){var C=this.data.getUint8(E);C<16&&(s+="0"),s+=C.toString(16)}return s},r.DataBuffer.prototype.toString=function(s){var E=new Uint8Array(this.data,this.read,this.length());if(s=s||"utf8",s==="binary"||s==="raw")return r.binary.raw.encode(E);if(s==="hex")return r.binary.hex.encode(E);if(s==="base64")return r.binary.base64.encode(E);if(s==="utf8")return r.text.utf8.decode(E);if(s==="utf16")return r.text.utf16.decode(E);throw new Error("Invalid encoding: "+s)},r.createBuffer=function(s,E){return E=E||"raw",s!==void 0&&E==="utf8"&&(s=r.encodeUtf8(s)),new r.ByteBuffer(s)},r.fillString=function(s,E){for(var C="";E>0;)E&1&&(C+=s),E>>>=1,E>0&&(s+=s);return C},r.xorBytes=function(s,E,C){for(var _="",k="",v="",o=0,a=0;C>0;--C,++o)k=s.charCodeAt(o)^E.charCodeAt(o),a>=10&&(_+=v,v="",a=0),v+=String.fromCharCode(k),++a;return _+=v,_},r.hexToBytes=function(s){var E="",C=0;for(s.length&!0&&(C=1,E+=String.fromCharCode(parseInt(s[0],16)));C<s.length;C+=2)E+=String.fromCharCode(parseInt(s.substr(C,2),16));return E},r.bytesToHex=function(s){return r.createBuffer(s).toHex()},r.int32ToBytes=function(s){return String.fromCharCode(s>>24&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255)};var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",m=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],h="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";r.encode64=function(s,E){for(var C="",_="",k,v,o,a=0;a<s.length;)k=s.charCodeAt(a++),v=s.charCodeAt(a++),o=s.charCodeAt(a++),C+=n.charAt(k>>2),C+=n.charAt((k&3)<<4|v>>4),isNaN(v)?C+="==":(C+=n.charAt((v&15)<<2|o>>6),C+=isNaN(o)?"=":n.charAt(o&63)),E&&C.length>E&&(_+=C.substr(0,E)+`\r
`,C=C.substr(E));return _+=C,_},r.decode64=function(s){s=s.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var E="",C,_,k,v,o=0;o<s.length;)C=m[s.charCodeAt(o++)-43],_=m[s.charCodeAt(o++)-43],k=m[s.charCodeAt(o++)-43],v=m[s.charCodeAt(o++)-43],E+=String.fromCharCode(C<<2|_>>4),k!==64&&(E+=String.fromCharCode((_&15)<<4|k>>2),v!==64&&(E+=String.fromCharCode((k&3)<<6|v)));return E},r.encodeUtf8=function(s){return unescape(encodeURIComponent(s))},r.decodeUtf8=function(s){return decodeURIComponent(escape(s))},r.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:e.encode,decode:e.decode}},r.binary.raw.encode=function(s){return String.fromCharCode.apply(null,s)},r.binary.raw.decode=function(s,E,C){var _=E;_||(_=new Uint8Array(s.length)),C=C||0;for(var k=C,v=0;v<s.length;++v)_[k++]=s.charCodeAt(v);return E?k-C:_},r.binary.hex.encode=r.bytesToHex,r.binary.hex.decode=function(s,E,C){var _=E;_||(_=new Uint8Array(Math.ceil(s.length/2))),C=C||0;var k=0,v=C;for(s.length&1&&(k=1,_[v++]=parseInt(s[0],16));k<s.length;k+=2)_[v++]=parseInt(s.substr(k,2),16);return E?v-C:_},r.binary.base64.encode=function(s,E){for(var C="",_="",k,v,o,a=0;a<s.byteLength;)k=s[a++],v=s[a++],o=s[a++],C+=n.charAt(k>>2),C+=n.charAt((k&3)<<4|v>>4),isNaN(v)?C+="==":(C+=n.charAt((v&15)<<2|o>>6),C+=isNaN(o)?"=":n.charAt(o&63)),E&&C.length>E&&(_+=C.substr(0,E)+`\r
`,C=C.substr(E));return _+=C,_},r.binary.base64.decode=function(s,E,C){var _=E;_||(_=new Uint8Array(Math.ceil(s.length/4)*3)),s=s.replace(/[^A-Za-z0-9\+\/\=]/g,""),C=C||0;for(var k,v,o,a,w=0,P=C;w<s.length;)k=m[s.charCodeAt(w++)-43],v=m[s.charCodeAt(w++)-43],o=m[s.charCodeAt(w++)-43],a=m[s.charCodeAt(w++)-43],_[P++]=k<<2|v>>4,o!==64&&(_[P++]=(v&15)<<4|o>>2,a!==64&&(_[P++]=(o&3)<<6|a));return E?P-C:_.subarray(0,P)},r.binary.base58.encode=function(s,E){return r.binary.baseN.encode(s,h,E)},r.binary.base58.decode=function(s,E){return r.binary.baseN.decode(s,h,E)},r.text={utf8:{},utf16:{}},r.text.utf8.encode=function(s,E,C){s=r.encodeUtf8(s);var _=E;_||(_=new Uint8Array(s.length)),C=C||0;for(var k=C,v=0;v<s.length;++v)_[k++]=s.charCodeAt(v);return E?k-C:_},r.text.utf8.decode=function(s){return r.decodeUtf8(String.fromCharCode.apply(null,s))},r.text.utf16.encode=function(s,E,C){var _=E;_||(_=new Uint8Array(s.length*2));var k=new Uint16Array(_.buffer);C=C||0;for(var v=C,o=C,a=0;a<s.length;++a)k[o++]=s.charCodeAt(a),v+=2;return E?v-C:_},r.text.utf16.decode=function(s){return String.fromCharCode.apply(null,new Uint16Array(s.buffer))},r.deflate=function(s,E,C){if(E=r.decode64(s.deflate(r.encode64(E)).rval),C){var _=2,k=E.charCodeAt(1);k&32&&(_=6),E=E.substring(_,E.length-4)}return E},r.inflate=function(s,E,C){var _=s.inflate(r.encode64(E)).rval;return _===null?null:r.decode64(_)};var I=function(s,E,C){if(!s)throw new Error("WebStorage not available.");var _;if(C===null?_=s.removeItem(E):(C=r.encode64(JSON.stringify(C)),_=s.setItem(E,C)),typeof _<"u"&&_.rval!==!0){var k=new Error(_.error.message);throw k.id=_.error.id,k.name=_.error.name,k}},x=function(s,E){if(!s)throw new Error("WebStorage not available.");var C=s.getItem(E);if(s.init)if(C.rval===null){if(C.error){var _=new Error(C.error.message);throw _.id=C.error.id,_.name=C.error.name,_}C=null}else C=C.rval;return C!==null&&(C=JSON.parse(r.decode64(C))),C},A=function(s,E,C,_){var k=x(s,E);k===null&&(k={}),k[C]=_,I(s,E,k)},y=function(s,E,C){var _=x(s,E);return _!==null&&(_=C in _?_[C]:null),_},T=function(s,E,C){var _=x(s,E);if(_!==null&&C in _){delete _[C];var k=!0;for(var v in _){k=!1;break}k&&(_=null),I(s,E,_)}},b=function(s,E){I(s,E,null)},S=function(s,E,C){var _=null;typeof C>"u"&&(C=["web","flash"]);var k,v=!1,o=null;for(var a in C){k=C[a];try{if(k==="flash"||k==="both"){if(E[0]===null)throw new Error("Flash local storage not available.");_=s.apply(this,E),v=k==="flash"}(k==="web"||k==="both")&&(E[0]=localStorage,_=s.apply(this,E),v=!0)}catch(w){o=w}if(v)break}if(!v)throw o;return _};r.setItem=function(s,E,C,_,k){S(A,arguments,k)},r.getItem=function(s,E,C,_){return S(y,arguments,_)},r.removeItem=function(s,E,C,_){S(T,arguments,_)},r.clearItems=function(s,E,C){S(b,arguments,C)},r.isEmpty=function(s){for(var E in s)if(s.hasOwnProperty(E))return!1;return!0},r.format=function(s){for(var E=/%./g,C,_,k=0,v=[],o=0;C=E.exec(s);){_=s.substring(o,E.lastIndex-2),_.length>0&&v.push(_),o=E.lastIndex;var a=C[0][1];switch(a){case"s":case"o":k<arguments.length?v.push(arguments[k+++1]):v.push("<?>");break;case"%":v.push("%");break;default:v.push("<%"+a+"?>")}}return v.push(s.substring(o)),v.join("")},r.formatNumber=function(s,E,C,_){var k=s,v=isNaN(E=Math.abs(E))?2:E,o=C===void 0?",":C,a=_===void 0?".":_,w=k<0?"-":"",P=parseInt(k=Math.abs(+k||0).toFixed(v),10)+"",K=P.length>3?P.length%3:0;return w+(K?P.substr(0,K)+a:"")+P.substr(K).replace(/(\d{3})(?=\d)/g,"$1"+a)+(v?o+Math.abs(k-P).toFixed(v).slice(2):"")},r.formatSize=function(s){return s>=1073741824?s=r.formatNumber(s/1073741824,2,".","")+" GiB":s>=1048576?s=r.formatNumber(s/1048576,2,".","")+" MiB":s>=1024?s=r.formatNumber(s/1024,0)+" KiB":s=r.formatNumber(s,0)+" bytes",s},r.bytesFromIP=function(s){return s.indexOf(".")!==-1?r.bytesFromIPv4(s):s.indexOf(":")!==-1?r.bytesFromIPv6(s):null},r.bytesFromIPv4=function(s){if(s=s.split("."),s.length!==4)return null;for(var E=r.createBuffer(),C=0;C<s.length;++C){var _=parseInt(s[C],10);if(isNaN(_))return null;E.putByte(_)}return E.getBytes()},r.bytesFromIPv6=function(s){var E=0;s=s.split(":").filter(function(o){return o.length===0&&++E,!0});for(var C=(8-s.length+E)*2,_=r.createBuffer(),k=0;k<8;++k){if(!s[k]||s[k].length===0){_.fillWithByte(0,C),C=0;continue}var v=r.hexToBytes(s[k]);v.length<2&&_.putByte(0),_.putBytes(v)}return _.getBytes()},r.bytesToIP=function(s){return s.length===4?r.bytesToIPv4(s):s.length===16?r.bytesToIPv6(s):null},r.bytesToIPv4=function(s){if(s.length!==4)return null;for(var E=[],C=0;C<s.length;++C)E.push(s.charCodeAt(C));return E.join(".")},r.bytesToIPv6=function(s){if(s.length!==16)return null;for(var E=[],C=[],_=0,k=0;k<s.length;k+=2){for(var v=r.bytesToHex(s[k]+s[k+1]);v[0]==="0"&&v!=="0";)v=v.substr(1);if(v==="0"){var o=C[C.length-1],a=E.length;!o||a!==o.end+1?C.push({start:a,end:a}):(o.end=a,o.end-o.start>C[_].end-C[_].start&&(_=C.length-1))}E.push(v)}if(C.length>0){var w=C[_];w.end-w.start>0&&(E.splice(w.start,w.end-w.start+1,""),w.start===0&&E.unshift(""),w.end===7&&E.push(""))}return E.join(":")},r.estimateCores=function(s,E){if(typeof s=="function"&&(E=s,s={}),s=s||{},"cores"in r&&!s.update)return E(null,r.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return r.cores=navigator.hardwareConcurrency,E(null,r.cores);if(typeof Worker>"u")return r.cores=1,E(null,r.cores);if(typeof Blob>"u")return r.cores=2,E(null,r.cores);var C=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),w=a+4;Date.now()<w;);self.postMessage({st:a,et:w})})}.toString(),")()"],{type:"application/javascript"}));_([],5,16);function _(o,a,w){if(a===0){var P=Math.floor(o.reduce(function(K,D){return K+D},0)/o.length);return r.cores=Math.max(1,P),URL.revokeObjectURL(C),E(null,r.cores)}k(w,function(K,D){o.push(v(w,D)),_(o,a-1,w)})}function k(o,a){for(var w=[],P=[],K=0;K<o;++K){var D=new Worker(C);D.addEventListener("message",function(H){if(P.push(H.data),P.length===o){for(var G=0;G<o;++G)w[G].terminate();a(null,P)}}),w.push(D)}for(var K=0;K<o;++K)w[K].postMessage(K)}function v(o,a){for(var w=[],P=0;P<o;++P)for(var K=a[P],D=w[P]=[],H=0;H<o;++H)if(P!==H){var G=a[H];(K.st>G.st&&K.st<G.et||G.st>K.st&&G.st<K.et)&&D.push(H)}return w.reduce(function(q,j){return Math.max(q,j.length)},0)}}}),Sn=pe((l,i)=>{var t=fe();ve(),i.exports=t.cipher=t.cipher||{},t.cipher.algorithms=t.cipher.algorithms||{},t.cipher.createCipher=function(r,u){var f=r;if(typeof f=="string"&&(f=t.cipher.getAlgorithm(f),f&&(f=f())),!f)throw new Error("Unsupported algorithm: "+r);return new t.cipher.BlockCipher({algorithm:f,key:u,decrypt:!1})},t.cipher.createDecipher=function(r,u){var f=r;if(typeof f=="string"&&(f=t.cipher.getAlgorithm(f),f&&(f=f())),!f)throw new Error("Unsupported algorithm: "+r);return new t.cipher.BlockCipher({algorithm:f,key:u,decrypt:!0})},t.cipher.registerAlgorithm=function(r,u){r=r.toUpperCase(),t.cipher.algorithms[r]=u},t.cipher.getAlgorithm=function(r){return r=r.toUpperCase(),r in t.cipher.algorithms?t.cipher.algorithms[r]:null};var e=t.cipher.BlockCipher=function(r){this.algorithm=r.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=r.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=r.decrypt,this.algorithm.initialize(r)};e.prototype.start=function(r){r=r||{};var u={};for(var f in r)u[f]=r[f];u.decrypt=this._decrypt,this._finish=!1,this._input=t.util.createBuffer(),this.output=r.output||t.util.createBuffer(),this.mode.start(u)},e.prototype.update=function(r){for(r&&this._input.putBuffer(r);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},e.prototype.finish=function(r){r&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(f){return r(this.blockSize,f,!1)},this.mode.unpad=function(f){return r(this.blockSize,f,!0)});var u={};return u.decrypt=this._decrypt,u.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,u)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,u))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,u))}}),Zi=pe((l,i)=>{var t=fe();ve(),t.cipher=t.cipher||{};var e=i.exports=t.cipher.modes=t.cipher.modes||{};e.ecb=function(d){d=d||{},this.name="ECB",this.cipher=d.cipher,this.blockSize=d.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.ecb.prototype.start=function(d){},e.ecb.prototype.encrypt=function(d,c,n){if(d.length()<this.blockSize&&!(n&&d.length()>0))return!0;for(var m=0;m<this._ints;++m)this._inBlock[m]=d.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var m=0;m<this._ints;++m)c.putInt32(this._outBlock[m])},e.ecb.prototype.decrypt=function(d,c,n){if(d.length()<this.blockSize&&!(n&&d.length()>0))return!0;for(var m=0;m<this._ints;++m)this._inBlock[m]=d.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var m=0;m<this._ints;++m)c.putInt32(this._outBlock[m])},e.ecb.prototype.pad=function(d,c){var n=d.length()===this.blockSize?this.blockSize:this.blockSize-d.length();return d.fillWithByte(n,n),!0},e.ecb.prototype.unpad=function(d,c){if(c.overflow>0)return!1;var n=d.length(),m=d.at(n-1);return m>this.blockSize<<2?!1:(d.truncate(m),!0)},e.cbc=function(d){d=d||{},this.name="CBC",this.cipher=d.cipher,this.blockSize=d.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.cbc.prototype.start=function(d){if(d.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in d)this._iv=r(d.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},e.cbc.prototype.encrypt=function(d,c,n){if(d.length()<this.blockSize&&!(n&&d.length()>0))return!0;for(var m=0;m<this._ints;++m)this._inBlock[m]=this._prev[m]^d.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var m=0;m<this._ints;++m)c.putInt32(this._outBlock[m]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(d,c,n){if(d.length()<this.blockSize&&!(n&&d.length()>0))return!0;for(var m=0;m<this._ints;++m)this._inBlock[m]=d.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var m=0;m<this._ints;++m)c.putInt32(this._prev[m]^this._outBlock[m]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(d,c){var n=d.length()===this.blockSize?this.blockSize:this.blockSize-d.length();return d.fillWithByte(n,n),!0},e.cbc.prototype.unpad=function(d,c){if(c.overflow>0)return!1;var n=d.length(),m=d.at(n-1);return m>this.blockSize<<2?!1:(d.truncate(m),!0)},e.cfb=function(d){d=d||{},this.name="CFB",this.cipher=d.cipher,this.blockSize=d.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(d){if(!("iv"in d))throw new Error("Invalid IV parameter.");this._iv=r(d.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(d,c,n){var m=d.length();if(m===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&m>=this.blockSize){for(var h=0;h<this._ints;++h)this._inBlock[h]=d.getInt32()^this._outBlock[h],c.putInt32(this._inBlock[h]);return}var I=(this.blockSize-m)%this.blockSize;I>0&&(I=this.blockSize-I),this._partialOutput.clear();for(var h=0;h<this._ints;++h)this._partialBlock[h]=d.getInt32()^this._outBlock[h],this._partialOutput.putInt32(this._partialBlock[h]);if(I>0)d.read-=this.blockSize;else for(var h=0;h<this._ints;++h)this._inBlock[h]=this._partialBlock[h];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),I>0&&!n)return c.putBytes(this._partialOutput.getBytes(I-this._partialBytes)),this._partialBytes=I,!0;c.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=0},e.cfb.prototype.decrypt=function(d,c,n){var m=d.length();if(m===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&m>=this.blockSize){for(var h=0;h<this._ints;++h)this._inBlock[h]=d.getInt32(),c.putInt32(this._inBlock[h]^this._outBlock[h]);return}var I=(this.blockSize-m)%this.blockSize;I>0&&(I=this.blockSize-I),this._partialOutput.clear();for(var h=0;h<this._ints;++h)this._partialBlock[h]=d.getInt32(),this._partialOutput.putInt32(this._partialBlock[h]^this._outBlock[h]);if(I>0)d.read-=this.blockSize;else for(var h=0;h<this._ints;++h)this._inBlock[h]=this._partialBlock[h];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),I>0&&!n)return c.putBytes(this._partialOutput.getBytes(I-this._partialBytes)),this._partialBytes=I,!0;c.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=0},e.ofb=function(d){d=d||{},this.name="OFB",this.cipher=d.cipher,this.blockSize=d.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(d){if(!("iv"in d))throw new Error("Invalid IV parameter.");this._iv=r(d.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(d,c,n){var m=d.length();if(d.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&m>=this.blockSize){for(var h=0;h<this._ints;++h)c.putInt32(d.getInt32()^this._outBlock[h]),this._inBlock[h]=this._outBlock[h];return}var I=(this.blockSize-m)%this.blockSize;I>0&&(I=this.blockSize-I),this._partialOutput.clear();for(var h=0;h<this._ints;++h)this._partialOutput.putInt32(d.getInt32()^this._outBlock[h]);if(I>0)d.read-=this.blockSize;else for(var h=0;h<this._ints;++h)this._inBlock[h]=this._outBlock[h];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),I>0&&!n)return c.putBytes(this._partialOutput.getBytes(I-this._partialBytes)),this._partialBytes=I,!0;c.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=0},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(d){d=d||{},this.name="CTR",this.cipher=d.cipher,this.blockSize=d.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(d){if(!("iv"in d))throw new Error("Invalid IV parameter.");this._iv=r(d.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(d,c,n){var m=d.length();if(m===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&m>=this.blockSize)for(var h=0;h<this._ints;++h)c.putInt32(d.getInt32()^this._outBlock[h]);else{var I=(this.blockSize-m)%this.blockSize;I>0&&(I=this.blockSize-I),this._partialOutput.clear();for(var h=0;h<this._ints;++h)this._partialOutput.putInt32(d.getInt32()^this._outBlock[h]);if(I>0&&(d.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),I>0&&!n)return c.putBytes(this._partialOutput.getBytes(I-this._partialBytes)),this._partialBytes=I,!0;c.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=0}u(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(d){d=d||{},this.name="GCM",this.cipher=d.cipher,this.blockSize=d.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(d){if(!("iv"in d))throw new Error("Invalid IV parameter.");var c=t.util.createBuffer(d.iv);this._cipherLength=0;var n;if("additionalData"in d?n=t.util.createBuffer(d.additionalData):n=t.util.createBuffer(),"tagLength"in d?this._tagLength=d.tagLength:this._tagLength=128,this._tag=null,d.decrypt&&(this._tag=t.util.createBuffer(d.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var m=c.length();if(m===12)this._j0=[c.getInt32(),c.getInt32(),c.getInt32(),1];else{for(this._j0=[0,0,0,0];c.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[c.getInt32(),c.getInt32(),c.getInt32(),c.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(f(m*8)))}this._inBlock=this._j0.slice(0),u(this._inBlock),this._partialBytes=0,n=t.util.createBuffer(n),this._aDataLength=f(n.length()*8);var h=n.length()%this.blockSize;for(h&&n.fillWithByte(0,this.blockSize-h),this._s=[0,0,0,0];n.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[n.getInt32(),n.getInt32(),n.getInt32(),n.getInt32()])},e.gcm.prototype.encrypt=function(d,c,n){var m=d.length();if(m===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&m>=this.blockSize){for(var h=0;h<this._ints;++h)c.putInt32(this._outBlock[h]^=d.getInt32());this._cipherLength+=this.blockSize}else{var I=(this.blockSize-m)%this.blockSize;I>0&&(I=this.blockSize-I),this._partialOutput.clear();for(var h=0;h<this._ints;++h)this._partialOutput.putInt32(d.getInt32()^this._outBlock[h]);if(I<=0||n){if(n){var x=m%this.blockSize;this._cipherLength+=x,this._partialOutput.truncate(this.blockSize-x)}else this._cipherLength+=this.blockSize;for(var h=0;h<this._ints;++h)this._outBlock[h]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),I>0&&!n)return d.read-=this.blockSize,c.putBytes(this._partialOutput.getBytes(I-this._partialBytes)),this._partialBytes=I,!0;c.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),u(this._inBlock)},e.gcm.prototype.decrypt=function(d,c,n){var m=d.length();if(m<this.blockSize&&!(n&&m>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),u(this._inBlock),this._hashBlock[0]=d.getInt32(),this._hashBlock[1]=d.getInt32(),this._hashBlock[2]=d.getInt32(),this._hashBlock[3]=d.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var h=0;h<this._ints;++h)c.putInt32(this._outBlock[h]^this._hashBlock[h]);m<this.blockSize?this._cipherLength+=m%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(d,c){var n=!0;c.decrypt&&c.overflow&&d.truncate(this.blockSize-c.overflow),this.tag=t.util.createBuffer();var m=this._aDataLength.concat(f(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,m);var h=[];this.cipher.encrypt(this._j0,h);for(var I=0;I<this._ints;++I)this.tag.putInt32(this._s[I]^h[I]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),c.decrypt&&this.tag.bytes()!==this._tag&&(n=!1),n},e.gcm.prototype.multiply=function(d,c){for(var n=[0,0,0,0],m=c.slice(0),h=0;h<128;++h){var I=d[h/32|0]&1<<31-h%32;I&&(n[0]^=m[0],n[1]^=m[1],n[2]^=m[2],n[3]^=m[3]),this.pow(m,m)}return n},e.gcm.prototype.pow=function(d,c){for(var n=d[3]&1,m=3;m>0;--m)c[m]=d[m]>>>1|(d[m-1]&1)<<31;c[0]=d[0]>>>1,n&&(c[0]^=this._R)},e.gcm.prototype.tableMultiply=function(d){for(var c=[0,0,0,0],n=0;n<32;++n){var m=n/8|0,h=d[m]>>>(7-n%8)*4&15,I=this._m[n][h];c[0]^=I[0],c[1]^=I[1],c[2]^=I[2],c[3]^=I[3]}return c},e.gcm.prototype.ghash=function(d,c,n){return c[0]^=n[0],c[1]^=n[1],c[2]^=n[2],c[3]^=n[3],this.tableMultiply(c)},e.gcm.prototype.generateHashTable=function(d,c){for(var n=8/c,m=4*n,h=16*n,I=new Array(h),x=0;x<h;++x){var A=[0,0,0,0],y=x/m|0,T=(m-1-x%m)*c;A[y]=1<<c-1<<T,I[x]=this.generateSubHashTable(this.multiply(A,d),c)}return I},e.gcm.prototype.generateSubHashTable=function(d,c){var n=1<<c,m=n>>>1,h=new Array(n);h[m]=d.slice(0);for(var I=m>>>1;I>0;)this.pow(h[2*I],h[I]=[]),I>>=1;for(I=2;I<m;){for(var x=1;x<I;++x){var A=h[I],y=h[x];h[I+x]=[A[0]^y[0],A[1]^y[1],A[2]^y[2],A[3]^y[3]]}I*=2}for(h[0]=[0,0,0,0],I=m+1;I<n;++I){var T=h[I^m];h[I]=[d[0]^T[0],d[1]^T[1],d[2]^T[2],d[3]^T[3]]}return h};function r(d,c){if(typeof d=="string"&&(d=t.util.createBuffer(d)),t.util.isArray(d)&&d.length>4){var n=d;d=t.util.createBuffer();for(var m=0;m<n.length;++m)d.putByte(n[m])}if(d.length()<c)throw new Error("Invalid IV length; got "+d.length()+" bytes and expected "+c+" bytes.");if(!t.util.isArray(d)){for(var h=[],I=c/4,m=0;m<I;++m)h.push(d.getInt32());d=h}return d}function u(d){d[d.length-1]=d[d.length-1]+1&4294967295}function f(d){return[d/4294967296|0,d&4294967295]}}),Ft=pe((l,i)=>{var t=fe();Sn(),Zi(),ve(),i.exports=t.aes=t.aes||{},t.aes.startEncrypting=function(y,T,b,S){var s=A({key:y,output:b,decrypt:!1,mode:S});return s.start(T),s},t.aes.createEncryptionCipher=function(y,T){return A({key:y,output:null,decrypt:!1,mode:T})},t.aes.startDecrypting=function(y,T,b,S){var s=A({key:y,output:b,decrypt:!0,mode:S});return s.start(T),s},t.aes.createDecryptionCipher=function(y,T){return A({key:y,output:null,decrypt:!0,mode:T})},t.aes.Algorithm=function(y,T){r||h();var b=this;b.name=y,b.mode=new T({blockSize:16,cipher:{encrypt:function(S,s){return x(b._w,S,s,!1)},decrypt:function(S,s){return x(b._w,S,s,!0)}}}),b._init=!1},t.aes.Algorithm.prototype.initialize=function(y){if(!this._init){var T=y.key,b;if(typeof T=="string"&&(T.length===16||T.length===24||T.length===32))T=t.util.createBuffer(T);else if(t.util.isArray(T)&&(T.length===16||T.length===24||T.length===32)){b=T,T=t.util.createBuffer();for(var S=0;S<b.length;++S)T.putByte(b[S])}if(!t.util.isArray(T)){b=T,T=[];var s=b.length();if(s===16||s===24||s===32){s=s>>>2;for(var S=0;S<s;++S)T.push(b.getInt32())}}if(!t.util.isArray(T)||!(T.length===4||T.length===6||T.length===8))throw new Error("Invalid key parameter.");var E=this.mode.name,C=["CFB","OFB","CTR","GCM"].indexOf(E)!==-1;this._w=I(T,y.decrypt&&!C),this._init=!0}},t.aes._expandKey=function(y,T){return r||h(),I(y,T)},t.aes._updateBlock=x,e("AES-ECB",t.cipher.modes.ecb),e("AES-CBC",t.cipher.modes.cbc),e("AES-CFB",t.cipher.modes.cfb),e("AES-OFB",t.cipher.modes.ofb),e("AES-CTR",t.cipher.modes.ctr),e("AES-GCM",t.cipher.modes.gcm);function e(y,T){var b=function(){return new t.aes.Algorithm(y,T)};t.cipher.registerAlgorithm(y,b)}var r=!1,u=4,f,d,c,n,m;function h(){r=!0,c=[0,1,2,4,8,16,32,64,128,27,54];for(var y=new Array(256),T=0;T<128;++T)y[T]=T<<1,y[T+128]=T+128<<1^283;f=new Array(256),d=new Array(256),n=new Array(4),m=new Array(4);for(var T=0;T<4;++T)n[T]=new Array(256),m[T]=new Array(256);for(var b=0,S=0,s,E,C,_,k,v,o,T=0;T<256;++T){_=S^S<<1^S<<2^S<<3^S<<4,_=_>>8^_&255^99,f[b]=_,d[_]=b,k=y[_],s=y[b],E=y[s],C=y[E],v=k<<24^_<<16^_<<8^(_^k),o=(s^E^C)<<24^(b^C)<<16^(b^E^C)<<8^(b^s^C);for(var a=0;a<4;++a)n[a][b]=v,m[a][_]=o,v=v<<24|v>>>8,o=o<<24|o>>>8;b===0?b=S=1:(b=s^y[y[y[s^C]]],S^=y[y[S]])}}function I(y,T){for(var b=y.slice(0),S,s=1,E=b.length,C=E+6+1,_=u*C,k=E;k<_;++k)S=b[k-1],k%E===0?(S=f[S>>>16&255]<<24^f[S>>>8&255]<<16^f[S&255]<<8^f[S>>>24]^c[s]<<24,s++):E>6&&k%E===4&&(S=f[S>>>24]<<24^f[S>>>16&255]<<16^f[S>>>8&255]<<8^f[S&255]),b[k]=b[k-E]^S;if(T){var v,o=m[0],a=m[1],w=m[2],P=m[3],K=b.slice(0);_=b.length;for(var k=0,D=_-u;k<_;k+=u,D-=u)if(k===0||k===_-u)K[k]=b[D],K[k+1]=b[D+3],K[k+2]=b[D+2],K[k+3]=b[D+1];else for(var H=0;H<u;++H)v=b[D+H],K[k+(3&-H)]=o[f[v>>>24]]^a[f[v>>>16&255]]^w[f[v>>>8&255]]^P[f[v&255]];b=K}return b}function x(y,T,b,S){var s=y.length/4-1,E,C,_,k,v;S?(E=m[0],C=m[1],_=m[2],k=m[3],v=d):(E=n[0],C=n[1],_=n[2],k=n[3],v=f);var o,a,w,P,K,D,H;o=T[0]^y[0],a=T[S?3:1]^y[1],w=T[2]^y[2],P=T[S?1:3]^y[3];for(var G=3,q=1;q<s;++q)K=E[o>>>24]^C[a>>>16&255]^_[w>>>8&255]^k[P&255]^y[++G],D=E[a>>>24]^C[w>>>16&255]^_[P>>>8&255]^k[o&255]^y[++G],H=E[w>>>24]^C[P>>>16&255]^_[o>>>8&255]^k[a&255]^y[++G],P=E[P>>>24]^C[o>>>16&255]^_[a>>>8&255]^k[w&255]^y[++G],o=K,a=D,w=H;b[0]=v[o>>>24]<<24^v[a>>>16&255]<<16^v[w>>>8&255]<<8^v[P&255]^y[++G],b[S?3:1]=v[a>>>24]<<24^v[w>>>16&255]<<16^v[P>>>8&255]<<8^v[o&255]^y[++G],b[2]=v[w>>>24]<<24^v[P>>>16&255]<<16^v[o>>>8&255]<<8^v[a&255]^y[++G],b[S?1:3]=v[P>>>24]<<24^v[o>>>16&255]<<16^v[a>>>8&255]<<8^v[w&255]^y[++G]}function A(y){y=y||{};var T=(y.mode||"CBC").toUpperCase(),b="AES-"+T,S;y.decrypt?S=t.cipher.createDecipher(b,y.key):S=t.cipher.createCipher(b,y.key);var s=S.start;return S.start=function(E,C){var _=null;C instanceof t.util.ByteBuffer&&(_=C,C={}),C=C||{},C.output=_,C.iv=E,s.call(S,C)},S}}),Gt=pe((l,i)=>{var t=fe();t.pki=t.pki||{};var e=i.exports=t.pki.oids=t.oids=t.oids||{};function r(f,d){e[f]=d,e[d]=f}function u(f,d){e[f]=d}r("1.2.840.113549.1.1.1","rsaEncryption"),r("1.2.840.113549.1.1.4","md5WithRSAEncryption"),r("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),r("1.2.840.113549.1.1.7","RSAES-OAEP"),r("1.2.840.113549.1.1.8","mgf1"),r("1.2.840.113549.1.1.9","pSpecified"),r("1.2.840.113549.1.1.10","RSASSA-PSS"),r("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),r("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),r("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),r("1.3.101.112","EdDSA25519"),r("1.2.840.10040.4.3","dsa-with-sha1"),r("1.3.14.3.2.7","desCBC"),r("1.3.14.3.2.26","sha1"),r("1.3.14.3.2.29","sha1WithRSASignature"),r("2.16.840.1.101.3.4.2.1","sha256"),r("2.16.840.1.101.3.4.2.2","sha384"),r("2.16.840.1.101.3.4.2.3","sha512"),r("2.16.840.1.101.3.4.2.4","sha224"),r("2.16.840.1.101.3.4.2.5","sha512-224"),r("2.16.840.1.101.3.4.2.6","sha512-256"),r("1.2.840.113549.2.2","md2"),r("1.2.840.113549.2.5","md5"),r("1.2.840.113549.1.7.1","data"),r("1.2.840.113549.1.7.2","signedData"),r("1.2.840.113549.1.7.3","envelopedData"),r("1.2.840.113549.1.7.4","signedAndEnvelopedData"),r("1.2.840.113549.1.7.5","digestedData"),r("1.2.840.113549.1.7.6","encryptedData"),r("1.2.840.113549.1.9.1","emailAddress"),r("1.2.840.113549.1.9.2","unstructuredName"),r("1.2.840.113549.1.9.3","contentType"),r("1.2.840.113549.1.9.4","messageDigest"),r("1.2.840.113549.1.9.5","signingTime"),r("1.2.840.113549.1.9.6","counterSignature"),r("1.2.840.113549.1.9.7","challengePassword"),r("1.2.840.113549.1.9.8","unstructuredAddress"),r("1.2.840.113549.1.9.14","extensionRequest"),r("1.2.840.113549.1.9.20","friendlyName"),r("1.2.840.113549.1.9.21","localKeyId"),r("1.2.840.113549.1.9.22.1","x509Certificate"),r("1.2.840.113549.1.12.10.1.1","keyBag"),r("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),r("1.2.840.113549.1.12.10.1.3","certBag"),r("1.2.840.113549.1.12.10.1.4","crlBag"),r("1.2.840.113549.1.12.10.1.5","secretBag"),r("1.2.840.113549.1.12.10.1.6","safeContentsBag"),r("1.2.840.113549.1.5.13","pkcs5PBES2"),r("1.2.840.113549.1.5.12","pkcs5PBKDF2"),r("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),r("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),r("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),r("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),r("1.2.840.113549.2.7","hmacWithSHA1"),r("1.2.840.113549.2.8","hmacWithSHA224"),r("1.2.840.113549.2.9","hmacWithSHA256"),r("1.2.840.113549.2.10","hmacWithSHA384"),r("1.2.840.113549.2.11","hmacWithSHA512"),r("1.2.840.113549.3.7","des-EDE3-CBC"),r("2.16.840.1.101.3.4.1.2","aes128-CBC"),r("2.16.840.1.101.3.4.1.22","aes192-CBC"),r("2.16.840.1.101.3.4.1.42","aes256-CBC"),r("2.5.4.3","commonName"),r("2.5.4.4","surname"),r("2.5.4.5","serialNumber"),r("2.5.4.6","countryName"),r("2.5.4.7","localityName"),r("2.5.4.8","stateOrProvinceName"),r("2.5.4.9","streetAddress"),r("2.5.4.10","organizationName"),r("2.5.4.11","organizationalUnitName"),r("2.5.4.12","title"),r("2.5.4.13","description"),r("2.5.4.15","businessCategory"),r("2.5.4.17","postalCode"),r("2.5.4.42","givenName"),r("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),r("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),r("2.16.840.1.113730.1.1","nsCertType"),r("2.16.840.1.113730.1.13","nsComment"),u("2.5.29.1","authorityKeyIdentifier"),u("2.5.29.2","keyAttributes"),u("2.5.29.3","certificatePolicies"),u("2.5.29.4","keyUsageRestriction"),u("2.5.29.5","policyMapping"),u("2.5.29.6","subtreesConstraint"),u("2.5.29.7","subjectAltName"),u("2.5.29.8","issuerAltName"),u("2.5.29.9","subjectDirectoryAttributes"),u("2.5.29.10","basicConstraints"),u("2.5.29.11","nameConstraints"),u("2.5.29.12","policyConstraints"),u("2.5.29.13","basicConstraints"),r("2.5.29.14","subjectKeyIdentifier"),r("2.5.29.15","keyUsage"),u("2.5.29.16","privateKeyUsagePeriod"),r("2.5.29.17","subjectAltName"),r("2.5.29.18","issuerAltName"),r("2.5.29.19","basicConstraints"),u("2.5.29.20","cRLNumber"),u("2.5.29.21","cRLReason"),u("2.5.29.22","expirationDate"),u("2.5.29.23","instructionCode"),u("2.5.29.24","invalidityDate"),u("2.5.29.25","cRLDistributionPoints"),u("2.5.29.26","issuingDistributionPoint"),u("2.5.29.27","deltaCRLIndicator"),u("2.5.29.28","issuingDistributionPoint"),u("2.5.29.29","certificateIssuer"),u("2.5.29.30","nameConstraints"),r("2.5.29.31","cRLDistributionPoints"),r("2.5.29.32","certificatePolicies"),u("2.5.29.33","policyMappings"),u("2.5.29.34","policyConstraints"),r("2.5.29.35","authorityKeyIdentifier"),u("2.5.29.36","policyConstraints"),r("2.5.29.37","extKeyUsage"),u("2.5.29.46","freshestCRL"),u("2.5.29.54","inhibitAnyPolicy"),r("1.3.6.1.4.1.11129.2.4.2","timestampList"),r("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),r("1.3.6.1.5.5.7.3.1","serverAuth"),r("1.3.6.1.5.5.7.3.2","clientAuth"),r("1.3.6.1.5.5.7.3.3","codeSigning"),r("1.3.6.1.5.5.7.3.4","emailProtection"),r("1.3.6.1.5.5.7.3.8","timeStamping")}),Tt=pe((l,i)=>{var t=fe();ve(),Gt();var e=i.exports=t.asn1=t.asn1||{};e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},e.create=function(c,n,m,h,I){if(t.util.isArray(h)){for(var x=[],A=0;A<h.length;++A)h[A]!==void 0&&x.push(h[A]);h=x}var y={tagClass:c,type:n,constructed:m,composed:m||t.util.isArray(h),value:h};return I&&"bitStringContents"in I&&(y.bitStringContents=I.bitStringContents,y.original=e.copy(y)),y},e.copy=function(c,n){var m;if(t.util.isArray(c)){m=[];for(var h=0;h<c.length;++h)m.push(e.copy(c[h],n));return m}return typeof c=="string"?c:(m={tagClass:c.tagClass,type:c.type,constructed:c.constructed,composed:c.composed,value:e.copy(c.value,n)},n&&!n.excludeBitStringContents&&(m.bitStringContents=c.bitStringContents),m)},e.equals=function(c,n,m){if(t.util.isArray(c)){if(!t.util.isArray(n)||c.length!==n.length)return!1;for(var h=0;h<c.length;++h)if(!e.equals(c[h],n[h]))return!1;return!0}if(typeof c!=typeof n)return!1;if(typeof c=="string")return c===n;var I=c.tagClass===n.tagClass&&c.type===n.type&&c.constructed===n.constructed&&c.composed===n.composed&&e.equals(c.value,n.value);return m&&m.includeBitStringContents&&(I=I&&c.bitStringContents===n.bitStringContents),I},e.getBerValueLength=function(c){var n=c.getByte();if(n!==128){var m,h=n&128;return h?m=c.getInt((n&127)<<3):m=n,m}};function r(c,n,m){if(m>n){var h=new Error("Too few bytes to parse DER.");throw h.available=c.length(),h.remaining=n,h.requested=m,h}}var u=function(c,n){var m=c.getByte();if(n--,m!==128){var h,I=m&128;if(!I)h=m;else{var x=m&127;r(c,n,x),h=c.getInt(x<<3)}if(h<0)throw new Error("Negative length: "+h);return h}};e.fromDer=function(c,n){n===void 0&&(n={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof n=="boolean"&&(n={strict:n,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in n||(n.strict=!0),"parseAllBytes"in n||(n.parseAllBytes=!0),"decodeBitStrings"in n||(n.decodeBitStrings=!0),typeof c=="string"&&(c=t.util.createBuffer(c));var m=c.length(),h=f(c,c.length(),0,n);if(n.parseAllBytes&&c.length()!==0){var I=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw I.byteCount=m,I.remaining=c.length(),I}return h};function f(c,n,m,h){var I;r(c,n,2);var x=c.getByte();n--;var A=x&192,y=x&31;I=c.length();var T=u(c,n);if(n-=I-c.length(),T!==void 0&&T>n){if(h.strict){var b=new Error("Too few bytes to read ASN.1 value.");throw b.available=c.length(),b.remaining=n,b.requested=T,b}T=n}var S,s,E=(x&32)===32;if(E)if(S=[],T===void 0)for(;;){if(r(c,n,2),c.bytes(2)==="\0\0"){c.getBytes(2),n-=2;break}I=c.length(),S.push(f(c,n,m+1,h)),n-=I-c.length()}else for(;T>0;)I=c.length(),S.push(f(c,T,m+1,h)),n-=I-c.length(),T-=I-c.length();if(S===void 0&&A===e.Class.UNIVERSAL&&y===e.Type.BITSTRING&&(s=c.bytes(T)),S===void 0&&h.decodeBitStrings&&A===e.Class.UNIVERSAL&&y===e.Type.BITSTRING&&T>1){var C=c.read,_=n,k=0;if(y===e.Type.BITSTRING&&(r(c,n,1),k=c.getByte(),n--),k===0)try{I=c.length();var v={strict:!0,decodeBitStrings:!0},o=f(c,n,m+1,v),a=I-c.length();n-=a,y==e.Type.BITSTRING&&a++;var w=o.tagClass;a===T&&(w===e.Class.UNIVERSAL||w===e.Class.CONTEXT_SPECIFIC)&&(S=[o])}catch{}S===void 0&&(c.read=C,n=_)}if(S===void 0){if(T===void 0){if(h.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");T=n}if(y===e.Type.BMPSTRING)for(S="";T>0;T-=2)r(c,n,2),S+=String.fromCharCode(c.getInt16()),n-=2;else S=c.getBytes(T),n-=T}var P=s===void 0?null:{bitStringContents:s};return e.create(A,y,E,S,P)}e.toDer=function(c){var n=t.util.createBuffer(),m=c.tagClass|c.type,h=t.util.createBuffer(),I=!1;if("bitStringContents"in c&&(I=!0,c.original&&(I=e.equals(c,c.original))),I)h.putBytes(c.bitStringContents);else if(c.composed){c.constructed?m|=32:h.putByte(0);for(var x=0;x<c.value.length;++x)c.value[x]!==void 0&&h.putBuffer(e.toDer(c.value[x]))}else if(c.type===e.Type.BMPSTRING)for(var x=0;x<c.value.length;++x)h.putInt16(c.value.charCodeAt(x));else c.type===e.Type.INTEGER&&c.value.length>1&&(c.value.charCodeAt(0)===0&&!(c.value.charCodeAt(1)&128)||c.value.charCodeAt(0)===255&&(c.value.charCodeAt(1)&128)===128)?h.putBytes(c.value.substr(1)):h.putBytes(c.value);if(n.putByte(m),h.length()<=127)n.putByte(h.length()&127);else{var A=h.length(),y="";do y+=String.fromCharCode(A&255),A=A>>>8;while(A>0);n.putByte(y.length|128);for(var x=y.length-1;x>=0;--x)n.putByte(y.charCodeAt(x))}return n.putBuffer(h),n},e.oidToDer=function(c){var n=c.split("."),m=t.util.createBuffer();m.putByte(40*parseInt(n[0],10)+parseInt(n[1],10));for(var h,I,x,A,y=2;y<n.length;++y){h=!0,I=[],x=parseInt(n[y],10);do A=x&127,x=x>>>7,h||(A|=128),I.push(A),h=!1;while(x>0);for(var T=I.length-1;T>=0;--T)m.putByte(I[T])}return m},e.derToOid=function(c){var n;typeof c=="string"&&(c=t.util.createBuffer(c));var m=c.getByte();n=Math.floor(m/40)+"."+m%40;for(var h=0;c.length()>0;)m=c.getByte(),h=h<<7,m&128?h+=m&127:(n+="."+(h+m),h=0);return n},e.utcTimeToDate=function(c){var n=new Date,m=parseInt(c.substr(0,2),10);m=m>=50?1900+m:2e3+m;var h=parseInt(c.substr(2,2),10)-1,I=parseInt(c.substr(4,2),10),x=parseInt(c.substr(6,2),10),A=parseInt(c.substr(8,2),10),y=0;if(c.length>11){var T=c.charAt(10),b=10;T!=="+"&&T!=="-"&&(y=parseInt(c.substr(10,2),10),b+=2)}if(n.setUTCFullYear(m,h,I),n.setUTCHours(x,A,y,0),b&&(T=c.charAt(b),T==="+"||T==="-")){var S=parseInt(c.substr(b+1,2),10),s=parseInt(c.substr(b+4,2),10),E=S*60+s;E*=6e4,T==="+"?n.setTime(+n-E):n.setTime(+n+E)}return n},e.generalizedTimeToDate=function(c){var n=new Date,m=parseInt(c.substr(0,4),10),h=parseInt(c.substr(4,2),10)-1,I=parseInt(c.substr(6,2),10),x=parseInt(c.substr(8,2),10),A=parseInt(c.substr(10,2),10),y=parseInt(c.substr(12,2),10),T=0,b=0,S=!1;c.charAt(c.length-1)==="Z"&&(S=!0);var s=c.length-5,E=c.charAt(s);if(E==="+"||E==="-"){var C=parseInt(c.substr(s+1,2),10),_=parseInt(c.substr(s+4,2),10);b=C*60+_,b*=6e4,E==="+"&&(b*=-1),S=!0}return c.charAt(14)==="."&&(T=parseFloat(c.substr(14),10)*1e3),S?(n.setUTCFullYear(m,h,I),n.setUTCHours(x,A,y,T),n.setTime(+n+b)):(n.setFullYear(m,h,I),n.setHours(x,A,y,T)),n},e.dateToUtcTime=function(c){if(typeof c=="string")return c;var n="",m=[];m.push((""+c.getUTCFullYear()).substr(2)),m.push(""+(c.getUTCMonth()+1)),m.push(""+c.getUTCDate()),m.push(""+c.getUTCHours()),m.push(""+c.getUTCMinutes()),m.push(""+c.getUTCSeconds());for(var h=0;h<m.length;++h)m[h].length<2&&(n+="0"),n+=m[h];return n+="Z",n},e.dateToGeneralizedTime=function(c){if(typeof c=="string")return c;var n="",m=[];m.push(""+c.getUTCFullYear()),m.push(""+(c.getUTCMonth()+1)),m.push(""+c.getUTCDate()),m.push(""+c.getUTCHours()),m.push(""+c.getUTCMinutes()),m.push(""+c.getUTCSeconds());for(var h=0;h<m.length;++h)m[h].length<2&&(n+="0"),n+=m[h];return n+="Z",n},e.integerToDer=function(c){var n=t.util.createBuffer();if(c>=-128&&c<128)return n.putSignedInt(c,8);if(c>=-32768&&c<32768)return n.putSignedInt(c,16);if(c>=-8388608&&c<8388608)return n.putSignedInt(c,24);if(c>=-2147483648&&c<2147483648)return n.putSignedInt(c,32);var m=new Error("Integer too large; max is 32-bits.");throw m.integer=c,m},e.derToInteger=function(c){typeof c=="string"&&(c=t.util.createBuffer(c));var n=c.length()*8;if(n>32)throw new Error("Integer too large; max is 32-bits.");return c.getSignedInt(n)},e.validate=function(c,n,m,h){var I=!1;if((c.tagClass===n.tagClass||typeof n.tagClass>"u")&&(c.type===n.type||typeof n.type>"u"))if(c.constructed===n.constructed||typeof n.constructed>"u"){if(I=!0,n.value&&t.util.isArray(n.value))for(var x=0,A=0;I&&A<n.value.length;++A)I=n.value[A].optional||!1,c.value[x]&&(I=e.validate(c.value[x],n.value[A],m,h),I?++x:n.value[A].optional&&(I=!0)),!I&&h&&h.push("["+n.name+'] Tag class "'+n.tagClass+'", type "'+n.type+'" expected value length "'+n.value.length+'", got "'+c.value.length+'"');if(I&&m&&(n.capture&&(m[n.capture]=c.value),n.captureAsn1&&(m[n.captureAsn1]=c),n.captureBitStringContents&&"bitStringContents"in c&&(m[n.captureBitStringContents]=c.bitStringContents),n.captureBitStringValue&&"bitStringContents"in c)){var y;if(c.bitStringContents.length<2)m[n.captureBitStringValue]="";else{var T=c.bitStringContents.charCodeAt(0);if(T!==0)throw new Error("captureBitStringValue only supported for zero unused bits");m[n.captureBitStringValue]=c.bitStringContents.slice(1)}}}else h&&h.push("["+n.name+'] Expected constructed "'+n.constructed+'", got "'+c.constructed+'"');else h&&(c.tagClass!==n.tagClass&&h.push("["+n.name+'] Expected tag class "'+n.tagClass+'", got "'+c.tagClass+'"'),c.type!==n.type&&h.push("["+n.name+'] Expected type "'+n.type+'", got "'+c.type+'"'));return I};var d=/[^\\u0000-\\u00ff]/;e.prettyPrint=function(c,n,m){var h="";n=n||0,m=m||2,n>0&&(h+=`
`);for(var I="",x=0;x<n*m;++x)I+=" ";switch(h+=I+"Tag: ",c.tagClass){case e.Class.UNIVERSAL:h+="Universal:";break;case e.Class.APPLICATION:h+="Application:";break;case e.Class.CONTEXT_SPECIFIC:h+="Context-Specific:";break;case e.Class.PRIVATE:h+="Private:";break}if(c.tagClass===e.Class.UNIVERSAL)switch(h+=c.type,c.type){case e.Type.NONE:h+=" (None)";break;case e.Type.BOOLEAN:h+=" (Boolean)";break;case e.Type.INTEGER:h+=" (Integer)";break;case e.Type.BITSTRING:h+=" (Bit string)";break;case e.Type.OCTETSTRING:h+=" (Octet string)";break;case e.Type.NULL:h+=" (Null)";break;case e.Type.OID:h+=" (Object Identifier)";break;case e.Type.ODESC:h+=" (Object Descriptor)";break;case e.Type.EXTERNAL:h+=" (External or Instance of)";break;case e.Type.REAL:h+=" (Real)";break;case e.Type.ENUMERATED:h+=" (Enumerated)";break;case e.Type.EMBEDDED:h+=" (Embedded PDV)";break;case e.Type.UTF8:h+=" (UTF8)";break;case e.Type.ROID:h+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:h+=" (Sequence)";break;case e.Type.SET:h+=" (Set)";break;case e.Type.PRINTABLESTRING:h+=" (Printable String)";break;case e.Type.IA5String:h+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:h+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:h+=" (Generalized time)";break;case e.Type.BMPSTRING:h+=" (BMP String)";break}else h+=c.type;if(h+=`
`,h+=I+"Constructed: "+c.constructed+`
`,c.composed){for(var A=0,y="",x=0;x<c.value.length;++x)c.value[x]!==void 0&&(A+=1,y+=e.prettyPrint(c.value[x],n+1,m),x+1<c.value.length&&(y+=","));h+=I+"Sub values: "+A+y}else{if(h+=I+"Value: ",c.type===e.Type.OID){var T=e.derToOid(c.value);h+=T,t.pki&&t.pki.oids&&T in t.pki.oids&&(h+=" ("+t.pki.oids[T]+") ")}if(c.type===e.Type.INTEGER)try{h+=e.derToInteger(c.value)}catch{h+="0x"+t.util.bytesToHex(c.value)}else if(c.type===e.Type.BITSTRING){if(c.value.length>1?h+="0x"+t.util.bytesToHex(c.value.slice(1)):h+="(none)",c.value.length>0){var b=c.value.charCodeAt(0);b==1?h+=" (1 unused bit shown)":b>1&&(h+=" ("+b+" unused bits shown)")}}else if(c.type===e.Type.OCTETSTRING)d.test(c.value)||(h+="("+c.value+") "),h+="0x"+t.util.bytesToHex(c.value);else if(c.type===e.Type.UTF8)try{h+=t.util.decodeUtf8(c.value)}catch(S){if(S.message==="URI malformed")h+="0x"+t.util.bytesToHex(c.value)+" (malformed UTF8)";else throw S}else c.type===e.Type.PRINTABLESTRING||c.type===e.Type.IA5String?h+=c.value:d.test(c.value)?h+="0x"+t.util.bytesToHex(c.value):c.value.length===0?h+="[null]":h+=c.value}return h}}),wt=pe((l,i)=>{var t=fe();i.exports=t.md=t.md||{},t.md.algorithms=t.md.algorithms||{}}),vr=pe((l,i)=>{var t=fe();wt(),ve();var e=i.exports=t.hmac=t.hmac||{};e.create=function(){var r=null,u=null,f=null,d=null,c={};return c.start=function(n,m){if(n!==null)if(typeof n=="string")if(n=n.toLowerCase(),n in t.md.algorithms)u=t.md.algorithms[n].create();else throw new Error('Unknown hash algorithm "'+n+'"');else u=n;if(m===null)m=r;else{if(typeof m=="string")m=t.util.createBuffer(m);else if(t.util.isArray(m)){var h=m;m=t.util.createBuffer();for(var I=0;I<h.length;++I)m.putByte(h[I])}var x=m.length();x>u.blockLength&&(u.start(),u.update(m.bytes()),m=u.digest()),f=t.util.createBuffer(),d=t.util.createBuffer(),x=m.length();for(var I=0;I<x;++I){var h=m.at(I);f.putByte(54^h),d.putByte(92^h)}if(x<u.blockLength)for(var h=u.blockLength-x,I=0;I<h;++I)f.putByte(54),d.putByte(92);r=m,f=f.bytes(),d=d.bytes()}u.start(),u.update(f)},c.update=function(n){u.update(n)},c.getMac=function(){var n=u.digest().bytes();return u.start(),u.update(d),u.update(n),u.digest()},c.digest=c.getMac,c}}),bn=pe((l,i)=>{var t=fe();wt(),ve();var e=i.exports=t.md5=t.md5||{};t.md.md5=t.md.algorithms.md5=e,e.create=function(){c||n();var h=null,I=t.util.createBuffer(),x=new Array(16),A={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return A.start=function(){A.messageLength=0,A.fullMessageLength=A.messageLength64=[];for(var y=A.messageLengthSize/4,T=0;T<y;++T)A.fullMessageLength.push(0);return I=t.util.createBuffer(),h={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},A},A.start(),A.update=function(y,T){T==="utf8"&&(y=t.util.encodeUtf8(y));var b=y.length;A.messageLength+=b,b=[b/4294967296>>>0,b>>>0];for(var S=A.fullMessageLength.length-1;S>=0;--S)A.fullMessageLength[S]+=b[1],b[1]=b[0]+(A.fullMessageLength[S]/4294967296>>>0),A.fullMessageLength[S]=A.fullMessageLength[S]>>>0,b[0]=b[1]/4294967296>>>0;return I.putBytes(y),m(h,x,I),(I.read>2048||I.length()===0)&&I.compact(),A},A.digest=function(){var y=t.util.createBuffer();y.putBytes(I.bytes());var T=A.fullMessageLength[A.fullMessageLength.length-1]+A.messageLengthSize,b=T&A.blockLength-1;y.putBytes(r.substr(0,A.blockLength-b));for(var S,s=0,E=A.fullMessageLength.length-1;E>=0;--E)S=A.fullMessageLength[E]*8+s,s=S/4294967296>>>0,y.putInt32Le(S>>>0);var C={h0:h.h0,h1:h.h1,h2:h.h2,h3:h.h3};m(C,x,y);var _=t.util.createBuffer();return _.putInt32Le(C.h0),_.putInt32Le(C.h1),_.putInt32Le(C.h2),_.putInt32Le(C.h3),_},A};var r=null,u=null,f=null,d=null,c=!1;function n(){r="\x80",r+=t.util.fillString("\0",64),u=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],f=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],d=new Array(64);for(var h=0;h<64;++h)d[h]=Math.floor(Math.abs(Math.sin(h+1))*4294967296);c=!0}function m(h,I,x){for(var A,y,T,b,S,s,E,C,_=x.length();_>=64;){for(y=h.h0,T=h.h1,b=h.h2,S=h.h3,C=0;C<16;++C)I[C]=x.getInt32Le(),s=S^T&(b^S),A=y+s+d[C]+I[C],E=f[C],y=S,S=b,b=T,T+=A<<E|A>>>32-E;for(;C<32;++C)s=b^S&(T^b),A=y+s+d[C]+I[u[C]],E=f[C],y=S,S=b,b=T,T+=A<<E|A>>>32-E;for(;C<48;++C)s=T^b^S,A=y+s+d[C]+I[u[C]],E=f[C],y=S,S=b,b=T,T+=A<<E|A>>>32-E;for(;C<64;++C)s=b^(T|~S),A=y+s+d[C]+I[u[C]],E=f[C],y=S,S=b,b=T,T+=A<<E|A>>>32-E;h.h0=h.h0+y|0,h.h1=h.h1+T|0,h.h2=h.h2+b|0,h.h3=h.h3+S|0,_-=64}}}),tr=pe((l,i)=>{var t=fe();ve();var e=i.exports=t.pem=t.pem||{};e.encode=function(f,d){d=d||{};var c="-----BEGIN "+f.type+`-----\r
`,n;if(f.procType&&(n={name:"Proc-Type",values:[String(f.procType.version),f.procType.type]},c+=r(n)),f.contentDomain&&(n={name:"Content-Domain",values:[f.contentDomain]},c+=r(n)),f.dekInfo&&(n={name:"DEK-Info",values:[f.dekInfo.algorithm]},f.dekInfo.parameters&&n.values.push(f.dekInfo.parameters),c+=r(n)),f.headers)for(var m=0;m<f.headers.length;++m)c+=r(f.headers[m]);return f.procType&&(c+=`\r
`),c+=t.util.encode64(f.body,d.maxline||64)+`\r
`,c+="-----END "+f.type+`-----\r
`,c},e.decode=function(f){for(var d=[],c=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,m=/\r?\n/,h;h=c.exec(f),!!h;){var I=h[1];I==="NEW CERTIFICATE REQUEST"&&(I="CERTIFICATE REQUEST");var x={type:I,procType:null,contentDomain:null,dekInfo:null,headers:[],body:t.util.decode64(h[3])};if(d.push(x),!!h[2]){for(var A=h[2].split(m),y=0;h&&y<A.length;){for(var T=A[y].replace(/\s+$/,""),b=y+1;b<A.length;++b){var S=A[b];if(!/\s/.test(S[0]))break;T+=S,y=b}if(h=T.match(n),h){for(var s={name:h[1],values:[]},E=h[2].split(","),C=0;C<E.length;++C)s.values.push(u(E[C]));if(x.procType)if(!x.contentDomain&&s.name==="Content-Domain")x.contentDomain=E[0]||"";else if(!x.dekInfo&&s.name==="DEK-Info"){if(s.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');x.dekInfo={algorithm:E[0],parameters:E[1]||null}}else x.headers.push(s);else{if(s.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(s.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');x.procType={version:E[0],type:E[1]}}}++y}if(x.procType==="ENCRYPTED"&&!x.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(d.length===0)throw new Error("Invalid PEM formatted message.");return d};function r(f){for(var d=f.name+": ",c=[],n=function(A,y){return" "+y},m=0;m<f.values.length;++m)c.push(f.values[m].replace(/^(\S+\r\n)/,n));d+=c.join(",")+`\r
`;for(var h=0,I=-1,m=0;m<d.length;++m,++h)if(h>65&&I!==-1){var x=d[I];x===","?(++I,d=d.substr(0,I)+`\r
 `+d.substr(I)):d=d.substr(0,I)+`\r
`+x+d.substr(I+1),h=m-I-1,I=-1,++m}else(d[m]===" "||d[m]==="	"||d[m]===",")&&(I=m);return d}function u(f){return f.replace(/^\s+/,"")}}),Kr=pe((l,i)=>{var t=fe();Sn(),Zi(),ve(),i.exports=t.des=t.des||{},t.des.startEncrypting=function(y,T,b,S){var s=A({key:y,output:b,decrypt:!1,mode:S||(T===null?"ECB":"CBC")});return s.start(T),s},t.des.createEncryptionCipher=function(y,T){return A({key:y,output:null,decrypt:!1,mode:T})},t.des.startDecrypting=function(y,T,b,S){var s=A({key:y,output:b,decrypt:!0,mode:S||(T===null?"ECB":"CBC")});return s.start(T),s},t.des.createDecryptionCipher=function(y,T){return A({key:y,output:null,decrypt:!0,mode:T})},t.des.Algorithm=function(y,T){var b=this;b.name=y,b.mode=new T({blockSize:8,cipher:{encrypt:function(S,s){return x(b._keys,S,s,!1)},decrypt:function(S,s){return x(b._keys,S,s,!0)}}}),b._init=!1},t.des.Algorithm.prototype.initialize=function(y){if(!this._init){var T=t.util.createBuffer(y.key);if(this.name.indexOf("3DES")===0&&T.length()!==24)throw new Error("Invalid Triple-DES key size: "+T.length()*8);this._keys=I(T),this._init=!0}},e("DES-ECB",t.cipher.modes.ecb),e("DES-CBC",t.cipher.modes.cbc),e("DES-CFB",t.cipher.modes.cfb),e("DES-OFB",t.cipher.modes.ofb),e("DES-CTR",t.cipher.modes.ctr),e("3DES-ECB",t.cipher.modes.ecb),e("3DES-CBC",t.cipher.modes.cbc),e("3DES-CFB",t.cipher.modes.cfb),e("3DES-OFB",t.cipher.modes.ofb),e("3DES-CTR",t.cipher.modes.ctr);function e(y,T){var b=function(){return new t.des.Algorithm(y,T)};t.cipher.registerAlgorithm(y,b)}var r=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],u=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],f=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],d=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],c=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],n=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],m=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],h=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function I(y){for(var T=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],b=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],S=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],s=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],E=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],C=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],_=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],k=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],v=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],o=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],a=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],w=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],P=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],K=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],D=y.length()>8?3:1,H=[],G=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],q=0,j,Y=0;Y<D;Y++){var J=y.getInt32(),ee=y.getInt32();j=(J>>>4^ee)&252645135,ee^=j,J^=j<<4,j=(ee>>>-16^J)&65535,J^=j,ee^=j<<-16,j=(J>>>2^ee)&858993459,ee^=j,J^=j<<2,j=(ee>>>-16^J)&65535,J^=j,ee^=j<<-16,j=(J>>>1^ee)&1431655765,ee^=j,J^=j<<1,j=(ee>>>8^J)&16711935,J^=j,ee^=j<<8,j=(J>>>1^ee)&1431655765,ee^=j,J^=j<<1,j=J<<8|ee>>>20&240,J=ee<<24|ee<<8&16711680|ee>>>8&65280|ee>>>24&240,ee=j;for(var ie=0;ie<G.length;++ie){G[ie]?(J=J<<2|J>>>26,ee=ee<<2|ee>>>26):(J=J<<1|J>>>27,ee=ee<<1|ee>>>27),J&=-15,ee&=-15;var le=T[J>>>28]|b[J>>>24&15]|S[J>>>20&15]|s[J>>>16&15]|E[J>>>12&15]|C[J>>>8&15]|_[J>>>4&15],ge=k[ee>>>28]|v[ee>>>24&15]|o[ee>>>20&15]|a[ee>>>16&15]|w[ee>>>12&15]|P[ee>>>8&15]|K[ee>>>4&15];j=(ge>>>16^le)&65535,H[q++]=le^j,H[q++]=ge^j<<16}}return H}function x(y,T,b,S){var s=y.length===32?3:9,E;s===3?E=S?[30,-2,-2]:[0,32,2]:E=S?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var C,_=T[0],k=T[1];C=(_>>>4^k)&252645135,k^=C,_^=C<<4,C=(_>>>16^k)&65535,k^=C,_^=C<<16,C=(k>>>2^_)&858993459,_^=C,k^=C<<2,C=(k>>>8^_)&16711935,_^=C,k^=C<<8,C=(_>>>1^k)&1431655765,k^=C,_^=C<<1,_=_<<1|_>>>31,k=k<<1|k>>>31;for(var v=0;v<s;v+=3){for(var o=E[v+1],a=E[v+2],w=E[v];w!=o;w+=a){var P=k^y[w],K=(k>>>4|k<<28)^y[w+1];C=_,_=k,k=C^(u[P>>>24&63]|d[P>>>16&63]|n[P>>>8&63]|h[P&63]|r[K>>>24&63]|f[K>>>16&63]|c[K>>>8&63]|m[K&63])}C=_,_=k,k=C}_=_>>>1|_<<31,k=k>>>1|k<<31,C=(_>>>1^k)&1431655765,k^=C,_^=C<<1,C=(k>>>8^_)&16711935,_^=C,k^=C<<8,C=(k>>>2^_)&858993459,_^=C,k^=C<<2,C=(_>>>16^k)&65535,k^=C,_^=C<<16,C=(_>>>4^k)&252645135,k^=C,_^=C<<4,b[0]=_,b[1]=k}function A(y){y=y||{};var T=(y.mode||"CBC").toUpperCase(),b="DES-"+T,S;y.decrypt?S=t.cipher.createDecipher(b,y.key):S=t.cipher.createCipher(b,y.key);var s=S.start;return S.start=function(E,C){var _=null;C instanceof t.util.ByteBuffer&&(_=C,C={}),C=C||{},C.output=_,C.iv=E,s.call(S,C)},S}}),An=pe((l,i)=>{var t=fe();vr(),wt(),ve();var e=t.pkcs5=t.pkcs5||{},r;t.util.isNodejs&&!t.options.usePureJavaScript&&(r=Tn("node:crypto")),i.exports=t.pbkdf2=e.pbkdf2=function(u,f,d,c,n,m){if(typeof n=="function"&&(m=n,n=null),t.util.isNodejs&&!t.options.usePureJavaScript&&r.pbkdf2&&(n===null||typeof n!="object")&&(r.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),u=__Buffer$.from(u,"binary"),f=__Buffer$.from(f,"binary"),m?r.pbkdf2Sync.length===4?r.pbkdf2(u,f,d,c,function(v,o){if(v)return m(v);m(null,o.toString("binary"))}):r.pbkdf2(u,f,d,c,n,function(v,o){if(v)return m(v);m(null,o.toString("binary"))}):r.pbkdf2Sync.length===4?r.pbkdf2Sync(u,f,d,c).toString("binary"):r.pbkdf2Sync(u,f,d,c,n).toString("binary");if((typeof n>"u"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in t.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=t.md[n].create()}var h=n.digestLength;if(c>4294967295*h){var I=new Error("Derived key is too long.");if(m)return m(I);throw I}var x=Math.ceil(c/h),A=c-(x-1)*h,y=t.hmac.create();y.start(n,u);var T="",b,S,s;if(!m){for(var E=1;E<=x;++E){y.start(null,null),y.update(f),y.update(t.util.int32ToBytes(E)),b=s=y.digest().getBytes();for(var C=2;C<=d;++C)y.start(null,null),y.update(s),S=y.digest().getBytes(),b=t.util.xorBytes(b,S,h),s=S;T+=E<x?b:b.substr(0,A)}return T}var E=1,C;function _(){if(E>x)return m(null,T);y.start(null,null),y.update(f),y.update(t.util.int32ToBytes(E)),b=s=y.digest().getBytes(),C=2,k()}function k(){if(C<=d)return y.start(null,null),y.update(s),S=y.digest().getBytes(),b=t.util.xorBytes(b,S,h),s=S,++C,t.util.setImmediate(k);T+=E<x?b:b.substr(0,A),++E,_()}_()}}),es=pe((l,i)=>{var t=fe();wt(),ve();var e=i.exports=t.sha256=t.sha256||{};t.md.sha256=t.md.algorithms.sha256=e,e.create=function(){u||d();var n=null,m=t.util.createBuffer(),h=new Array(64),I={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return I.start=function(){I.messageLength=0,I.fullMessageLength=I.messageLength64=[];for(var x=I.messageLengthSize/4,A=0;A<x;++A)I.fullMessageLength.push(0);return m=t.util.createBuffer(),n={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},I},I.start(),I.update=function(x,A){A==="utf8"&&(x=t.util.encodeUtf8(x));var y=x.length;I.messageLength+=y,y=[y/4294967296>>>0,y>>>0];for(var T=I.fullMessageLength.length-1;T>=0;--T)I.fullMessageLength[T]+=y[1],y[1]=y[0]+(I.fullMessageLength[T]/4294967296>>>0),I.fullMessageLength[T]=I.fullMessageLength[T]>>>0,y[0]=y[1]/4294967296>>>0;return m.putBytes(x),c(n,h,m),(m.read>2048||m.length()===0)&&m.compact(),I},I.digest=function(){var x=t.util.createBuffer();x.putBytes(m.bytes());var A=I.fullMessageLength[I.fullMessageLength.length-1]+I.messageLengthSize,y=A&I.blockLength-1;x.putBytes(r.substr(0,I.blockLength-y));for(var T,b,S=I.fullMessageLength[0]*8,s=0;s<I.fullMessageLength.length-1;++s)T=I.fullMessageLength[s+1]*8,b=T/4294967296>>>0,S+=b,x.putInt32(S>>>0),S=T>>>0;x.putInt32(S);var E={h0:n.h0,h1:n.h1,h2:n.h2,h3:n.h3,h4:n.h4,h5:n.h5,h6:n.h6,h7:n.h7};c(E,h,x);var C=t.util.createBuffer();return C.putInt32(E.h0),C.putInt32(E.h1),C.putInt32(E.h2),C.putInt32(E.h3),C.putInt32(E.h4),C.putInt32(E.h5),C.putInt32(E.h6),C.putInt32(E.h7),C},I};var r=null,u=!1,f=null;function d(){r="\x80",r+=t.util.fillString("\0",64),f=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],u=!0}function c(n,m,h){for(var I,x,A,y,T,b,S,s,E,C,_,k,v,o,a,w=h.length();w>=64;){for(S=0;S<16;++S)m[S]=h.getInt32();for(;S<64;++S)I=m[S-2],I=(I>>>17|I<<15)^(I>>>19|I<<13)^I>>>10,x=m[S-15],x=(x>>>7|x<<25)^(x>>>18|x<<14)^x>>>3,m[S]=I+m[S-7]+x+m[S-16]|0;for(s=n.h0,E=n.h1,C=n.h2,_=n.h3,k=n.h4,v=n.h5,o=n.h6,a=n.h7,S=0;S<64;++S)y=(k>>>6|k<<26)^(k>>>11|k<<21)^(k>>>25|k<<7),T=o^k&(v^o),A=(s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10),b=s&E|C&(s^E),I=a+y+T+f[S]+m[S],x=A+b,a=o,o=v,v=k,k=_+I>>>0,_=C,C=E,E=s,s=I+x>>>0;n.h0=n.h0+s|0,n.h1=n.h1+E|0,n.h2=n.h2+C|0,n.h3=n.h3+_|0,n.h4=n.h4+k|0,n.h5=n.h5+v|0,n.h6=n.h6+o|0,n.h7=n.h7+a|0,w-=64}}}),ts=pe((l,i)=>{var t=fe();ve();var e=null;t.util.isNodejs&&!t.options.usePureJavaScript&&!__Process$.versions["node-webkit"]&&(e=Tn("node:crypto"));var r=i.exports=t.prng=t.prng||{};r.create=function(u){for(var f={plugin:u,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},d=u.md,c=new Array(32),n=0;n<32;++n)c[n]=d.create();f.pools=c,f.pool=0,f.generate=function(A,y){if(!y)return f.generateSync(A);var T=f.plugin.cipher,b=f.plugin.increment,S=f.plugin.formatKey,s=f.plugin.formatSeed,E=t.util.createBuffer();f.key=null,C();function C(_){if(_)return y(_);if(E.length()>=A)return y(null,E.getBytes(A));if(f.generated>1048575&&(f.key=null),f.key===null)return t.util.nextTick(function(){m(C)});var k=T(f.key,f.seed);f.generated+=k.length,E.putBytes(k),f.key=S(T(f.key,b(f.seed))),f.seed=s(T(f.key,f.seed)),t.util.setImmediate(C)}},f.generateSync=function(A){var y=f.plugin.cipher,T=f.plugin.increment,b=f.plugin.formatKey,S=f.plugin.formatSeed;f.key=null;for(var s=t.util.createBuffer();s.length()<A;){f.generated>1048575&&(f.key=null),f.key===null&&h();var E=y(f.key,f.seed);f.generated+=E.length,s.putBytes(E),f.key=b(y(f.key,T(f.seed))),f.seed=S(y(f.key,f.seed))}return s.getBytes(A)};function m(A){if(f.pools[0].messageLength>=32)return I(),A();var y=32-f.pools[0].messageLength<<5;f.seedFile(y,function(T,b){if(T)return A(T);f.collect(b),I(),A()})}function h(){if(f.pools[0].messageLength>=32)return I();var A=32-f.pools[0].messageLength<<5;f.collect(f.seedFileSync(A)),I()}function I(){f.reseeds=f.reseeds===4294967295?0:f.reseeds+1;var A=f.plugin.md.create();A.update(f.keyBytes);for(var y=1,T=0;T<32;++T)f.reseeds%y===0&&(A.update(f.pools[T].digest().getBytes()),f.pools[T].start()),y=y<<1;f.keyBytes=A.digest().getBytes(),A.start(),A.update(f.keyBytes);var b=A.digest().getBytes();f.key=f.plugin.formatKey(f.keyBytes),f.seed=f.plugin.formatSeed(b),f.generated=0}function x(A){var y=null,T=t.util.globalScope,b=T.crypto||T.msCrypto;b&&b.getRandomValues&&(y=function(a){return b.getRandomValues(a)});var S=t.util.createBuffer();if(y)for(;S.length()<A;){var s=Math.max(1,Math.min(A-S.length(),65536)/4),E=new Uint32Array(Math.floor(s));try{y(E);for(var C=0;C<E.length;++C)S.putInt32(E[C])}catch(a){if(!(typeof QuotaExceededError<"u"&&a instanceof QuotaExceededError))throw a}}if(S.length()<A)for(var _,k,v,o=Math.floor(Math.random()*65536);S.length()<A;){k=16807*(o&65535),_=16807*(o>>16),k+=(_&32767)<<16,k+=_>>15,k=(k&2147483647)+(k>>31),o=k&4294967295;for(var C=0;C<3;++C)v=o>>>(C<<3),v^=Math.floor(Math.random()*256),S.putByte(v&255)}return S.getBytes(A)}return e?(f.seedFile=function(A,y){e.randomBytes(A,function(T,b){if(T)return y(T);y(null,b.toString())})},f.seedFileSync=function(A){return e.randomBytes(A).toString()}):(f.seedFile=function(A,y){try{y(null,x(A))}catch(T){y(T)}},f.seedFileSync=x),f.collect=function(A){for(var y=A.length,T=0;T<y;++T)f.pools[f.pool].update(A.substr(T,1)),f.pool=f.pool===31?0:f.pool+1},f.collectInt=function(A,y){for(var T="",b=0;b<y;b+=8)T+=String.fromCharCode(A>>b&255);f.collect(T)},f.registerWorker=function(A){if(A===self)f.seedFile=function(T,b){function S(s){var E=s.data;E.forge&&E.forge.prng&&(self.removeEventListener("message",S),b(E.forge.prng.err,E.forge.prng.bytes))}self.addEventListener("message",S),self.postMessage({forge:{prng:{needed:T}}})};else{var y=function(T){var b=T.data;b.forge&&b.forge.prng&&f.seedFile(b.forge.prng.needed,function(S,s){A.postMessage({forge:{prng:{err:S,bytes:s}}})})};A.addEventListener("message",y)}},f}}),yt=pe((l,i)=>{var t=fe();Ft(),es(),ts(),ve(),function(){if(t.random&&t.random.getBytes){i.exports=t.random;return}(function(e){var r={},u=new Array(4),f=t.util.createBuffer();r.formatKey=function(A){var y=t.util.createBuffer(A);return A=new Array(4),A[0]=y.getInt32(),A[1]=y.getInt32(),A[2]=y.getInt32(),A[3]=y.getInt32(),t.aes._expandKey(A,!1)},r.formatSeed=function(A){var y=t.util.createBuffer(A);return A=new Array(4),A[0]=y.getInt32(),A[1]=y.getInt32(),A[2]=y.getInt32(),A[3]=y.getInt32(),A},r.cipher=function(A,y){return t.aes._updateBlock(A,y,u,!1),f.putInt32(u[0]),f.putInt32(u[1]),f.putInt32(u[2]),f.putInt32(u[3]),f.getBytes()},r.increment=function(A){return++A[3],A},r.md=t.md.sha256;function d(){var A=t.prng.create(r);return A.getBytes=function(y,T){return A.generate(y,T)},A.getBytesSync=function(y){return A.generate(y)},A}var c=d(),n=null,m=t.util.globalScope,h=m.crypto||m.msCrypto;if(h&&h.getRandomValues&&(n=function(A){return h.getRandomValues(A)}),t.options.usePureJavaScript||!t.util.isNodejs&&!n){if(typeof window>"u"||window.document,c.collectInt(+new Date,32),typeof navigator<"u"){var I="";for(var x in navigator)try{typeof navigator[x]=="string"&&(I+=navigator[x])}catch{}c.collect(I),I=null}e&&(e().mousemove(function(A){c.collectInt(A.clientX,16),c.collectInt(A.clientY,16)}),e().keypress(function(A){c.collectInt(A.charCode,8)}))}if(!t.random)t.random=c;else for(var x in c)t.random[x]=c[x];t.random.createInstance=d,i.exports=t.random})(typeof jQuery<"u"?jQuery:null)}()}),rs=pe((l,i)=>{var t=fe();ve();var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],r=[1,2,3,5],u=function(c,n){return c<<n&65535|(c&65535)>>16-n},f=function(c,n){return(c&65535)>>n|c<<16-n&65535};i.exports=t.rc2=t.rc2||{},t.rc2.expandKey=function(c,n){typeof c=="string"&&(c=t.util.createBuffer(c)),n=n||128;var m=c,h=c.length(),I=n,x=Math.ceil(I/8),A=255>>(I&7),y;for(y=h;y<128;y++)m.putByte(e[m.at(y-1)+m.at(y-h)&255]);for(m.setAt(128-x,e[m.at(128-x)&A]),y=127-x;y>=0;y--)m.setAt(y,e[m.at(y+1)^m.at(y+x)]);return m};var d=function(c,n,m){var h=!1,I=null,x=null,A=null,y,T,b,S,s=[];for(c=t.rc2.expandKey(c,n),b=0;b<64;b++)s.push(c.getInt16Le());m?(y=function(_){for(b=0;b<4;b++)_[b]+=s[S]+(_[(b+3)%4]&_[(b+2)%4])+(~_[(b+3)%4]&_[(b+1)%4]),_[b]=u(_[b],r[b]),S++},T=function(_){for(b=0;b<4;b++)_[b]+=s[_[(b+3)%4]&63]}):(y=function(_){for(b=3;b>=0;b--)_[b]=f(_[b],r[b]),_[b]-=s[S]+(_[(b+3)%4]&_[(b+2)%4])+(~_[(b+3)%4]&_[(b+1)%4]),S--},T=function(_){for(b=3;b>=0;b--)_[b]-=s[_[(b+3)%4]&63]});var E=function(_){var k=[];for(b=0;b<4;b++){var v=I.getInt16Le();A!==null&&(m?v^=A.getInt16Le():A.putInt16Le(v)),k.push(v&65535)}S=m?0:63;for(var o=0;o<_.length;o++)for(var a=0;a<_[o][0];a++)_[o][1](k);for(b=0;b<4;b++)A!==null&&(m?A.putInt16Le(k[b]):k[b]^=A.getInt16Le()),x.putInt16Le(k[b])},C=null;return C={start:function(_,k){_&&typeof _=="string"&&(_=t.util.createBuffer(_)),h=!1,I=t.util.createBuffer(),x=k||new t.util.createBuffer,A=_,C.output=x},update:function(_){for(h||I.putBuffer(_);I.length()>=8;)E([[5,y],[1,T],[6,y],[1,T],[5,y]])},finish:function(_){var k=!0;if(m)if(_)k=_(8,I,!m);else{var v=I.length()===8?8:8-I.length();I.fillWithByte(v,v)}if(k&&(h=!0,C.update()),!m&&(k=I.length()===0,k))if(_)k=_(8,x,!m);else{var o=x.length(),a=x.at(o-1);a>o?k=!1:x.truncate(a)}return k}},C};t.rc2.startEncrypting=function(c,n,m){var h=t.rc2.createEncryptionCipher(c,128);return h.start(n,m),h},t.rc2.createEncryptionCipher=function(c,n){return d(c,n,!0)},t.rc2.startDecrypting=function(c,n,m){var h=t.rc2.createDecryptionCipher(c,128);return h.start(n,m),h},t.rc2.createDecryptionCipher=function(c,n){return d(c,n,!1)}}),Hr=pe((l,i)=>{var t=fe();i.exports=t.jsbn=t.jsbn||{};var e,r=0xdeadbeefcafe,u=(r&16777215)==15715070;function f(B,R,O){this.data=[],B!=null&&(typeof B=="number"?this.fromNumber(B,R,O):R==null&&typeof B!="string"?this.fromString(B,256):this.fromString(B,R))}t.jsbn.BigInteger=f;function d(){return new f(null)}function c(B,R,O,F,Q,X){for(;--X>=0;){var ne=R*this.data[B++]+O.data[F]+Q;Q=Math.floor(ne/67108864),O.data[F++]=ne&67108863}return Q}function n(B,R,O,F,Q,X){for(var ne=R&32767,te=R>>15;--X>=0;){var Ee=this.data[B]&32767,Qe=this.data[B++]>>15,st=te*Ee+Qe*ne;Ee=ne*Ee+((st&32767)<<15)+O.data[F]+(Q&1073741823),Q=(Ee>>>30)+(st>>>15)+te*Qe+(Q>>>30),O.data[F++]=Ee&1073741823}return Q}function m(B,R,O,F,Q,X){for(var ne=R&16383,te=R>>14;--X>=0;){var Ee=this.data[B]&16383,Qe=this.data[B++]>>14,st=te*Ee+Qe*ne;Ee=ne*Ee+((st&16383)<<14)+O.data[F]+Q,Q=(Ee>>28)+(st>>14)+te*Qe,O.data[F++]=Ee&268435455}return Q}typeof navigator>"u"?(f.prototype.am=m,e=28):u&&navigator.appName=="Microsoft Internet Explorer"?(f.prototype.am=n,e=30):u&&navigator.appName!="Netscape"?(f.prototype.am=c,e=26):(f.prototype.am=m,e=28),f.prototype.DB=e,f.prototype.DM=(1<<e)-1,f.prototype.DV=1<<e;var h=52;f.prototype.FV=Math.pow(2,h),f.prototype.F1=h-e,f.prototype.F2=2*e-h;var I="0123456789abcdefghijklmnopqrstuvwxyz",x=new Array,A,y;for(A=48,y=0;y<=9;++y)x[A++]=y;for(A=97,y=10;y<36;++y)x[A++]=y;for(A=65,y=10;y<36;++y)x[A++]=y;function T(B){return I.charAt(B)}function b(B,R){var O=x[B.charCodeAt(R)];return O??-1}function S(B){for(var R=this.t-1;R>=0;--R)B.data[R]=this.data[R];B.t=this.t,B.s=this.s}function s(B){this.t=1,this.s=B<0?-1:0,B>0?this.data[0]=B:B<-1?this.data[0]=B+this.DV:this.t=0}function E(B){var R=d();return R.fromInt(B),R}function C(B,R){var O;if(R==16)O=4;else if(R==8)O=3;else if(R==256)O=8;else if(R==2)O=1;else if(R==32)O=5;else if(R==4)O=2;else{this.fromRadix(B,R);return}this.t=0,this.s=0;for(var F=B.length,Q=!1,X=0;--F>=0;){var ne=O==8?B[F]&255:b(B,F);if(ne<0){B.charAt(F)=="-"&&(Q=!0);continue}Q=!1,X==0?this.data[this.t++]=ne:X+O>this.DB?(this.data[this.t-1]|=(ne&(1<<this.DB-X)-1)<<X,this.data[this.t++]=ne>>this.DB-X):this.data[this.t-1]|=ne<<X,X+=O,X>=this.DB&&(X-=this.DB)}O==8&&B[0]&128&&(this.s=-1,X>0&&(this.data[this.t-1]|=(1<<this.DB-X)-1<<X)),this.clamp(),Q&&f.ZERO.subTo(this,this)}function _(){for(var B=this.s&this.DM;this.t>0&&this.data[this.t-1]==B;)--this.t}function k(B){if(this.s<0)return"-"+this.negate().toString(B);var R;if(B==16)R=4;else if(B==8)R=3;else if(B==2)R=1;else if(B==32)R=5;else if(B==4)R=2;else return this.toRadix(B);var O=(1<<R)-1,F,Q=!1,X="",ne=this.t,te=this.DB-ne*this.DB%R;if(ne-- >0)for(te<this.DB&&(F=this.data[ne]>>te)>0&&(Q=!0,X=T(F));ne>=0;)te<R?(F=(this.data[ne]&(1<<te)-1)<<R-te,F|=this.data[--ne]>>(te+=this.DB-R)):(F=this.data[ne]>>(te-=R)&O,te<=0&&(te+=this.DB,--ne)),F>0&&(Q=!0),Q&&(X+=T(F));return Q?X:"0"}function v(){var B=d();return f.ZERO.subTo(this,B),B}function o(){return this.s<0?this.negate():this}function a(B){var R=this.s-B.s;if(R!=0)return R;var O=this.t;if(R=O-B.t,R!=0)return this.s<0?-R:R;for(;--O>=0;)if((R=this.data[O]-B.data[O])!=0)return R;return 0}function w(B){var R=1,O;return(O=B>>>16)!=0&&(B=O,R+=16),(O=B>>8)!=0&&(B=O,R+=8),(O=B>>4)!=0&&(B=O,R+=4),(O=B>>2)!=0&&(B=O,R+=2),(O=B>>1)!=0&&(B=O,R+=1),R}function P(){return this.t<=0?0:this.DB*(this.t-1)+w(this.data[this.t-1]^this.s&this.DM)}function K(B,R){var O;for(O=this.t-1;O>=0;--O)R.data[O+B]=this.data[O];for(O=B-1;O>=0;--O)R.data[O]=0;R.t=this.t+B,R.s=this.s}function D(B,R){for(var O=B;O<this.t;++O)R.data[O-B]=this.data[O];R.t=Math.max(this.t-B,0),R.s=this.s}function H(B,R){var O=B%this.DB,F=this.DB-O,Q=(1<<F)-1,X=Math.floor(B/this.DB),ne=this.s<<O&this.DM,te;for(te=this.t-1;te>=0;--te)R.data[te+X+1]=this.data[te]>>F|ne,ne=(this.data[te]&Q)<<O;for(te=X-1;te>=0;--te)R.data[te]=0;R.data[X]=ne,R.t=this.t+X+1,R.s=this.s,R.clamp()}function G(B,R){R.s=this.s;var O=Math.floor(B/this.DB);if(O>=this.t){R.t=0;return}var F=B%this.DB,Q=this.DB-F,X=(1<<F)-1;R.data[0]=this.data[O]>>F;for(var ne=O+1;ne<this.t;++ne)R.data[ne-O-1]|=(this.data[ne]&X)<<Q,R.data[ne-O]=this.data[ne]>>F;F>0&&(R.data[this.t-O-1]|=(this.s&X)<<Q),R.t=this.t-O,R.clamp()}function q(B,R){for(var O=0,F=0,Q=Math.min(B.t,this.t);O<Q;)F+=this.data[O]-B.data[O],R.data[O++]=F&this.DM,F>>=this.DB;if(B.t<this.t){for(F-=B.s;O<this.t;)F+=this.data[O],R.data[O++]=F&this.DM,F>>=this.DB;F+=this.s}else{for(F+=this.s;O<B.t;)F-=B.data[O],R.data[O++]=F&this.DM,F>>=this.DB;F-=B.s}R.s=F<0?-1:0,F<-1?R.data[O++]=this.DV+F:F>0&&(R.data[O++]=F),R.t=O,R.clamp()}function j(B,R){var O=this.abs(),F=B.abs(),Q=O.t;for(R.t=Q+F.t;--Q>=0;)R.data[Q]=0;for(Q=0;Q<F.t;++Q)R.data[Q+O.t]=O.am(0,F.data[Q],R,Q,0,O.t);R.s=0,R.clamp(),this.s!=B.s&&f.ZERO.subTo(R,R)}function Y(B){for(var R=this.abs(),O=B.t=2*R.t;--O>=0;)B.data[O]=0;for(O=0;O<R.t-1;++O){var F=R.am(O,R.data[O],B,2*O,0,1);(B.data[O+R.t]+=R.am(O+1,2*R.data[O],B,2*O+1,F,R.t-O-1))>=R.DV&&(B.data[O+R.t]-=R.DV,B.data[O+R.t+1]=1)}B.t>0&&(B.data[B.t-1]+=R.am(O,R.data[O],B,2*O,0,1)),B.s=0,B.clamp()}function J(B,R,O){var F=B.abs();if(!(F.t<=0)){var Q=this.abs();if(Q.t<F.t){R?.fromInt(0),O!=null&&this.copyTo(O);return}O==null&&(O=d());var X=d(),ne=this.s,te=B.s,Ee=this.DB-w(F.data[F.t-1]);Ee>0?(F.lShiftTo(Ee,X),Q.lShiftTo(Ee,O)):(F.copyTo(X),Q.copyTo(O));var Qe=X.t,st=X.data[Qe-1];if(st!=0){var nt=st*(1<<this.F1)+(Qe>1?X.data[Qe-2]>>this.F2:0),bt=this.FV/nt,Br=(1<<this.F1)/nt,ht=1<<this.F2,ft=O.t,wr=ft-Qe,Rt=R??d();for(X.dlShiftTo(wr,Rt),O.compareTo(Rt)>=0&&(O.data[O.t++]=1,O.subTo(Rt,O)),f.ONE.dlShiftTo(Qe,Rt),Rt.subTo(X,X);X.t<Qe;)X.data[X.t++]=0;for(;--wr>=0;){var $r=O.data[--ft]==st?this.DM:Math.floor(O.data[ft]*bt+(O.data[ft-1]+ht)*Br);if((O.data[ft]+=X.am(0,$r,O,wr,0,Qe))<$r)for(X.dlShiftTo(wr,Rt),O.subTo(Rt,O);O.data[ft]<--$r;)O.subTo(Rt,O)}R!=null&&(O.drShiftTo(Qe,R),ne!=te&&f.ZERO.subTo(R,R)),O.t=Qe,O.clamp(),Ee>0&&O.rShiftTo(Ee,O),ne<0&&f.ZERO.subTo(O,O)}}}function ee(B){var R=d();return this.abs().divRemTo(B,null,R),this.s<0&&R.compareTo(f.ZERO)>0&&B.subTo(R,R),R}function ie(B){this.m=B}function le(B){return B.s<0||B.compareTo(this.m)>=0?B.mod(this.m):B}function ge(B){return B}function Se(B){B.divRemTo(this.m,null,B)}function $(B,R,O){B.multiplyTo(R,O),this.reduce(O)}function me(B,R){B.squareTo(R),this.reduce(R)}ie.prototype.convert=le,ie.prototype.revert=ge,ie.prototype.reduce=Se,ie.prototype.mulTo=$,ie.prototype.sqrTo=me;function Z(){if(this.t<1)return 0;var B=this.data[0];if(!(B&1))return 0;var R=B&3;return R=R*(2-(B&15)*R)&15,R=R*(2-(B&255)*R)&255,R=R*(2-((B&65535)*R&65535))&65535,R=R*(2-B*R%this.DV)%this.DV,R>0?this.DV-R:-R}function we(B){this.m=B,this.mp=B.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<B.DB-15)-1,this.mt2=2*B.t}function de(B){var R=d();return B.abs().dlShiftTo(this.m.t,R),R.divRemTo(this.m,null,R),B.s<0&&R.compareTo(f.ZERO)>0&&this.m.subTo(R,R),R}function g(B){var R=d();return B.copyTo(R),this.reduce(R),R}function U(B){for(;B.t<=this.mt2;)B.data[B.t++]=0;for(var R=0;R<this.m.t;++R){var O=B.data[R]&32767,F=O*this.mpl+((O*this.mph+(B.data[R]>>15)*this.mpl&this.um)<<15)&B.DM;for(O=R+this.m.t,B.data[O]+=this.m.am(0,F,B,R,0,this.m.t);B.data[O]>=B.DV;)B.data[O]-=B.DV,B.data[++O]++}B.clamp(),B.drShiftTo(this.m.t,B),B.compareTo(this.m)>=0&&B.subTo(this.m,B)}function L(B,R){B.squareTo(R),this.reduce(R)}function p(B,R,O){B.multiplyTo(R,O),this.reduce(O)}we.prototype.convert=de,we.prototype.revert=g,we.prototype.reduce=U,we.prototype.mulTo=p,we.prototype.sqrTo=L;function N(){return(this.t>0?this.data[0]&1:this.s)==0}function M(B,R){if(B>4294967295||B<1)return f.ONE;var O=d(),F=d(),Q=R.convert(this),X=w(B)-1;for(Q.copyTo(O);--X>=0;)if(R.sqrTo(O,F),(B&1<<X)>0)R.mulTo(F,Q,O);else{var ne=O;O=F,F=ne}return R.revert(O)}function V(B,R){var O;return B<256||R.isEven()?O=new ie(R):O=new we(R),this.exp(B,O)}f.prototype.copyTo=S,f.prototype.fromInt=s,f.prototype.fromString=C,f.prototype.clamp=_,f.prototype.dlShiftTo=K,f.prototype.drShiftTo=D,f.prototype.lShiftTo=H,f.prototype.rShiftTo=G,f.prototype.subTo=q,f.prototype.multiplyTo=j,f.prototype.squareTo=Y,f.prototype.divRemTo=J,f.prototype.invDigit=Z,f.prototype.isEven=N,f.prototype.exp=M,f.prototype.toString=k,f.prototype.negate=v,f.prototype.abs=o,f.prototype.compareTo=a,f.prototype.bitLength=P,f.prototype.mod=ee,f.prototype.modPowInt=V,f.ZERO=E(0),f.ONE=E(1);function W(){var B=d();return this.copyTo(B),B}function ae(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function se(){return this.t==0?this.s:this.data[0]<<24>>24}function z(){return this.t==0?this.s:this.data[0]<<16>>16}function re(B){return Math.floor(Math.LN2*this.DB/Math.log(B))}function ue(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function ye(B){if(B==null&&(B=10),this.signum()==0||B<2||B>36)return"0";var R=this.chunkSize(B),O=Math.pow(B,R),F=E(O),Q=d(),X=d(),ne="";for(this.divRemTo(F,Q,X);Q.signum()>0;)ne=(O+X.intValue()).toString(B).substr(1)+ne,Q.divRemTo(F,Q,X);return X.intValue().toString(B)+ne}function he(B,R){this.fromInt(0),R==null&&(R=10);for(var O=this.chunkSize(R),F=Math.pow(R,O),Q=!1,X=0,ne=0,te=0;te<B.length;++te){var Ee=b(B,te);if(Ee<0){B.charAt(te)=="-"&&this.signum()==0&&(Q=!0);continue}ne=R*ne+Ee,++X>=O&&(this.dMultiply(F),this.dAddOffset(ne,0),X=0,ne=0)}X>0&&(this.dMultiply(Math.pow(R,X)),this.dAddOffset(ne,0)),Q&&f.ZERO.subTo(this,this)}function be(B,R,O){if(typeof R=="number")if(B<2)this.fromInt(1);else for(this.fromNumber(B,O),this.testBit(B-1)||this.bitwiseTo(f.ONE.shiftLeft(B-1),ke,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(R);)this.dAddOffset(2,0),this.bitLength()>B&&this.subTo(f.ONE.shiftLeft(B-1),this);else{var F=new Array,Q=B&7;F.length=(B>>3)+1,R.nextBytes(F),Q>0?F[0]&=(1<<Q)-1:F[0]=0,this.fromString(F,256)}}function Ne(){var B=this.t,R=new Array;R[0]=this.s;var O=this.DB-B*this.DB%8,F,Q=0;if(B-- >0)for(O<this.DB&&(F=this.data[B]>>O)!=(this.s&this.DM)>>O&&(R[Q++]=F|this.s<<this.DB-O);B>=0;)O<8?(F=(this.data[B]&(1<<O)-1)<<8-O,F|=this.data[--B]>>(O+=this.DB-8)):(F=this.data[B]>>(O-=8)&255,O<=0&&(O+=this.DB,--B)),F&128&&(F|=-256),Q==0&&(this.s&128)!=(F&128)&&++Q,(Q>0||F!=this.s)&&(R[Q++]=F);return R}function _e(B){return this.compareTo(B)==0}function Ae(B){return this.compareTo(B)<0?this:B}function Ce(B){return this.compareTo(B)>0?this:B}function Te(B,R,O){var F,Q,X=Math.min(B.t,this.t);for(F=0;F<X;++F)O.data[F]=R(this.data[F],B.data[F]);if(B.t<this.t){for(Q=B.s&this.DM,F=X;F<this.t;++F)O.data[F]=R(this.data[F],Q);O.t=this.t}else{for(Q=this.s&this.DM,F=X;F<B.t;++F)O.data[F]=R(Q,B.data[F]);O.t=B.t}O.s=R(this.s,B.s),O.clamp()}function Le(B,R){return B&R}function Ye(B){var R=d();return this.bitwiseTo(B,Le,R),R}function ke(B,R){return B|R}function $e(B){var R=d();return this.bitwiseTo(B,ke,R),R}function Je(B,R){return B^R}function tt(B){var R=d();return this.bitwiseTo(B,Je,R),R}function rt(B,R){return B&~R}function lt(B){var R=d();return this.bitwiseTo(B,rt,R),R}function gt(){for(var B=d(),R=0;R<this.t;++R)B.data[R]=this.DM&~this.data[R];return B.t=this.t,B.s=~this.s,B}function St(B){var R=d();return B<0?this.rShiftTo(-B,R):this.lShiftTo(B,R),R}function Nt(B){var R=d();return B<0?this.lShiftTo(-B,R):this.rShiftTo(B,R),R}function xt(B){if(B==0)return-1;var R=0;return B&65535||(B>>=16,R+=16),B&255||(B>>=8,R+=8),B&15||(B>>=4,R+=4),B&3||(B>>=2,R+=2),B&1||++R,R}function jt(){for(var B=0;B<this.t;++B)if(this.data[B]!=0)return B*this.DB+xt(this.data[B]);return this.s<0?this.t*this.DB:-1}function ar(B){for(var R=0;B!=0;)B&=B-1,++R;return R}function Ir(){for(var B=0,R=this.s&this.DM,O=0;O<this.t;++O)B+=ar(this.data[O]^R);return B}function xe(B){var R=Math.floor(B/this.DB);return R>=this.t?this.s!=0:(this.data[R]&1<<B%this.DB)!=0}function Ue(B,R){var O=f.ONE.shiftLeft(B);return this.bitwiseTo(O,R,O),O}function Pe(B){return this.changeBit(B,ke)}function De(B){return this.changeBit(B,rt)}function Oe(B){return this.changeBit(B,Je)}function Ve(B,R){for(var O=0,F=0,Q=Math.min(B.t,this.t);O<Q;)F+=this.data[O]+B.data[O],R.data[O++]=F&this.DM,F>>=this.DB;if(B.t<this.t){for(F+=B.s;O<this.t;)F+=this.data[O],R.data[O++]=F&this.DM,F>>=this.DB;F+=this.s}else{for(F+=this.s;O<B.t;)F+=B.data[O],R.data[O++]=F&this.DM,F>>=this.DB;F+=B.s}R.s=F<0?-1:0,F>0?R.data[O++]=F:F<-1&&(R.data[O++]=this.DV+F),R.t=O,R.clamp()}function Ke(B){var R=d();return this.addTo(B,R),R}function He(B){var R=d();return this.subTo(B,R),R}function Me(B){var R=d();return this.multiplyTo(B,R),R}function Fe(B){var R=d();return this.divRemTo(B,R,null),R}function Ge(B){var R=d();return this.divRemTo(B,null,R),R}function qe(B){var R=d(),O=d();return this.divRemTo(B,R,O),new Array(R,O)}function je(B){this.data[this.t]=this.am(0,B-1,this,0,0,this.t),++this.t,this.clamp()}function ze(B,R){if(B!=0){for(;this.t<=R;)this.data[this.t++]=0;for(this.data[R]+=B;this.data[R]>=this.DV;)this.data[R]-=this.DV,++R>=this.t&&(this.data[this.t++]=0),++this.data[R]}}function Ie(){}function Re(B){return B}function Us(B,R,O){B.multiplyTo(R,O)}function Ps(B,R){B.squareTo(R)}Ie.prototype.convert=Re,Ie.prototype.revert=Re,Ie.prototype.mulTo=Us,Ie.prototype.sqrTo=Ps;function Ds(B){return this.exp(B,new Ie)}function Os(B,R,O){var F=Math.min(this.t+B.t,R);for(O.s=0,O.t=F;F>0;)O.data[--F]=0;var Q;for(Q=O.t-this.t;F<Q;++F)O.data[F+this.t]=this.am(0,B.data[F],O,F,0,this.t);for(Q=Math.min(B.t,R);F<Q;++F)this.am(0,B.data[F],O,F,0,R-F);O.clamp()}function Vs(B,R,O){--R;var F=O.t=this.t+B.t-R;for(O.s=0;--F>=0;)O.data[F]=0;for(F=Math.max(R-this.t,0);F<B.t;++F)O.data[this.t+F-R]=this.am(R-F,B.data[F],O,0,0,this.t+F-R);O.clamp(),O.drShiftTo(1,O)}function zt(B){this.r2=d(),this.q3=d(),f.ONE.dlShiftTo(2*B.t,this.r2),this.mu=this.r2.divide(B),this.m=B}function Ks(B){if(B.s<0||B.t>2*this.m.t)return B.mod(this.m);if(B.compareTo(this.m)<0)return B;var R=d();return B.copyTo(R),this.reduce(R),R}function Hs(B){return B}function Ms(B){for(B.drShiftTo(this.m.t-1,this.r2),B.t>this.m.t+1&&(B.t=this.m.t+1,B.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);B.compareTo(this.r2)<0;)B.dAddOffset(1,this.m.t+1);for(B.subTo(this.r2,B);B.compareTo(this.m)>=0;)B.subTo(this.m,B)}function Fs(B,R){B.squareTo(R),this.reduce(R)}function Gs(B,R,O){B.multiplyTo(R,O),this.reduce(O)}zt.prototype.convert=Ks,zt.prototype.revert=Hs,zt.prototype.reduce=Ms,zt.prototype.mulTo=Gs,zt.prototype.sqrTo=Fs;function qs(B,R){var O=B.bitLength(),F,Q=E(1),X;if(O<=0)return Q;O<18?F=1:O<48?F=3:O<144?F=4:O<768?F=5:F=6,O<8?X=new ie(R):R.isEven()?X=new zt(R):X=new we(R);var ne=new Array,te=3,Ee=F-1,Qe=(1<<F)-1;if(ne[1]=X.convert(this),F>1){var st=d();for(X.sqrTo(ne[1],st);te<=Qe;)ne[te]=d(),X.mulTo(st,ne[te-2],ne[te]),te+=2}var nt=B.t-1,bt,Br=!0,ht=d(),ft;for(O=w(B.data[nt])-1;nt>=0;){for(O>=Ee?bt=B.data[nt]>>O-Ee&Qe:(bt=(B.data[nt]&(1<<O+1)-1)<<Ee-O,nt>0&&(bt|=B.data[nt-1]>>this.DB+O-Ee)),te=F;!(bt&1);)bt>>=1,--te;if((O-=te)<0&&(O+=this.DB,--nt),Br)ne[bt].copyTo(Q),Br=!1;else{for(;te>1;)X.sqrTo(Q,ht),X.sqrTo(ht,Q),te-=2;te>0?X.sqrTo(Q,ht):(ft=Q,Q=ht,ht=ft),X.mulTo(ht,ne[bt],Q)}for(;nt>=0&&!(B.data[nt]&1<<O);)X.sqrTo(Q,ht),ft=Q,Q=ht,ht=ft,--O<0&&(O=this.DB-1,--nt)}return X.revert(Q)}function js(B){var R=this.s<0?this.negate():this.clone(),O=B.s<0?B.negate():B.clone();if(R.compareTo(O)<0){var F=R;R=O,O=F}var Q=R.getLowestSetBit(),X=O.getLowestSetBit();if(X<0)return R;for(Q<X&&(X=Q),X>0&&(R.rShiftTo(X,R),O.rShiftTo(X,O));R.signum()>0;)(Q=R.getLowestSetBit())>0&&R.rShiftTo(Q,R),(Q=O.getLowestSetBit())>0&&O.rShiftTo(Q,O),R.compareTo(O)>=0?(R.subTo(O,R),R.rShiftTo(1,R)):(O.subTo(R,O),O.rShiftTo(1,O));return X>0&&O.lShiftTo(X,O),O}function zs(B){if(B<=0)return 0;var R=this.DV%B,O=this.s<0?B-1:0;if(this.t>0)if(R==0)O=this.data[0]%B;else for(var F=this.t-1;F>=0;--F)O=(R*O+this.data[F])%B;return O}function Qs(B){var R=B.isEven();if(this.isEven()&&R||B.signum()==0)return f.ZERO;for(var O=B.clone(),F=this.clone(),Q=E(1),X=E(0),ne=E(0),te=E(1);O.signum()!=0;){for(;O.isEven();)O.rShiftTo(1,O),R?((!Q.isEven()||!X.isEven())&&(Q.addTo(this,Q),X.subTo(B,X)),Q.rShiftTo(1,Q)):X.isEven()||X.subTo(B,X),X.rShiftTo(1,X);for(;F.isEven();)F.rShiftTo(1,F),R?((!ne.isEven()||!te.isEven())&&(ne.addTo(this,ne),te.subTo(B,te)),ne.rShiftTo(1,ne)):te.isEven()||te.subTo(B,te),te.rShiftTo(1,te);O.compareTo(F)>=0?(O.subTo(F,O),R&&Q.subTo(ne,Q),X.subTo(te,X)):(F.subTo(O,F),R&&ne.subTo(Q,ne),te.subTo(X,te))}if(F.compareTo(f.ONE)!=0)return f.ZERO;if(te.compareTo(B)>=0)return te.subtract(B);if(te.signum()<0)te.addTo(B,te);else return te;return te.signum()<0?te.add(B):te}var pt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Ws=(1<<26)/pt[pt.length-1];function Ys(B){var R,O=this.abs();if(O.t==1&&O.data[0]<=pt[pt.length-1]){for(R=0;R<pt.length;++R)if(O.data[0]==pt[R])return!0;return!1}if(O.isEven())return!1;for(R=1;R<pt.length;){for(var F=pt[R],Q=R+1;Q<pt.length&&F<Ws;)F*=pt[Q++];for(F=O.modInt(F);R<Q;)if(F%pt[R++]==0)return!1}return O.millerRabin(B)}function Xs(B){var R=this.subtract(f.ONE),O=R.getLowestSetBit();if(O<=0)return!1;for(var F=R.shiftRight(O),Q=$s(),X,ne=0;ne<B;++ne){do X=new f(this.bitLength(),Q);while(X.compareTo(f.ONE)<=0||X.compareTo(R)>=0);var te=X.modPow(F,this);if(te.compareTo(f.ONE)!=0&&te.compareTo(R)!=0){for(var Ee=1;Ee++<O&&te.compareTo(R)!=0;)if(te=te.modPowInt(2,this),te.compareTo(f.ONE)==0)return!1;if(te.compareTo(R)!=0)return!1}}return!0}function $s(){return{nextBytes:function(B){for(var R=0;R<B.length;++R)B[R]=Math.floor(Math.random()*256)}}}f.prototype.chunkSize=re,f.prototype.toRadix=ye,f.prototype.fromRadix=he,f.prototype.fromNumber=be,f.prototype.bitwiseTo=Te,f.prototype.changeBit=Ue,f.prototype.addTo=Ve,f.prototype.dMultiply=je,f.prototype.dAddOffset=ze,f.prototype.multiplyLowerTo=Os,f.prototype.multiplyUpperTo=Vs,f.prototype.modInt=zs,f.prototype.millerRabin=Xs,f.prototype.clone=W,f.prototype.intValue=ae,f.prototype.byteValue=se,f.prototype.shortValue=z,f.prototype.signum=ue,f.prototype.toByteArray=Ne,f.prototype.equals=_e,f.prototype.min=Ae,f.prototype.max=Ce,f.prototype.and=Ye,f.prototype.or=$e,f.prototype.xor=tt,f.prototype.andNot=lt,f.prototype.not=gt,f.prototype.shiftLeft=St,f.prototype.shiftRight=Nt,f.prototype.getLowestSetBit=jt,f.prototype.bitCount=Ir,f.prototype.testBit=xe,f.prototype.setBit=Pe,f.prototype.clearBit=De,f.prototype.flipBit=Oe,f.prototype.add=Ke,f.prototype.subtract=He,f.prototype.multiply=Me,f.prototype.divide=Fe,f.prototype.remainder=Ge,f.prototype.divideAndRemainder=qe,f.prototype.modPow=qs,f.prototype.modInverse=Qs,f.prototype.pow=Ds,f.prototype.gcd=js,f.prototype.isProbablePrime=Ys}),Er=pe((l,i)=>{var t=fe();wt(),ve();var e=i.exports=t.sha1=t.sha1||{};t.md.sha1=t.md.algorithms.sha1=e,e.create=function(){u||f();var c=null,n=t.util.createBuffer(),m=new Array(80),h={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return h.start=function(){h.messageLength=0,h.fullMessageLength=h.messageLength64=[];for(var I=h.messageLengthSize/4,x=0;x<I;++x)h.fullMessageLength.push(0);return n=t.util.createBuffer(),c={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},h},h.start(),h.update=function(I,x){x==="utf8"&&(I=t.util.encodeUtf8(I));var A=I.length;h.messageLength+=A,A=[A/4294967296>>>0,A>>>0];for(var y=h.fullMessageLength.length-1;y>=0;--y)h.fullMessageLength[y]+=A[1],A[1]=A[0]+(h.fullMessageLength[y]/4294967296>>>0),h.fullMessageLength[y]=h.fullMessageLength[y]>>>0,A[0]=A[1]/4294967296>>>0;return n.putBytes(I),d(c,m,n),(n.read>2048||n.length()===0)&&n.compact(),h},h.digest=function(){var I=t.util.createBuffer();I.putBytes(n.bytes());var x=h.fullMessageLength[h.fullMessageLength.length-1]+h.messageLengthSize,A=x&h.blockLength-1;I.putBytes(r.substr(0,h.blockLength-A));for(var y,T,b=h.fullMessageLength[0]*8,S=0;S<h.fullMessageLength.length-1;++S)y=h.fullMessageLength[S+1]*8,T=y/4294967296>>>0,b+=T,I.putInt32(b>>>0),b=y>>>0;I.putInt32(b);var s={h0:c.h0,h1:c.h1,h2:c.h2,h3:c.h3,h4:c.h4};d(s,m,I);var E=t.util.createBuffer();return E.putInt32(s.h0),E.putInt32(s.h1),E.putInt32(s.h2),E.putInt32(s.h3),E.putInt32(s.h4),E},h};var r=null,u=!1;function f(){r="\x80",r+=t.util.fillString("\0",64),u=!0}function d(c,n,m){for(var h,I,x,A,y,T,b,S,s=m.length();s>=64;){for(I=c.h0,x=c.h1,A=c.h2,y=c.h3,T=c.h4,S=0;S<16;++S)h=m.getInt32(),n[S]=h,b=y^x&(A^y),h=(I<<5|I>>>27)+b+T+1518500249+h,T=y,y=A,A=(x<<30|x>>>2)>>>0,x=I,I=h;for(;S<20;++S)h=n[S-3]^n[S-8]^n[S-14]^n[S-16],h=h<<1|h>>>31,n[S]=h,b=y^x&(A^y),h=(I<<5|I>>>27)+b+T+1518500249+h,T=y,y=A,A=(x<<30|x>>>2)>>>0,x=I,I=h;for(;S<32;++S)h=n[S-3]^n[S-8]^n[S-14]^n[S-16],h=h<<1|h>>>31,n[S]=h,b=x^A^y,h=(I<<5|I>>>27)+b+T+1859775393+h,T=y,y=A,A=(x<<30|x>>>2)>>>0,x=I,I=h;for(;S<40;++S)h=n[S-6]^n[S-16]^n[S-28]^n[S-32],h=h<<2|h>>>30,n[S]=h,b=x^A^y,h=(I<<5|I>>>27)+b+T+1859775393+h,T=y,y=A,A=(x<<30|x>>>2)>>>0,x=I,I=h;for(;S<60;++S)h=n[S-6]^n[S-16]^n[S-28]^n[S-32],h=h<<2|h>>>30,n[S]=h,b=x&A|y&(x^A),h=(I<<5|I>>>27)+b+T+2400959708+h,T=y,y=A,A=(x<<30|x>>>2)>>>0,x=I,I=h;for(;S<80;++S)h=n[S-6]^n[S-16]^n[S-28]^n[S-32],h=h<<2|h>>>30,n[S]=h,b=x^A^y,h=(I<<5|I>>>27)+b+T+3395469782+h,T=y,y=A,A=(x<<30|x>>>2)>>>0,x=I,I=h;c.h0=c.h0+I|0,c.h1=c.h1+x|0,c.h2=c.h2+A|0,c.h3=c.h3+y|0,c.h4=c.h4+T|0,s-=64}}}),ns=pe((l,i)=>{var t=fe();ve(),yt(),Er();var e=i.exports=t.pkcs1=t.pkcs1||{};e.encode_rsa_oaep=function(u,f,d){var c,n,m,h;typeof d=="string"?(c=d,n=arguments[3]||void 0,m=arguments[4]||void 0):d&&(c=d.label||void 0,n=d.seed||void 0,m=d.md||void 0,d.mgf1&&d.mgf1.md&&(h=d.mgf1.md)),m?m.start():m=t.md.sha1.create(),h||(h=m);var I=Math.ceil(u.n.bitLength()/8),x=I-2*m.digestLength-2;if(f.length>x){var A=new Error("RSAES-OAEP input message length is too long.");throw A.length=f.length,A.maxLength=x,A}c||(c=""),m.update(c,"raw");for(var y=m.digest(),T="",b=x-f.length,S=0;S<b;S++)T+="\0";var s=y.getBytes()+T+""+f;if(!n)n=t.random.getBytes(m.digestLength);else if(n.length!==m.digestLength){var A=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw A.seedLength=n.length,A.digestLength=m.digestLength,A}var E=r(n,I-m.digestLength-1,h),C=t.util.xorBytes(s,E,s.length),_=r(C,m.digestLength,h),k=t.util.xorBytes(n,_,n.length);return"\0"+k+C},e.decode_rsa_oaep=function(u,f,d){var c,n,m;typeof d=="string"?(c=d,n=arguments[3]||void 0):d&&(c=d.label||void 0,n=d.md||void 0,d.mgf1&&d.mgf1.md&&(m=d.mgf1.md));var h=Math.ceil(u.n.bitLength()/8);if(f.length!==h){var I=new Error("RSAES-OAEP encoded message length is invalid.");throw I.length=f.length,I.expectedLength=h,I}if(n===void 0?n=t.md.sha1.create():n.start(),m||(m=n),h<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");c||(c=""),n.update(c,"raw");for(var x=n.digest().getBytes(),A=f.charAt(0),y=f.substring(1,n.digestLength+1),T=f.substring(1+n.digestLength),b=r(T,n.digestLength,m),S=t.util.xorBytes(y,b,y.length),s=r(S,h-n.digestLength-1,m),E=t.util.xorBytes(T,s,T.length),C=E.substring(0,n.digestLength),I=A!=="\0",_=0;_<n.digestLength;++_)I|=x.charAt(_)!==C.charAt(_);for(var k=1,v=n.digestLength,o=n.digestLength;o<E.length;o++){var a=E.charCodeAt(o),w=a&1^1,P=k?65534:0;I|=a&P,k=k&w,v+=k}if(I||E.charCodeAt(v)!==1)throw new Error("Invalid RSAES-OAEP padding.");return E.substring(v+1)};function r(u,f,d){d||(d=t.md.sha1.create());for(var c="",n=Math.ceil(f/d.digestLength),m=0;m<n;++m){var h=String.fromCharCode(m>>24&255,m>>16&255,m>>8&255,m&255);d.start(),d.update(u+h),c+=d.digest().getBytes()}return c.substring(0,f)}}),as=pe((l,i)=>{var t=fe();ve(),Hr(),yt(),function(){if(t.prime){i.exports=t.prime;return}var e=i.exports=t.prime=t.prime||{},r=t.jsbn.BigInteger,u=[6,4,2,4,2,4,6,2],f=new r(null);f.fromInt(30);var d=function(A,y){return A|y};e.generateProbablePrime=function(A,y,T){typeof y=="function"&&(T=y,y={}),y=y||{};var b=y.algorithm||"PRIMEINC";typeof b=="string"&&(b={name:b}),b.options=b.options||{};var S=y.prng||t.random,s={nextBytes:function(E){for(var C=S.getBytesSync(E.length),_=0;_<E.length;++_)E[_]=C.charCodeAt(_)}};if(b.name==="PRIMEINC")return c(A,s,b.options,T);throw new Error("Invalid prime generation algorithm: "+b.name)};function c(A,y,T,b){return"workers"in T?h(A,y,T,b):n(A,y,T,b)}function n(A,y,T,b){var S=I(A,y),s=0,E=x(S.bitLength());"millerRabinTests"in T&&(E=T.millerRabinTests);var C=10;"maxBlockTime"in T&&(C=T.maxBlockTime),m(S,A,y,s,E,C,b)}function m(A,y,T,b,S,s,E){var C=+new Date;do{if(A.bitLength()>y&&(A=I(y,T)),A.isProbablePrime(S))return E(null,A);A.dAddOffset(u[b++%8],0)}while(s<0||+new Date-C<s);t.util.setImmediate(function(){m(A,y,T,b,S,s,E)})}function h(A,y,T,b){if(typeof Worker>"u")return n(A,y,T,b);var S=I(A,y),s=T.workers,E=T.workLoad||100,C=E*30/8,_=T.workerScript||"forge/prime.worker.js";if(s===-1)return t.util.estimateCores(function(v,o){v&&(o=2),s=o-1,k()});k();function k(){s=Math.max(1,s);for(var v=[],o=0;o<s;++o)v[o]=new Worker(_);for(var a=s,o=0;o<s;++o)v[o].addEventListener("message",P);var w=!1;function P(K){if(!w){--a;var D=K.data;if(D.found){for(var H=0;H<v.length;++H)v[H].terminate();return w=!0,b(null,new r(D.prime,16))}S.bitLength()>A&&(S=I(A,y));var G=S.toString(16);K.target.postMessage({hex:G,workLoad:E}),S.dAddOffset(C,0)}}}}function I(A,y){var T=new r(A,y),b=A-1;return T.testBit(b)||T.bitwiseTo(r.ONE.shiftLeft(b),d,T),T.dAddOffset(31-T.mod(f).byteValue(),0),T}function x(A){return A<=100?27:A<=150?18:A<=200?15:A<=250?12:A<=300?9:A<=350?8:A<=400?7:A<=500?6:A<=600?5:A<=800?4:A<=1250?3:2}}()}),Mr=pe((l,i)=>{var t=fe();Tt(),Hr(),Gt(),ns(),as(),yt(),ve(),typeof e>"u"&&(e=t.jsbn.BigInteger);var e,r=t.util.isNodejs?Tn("node:crypto"):null,u=t.asn1,f=t.util;t.pki=t.pki||{},i.exports=t.pki.rsa=t.rsa=t.rsa||{};var d=t.pki,c=[6,4,2,4,2,4,6,2],n={name:"PrivateKeyInfo",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:u.Class.UNIVERSAL,type:u.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},m={name:"RSAPrivateKey",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},h={name:"RSAPublicKey",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},I=t.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:u.Class.UNIVERSAL,type:u.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},x={name:"DigestInfo",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:u.Class.UNIVERSAL,type:u.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:u.Class.UNIVERSAL,type:u.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},A=function(o){var a;if(o.algorithm in d.oids)a=d.oids[o.algorithm];else{var w=new Error("Unknown message digest algorithm.");throw w.algorithm=o.algorithm,w}var P=u.oidToDer(a).getBytes(),K=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[]),D=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[]);D.value.push(u.create(u.Class.UNIVERSAL,u.Type.OID,!1,P)),D.value.push(u.create(u.Class.UNIVERSAL,u.Type.NULL,!1,""));var H=u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,o.digest().getBytes());return K.value.push(D),K.value.push(H),u.toDer(K).getBytes()},y=function(o,a,w){if(w)return o.modPow(a.e,a.n);if(!a.p||!a.q)return o.modPow(a.d,a.n);a.dP||(a.dP=a.d.mod(a.p.subtract(e.ONE))),a.dQ||(a.dQ=a.d.mod(a.q.subtract(e.ONE))),a.qInv||(a.qInv=a.q.modInverse(a.p));var P;do P=new e(t.util.bytesToHex(t.random.getBytes(a.n.bitLength()/8)),16);while(P.compareTo(a.n)>=0||!P.gcd(a.n).equals(e.ONE));o=o.multiply(P.modPow(a.e,a.n)).mod(a.n);for(var K=o.mod(a.p).modPow(a.dP,a.p),D=o.mod(a.q).modPow(a.dQ,a.q);K.compareTo(D)<0;)K=K.add(a.p);var H=K.subtract(D).multiply(a.qInv).mod(a.p).multiply(a.q).add(D);return H=H.multiply(P.modInverse(a.n)).mod(a.n),H};d.rsa.encrypt=function(o,a,w){var P=w,K,D=Math.ceil(a.n.bitLength()/8);w!==!1&&w!==!0?(P=w===2,K=T(o,a,w)):(K=t.util.createBuffer(),K.putBytes(o));for(var H=new e(K.toHex(),16),G=y(H,a,P),q=G.toString(16),j=t.util.createBuffer(),Y=D-Math.ceil(q.length/2);Y>0;)j.putByte(0),--Y;return j.putBytes(t.util.hexToBytes(q)),j.getBytes()},d.rsa.decrypt=function(o,a,w,P){var K=Math.ceil(a.n.bitLength()/8);if(o.length!==K){var D=new Error("Encrypted message length is invalid.");throw D.length=o.length,D.expected=K,D}var H=new e(t.util.createBuffer(o).toHex(),16);if(H.compareTo(a.n)>=0)throw new Error("Encrypted message is invalid.");for(var G=y(H,a,w),q=G.toString(16),j=t.util.createBuffer(),Y=K-Math.ceil(q.length/2);Y>0;)j.putByte(0),--Y;return j.putBytes(t.util.hexToBytes(q)),P!==!1?b(j.getBytes(),a,w):j.getBytes()},d.rsa.createKeyPairGenerationState=function(o,a,w){typeof o=="string"&&(o=parseInt(o,10)),o=o||2048,w=w||{};var P=w.prng||t.random,K={nextBytes:function(G){for(var q=P.getBytesSync(G.length),j=0;j<G.length;++j)G[j]=q.charCodeAt(j)}},D=w.algorithm||"PRIMEINC",H;if(D==="PRIMEINC")H={algorithm:D,state:0,bits:o,rng:K,eInt:a||65537,e:new e(null),p:null,q:null,qBits:o>>1,pBits:o-(o>>1),pqState:0,num:null,keys:null},H.e.fromInt(H.eInt);else throw new Error("Invalid key generation algorithm: "+D);return H},d.rsa.stepKeyPairGenerationState=function(o,a){"algorithm"in o||(o.algorithm="PRIMEINC");var w=new e(null);w.fromInt(30);for(var P=0,K=function(J,ee){return J|ee},D=+new Date,H,G=0;o.keys===null&&(a<=0||G<a);){if(o.state===0){var q=o.p===null?o.pBits:o.qBits,j=q-1;o.pqState===0?(o.num=new e(q,o.rng),o.num.testBit(j)||o.num.bitwiseTo(e.ONE.shiftLeft(j),K,o.num),o.num.dAddOffset(31-o.num.mod(w).byteValue(),0),P=0,++o.pqState):o.pqState===1?o.num.bitLength()>q?o.pqState=0:o.num.isProbablePrime(E(o.num.bitLength()))?++o.pqState:o.num.dAddOffset(c[P++%8],0):o.pqState===2?o.pqState=o.num.subtract(e.ONE).gcd(o.e).compareTo(e.ONE)===0?3:0:o.pqState===3&&(o.pqState=0,o.p===null?o.p=o.num:o.q=o.num,o.p!==null&&o.q!==null&&++o.state,o.num=null)}else if(o.state===1)o.p.compareTo(o.q)<0&&(o.num=o.p,o.p=o.q,o.q=o.num),++o.state;else if(o.state===2)o.p1=o.p.subtract(e.ONE),o.q1=o.q.subtract(e.ONE),o.phi=o.p1.multiply(o.q1),++o.state;else if(o.state===3)o.phi.gcd(o.e).compareTo(e.ONE)===0?++o.state:(o.p=null,o.q=null,o.state=0);else if(o.state===4)o.n=o.p.multiply(o.q),o.n.bitLength()===o.bits?++o.state:(o.q=null,o.state=0);else if(o.state===5){var Y=o.e.modInverse(o.phi);o.keys={privateKey:d.rsa.setPrivateKey(o.n,o.e,Y,o.p,o.q,Y.mod(o.p1),Y.mod(o.q1),o.q.modInverse(o.p)),publicKey:d.rsa.setPublicKey(o.n,o.e)}}H=+new Date,G+=H-D,D=H}return o.keys!==null},d.rsa.generateKeyPair=function(o,a,w,P){if(arguments.length===1?typeof o=="object"?(w=o,o=void 0):typeof o=="function"&&(P=o,o=void 0):arguments.length===2?typeof o=="number"?typeof a=="function"?(P=a,a=void 0):typeof a!="number"&&(w=a,a=void 0):(w=o,P=a,o=void 0,a=void 0):arguments.length===3&&(typeof a=="number"?typeof w=="function"&&(P=w,w=void 0):(P=w,w=a,a=void 0)),w=w||{},o===void 0&&(o=w.bits||2048),a===void 0&&(a=w.e||65537),!t.options.usePureJavaScript&&!w.prng&&o>=256&&o<=16384&&(a===65537||a===3)){if(P){if(C("generateKeyPair"))return r.generateKeyPair("rsa",{modulusLength:o,publicExponent:a,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(G,q,j){if(G)return P(G);P(null,{privateKey:d.privateKeyFromPem(j),publicKey:d.publicKeyFromPem(q)})});if(_("generateKey")&&_("exportKey"))return f.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:o,publicExponent:v(a),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(G){return f.globalScope.crypto.subtle.exportKey("pkcs8",G.privateKey)}).then(void 0,function(G){P(G)}).then(function(G){if(G){var q=d.privateKeyFromAsn1(u.fromDer(t.util.createBuffer(G)));P(null,{privateKey:q,publicKey:d.setRsaPublicKey(q.n,q.e)})}});if(k("generateKey")&&k("exportKey")){var K=f.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:o,publicExponent:v(a),hash:{name:"SHA-256"}},!0,["sign","verify"]);K.oncomplete=function(G){var q=G.target.result,j=f.globalScope.msCrypto.subtle.exportKey("pkcs8",q.privateKey);j.oncomplete=function(Y){var J=Y.target.result,ee=d.privateKeyFromAsn1(u.fromDer(t.util.createBuffer(J)));P(null,{privateKey:ee,publicKey:d.setRsaPublicKey(ee.n,ee.e)})},j.onerror=function(Y){P(Y)}},K.onerror=function(G){P(G)};return}}else if(C("generateKeyPairSync")){var D=r.generateKeyPairSync("rsa",{modulusLength:o,publicExponent:a,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:d.privateKeyFromPem(D.privateKey),publicKey:d.publicKeyFromPem(D.publicKey)}}}var H=d.rsa.createKeyPairGenerationState(o,a,w);if(!P)return d.rsa.stepKeyPairGenerationState(H,0),H.keys;S(H,w,P)},d.setRsaPublicKey=d.rsa.setPublicKey=function(o,a){var w={n:o,e:a};return w.encrypt=function(P,K,D){if(typeof K=="string"?K=K.toUpperCase():K===void 0&&(K="RSAES-PKCS1-V1_5"),K==="RSAES-PKCS1-V1_5")K={encode:function(G,q,j){return T(G,q,2).getBytes()}};else if(K==="RSA-OAEP"||K==="RSAES-OAEP")K={encode:function(G,q){return t.pkcs1.encode_rsa_oaep(q,G,D)}};else if(["RAW","NONE","NULL",null].indexOf(K)!==-1)K={encode:function(G){return G}};else if(typeof K=="string")throw new Error('Unsupported encryption scheme: "'+K+'".');var H=K.encode(P,w,!0);return d.rsa.encrypt(H,w,!0)},w.verify=function(P,K,D,H){typeof D=="string"?D=D.toUpperCase():D===void 0&&(D="RSASSA-PKCS1-V1_5"),H===void 0&&(H={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in H||(H._parseAllDigestBytes=!0),D==="RSASSA-PKCS1-V1_5"?D={verify:function(q,j){j=b(j,w,!0);var Y=u.fromDer(j,{parseAllBytes:H._parseAllDigestBytes}),J={},ee=[];if(!u.validate(Y,x,J,ee)){var ie=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw ie.errors=ee,ie}var le=u.derToOid(J.algorithmIdentifier);if(!(le===t.oids.md2||le===t.oids.md5||le===t.oids.sha1||le===t.oids.sha224||le===t.oids.sha256||le===t.oids.sha384||le===t.oids.sha512||le===t.oids["sha512-224"]||le===t.oids["sha512-256"])){var ie=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw ie.oid=le,ie}if((le===t.oids.md2||le===t.oids.md5)&&!("parameters"in J))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return q===J.digest}}:(D==="NONE"||D==="NULL"||D===null)&&(D={verify:function(q,j){return j=b(j,w,!0),q===j}});var G=d.rsa.decrypt(K,w,!0,!1);return D.verify(P,G,w.n.bitLength())},w},d.setRsaPrivateKey=d.rsa.setPrivateKey=function(o,a,w,P,K,D,H,G){var q={n:o,e:a,d:w,p:P,q:K,dP:D,dQ:H,qInv:G};return q.decrypt=function(j,Y,J){typeof Y=="string"?Y=Y.toUpperCase():Y===void 0&&(Y="RSAES-PKCS1-V1_5");var ee=d.rsa.decrypt(j,q,!1,!1);if(Y==="RSAES-PKCS1-V1_5")Y={decode:b};else if(Y==="RSA-OAEP"||Y==="RSAES-OAEP")Y={decode:function(ie,le){return t.pkcs1.decode_rsa_oaep(le,ie,J)}};else if(["RAW","NONE","NULL",null].indexOf(Y)!==-1)Y={decode:function(ie){return ie}};else throw new Error('Unsupported encryption scheme: "'+Y+'".');return Y.decode(ee,q,!1)},q.sign=function(j,Y){var J=!1;typeof Y=="string"&&(Y=Y.toUpperCase()),Y===void 0||Y==="RSASSA-PKCS1-V1_5"?(Y={encode:A},J=1):(Y==="NONE"||Y==="NULL"||Y===null)&&(Y={encode:function(){return j}},J=1);var ee=Y.encode(j,q.n.bitLength());return d.rsa.encrypt(ee,q,J)},q},d.wrapRsaPrivateKey=function(o){return u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,u.integerToDer(0).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(d.oids.rsaEncryption).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.NULL,!1,"")]),u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,u.toDer(o).getBytes())])},d.privateKeyFromAsn1=function(o){var a={},w=[];if(u.validate(o,n,a,w)&&(o=u.fromDer(t.util.createBuffer(a.privateKey))),a={},w=[],!u.validate(o,m,a,w)){var P=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw P.errors=w,P}var K,D,H,G,q,j,Y,J;return K=t.util.createBuffer(a.privateKeyModulus).toHex(),D=t.util.createBuffer(a.privateKeyPublicExponent).toHex(),H=t.util.createBuffer(a.privateKeyPrivateExponent).toHex(),G=t.util.createBuffer(a.privateKeyPrime1).toHex(),q=t.util.createBuffer(a.privateKeyPrime2).toHex(),j=t.util.createBuffer(a.privateKeyExponent1).toHex(),Y=t.util.createBuffer(a.privateKeyExponent2).toHex(),J=t.util.createBuffer(a.privateKeyCoefficient).toHex(),d.setRsaPrivateKey(new e(K,16),new e(D,16),new e(H,16),new e(G,16),new e(q,16),new e(j,16),new e(Y,16),new e(J,16))},d.privateKeyToAsn1=d.privateKeyToRSAPrivateKey=function(o){return u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,u.integerToDer(0).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,s(o.n)),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,s(o.e)),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,s(o.d)),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,s(o.p)),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,s(o.q)),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,s(o.dP)),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,s(o.dQ)),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,s(o.qInv))])},d.publicKeyFromAsn1=function(o){var a={},w=[];if(u.validate(o,I,a,w)){var P=u.derToOid(a.publicKeyOid);if(P!==d.oids.rsaEncryption){var K=new Error("Cannot read public key. Unknown OID.");throw K.oid=P,K}o=a.rsaPublicKey}if(w=[],!u.validate(o,h,a,w)){var K=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw K.errors=w,K}var D=t.util.createBuffer(a.publicKeyModulus).toHex(),H=t.util.createBuffer(a.publicKeyExponent).toHex();return d.setRsaPublicKey(new e(D,16),new e(H,16))},d.publicKeyToAsn1=d.publicKeyToSubjectPublicKeyInfo=function(o){return u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(d.oids.rsaEncryption).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.NULL,!1,"")]),u.create(u.Class.UNIVERSAL,u.Type.BITSTRING,!1,[d.publicKeyToRSAPublicKey(o)])])},d.publicKeyToRSAPublicKey=function(o){return u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,s(o.n)),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,s(o.e))])};function T(o,a,w){var P=t.util.createBuffer(),K=Math.ceil(a.n.bitLength()/8);if(o.length>K-11){var D=new Error("Message is too long for PKCS#1 v1.5 padding.");throw D.length=o.length,D.max=K-11,D}P.putByte(0),P.putByte(w);var H=K-3-o.length,G;if(w===0||w===1){G=w===0?0:255;for(var q=0;q<H;++q)P.putByte(G)}else for(;H>0;){for(var j=0,Y=t.random.getBytes(H),q=0;q<H;++q)G=Y.charCodeAt(q),G===0?++j:P.putByte(G);H=j}return P.putByte(0),P.putBytes(o),P}function b(o,a,w,P){var K=Math.ceil(a.n.bitLength()/8),D=t.util.createBuffer(o),H=D.getByte(),G=D.getByte();if(H!==0||w&&G!==0&&G!==1||!w&&G!=2||w&&G===0&&typeof P>"u")throw new Error("Encryption block is invalid.");var q=0;if(G===0){q=K-3-P;for(var j=0;j<q;++j)if(D.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(G===1)for(q=0;D.length()>1;){if(D.getByte()!==255){--D.read;break}++q}else if(G===2)for(q=0;D.length()>1;){if(D.getByte()===0){--D.read;break}++q}var Y=D.getByte();if(Y!==0||q!==K-3-D.length())throw new Error("Encryption block is invalid.");return D.getBytes()}function S(o,a,w){typeof a=="function"&&(w=a,a={}),a=a||{};var P={algorithm:{name:a.algorithm||"PRIMEINC",options:{workers:a.workers||2,workLoad:a.workLoad||100,workerScript:a.workerScript}}};"prng"in a&&(P.prng=a.prng),K();function K(){D(o.pBits,function(G,q){if(G)return w(G);if(o.p=q,o.q!==null)return H(G,o.q);D(o.qBits,H)})}function D(G,q){t.prime.generateProbablePrime(G,P,q)}function H(G,q){if(G)return w(G);if(o.q=q,o.p.compareTo(o.q)<0){var j=o.p;o.p=o.q,o.q=j}if(o.p.subtract(e.ONE).gcd(o.e).compareTo(e.ONE)!==0){o.p=null,K();return}if(o.q.subtract(e.ONE).gcd(o.e).compareTo(e.ONE)!==0){o.q=null,D(o.qBits,H);return}if(o.p1=o.p.subtract(e.ONE),o.q1=o.q.subtract(e.ONE),o.phi=o.p1.multiply(o.q1),o.phi.gcd(o.e).compareTo(e.ONE)!==0){o.p=o.q=null,K();return}if(o.n=o.p.multiply(o.q),o.n.bitLength()!==o.bits){o.q=null,D(o.qBits,H);return}var Y=o.e.modInverse(o.phi);o.keys={privateKey:d.rsa.setPrivateKey(o.n,o.e,Y,o.p,o.q,Y.mod(o.p1),Y.mod(o.q1),o.q.modInverse(o.p)),publicKey:d.rsa.setPublicKey(o.n,o.e)},w(null,o.keys)}}function s(o){var a=o.toString(16);a[0]>="8"&&(a="00"+a);var w=t.util.hexToBytes(a);return w.length>1&&(w.charCodeAt(0)===0&&!(w.charCodeAt(1)&128)||w.charCodeAt(0)===255&&(w.charCodeAt(1)&128)===128)?w.substr(1):w}function E(o){return o<=100?27:o<=150?18:o<=200?15:o<=250?12:o<=300?9:o<=350?8:o<=400?7:o<=500?6:o<=600?5:o<=800?4:o<=1250?3:2}function C(o){return t.util.isNodejs&&typeof r[o]=="function"}function _(o){return typeof f.globalScope<"u"&&typeof f.globalScope.crypto=="object"&&typeof f.globalScope.crypto.subtle=="object"&&typeof f.globalScope.crypto.subtle[o]=="function"}function k(o){return typeof f.globalScope<"u"&&typeof f.globalScope.msCrypto=="object"&&typeof f.globalScope.msCrypto.subtle=="object"&&typeof f.globalScope.msCrypto.subtle[o]=="function"}function v(o){for(var a=t.util.hexToBytes(o.toString(16)),w=new Uint8Array(a.length),P=0;P<a.length;++P)w[P]=a.charCodeAt(P);return w}}),is=pe((l,i)=>{var t=fe();Ft(),Tt(),Kr(),wt(),Gt(),An(),tr(),yt(),rs(),Mr(),ve(),typeof e>"u"&&(e=t.jsbn.BigInteger);var e,r=t.asn1,u=t.pki=t.pki||{};i.exports=u.pbe=t.pbe=t.pbe||{};var f=u.oids,d={name:"EncryptedPrivateKeyInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},c={name:"PBES2Algorithms",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},n={name:"pkcs-12PbeParams",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"iterations"}]};u.encryptPrivateKeyInfo=function(A,y,T){T=T||{},T.saltSize=T.saltSize||8,T.count=T.count||2048,T.algorithm=T.algorithm||"aes128",T.prfAlgorithm=T.prfAlgorithm||"sha1";var b=t.random.getBytesSync(T.saltSize),S=T.count,s=r.integerToDer(S),E,C,_;if(T.algorithm.indexOf("aes")===0||T.algorithm==="des"){var k,v,o;switch(T.algorithm){case"aes128":E=16,k=16,v=f["aes128-CBC"],o=t.aes.createEncryptionCipher;break;case"aes192":E=24,k=16,v=f["aes192-CBC"],o=t.aes.createEncryptionCipher;break;case"aes256":E=32,k=16,v=f["aes256-CBC"],o=t.aes.createEncryptionCipher;break;case"des":E=8,k=8,v=f.desCBC,o=t.des.createEncryptionCipher;break;default:var a=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw a.algorithm=T.algorithm,a}var w="hmacWith"+T.prfAlgorithm.toUpperCase(),P=I(w),K=t.pkcs5.pbkdf2(y,b,S,E,P),D=t.random.getBytesSync(k),H=o(K);H.start(D),H.update(r.toDer(A)),H.finish(),_=H.output.getBytes();var G=x(b,s,E,w);C=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(f.pkcs5PBES2).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(f.pkcs5PBKDF2).getBytes()),G]),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(v).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,D)])])])}else if(T.algorithm==="3des"){E=24;var q=new t.util.ByteBuffer(b),K=u.pbe.generatePkcs12Key(y,q,1,S,E),D=u.pbe.generatePkcs12Key(y,q,2,S,E),H=t.des.createEncryptionCipher(K);H.start(D),H.update(r.toDer(A)),H.finish(),_=H.output.getBytes(),C=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(f["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,b),r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,s.getBytes())])])}else{var a=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw a.algorithm=T.algorithm,a}var j=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[C,r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,_)]);return j},u.decryptPrivateKeyInfo=function(A,y){var T=null,b={},S=[];if(!r.validate(A,d,b,S)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=S,s}var E=r.derToOid(b.encryptionOid),C=u.pbe.getCipher(E,b.encryptionParams,y),_=t.util.createBuffer(b.encryptedData);return C.update(_),C.finish()&&(T=r.fromDer(C.output)),T},u.encryptedPrivateKeyToPem=function(A,y){var T={type:"ENCRYPTED PRIVATE KEY",body:r.toDer(A).getBytes()};return t.pem.encode(T,{maxline:y})},u.encryptedPrivateKeyFromPem=function(A){var y=t.pem.decode(A)[0];if(y.type!=="ENCRYPTED PRIVATE KEY"){var T=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw T.headerType=y.type,T}if(y.procType&&y.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return r.fromDer(y.body)},u.encryptRsaPrivateKey=function(A,y,T){if(T=T||{},!T.legacy){var b=u.wrapRsaPrivateKey(u.privateKeyToAsn1(A));return b=u.encryptPrivateKeyInfo(b,y,T),u.encryptedPrivateKeyToPem(b)}var S,s,E,C;switch(T.algorithm){case"aes128":S="AES-128-CBC",E=16,s=t.random.getBytesSync(16),C=t.aes.createEncryptionCipher;break;case"aes192":S="AES-192-CBC",E=24,s=t.random.getBytesSync(16),C=t.aes.createEncryptionCipher;break;case"aes256":S="AES-256-CBC",E=32,s=t.random.getBytesSync(16),C=t.aes.createEncryptionCipher;break;case"3des":S="DES-EDE3-CBC",E=24,s=t.random.getBytesSync(8),C=t.des.createEncryptionCipher;break;case"des":S="DES-CBC",E=8,s=t.random.getBytesSync(8),C=t.des.createEncryptionCipher;break;default:var _=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+T.algorithm+'".');throw _.algorithm=T.algorithm,_}var k=t.pbe.opensslDeriveBytes(y,s.substr(0,8),E),v=C(k);v.start(s),v.update(r.toDer(u.privateKeyToAsn1(A))),v.finish();var o={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:S,parameters:t.util.bytesToHex(s).toUpperCase()},body:v.output.getBytes()};return t.pem.encode(o)},u.decryptRsaPrivateKey=function(A,y){var T=null,b=t.pem.decode(A)[0];if(b.type!=="ENCRYPTED PRIVATE KEY"&&b.type!=="PRIVATE KEY"&&b.type!=="RSA PRIVATE KEY"){var S=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw S.headerType=S,S}if(b.procType&&b.procType.type==="ENCRYPTED"){var s,E;switch(b.dekInfo.algorithm){case"DES-CBC":s=8,E=t.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,E=t.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,E=t.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,E=t.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,E=t.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,E=function(o){return t.rc2.createDecryptionCipher(o,40)};break;case"RC2-64-CBC":s=8,E=function(o){return t.rc2.createDecryptionCipher(o,64)};break;case"RC2-128-CBC":s=16,E=function(o){return t.rc2.createDecryptionCipher(o,128)};break;default:var S=new Error('Could not decrypt private key; unsupported encryption algorithm "'+b.dekInfo.algorithm+'".');throw S.algorithm=b.dekInfo.algorithm,S}var C=t.util.hexToBytes(b.dekInfo.parameters),_=t.pbe.opensslDeriveBytes(y,C.substr(0,8),s),k=E(_);if(k.start(C),k.update(t.util.createBuffer(b.body)),k.finish())T=k.output.getBytes();else return T}else T=b.body;return b.type==="ENCRYPTED PRIVATE KEY"?T=u.decryptPrivateKeyInfo(r.fromDer(T),y):T=r.fromDer(T),T!==null&&(T=u.privateKeyFromAsn1(T)),T},u.pbe.generatePkcs12Key=function(A,y,T,b,S,s){var E,C;if(typeof s>"u"||s===null){if(!("sha1"in t.md))throw new Error('"sha1" hash algorithm unavailable.');s=t.md.sha1.create()}var _=s.digestLength,k=s.blockLength,v=new t.util.ByteBuffer,o=new t.util.ByteBuffer;if(A!=null){for(C=0;C<A.length;C++)o.putInt16(A.charCodeAt(C));o.putInt16(0)}var a=o.length(),w=y.length(),P=new t.util.ByteBuffer;P.fillWithByte(T,k);var K=k*Math.ceil(w/k),D=new t.util.ByteBuffer;for(C=0;C<K;C++)D.putByte(y.at(C%w));var H=k*Math.ceil(a/k),G=new t.util.ByteBuffer;for(C=0;C<H;C++)G.putByte(o.at(C%a));var q=D;q.putBuffer(G);for(var j=Math.ceil(S/_),Y=1;Y<=j;Y++){var J=new t.util.ByteBuffer;J.putBytes(P.bytes()),J.putBytes(q.bytes());for(var ee=0;ee<b;ee++)s.start(),s.update(J.getBytes()),J=s.digest();var ie=new t.util.ByteBuffer;for(C=0;C<k;C++)ie.putByte(J.at(C%_));var le=Math.ceil(w/k)+Math.ceil(a/k),ge=new t.util.ByteBuffer;for(E=0;E<le;E++){var Se=new t.util.ByteBuffer(q.getBytes(k)),$=511;for(C=ie.length()-1;C>=0;C--)$=$>>8,$+=ie.at(C)+Se.at(C),Se.setAt(C,$&255);ge.putBuffer(Se)}q=ge,v.putBuffer(J)}return v.truncate(v.length()-S),v},u.pbe.getCipher=function(A,y,T){switch(A){case u.oids.pkcs5PBES2:return u.pbe.getCipherForPBES2(A,y,T);case u.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case u.oids["pbewithSHAAnd40BitRC2-CBC"]:return u.pbe.getCipherForPKCS12PBE(A,y,T);default:var b=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw b.oid=A,b.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],b}},u.pbe.getCipherForPBES2=function(A,y,T){var b={},S=[];if(!r.validate(y,c,b,S)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=S,s}if(A=r.derToOid(b.kdfOid),A!==u.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=A,s.supportedOids=["pkcs5PBKDF2"],s}if(A=r.derToOid(b.encOid),A!==u.oids["aes128-CBC"]&&A!==u.oids["aes192-CBC"]&&A!==u.oids["aes256-CBC"]&&A!==u.oids["des-EDE3-CBC"]&&A!==u.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=A,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var E=b.kdfSalt,C=t.util.createBuffer(b.kdfIterationCount);C=C.getInt(C.length()<<3);var _,k;switch(u.oids[A]){case"aes128-CBC":_=16,k=t.aes.createDecryptionCipher;break;case"aes192-CBC":_=24,k=t.aes.createDecryptionCipher;break;case"aes256-CBC":_=32,k=t.aes.createDecryptionCipher;break;case"des-EDE3-CBC":_=24,k=t.des.createDecryptionCipher;break;case"desCBC":_=8,k=t.des.createDecryptionCipher;break}var v=h(b.prfOid),o=t.pkcs5.pbkdf2(T,E,C,_,v),a=b.encIv,w=k(o);return w.start(a),w},u.pbe.getCipherForPKCS12PBE=function(A,y,T){var b={},S=[];if(!r.validate(y,n,b,S)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=S,s}var E=t.util.createBuffer(b.salt),C=t.util.createBuffer(b.iterations);C=C.getInt(C.length()<<3);var _,k,v;switch(A){case u.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:_=24,k=8,v=t.des.startDecrypting;break;case u.oids["pbewithSHAAnd40BitRC2-CBC"]:_=5,k=8,v=function(K,D){var H=t.rc2.createDecryptionCipher(K,40);return H.start(D,null),H};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=A,s}var o=h(b.prfOid),a=u.pbe.generatePkcs12Key(T,E,1,C,_,o);o.start();var w=u.pbe.generatePkcs12Key(T,E,2,C,k,o);return v(a,w)},u.pbe.opensslDeriveBytes=function(A,y,T,b){if(typeof b>"u"||b===null){if(!("md5"in t.md))throw new Error('"md5" hash algorithm unavailable.');b=t.md.md5.create()}y===null&&(y="");for(var S=[m(b,A+y)],s=16,E=1;s<T;++E,s+=16)S.push(m(b,S[E-1]+A+y));return S.join("").substr(0,T)};function m(A,y){return A.start().update(y).digest().getBytes()}function h(A){var y;if(!A)y="hmacWithSHA1";else if(y=u.oids[r.derToOid(A)],!y){var T=new Error("Unsupported PRF OID.");throw T.oid=A,T.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],T}return I(y)}function I(A){var y=t.md;switch(A){case"hmacWithSHA224":y=t.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":A=A.substr(8).toLowerCase();break;default:var T=new Error("Unsupported PRF algorithm.");throw T.algorithm=A,T.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],T}if(!y||!(A in y))throw new Error("Unknown hash algorithm: "+A);return y[A].create()}function x(A,y,T,b){var S=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,A),r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,y.getBytes())]);return b!=="hmacWithSHA1"&&S.value.push(r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,t.util.hexToBytes(T.toString(16))),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(u.oids[b]).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.NULL,!1,"")])),S}}),ss=pe((l,i)=>{var t=fe();Tt(),ve();var e=t.asn1,r=i.exports=t.pkcs7asn1=t.pkcs7asn1||{};t.pkcs7=t.pkcs7||{},t.pkcs7.asn1=r;var u={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};r.contentInfoValidator=u;var f={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};r.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(f)},r.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(f)};var d={name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};r.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},u,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[d]}]},r.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}}),os=pe((l,i)=>{var t=fe();ve(),t.mgf=t.mgf||{};var e=i.exports=t.mgf.mgf1=t.mgf1=t.mgf1||{};e.create=function(r){var u={generate:function(f,d){for(var c=new t.util.ByteBuffer,n=Math.ceil(d/r.digestLength),m=0;m<n;m++){var h=new t.util.ByteBuffer;h.putInt32(m),r.start(),r.update(f+h.getBytes()),c.putBuffer(r.digest())}return c.truncate(c.length()-d),c.getBytes()}};return u}}),oc=pe((l,i)=>{var t=fe();os(),i.exports=t.mgf=t.mgf||{},t.mgf.mgf1=t.mgf1}),In=pe((l,i)=>{var t=fe();yt(),ve();var e=i.exports=t.pss=t.pss||{};e.create=function(r){arguments.length===3&&(r={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var u=r.md,f=r.mgf,d=u.digestLength,c=r.salt||null;typeof c=="string"&&(c=t.util.createBuffer(c));var n;if("saltLength"in r)n=r.saltLength;else if(c!==null)n=c.length();else throw new Error("Salt length not specified or specific salt not given.");if(c!==null&&c.length()!==n)throw new Error("Given salt length does not match length of given salt.");var m=r.prng||t.random,h={};return h.encode=function(I,x){var A,y=x-1,T=Math.ceil(y/8),b=I.digest().getBytes();if(T<d+n+2)throw new Error("Message is too long to encrypt.");var S;c===null?S=m.getBytesSync(n):S=c.bytes();var s=new t.util.ByteBuffer;s.fillWithByte(0,8),s.putBytes(b),s.putBytes(S),u.start(),u.update(s.getBytes());var E=u.digest().getBytes(),C=new t.util.ByteBuffer;C.fillWithByte(0,T-n-d-2),C.putByte(1),C.putBytes(S);var _=C.getBytes(),k=T-d-1,v=f.generate(E,k),o="";for(A=0;A<k;A++)o+=String.fromCharCode(_.charCodeAt(A)^v.charCodeAt(A));var a=65280>>8*T-y&255;return o=String.fromCharCode(o.charCodeAt(0)&~a)+o.substr(1),o+E+"\xBC"},h.verify=function(I,x,A){var y,T=A-1,b=Math.ceil(T/8);if(x=x.substr(-b),b<d+n+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(x.charCodeAt(b-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var S=b-d-1,s=x.substr(0,S),E=x.substr(S,d),C=65280>>8*b-T&255;if(s.charCodeAt(0)&C)throw new Error("Bits beyond keysize not zero as expected.");var _=f.generate(E,S),k="";for(y=0;y<S;y++)k+=String.fromCharCode(s.charCodeAt(y)^_.charCodeAt(y));k=String.fromCharCode(k.charCodeAt(0)&~C)+k.substr(1);var v=b-d-n-2;for(y=0;y<v;y++)if(k.charCodeAt(y)!==0)throw new Error("Leftmost octets not zero as expected");if(k.charCodeAt(v)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var o=k.substr(-n),a=new t.util.ByteBuffer;a.fillWithByte(0,8),a.putBytes(I),a.putBytes(o),u.start(),u.update(a.getBytes());var w=u.digest().getBytes();return E===w},h}}),Bn=pe((l,i)=>{var t=fe();Ft(),Tt(),Kr(),wt(),oc(),Gt(),tr(),In(),Mr(),ve();var e=t.asn1,r=i.exports=t.pki=t.pki||{},u=r.oids,f={};f.CN=u.commonName,f.commonName="CN",f.C=u.countryName,f.countryName="C",f.L=u.localityName,f.localityName="L",f.ST=u.stateOrProvinceName,f.stateOrProvinceName="ST",f.O=u.organizationName,f.organizationName="O",f.OU=u.organizationalUnitName,f.organizationalUnitName="OU",f.E=u.emailAddress,f.emailAddress="E";var d=t.pki.rsa.publicKeyValidator,c={name:"Certificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},d,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},n={name:"rsapss",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},m={name:"CertificationRequestInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},d,{name:"CertificationRequestInfo.attributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0}]}]}]},h={name:"CertificationRequest",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[m,{name:"CertificationRequest.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};r.RDNAttributesAsArray=function(v,o){for(var a=[],w,P,K,D=0;D<v.value.length;++D){w=v.value[D];for(var H=0;H<w.value.length;++H)K={},P=w.value[H],K.type=e.derToOid(P.value[0].value),K.value=P.value[1].value,K.valueTagClass=P.value[1].type,K.type in u&&(K.name=u[K.type],K.name in f&&(K.shortName=f[K.name])),o&&(o.update(K.type),o.update(K.value)),a.push(K)}return a},r.CRIAttributesAsArray=function(v){for(var o=[],a=0;a<v.length;++a)for(var w=v[a],P=e.derToOid(w.value[0].value),K=w.value[1].value,D=0;D<K.length;++D){var H={};if(H.type=P,H.value=K[D].value,H.valueTagClass=K[D].type,H.type in u&&(H.name=u[H.type],H.name in f&&(H.shortName=f[H.name])),H.type===u.extensionRequest){H.extensions=[];for(var G=0;G<H.value.length;++G)H.extensions.push(r.certificateExtensionFromAsn1(H.value[G]))}o.push(H)}return o};function I(v,o){typeof o=="string"&&(o={shortName:o});for(var a=null,w,P=0;a===null&&P<v.attributes.length;++P)w=v.attributes[P],(o.type&&o.type===w.type||o.name&&o.name===w.name||o.shortName&&o.shortName===w.shortName)&&(a=w);return a}var x=function(v,o,a){var w={};if(v!==u["RSASSA-PSS"])return w;a&&(w={hash:{algorithmOid:u.sha1},mgf:{algorithmOid:u.mgf1,hash:{algorithmOid:u.sha1}},saltLength:20});var P={},K=[];if(!e.validate(o,n,P,K)){var D=new Error("Cannot read RSASSA-PSS parameter block.");throw D.errors=K,D}return P.hashOid!==void 0&&(w.hash=w.hash||{},w.hash.algorithmOid=e.derToOid(P.hashOid)),P.maskGenOid!==void 0&&(w.mgf=w.mgf||{},w.mgf.algorithmOid=e.derToOid(P.maskGenOid),w.mgf.hash=w.mgf.hash||{},w.mgf.hash.algorithmOid=e.derToOid(P.maskGenHashOid)),P.saltLength!==void 0&&(w.saltLength=P.saltLength.charCodeAt(0)),w},A=function(v){switch(u[v.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return t.md.sha1.create();case"md5WithRSAEncryption":return t.md.md5.create();case"sha256WithRSAEncryption":return t.md.sha256.create();case"sha384WithRSAEncryption":return t.md.sha384.create();case"sha512WithRSAEncryption":return t.md.sha512.create();case"RSASSA-PSS":return t.md.sha256.create();default:var o=new Error("Could not compute "+v.type+" digest. Unknown signature OID.");throw o.signatureOid=v.signatureOid,o}},y=function(v){var o=v.certificate,a;switch(o.signatureOid){case u.sha1WithRSAEncryption:case u.sha1WithRSASignature:break;case u["RSASSA-PSS"]:var w,P;if(w=u[o.signatureParameters.mgf.hash.algorithmOid],w===void 0||t.md[w]===void 0){var K=new Error("Unsupported MGF hash function.");throw K.oid=o.signatureParameters.mgf.hash.algorithmOid,K.name=w,K}if(P=u[o.signatureParameters.mgf.algorithmOid],P===void 0||t.mgf[P]===void 0){var K=new Error("Unsupported MGF function.");throw K.oid=o.signatureParameters.mgf.algorithmOid,K.name=P,K}if(P=t.mgf[P].create(t.md[w].create()),w=u[o.signatureParameters.hash.algorithmOid],w===void 0||t.md[w]===void 0){var K=new Error("Unsupported RSASSA-PSS hash function.");throw K.oid=o.signatureParameters.hash.algorithmOid,K.name=w,K}a=t.pss.create(t.md[w].create(),P,o.signatureParameters.saltLength);break}return o.publicKey.verify(v.md.digest().getBytes(),v.signature,a)};r.certificateFromPem=function(v,o,a){var w=t.pem.decode(v)[0];if(w.type!=="CERTIFICATE"&&w.type!=="X509 CERTIFICATE"&&w.type!=="TRUSTED CERTIFICATE"){var P=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw P.headerType=w.type,P}if(w.procType&&w.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var K=e.fromDer(w.body,a);return r.certificateFromAsn1(K,o)},r.certificateToPem=function(v,o){var a={type:"CERTIFICATE",body:e.toDer(r.certificateToAsn1(v)).getBytes()};return t.pem.encode(a,{maxline:o})},r.publicKeyFromPem=function(v){var o=t.pem.decode(v)[0];if(o.type!=="PUBLIC KEY"&&o.type!=="RSA PUBLIC KEY"){var a=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw a.headerType=o.type,a}if(o.procType&&o.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var w=e.fromDer(o.body);return r.publicKeyFromAsn1(w)},r.publicKeyToPem=function(v,o){var a={type:"PUBLIC KEY",body:e.toDer(r.publicKeyToAsn1(v)).getBytes()};return t.pem.encode(a,{maxline:o})},r.publicKeyToRSAPublicKeyPem=function(v,o){var a={type:"RSA PUBLIC KEY",body:e.toDer(r.publicKeyToRSAPublicKey(v)).getBytes()};return t.pem.encode(a,{maxline:o})},r.getPublicKeyFingerprint=function(v,o){o=o||{};var a=o.md||t.md.sha1.create(),w=o.type||"RSAPublicKey",P;switch(w){case"RSAPublicKey":P=e.toDer(r.publicKeyToRSAPublicKey(v)).getBytes();break;case"SubjectPublicKeyInfo":P=e.toDer(r.publicKeyToAsn1(v)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+o.type+'".')}a.start(),a.update(P);var K=a.digest();if(o.encoding==="hex"){var D=K.toHex();return o.delimiter?D.match(/.{2}/g).join(o.delimiter):D}else{if(o.encoding==="binary")return K.getBytes();if(o.encoding)throw new Error('Unknown encoding "'+o.encoding+'".')}return K},r.certificationRequestFromPem=function(v,o,a){var w=t.pem.decode(v)[0];if(w.type!=="CERTIFICATE REQUEST"){var P=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw P.headerType=w.type,P}if(w.procType&&w.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var K=e.fromDer(w.body,a);return r.certificationRequestFromAsn1(K,o)},r.certificationRequestToPem=function(v,o){var a={type:"CERTIFICATE REQUEST",body:e.toDer(r.certificationRequestToAsn1(v)).getBytes()};return t.pem.encode(a,{maxline:o})},r.createCertificate=function(){var v={};return v.version=2,v.serialNumber="00",v.signatureOid=null,v.signature=null,v.siginfo={},v.siginfo.algorithmOid=null,v.validity={},v.validity.notBefore=new Date,v.validity.notAfter=new Date,v.issuer={},v.issuer.getField=function(o){return I(v.issuer,o)},v.issuer.addField=function(o){b([o]),v.issuer.attributes.push(o)},v.issuer.attributes=[],v.issuer.hash=null,v.subject={},v.subject.getField=function(o){return I(v.subject,o)},v.subject.addField=function(o){b([o]),v.subject.attributes.push(o)},v.subject.attributes=[],v.subject.hash=null,v.extensions=[],v.publicKey=null,v.md=null,v.setSubject=function(o,a){b(o),v.subject.attributes=o,delete v.subject.uniqueId,a&&(v.subject.uniqueId=a),v.subject.hash=null},v.setIssuer=function(o,a){b(o),v.issuer.attributes=o,delete v.issuer.uniqueId,a&&(v.issuer.uniqueId=a),v.issuer.hash=null},v.setExtensions=function(o){for(var a=0;a<o.length;++a)S(o[a],{cert:v});v.extensions=o},v.getExtension=function(o){typeof o=="string"&&(o={name:o});for(var a=null,w,P=0;a===null&&P<v.extensions.length;++P)w=v.extensions[P],(o.id&&w.id===o.id||o.name&&w.name===o.name)&&(a=w);return a},v.sign=function(o,a){v.md=a||t.md.sha1.create();var w=u[v.md.algorithm+"WithRSAEncryption"];if(!w){var P=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw P.algorithm=v.md.algorithm,P}v.signatureOid=v.siginfo.algorithmOid=w,v.tbsCertificate=r.getTBSCertificate(v);var K=e.toDer(v.tbsCertificate);v.md.update(K.getBytes()),v.signature=o.sign(v.md)},v.verify=function(o){var a=!1;if(!v.issued(o)){var w=o.issuer,P=v.subject,K=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw K.expectedIssuer=P.attributes,K.actualIssuer=w.attributes,K}var D=o.md;if(D===null){D=A({signatureOid:o.signatureOid,type:"certificate"});var H=o.tbsCertificate||r.getTBSCertificate(o),G=e.toDer(H);D.update(G.getBytes())}return D!==null&&(a=y({certificate:v,md:D,signature:o.signature})),a},v.isIssuer=function(o){var a=!1,w=v.issuer,P=o.subject;if(w.hash&&P.hash)a=w.hash===P.hash;else if(w.attributes.length===P.attributes.length){a=!0;for(var K,D,H=0;a&&H<w.attributes.length;++H)K=w.attributes[H],D=P.attributes[H],(K.type!==D.type||K.value!==D.value)&&(a=!1)}return a},v.issued=function(o){return o.isIssuer(v)},v.generateSubjectKeyIdentifier=function(){return r.getPublicKeyFingerprint(v.publicKey,{type:"RSAPublicKey"})},v.verifySubjectKeyIdentifier=function(){for(var o=u.subjectKeyIdentifier,a=0;a<v.extensions.length;++a){var w=v.extensions[a];if(w.id===o){var P=v.generateSubjectKeyIdentifier().getBytes();return t.util.hexToBytes(w.subjectKeyIdentifier)===P}}return!1},v},r.certificateFromAsn1=function(v,o){var a={},w=[];if(!e.validate(v,c,a,w)){var P=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw P.errors=w,P}var K=e.derToOid(a.publicKeyOid);if(K!==r.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var D=r.createCertificate();D.version=a.certVersion?a.certVersion.charCodeAt(0):0;var H=t.util.createBuffer(a.certSerialNumber);D.serialNumber=H.toHex(),D.signatureOid=t.asn1.derToOid(a.certSignatureOid),D.signatureParameters=x(D.signatureOid,a.certSignatureParams,!0),D.siginfo.algorithmOid=t.asn1.derToOid(a.certinfoSignatureOid),D.siginfo.parameters=x(D.siginfo.algorithmOid,a.certinfoSignatureParams,!1),D.signature=a.certSignature;var G=[];if(a.certValidity1UTCTime!==void 0&&G.push(e.utcTimeToDate(a.certValidity1UTCTime)),a.certValidity2GeneralizedTime!==void 0&&G.push(e.generalizedTimeToDate(a.certValidity2GeneralizedTime)),a.certValidity3UTCTime!==void 0&&G.push(e.utcTimeToDate(a.certValidity3UTCTime)),a.certValidity4GeneralizedTime!==void 0&&G.push(e.generalizedTimeToDate(a.certValidity4GeneralizedTime)),G.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(G.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(D.validity.notBefore=G[0],D.validity.notAfter=G[1],D.tbsCertificate=a.tbsCertificate,o){D.md=A({signatureOid:D.signatureOid,type:"certificate"});var q=e.toDer(D.tbsCertificate);D.md.update(q.getBytes())}var j=t.md.sha1.create(),Y=e.toDer(a.certIssuer);j.update(Y.getBytes()),D.issuer.getField=function(ie){return I(D.issuer,ie)},D.issuer.addField=function(ie){b([ie]),D.issuer.attributes.push(ie)},D.issuer.attributes=r.RDNAttributesAsArray(a.certIssuer),a.certIssuerUniqueId&&(D.issuer.uniqueId=a.certIssuerUniqueId),D.issuer.hash=j.digest().toHex();var J=t.md.sha1.create(),ee=e.toDer(a.certSubject);return J.update(ee.getBytes()),D.subject.getField=function(ie){return I(D.subject,ie)},D.subject.addField=function(ie){b([ie]),D.subject.attributes.push(ie)},D.subject.attributes=r.RDNAttributesAsArray(a.certSubject),a.certSubjectUniqueId&&(D.subject.uniqueId=a.certSubjectUniqueId),D.subject.hash=J.digest().toHex(),a.certExtensions?D.extensions=r.certificateExtensionsFromAsn1(a.certExtensions):D.extensions=[],D.publicKey=r.publicKeyFromAsn1(a.subjectPublicKeyInfo),D},r.certificateExtensionsFromAsn1=function(v){for(var o=[],a=0;a<v.value.length;++a)for(var w=v.value[a],P=0;P<w.value.length;++P)o.push(r.certificateExtensionFromAsn1(w.value[P]));return o},r.certificateExtensionFromAsn1=function(v){var o={};if(o.id=e.derToOid(v.value[0].value),o.critical=!1,v.value[1].type===e.Type.BOOLEAN?(o.critical=v.value[1].value.charCodeAt(0)!==0,o.value=v.value[2].value):o.value=v.value[1].value,o.id in u){if(o.name=u[o.id],o.name==="keyUsage"){var a=e.fromDer(o.value),w=0,P=0;a.value.length>1&&(w=a.value.charCodeAt(1),P=a.value.length>2?a.value.charCodeAt(2):0),o.digitalSignature=(w&128)===128,o.nonRepudiation=(w&64)===64,o.keyEncipherment=(w&32)===32,o.dataEncipherment=(w&16)===16,o.keyAgreement=(w&8)===8,o.keyCertSign=(w&4)===4,o.cRLSign=(w&2)===2,o.encipherOnly=(w&1)===1,o.decipherOnly=(P&128)===128}else if(o.name==="basicConstraints"){var a=e.fromDer(o.value);a.value.length>0&&a.value[0].type===e.Type.BOOLEAN?o.cA=a.value[0].value.charCodeAt(0)!==0:o.cA=!1;var K=null;a.value.length>0&&a.value[0].type===e.Type.INTEGER?K=a.value[0].value:a.value.length>1&&(K=a.value[1].value),K!==null&&(o.pathLenConstraint=e.derToInteger(K))}else if(o.name==="extKeyUsage")for(var a=e.fromDer(o.value),D=0;D<a.value.length;++D){var H=e.derToOid(a.value[D].value);H in u?o[u[H]]=!0:o[H]=!0}else if(o.name==="nsCertType"){var a=e.fromDer(o.value),w=0;a.value.length>1&&(w=a.value.charCodeAt(1)),o.client=(w&128)===128,o.server=(w&64)===64,o.email=(w&32)===32,o.objsign=(w&16)===16,o.reserved=(w&8)===8,o.sslCA=(w&4)===4,o.emailCA=(w&2)===2,o.objCA=(w&1)===1}else if(o.name==="subjectAltName"||o.name==="issuerAltName"){o.altNames=[];for(var G,a=e.fromDer(o.value),q=0;q<a.value.length;++q){G=a.value[q];var j={type:G.type,value:G.value};switch(o.altNames.push(j),G.type){case 1:case 2:case 6:break;case 7:j.ip=t.util.bytesToIP(G.value);break;case 8:j.oid=e.derToOid(G.value);break;default:}}}else if(o.name==="subjectKeyIdentifier"){var a=e.fromDer(o.value);o.subjectKeyIdentifier=t.util.bytesToHex(a.value)}}return o},r.certificationRequestFromAsn1=function(v,o){var a={},w=[];if(!e.validate(v,h,a,w)){var P=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw P.errors=w,P}var K=e.derToOid(a.publicKeyOid);if(K!==r.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var D=r.createCertificationRequest();if(D.version=a.csrVersion?a.csrVersion.charCodeAt(0):0,D.signatureOid=t.asn1.derToOid(a.csrSignatureOid),D.signatureParameters=x(D.signatureOid,a.csrSignatureParams,!0),D.siginfo.algorithmOid=t.asn1.derToOid(a.csrSignatureOid),D.siginfo.parameters=x(D.siginfo.algorithmOid,a.csrSignatureParams,!1),D.signature=a.csrSignature,D.certificationRequestInfo=a.certificationRequestInfo,o){D.md=A({signatureOid:D.signatureOid,type:"certification request"});var H=e.toDer(D.certificationRequestInfo);D.md.update(H.getBytes())}var G=t.md.sha1.create();return D.subject.getField=function(q){return I(D.subject,q)},D.subject.addField=function(q){b([q]),D.subject.attributes.push(q)},D.subject.attributes=r.RDNAttributesAsArray(a.certificationRequestInfoSubject,G),D.subject.hash=G.digest().toHex(),D.publicKey=r.publicKeyFromAsn1(a.subjectPublicKeyInfo),D.getAttribute=function(q){return I(D,q)},D.addAttribute=function(q){b([q]),D.attributes.push(q)},D.attributes=r.CRIAttributesAsArray(a.certificationRequestInfoAttributes||[]),D},r.createCertificationRequest=function(){var v={};return v.version=0,v.signatureOid=null,v.signature=null,v.siginfo={},v.siginfo.algorithmOid=null,v.subject={},v.subject.getField=function(o){return I(v.subject,o)},v.subject.addField=function(o){b([o]),v.subject.attributes.push(o)},v.subject.attributes=[],v.subject.hash=null,v.publicKey=null,v.attributes=[],v.getAttribute=function(o){return I(v,o)},v.addAttribute=function(o){b([o]),v.attributes.push(o)},v.md=null,v.setSubject=function(o){b(o),v.subject.attributes=o,v.subject.hash=null},v.setAttributes=function(o){b(o),v.attributes=o},v.sign=function(o,a){v.md=a||t.md.sha1.create();var w=u[v.md.algorithm+"WithRSAEncryption"];if(!w){var P=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw P.algorithm=v.md.algorithm,P}v.signatureOid=v.siginfo.algorithmOid=w,v.certificationRequestInfo=r.getCertificationRequestInfo(v);var K=e.toDer(v.certificationRequestInfo);v.md.update(K.getBytes()),v.signature=o.sign(v.md)},v.verify=function(){var o=!1,a=v.md;if(a===null){a=A({signatureOid:v.signatureOid,type:"certification request"});var w=v.certificationRequestInfo||r.getCertificationRequestInfo(v),P=e.toDer(w);a.update(P.getBytes())}return a!==null&&(o=y({certificate:v,md:a,signature:v.signature})),o},v};function T(v){for(var o=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),a,w,P=v.attributes,K=0;K<P.length;++K){a=P[K];var D=a.value,H=e.Type.PRINTABLESTRING;"valueTagClass"in a&&(H=a.valueTagClass,H===e.Type.UTF8&&(D=t.util.encodeUtf8(D))),w=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.type).getBytes()),e.create(e.Class.UNIVERSAL,H,!1,D)])]),o.value.push(w)}return o}function b(v){for(var o,a=0;a<v.length;++a){if(o=v[a],typeof o.name>"u"&&(o.type&&o.type in r.oids?o.name=r.oids[o.type]:o.shortName&&o.shortName in f&&(o.name=r.oids[f[o.shortName]])),typeof o.type>"u")if(o.name&&o.name in r.oids)o.type=r.oids[o.name];else{var w=new Error("Attribute type not specified.");throw w.attribute=o,w}if(typeof o.shortName>"u"&&o.name&&o.name in f&&(o.shortName=f[o.name]),o.type===u.extensionRequest&&(o.valueConstructed=!0,o.valueTagClass=e.Type.SEQUENCE,!o.value&&o.extensions)){o.value=[];for(var P=0;P<o.extensions.length;++P)o.value.push(r.certificateExtensionToAsn1(S(o.extensions[P])))}if(typeof o.value>"u"){var w=new Error("Attribute value not specified.");throw w.attribute=o,w}}}function S(v,o){if(o=o||{},typeof v.name>"u"&&v.id&&v.id in r.oids&&(v.name=r.oids[v.id]),typeof v.id>"u")if(v.name&&v.name in r.oids)v.id=r.oids[v.name];else{var a=new Error("Extension ID not specified.");throw a.extension=v,a}if(typeof v.value<"u")return v;if(v.name==="keyUsage"){var w=0,P=0,K=0;v.digitalSignature&&(P|=128,w=7),v.nonRepudiation&&(P|=64,w=6),v.keyEncipherment&&(P|=32,w=5),v.dataEncipherment&&(P|=16,w=4),v.keyAgreement&&(P|=8,w=3),v.keyCertSign&&(P|=4,w=2),v.cRLSign&&(P|=2,w=1),v.encipherOnly&&(P|=1,w=0),v.decipherOnly&&(K|=128,w=7);var D=String.fromCharCode(w);K!==0?D+=String.fromCharCode(P)+String.fromCharCode(K):P!==0&&(D+=String.fromCharCode(P)),v.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,D)}else if(v.name==="basicConstraints")v.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),v.cA&&v.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"\xFF")),"pathLenConstraint"in v&&v.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(v.pathLenConstraint).getBytes()));else if(v.name==="extKeyUsage"){v.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var H=v.value.value;for(var G in v)v[G]===!0&&(G in u?H.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u[G]).getBytes())):G.indexOf(".")!==-1&&H.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(G).getBytes())))}else if(v.name==="nsCertType"){var w=0,P=0;v.client&&(P|=128,w=7),v.server&&(P|=64,w=6),v.email&&(P|=32,w=5),v.objsign&&(P|=16,w=4),v.reserved&&(P|=8,w=3),v.sslCA&&(P|=4,w=2),v.emailCA&&(P|=2,w=1),v.objCA&&(P|=1,w=0);var D=String.fromCharCode(w);P!==0&&(D+=String.fromCharCode(P)),v.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,D)}else if(v.name==="subjectAltName"||v.name==="issuerAltName"){v.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var q,j=0;j<v.altNames.length;++j){q=v.altNames[j];var D=q.value;if(q.type===7&&q.ip){if(D=t.util.bytesFromIP(q.ip),D===null){var a=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw a.extension=v,a}}else q.type===8&&(q.oid?D=e.oidToDer(e.oidToDer(q.oid)):D=e.oidToDer(D));v.value.value.push(e.create(e.Class.CONTEXT_SPECIFIC,q.type,!1,D))}}else if(v.name==="nsComment"&&o.cert){if(!/^[\x00-\x7F]*$/.test(v.comment)||v.comment.length<1||v.comment.length>128)throw new Error('Invalid "nsComment" content.');v.value=e.create(e.Class.UNIVERSAL,e.Type.IA5STRING,!1,v.comment)}else if(v.name==="subjectKeyIdentifier"&&o.cert){var Y=o.cert.generateSubjectKeyIdentifier();v.subjectKeyIdentifier=Y.toHex(),v.value=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,Y.getBytes())}else if(v.name==="authorityKeyIdentifier"&&o.cert){v.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var H=v.value.value;if(v.keyIdentifier){var J=v.keyIdentifier===!0?o.cert.generateSubjectKeyIdentifier().getBytes():v.keyIdentifier;H.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!1,J))}if(v.authorityCertIssuer){var ee=[e.create(e.Class.CONTEXT_SPECIFIC,4,!0,[T(v.authorityCertIssuer===!0?o.cert.issuer:v.authorityCertIssuer)])];H.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,ee))}if(v.serialNumber){var ie=t.util.hexToBytes(v.serialNumber===!0?o.cert.serialNumber:v.serialNumber);H.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!1,ie))}}else if(v.name==="cRLDistributionPoints"){v.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var H=v.value.value,le=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),ge=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]),q,j=0;j<v.altNames.length;++j){q=v.altNames[j];var D=q.value;if(q.type===7&&q.ip){if(D=t.util.bytesFromIP(q.ip),D===null){var a=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw a.extension=v,a}}else q.type===8&&(q.oid?D=e.oidToDer(e.oidToDer(q.oid)):D=e.oidToDer(D));ge.value.push(e.create(e.Class.CONTEXT_SPECIFIC,q.type,!1,D))}le.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[ge])),H.push(le)}if(typeof v.value>"u"){var a=new Error("Extension value not specified.");throw a.extension=v,a}return v}function s(v,o){switch(v){case u["RSASSA-PSS"]:var a=[];return o.hash.algorithmOid!==void 0&&a.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])),o.mgf.algorithmOid!==void 0&&a.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.mgf.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.mgf.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])])),o.saltLength!==void 0&&a.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(o.saltLength).getBytes())])),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,a);default:return e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")}}function E(v){var o=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);if(v.attributes.length===0)return o;for(var a=v.attributes,w=0;w<a.length;++w){var P=a[w],K=P.value,D=e.Type.UTF8;"valueTagClass"in P&&(D=P.valueTagClass),D===e.Type.UTF8&&(K=t.util.encodeUtf8(K));var H=!1;"valueConstructed"in P&&(H=P.valueConstructed);var G=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(P.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,D,H,K)])]);o.value.push(G)}return o}var C=new Date("1950-01-01T00:00:00Z"),_=new Date("2050-01-01T00:00:00Z");function k(v){return v>=C&&v<_?e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(v)):e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(v))}r.getTBSCertificate=function(v){var o=k(v.validity.notBefore),a=k(v.validity.notAfter),w=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(v.version).getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(v.serialNumber)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(v.siginfo.algorithmOid).getBytes()),s(v.siginfo.algorithmOid,v.siginfo.parameters)]),T(v.issuer),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[o,a]),T(v.subject),r.publicKeyToAsn1(v.publicKey)]);return v.issuer.uniqueId&&w.value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+v.issuer.uniqueId)])),v.subject.uniqueId&&w.value.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+v.subject.uniqueId)])),v.extensions.length>0&&w.value.push(r.certificateExtensionsToAsn1(v.extensions)),w},r.getCertificationRequestInfo=function(v){var o=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(v.version).getBytes()),T(v.subject),r.publicKeyToAsn1(v.publicKey),E(v)]);return o},r.distinguishedNameToAsn1=function(v){return T(v)},r.certificateToAsn1=function(v){var o=v.tbsCertificate||r.getTBSCertificate(v);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[o,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(v.signatureOid).getBytes()),s(v.signatureOid,v.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+v.signature)])},r.certificateExtensionsToAsn1=function(v){var o=e.create(e.Class.CONTEXT_SPECIFIC,3,!0,[]),a=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);o.value.push(a);for(var w=0;w<v.length;++w)a.value.push(r.certificateExtensionToAsn1(v[w]));return o},r.certificateExtensionToAsn1=function(v){var o=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);o.value.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(v.id).getBytes())),v.critical&&o.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"\xFF"));var a=v.value;return typeof v.value!="string"&&(a=e.toDer(a).getBytes()),o.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,a)),o},r.certificationRequestToAsn1=function(v){var o=v.certificationRequestInfo||r.getCertificationRequestInfo(v);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[o,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(v.signatureOid).getBytes()),s(v.signatureOid,v.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+v.signature)])},r.createCaStore=function(v){var o={certs:{}};o.getIssuer=function(D){var H=a(D.issuer);return H},o.addCertificate=function(D){if(typeof D=="string"&&(D=t.pki.certificateFromPem(D)),w(D.subject),!o.hasCertificate(D))if(D.subject.hash in o.certs){var H=o.certs[D.subject.hash];t.util.isArray(H)||(H=[H]),H.push(D),o.certs[D.subject.hash]=H}else o.certs[D.subject.hash]=D},o.hasCertificate=function(D){typeof D=="string"&&(D=t.pki.certificateFromPem(D));var H=a(D.subject);if(!H)return!1;t.util.isArray(H)||(H=[H]);for(var G=e.toDer(r.certificateToAsn1(D)).getBytes(),q=0;q<H.length;++q){var j=e.toDer(r.certificateToAsn1(H[q])).getBytes();if(G===j)return!0}return!1},o.listAllCertificates=function(){var D=[];for(var H in o.certs)if(o.certs.hasOwnProperty(H)){var G=o.certs[H];if(!t.util.isArray(G))D.push(G);else for(var q=0;q<G.length;++q)D.push(G[q])}return D},o.removeCertificate=function(D){var H;if(typeof D=="string"&&(D=t.pki.certificateFromPem(D)),w(D.subject),!o.hasCertificate(D))return null;var G=a(D.subject);if(!t.util.isArray(G))return H=o.certs[D.subject.hash],delete o.certs[D.subject.hash],H;for(var q=e.toDer(r.certificateToAsn1(D)).getBytes(),j=0;j<G.length;++j){var Y=e.toDer(r.certificateToAsn1(G[j])).getBytes();q===Y&&(H=G[j],G.splice(j,1))}return G.length===0&&delete o.certs[D.subject.hash],H};function a(D){return w(D),o.certs[D.hash]||null}function w(D){if(!D.hash){var H=t.md.sha1.create();D.attributes=r.RDNAttributesAsArray(T(D),H),D.hash=H.digest().toHex()}}if(v)for(var P=0;P<v.length;++P){var K=v[P];o.addCertificate(K)}return o},r.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},r.verifyCertificateChain=function(v,o,a){typeof a=="function"&&(a={verify:a}),a=a||{},o=o.slice(0);var w=o.slice(0),P=a.validityCheckDate;typeof P>"u"&&(P=new Date);var K=!0,D=null,H=0;do{var G=o.shift(),q=null,j=!1;if(P&&(P<G.validity.notBefore||P>G.validity.notAfter)&&(D={message:"Certificate is not valid yet or has expired.",error:r.certificateError.certificate_expired,notBefore:G.validity.notBefore,notAfter:G.validity.notAfter,now:P}),D===null){if(q=o[0]||v.getIssuer(G),q===null&&G.isIssuer(G)&&(j=!0,q=G),q){var Y=q;t.util.isArray(Y)||(Y=[Y]);for(var J=!1;!J&&Y.length>0;){q=Y.shift();try{J=q.verify(G)}catch{}}J||(D={message:"Certificate signature is invalid.",error:r.certificateError.bad_certificate})}D===null&&(!q||j)&&!v.hasCertificate(G)&&(D={message:"Certificate is not trusted.",error:r.certificateError.unknown_ca})}if(D===null&&q&&!G.isIssuer(q)&&(D={message:"Certificate issuer is invalid.",error:r.certificateError.bad_certificate}),D===null)for(var ee={keyUsage:!0,basicConstraints:!0},ie=0;D===null&&ie<G.extensions.length;++ie){var le=G.extensions[ie];le.critical&&!(le.name in ee)&&(D={message:"Certificate has an unsupported critical extension.",error:r.certificateError.unsupported_certificate})}if(D===null&&(!K||o.length===0&&(!q||j))){var ge=G.getExtension("basicConstraints"),Se=G.getExtension("keyUsage");if(Se!==null&&(!Se.keyCertSign||ge===null)&&(D={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:r.certificateError.bad_certificate}),D===null&&ge!==null&&!ge.cA&&(D={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:r.certificateError.bad_certificate}),D===null&&Se!==null&&"pathLenConstraint"in ge){var $=H-1;$>ge.pathLenConstraint&&(D={message:"Certificate basicConstraints pathLenConstraint violated.",error:r.certificateError.bad_certificate})}}var me=D===null?!0:D.error,Z=a.verify?a.verify(me,H,w):me;if(Z===!0)D=null;else throw me===!0&&(D={message:"The application rejected the certificate.",error:r.certificateError.bad_certificate}),(Z||Z===0)&&(typeof Z=="object"&&!t.util.isArray(Z)?(Z.message&&(D.message=Z.message),Z.error&&(D.error=Z.error)):typeof Z=="string"&&(D.error=Z)),D;K=!1,++H}while(o.length>0);return!0}}),cs=pe((l,i)=>{var t=fe();Tt(),vr(),Gt(),ss(),is(),yt(),Mr(),Er(),ve(),Bn();var e=t.asn1,r=t.pki,u=i.exports=t.pkcs12=t.pkcs12||{},f={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},d={name:"PFX",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},f,{name:"PFX.macData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},c={name:"SafeBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},n={name:"Attribute",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,capture:"values"}]},m={name:"CertBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:e.Class.UNIVERSAL,type:e.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function h(b,S,s,E){for(var C=[],_=0;_<b.length;_++)for(var k=0;k<b[_].safeBags.length;k++){var v=b[_].safeBags[k];if(!(E!==void 0&&v.type!==E)){if(S===null){C.push(v);continue}v.attributes[S]!==void 0&&v.attributes[S].indexOf(s)>=0&&C.push(v)}}return C}u.pkcs12FromAsn1=function(b,S,s){typeof S=="string"?(s=S,S=!0):S===void 0&&(S=!0);var E={},C=[];if(!e.validate(b,d,E,C)){var _=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw _.errors=_,_}var k={version:E.version.charCodeAt(0),safeContents:[],getBags:function(q){var j={},Y;return"localKeyId"in q?Y=q.localKeyId:"localKeyIdHex"in q&&(Y=t.util.hexToBytes(q.localKeyIdHex)),Y===void 0&&!("friendlyName"in q)&&"bagType"in q&&(j[q.bagType]=h(k.safeContents,null,null,q.bagType)),Y!==void 0&&(j.localKeyId=h(k.safeContents,"localKeyId",Y,q.bagType)),"friendlyName"in q&&(j.friendlyName=h(k.safeContents,"friendlyName",q.friendlyName,q.bagType)),j},getBagsByFriendlyName:function(q,j){return h(k.safeContents,"friendlyName",q,j)},getBagsByLocalKeyId:function(q,j){return h(k.safeContents,"localKeyId",q,j)}};if(E.version.charCodeAt(0)!==3){var _=new Error("PKCS#12 PFX of version other than 3 not supported.");throw _.version=E.version.charCodeAt(0),_}if(e.derToOid(E.contentType)!==r.oids.data){var _=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw _.oid=e.derToOid(E.contentType),_}var v=E.content.value[0];if(v.tagClass!==e.Class.UNIVERSAL||v.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(v=I(v),E.mac){var o=null,a=0,w=e.derToOid(E.macAlgorithm);switch(w){case r.oids.sha1:o=t.md.sha1.create(),a=20;break;case r.oids.sha256:o=t.md.sha256.create(),a=32;break;case r.oids.sha384:o=t.md.sha384.create(),a=48;break;case r.oids.sha512:o=t.md.sha512.create(),a=64;break;case r.oids.md5:o=t.md.md5.create(),a=16;break}if(o===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+w);var P=new t.util.ByteBuffer(E.macSalt),K="macIterations"in E?parseInt(t.util.bytesToHex(E.macIterations),16):1,D=u.generateKey(s,P,3,K,a,o),H=t.hmac.create();H.start(o,D),H.update(v.value);var G=H.getMac();if(G.getBytes()!==E.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return x(k,v.value,S,s),k};function I(b){if(b.composed||b.constructed){for(var S=t.util.createBuffer(),s=0;s<b.value.length;++s)S.putBytes(b.value[s].value);b.composed=b.constructed=!1,b.value=S.getBytes()}return b}function x(b,S,s,E){if(S=e.fromDer(S,s),S.tagClass!==e.Class.UNIVERSAL||S.type!==e.Type.SEQUENCE||S.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var C=0;C<S.value.length;C++){var _=S.value[C],k={},v=[];if(!e.validate(_,f,k,v)){var o=new Error("Cannot read ContentInfo.");throw o.errors=v,o}var a={encrypted:!1},w=null,P=k.content.value[0];switch(e.derToOid(k.contentType)){case r.oids.data:if(P.tagClass!==e.Class.UNIVERSAL||P.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");w=I(P).value;break;case r.oids.encryptedData:w=A(P,E),a.encrypted=!0;break;default:var o=new Error("Unsupported PKCS#12 contentType.");throw o.contentType=e.derToOid(k.contentType),o}a.safeBags=y(w,s,E),b.safeContents.push(a)}}function A(b,S){var s={},E=[];if(!e.validate(b,t.pkcs7.asn1.encryptedDataValidator,s,E)){var C=new Error("Cannot read EncryptedContentInfo.");throw C.errors=E,C}var _=e.derToOid(s.contentType);if(_!==r.oids.data){var C=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw C.oid=_,C}_=e.derToOid(s.encAlgorithm);var k=r.pbe.getCipher(_,s.encParameter,S),v=I(s.encryptedContentAsn1),o=t.util.createBuffer(v.value);if(k.update(o),!k.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return k.output.getBytes()}function y(b,S,s){if(!S&&b.length===0)return[];if(b=e.fromDer(b,S),b.tagClass!==e.Class.UNIVERSAL||b.type!==e.Type.SEQUENCE||b.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var E=[],C=0;C<b.value.length;C++){var _=b.value[C],k={},v=[];if(!e.validate(_,c,k,v)){var o=new Error("Cannot read SafeBag.");throw o.errors=v,o}var a={type:e.derToOid(k.bagId),attributes:T(k.bagAttributes)};E.push(a);var w,P,K=k.bagValue.value[0];switch(a.type){case r.oids.pkcs8ShroudedKeyBag:if(K=r.decryptPrivateKeyInfo(K,s),K===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case r.oids.keyBag:try{a.key=r.privateKeyFromAsn1(K)}catch{a.key=null,a.asn1=K}continue;case r.oids.certBag:w=m,P=function(){if(e.derToOid(k.certId)!==r.oids.x509Certificate){var H=new Error("Unsupported certificate type, only X.509 supported.");throw H.oid=e.derToOid(k.certId),H}var G=e.fromDer(k.cert,S);try{a.cert=r.certificateFromAsn1(G,!0)}catch{a.cert=null,a.asn1=G}};break;default:var o=new Error("Unsupported PKCS#12 SafeBag type.");throw o.oid=a.type,o}if(w!==void 0&&!e.validate(K,w,k,v)){var o=new Error("Cannot read PKCS#12 "+w.name);throw o.errors=v,o}P()}return E}function T(b){var S={};if(b!==void 0)for(var s=0;s<b.length;++s){var E={},C=[];if(!e.validate(b[s],n,E,C)){var _=new Error("Cannot read PKCS#12 BagAttribute.");throw _.errors=C,_}var k=e.derToOid(E.oid);if(r.oids[k]!==void 0){S[r.oids[k]]=[];for(var v=0;v<E.values.length;++v)S[r.oids[k]].push(E.values[v].value)}}return S}u.toPkcs12Asn1=function(b,S,s,E){E=E||{},E.saltSize=E.saltSize||8,E.count=E.count||2048,E.algorithm=E.algorithm||E.encAlgorithm||"aes128","useMac"in E||(E.useMac=!0),"localKeyId"in E||(E.localKeyId=null),"generateLocalKeyId"in E||(E.generateLocalKeyId=!0);var C=E.localKeyId,_;if(C!==null)C=t.util.hexToBytes(C);else if(E.generateLocalKeyId)if(S){var k=t.util.isArray(S)?S[0]:S;typeof k=="string"&&(k=r.certificateFromPem(k));var v=t.md.sha1.create();v.update(e.toDer(r.certificateToAsn1(k)).getBytes()),C=v.digest().getBytes()}else C=t.random.getBytes(20);var o=[];C!==null&&o.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.localKeyId).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,C)])])),"friendlyName"in E&&o.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.friendlyName).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.BMPSTRING,!1,E.friendlyName)])])),o.length>0&&(_=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,o));var a=[],w=[];S!==null&&(t.util.isArray(S)?w=S:w=[S]);for(var P=[],K=0;K<w.length;++K){S=w[K],typeof S=="string"&&(S=r.certificateFromPem(S));var D=K===0?_:void 0,H=r.certificateToAsn1(S),G=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.certBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.x509Certificate).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(H).getBytes())])])]),D]);P.push(G)}if(P.length>0){var q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,P),j=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(q).getBytes())])]);a.push(j)}var Y=null;if(b!==null){var J=r.wrapRsaPrivateKey(r.privateKeyToAsn1(b));s===null?Y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.keyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[J]),_]):Y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.pkcs8ShroudedKeyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[r.encryptPrivateKeyInfo(J,s,E)]),_]);var ee=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[Y]),ie=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(ee).getBytes())])]);a.push(ie)}var le=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,a),ge;if(E.useMac){var v=t.md.sha1.create(),Se=new t.util.ByteBuffer(t.random.getBytes(E.saltSize)),$=E.count,b=u.generateKey(s,Se,3,$,20),me=t.hmac.create();me.start(v,b),me.update(e.toDer(le).getBytes());var Z=me.getMac();ge=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.sha1).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,Z.getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,Se.getBytes()),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer($).getBytes())])}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(3).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(le).getBytes())])]),ge])},u.generateKey=t.pbe.generatePkcs12Key}),us=pe((l,i)=>{var t=fe();Tt(),Gt(),is(),tr(),An(),cs(),In(),Mr(),ve(),Bn();var e=t.asn1,r=i.exports=t.pki=t.pki||{};r.pemToDer=function(u){var f=t.pem.decode(u)[0];if(f.procType&&f.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return t.util.createBuffer(f.body)},r.privateKeyFromPem=function(u){var f=t.pem.decode(u)[0];if(f.type!=="PRIVATE KEY"&&f.type!=="RSA PRIVATE KEY"){var d=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw d.headerType=f.type,d}if(f.procType&&f.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var c=e.fromDer(f.body);return r.privateKeyFromAsn1(c)},r.privateKeyToPem=function(u,f){var d={type:"RSA PRIVATE KEY",body:e.toDer(r.privateKeyToAsn1(u)).getBytes()};return t.pem.encode(d,{maxline:f})},r.privateKeyInfoToPem=function(u,f){var d={type:"PRIVATE KEY",body:e.toDer(u).getBytes()};return t.pem.encode(d,{maxline:f})}}),ls=pe((l,i)=>{var t=fe();Tt(),vr(),bn(),tr(),us(),yt(),Er(),ve();var e=function(g,U,L,p){var N=t.util.createBuffer(),M=g.length>>1,V=M+(g.length&1),W=g.substr(0,V),ae=g.substr(M,V),se=t.util.createBuffer(),z=t.hmac.create();L=U+L;var re=Math.ceil(p/16),ue=Math.ceil(p/20);z.start("MD5",W);var ye=t.util.createBuffer();se.putBytes(L);for(var he=0;he<re;++he)z.start(null,null),z.update(se.getBytes()),se.putBuffer(z.digest()),z.start(null,null),z.update(se.bytes()+L),ye.putBuffer(z.digest());z.start("SHA1",ae);var be=t.util.createBuffer();se.clear(),se.putBytes(L);for(var he=0;he<ue;++he)z.start(null,null),z.update(se.getBytes()),se.putBuffer(z.digest()),z.start(null,null),z.update(se.bytes()+L),be.putBuffer(z.digest());return N.putBytes(t.util.xorBytes(ye.getBytes(),be.getBytes(),p)),N},r=function(g,U,L){var p=t.hmac.create();p.start("SHA1",g);var N=t.util.createBuffer();return N.putInt32(U[0]),N.putInt32(U[1]),N.putByte(L.type),N.putByte(L.version.major),N.putByte(L.version.minor),N.putInt16(L.length),N.putBytes(L.fragment.bytes()),p.update(N.getBytes()),p.digest().getBytes()},u=function(g,U,L){var p=!1;try{var N=g.deflate(U.fragment.getBytes());U.fragment=t.util.createBuffer(N),U.length=N.length,p=!0}catch{}return p},f=function(g,U,L){var p=!1;try{var N=g.inflate(U.fragment.getBytes());U.fragment=t.util.createBuffer(N),U.length=N.length,p=!0}catch{}return p},d=function(g,U){var L=0;switch(U){case 1:L=g.getByte();break;case 2:L=g.getInt16();break;case 3:L=g.getInt24();break;case 4:L=g.getInt32();break}return t.util.createBuffer(g.getBytes(L))},c=function(g,U,L){g.putInt(L.length(),U<<3),g.putBuffer(L)},n={};n.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},n.SupportedVersions=[n.Versions.TLS_1_1,n.Versions.TLS_1_0],n.Version=n.SupportedVersions[0],n.MaxFragment=15360,n.ConnectionEnd={server:0,client:1},n.PRFAlgorithm={tls_prf_sha256:0},n.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},n.CipherType={stream:0,block:1,aead:2},n.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},n.CompressionMethod={none:0,deflate:1},n.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},n.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},n.Alert={},n.Alert.Level={warning:1,fatal:2},n.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},n.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},n.CipherSuites={},n.getCipherSuite=function(g){var U=null;for(var L in n.CipherSuites){var p=n.CipherSuites[L];if(p.id[0]===g.charCodeAt(0)&&p.id[1]===g.charCodeAt(1)){U=p;break}}return U},n.handleUnexpected=function(g,U){var L=!g.open&&g.entity===n.ConnectionEnd.client;L||g.error(g,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.unexpected_message}})},n.handleHelloRequest=function(g,U,L){!g.handshaking&&g.handshakes>0&&(n.queue(g,n.createAlert(g,{level:n.Alert.Level.warning,description:n.Alert.Description.no_renegotiation})),n.flush(g)),g.process()},n.parseHelloMessage=function(g,U,L){var p=null,N=g.entity===n.ConnectionEnd.client;if(L<38)g.error(g,{message:N?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});else{var M=U.fragment,V=M.length();if(p={version:{major:M.getByte(),minor:M.getByte()},random:t.util.createBuffer(M.getBytes(32)),session_id:d(M,1),extensions:[]},N?(p.cipher_suite=M.getBytes(2),p.compression_method=M.getByte()):(p.cipher_suites=d(M,2),p.compression_methods=d(M,1)),V=L-(V-M.length()),V>0){for(var W=d(M,2);W.length()>0;)p.extensions.push({type:[W.getByte(),W.getByte()],data:d(W,2)});if(!N)for(var ae=0;ae<p.extensions.length;++ae){var se=p.extensions[ae];if(se.type[0]===0&&se.type[1]===0)for(var z=d(se.data,2);z.length()>0;){var re=z.getByte();if(re!==0)break;g.session.extensions.server_name.serverNameList.push(d(z,2).getBytes())}}}if(g.session.version&&(p.version.major!==g.session.version.major||p.version.minor!==g.session.version.minor))return g.error(g,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.protocol_version}});if(N)g.session.cipherSuite=n.getCipherSuite(p.cipher_suite);else for(var ue=t.util.createBuffer(p.cipher_suites.bytes());ue.length()>0&&(g.session.cipherSuite=n.getCipherSuite(ue.getBytes(2)),g.session.cipherSuite===null););if(g.session.cipherSuite===null)return g.error(g,{message:"No cipher suites in common.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.handshake_failure},cipherSuite:t.util.bytesToHex(p.cipher_suite)});N?g.session.compressionMethod=p.compression_method:g.session.compressionMethod=n.CompressionMethod.none}return p},n.createSecurityParameters=function(g,U){var L=g.entity===n.ConnectionEnd.client,p=U.random.bytes(),N=L?g.session.sp.client_random:p,M=L?p:n.createRandom().getBytes();g.session.sp={entity:g.entity,prf_algorithm:n.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:g.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:N,server_random:M}},n.handleServerHello=function(g,U,L){var p=n.parseHelloMessage(g,U,L);if(!g.fail){if(p.version.minor<=g.version.minor)g.version.minor=p.version.minor;else return g.error(g,{message:"Incompatible TLS version.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.protocol_version}});g.session.version=g.version;var N=p.session_id.bytes();N.length>0&&N===g.session.id?(g.expect=y,g.session.resuming=!0,g.session.sp.server_random=p.random.bytes()):(g.expect=h,g.session.resuming=!1,n.createSecurityParameters(g,p)),g.session.id=N,g.process()}},n.handleClientHello=function(g,U,L){var p=n.parseHelloMessage(g,U,L);if(!g.fail){var N=p.session_id.bytes(),M=null;if(g.sessionCache&&(M=g.sessionCache.getSession(N),M===null?N="":(M.version.major!==p.version.major||M.version.minor>p.version.minor)&&(M=null,N="")),N.length===0&&(N=t.random.getBytes(32)),g.session.id=N,g.session.clientHelloVersion=p.version,g.session.sp={},M)g.version=g.session.version=M.version,g.session.sp=M.sp;else{for(var V,W=1;W<n.SupportedVersions.length&&(V=n.SupportedVersions[W],!(V.minor<=p.version.minor));++W);g.version={major:V.major,minor:V.minor},g.session.version=g.version}M!==null?(g.expect=k,g.session.resuming=!0,g.session.sp.client_random=p.random.bytes()):(g.expect=g.verifyClient!==!1?E:C,g.session.resuming=!1,n.createSecurityParameters(g,p)),g.open=!0,n.queue(g,n.createRecord(g,{type:n.ContentType.handshake,data:n.createServerHello(g)})),g.session.resuming?(n.queue(g,n.createRecord(g,{type:n.ContentType.change_cipher_spec,data:n.createChangeCipherSpec()})),g.state.pending=n.createConnectionState(g),g.state.current.write=g.state.pending.write,n.queue(g,n.createRecord(g,{type:n.ContentType.handshake,data:n.createFinished(g)}))):(n.queue(g,n.createRecord(g,{type:n.ContentType.handshake,data:n.createCertificate(g)})),g.fail||(n.queue(g,n.createRecord(g,{type:n.ContentType.handshake,data:n.createServerKeyExchange(g)})),g.verifyClient!==!1&&n.queue(g,n.createRecord(g,{type:n.ContentType.handshake,data:n.createCertificateRequest(g)})),n.queue(g,n.createRecord(g,{type:n.ContentType.handshake,data:n.createServerHelloDone(g)})))),n.flush(g),g.process()}},n.handleCertificate=function(g,U,L){if(L<3)return g.error(g,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});var p=U.fragment,N={certificate_list:d(p,3)},M,V,W=[];try{for(;N.certificate_list.length()>0;)M=d(N.certificate_list,3),V=t.asn1.fromDer(M),M=t.pki.certificateFromAsn1(V,!0),W.push(M)}catch(se){return g.error(g,{message:"Could not parse certificate list.",cause:se,send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.bad_certificate}})}var ae=g.entity===n.ConnectionEnd.client;(ae||g.verifyClient===!0)&&W.length===0?g.error(g,{message:ae?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}}):W.length===0?g.expect=ae?I:C:(ae?g.session.serverCertificate=W[0]:g.session.clientCertificate=W[0],n.verifyCertificateChain(g,W)&&(g.expect=ae?I:C)),g.process()},n.handleServerKeyExchange=function(g,U,L){if(L>0)return g.error(g,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.unsupported_certificate}});g.expect=x,g.process()},n.handleClientKeyExchange=function(g,U,L){if(L<48)return g.error(g,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.unsupported_certificate}});var p=U.fragment,N={enc_pre_master_secret:d(p,2).getBytes()},M=null;if(g.getPrivateKey)try{M=g.getPrivateKey(g,g.session.serverCertificate),M=t.pki.privateKeyFromPem(M)}catch(ae){g.error(g,{message:"Could not get private key.",cause:ae,send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}})}if(M===null)return g.error(g,{message:"No private key set.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}});try{var V=g.session.sp;V.pre_master_secret=M.decrypt(N.enc_pre_master_secret);var W=g.session.clientHelloVersion;if(W.major!==V.pre_master_secret.charCodeAt(0)||W.minor!==V.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{V.pre_master_secret=t.random.getBytes(48)}g.expect=k,g.session.clientCertificate!==null&&(g.expect=_),g.process()},n.handleCertificateRequest=function(g,U,L){if(L<3)return g.error(g,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});var p=U.fragment,N={certificate_types:d(p,1),certificate_authorities:d(p,2)};g.session.certificateRequest=N,g.expect=A,g.process()},n.handleCertificateVerify=function(g,U,L){if(L<2)return g.error(g,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});var p=U.fragment;p.read-=4;var N=p.bytes();p.read+=4;var M={signature:d(p,2).getBytes()},V=t.util.createBuffer();V.putBuffer(g.session.md5.digest()),V.putBuffer(g.session.sha1.digest()),V=V.getBytes();try{var W=g.session.clientCertificate;if(!W.publicKey.verify(V,M.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");g.session.md5.update(N),g.session.sha1.update(N)}catch{return g.error(g,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.handshake_failure}})}g.expect=k,g.process()},n.handleServerHelloDone=function(g,U,L){if(L>0)return g.error(g,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.record_overflow}});if(g.serverCertificate===null){var p={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.insufficient_security}},N=0,M=g.verify(g,p.alert.description,N,[]);if(M!==!0)return(M||M===0)&&(typeof M=="object"&&!t.util.isArray(M)?(M.message&&(p.message=M.message),M.alert&&(p.alert.description=M.alert)):typeof M=="number"&&(p.alert.description=M)),g.error(g,p)}g.session.certificateRequest!==null&&(U=n.createRecord(g,{type:n.ContentType.handshake,data:n.createCertificate(g)}),n.queue(g,U)),U=n.createRecord(g,{type:n.ContentType.handshake,data:n.createClientKeyExchange(g)}),n.queue(g,U),g.expect=S;var V=function(W,ae){W.session.certificateRequest!==null&&W.session.clientCertificate!==null&&n.queue(W,n.createRecord(W,{type:n.ContentType.handshake,data:n.createCertificateVerify(W,ae)})),n.queue(W,n.createRecord(W,{type:n.ContentType.change_cipher_spec,data:n.createChangeCipherSpec()})),W.state.pending=n.createConnectionState(W),W.state.current.write=W.state.pending.write,n.queue(W,n.createRecord(W,{type:n.ContentType.handshake,data:n.createFinished(W)})),W.expect=y,n.flush(W),W.process()};if(g.session.certificateRequest===null||g.session.clientCertificate===null)return V(g,null);n.getClientSignature(g,V)},n.handleChangeCipherSpec=function(g,U){if(U.fragment.getByte()!==1)return g.error(g,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});var L=g.entity===n.ConnectionEnd.client;(g.session.resuming&&L||!g.session.resuming&&!L)&&(g.state.pending=n.createConnectionState(g)),g.state.current.read=g.state.pending.read,(!g.session.resuming&&L||g.session.resuming&&!L)&&(g.state.pending=null),g.expect=L?T:v,g.process()},n.handleFinished=function(g,U,L){var p=U.fragment;p.read-=4;var N=p.bytes();p.read+=4;var M=U.fragment.getBytes();p=t.util.createBuffer(),p.putBuffer(g.session.md5.digest()),p.putBuffer(g.session.sha1.digest());var V=g.entity===n.ConnectionEnd.client,W=V?"server finished":"client finished",ae=g.session.sp,se=12,z=e;if(p=z(ae.master_secret,W,p.getBytes(),se),p.getBytes()!==M)return g.error(g,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.decrypt_error}});g.session.md5.update(N),g.session.sha1.update(N),(g.session.resuming&&V||!g.session.resuming&&!V)&&(n.queue(g,n.createRecord(g,{type:n.ContentType.change_cipher_spec,data:n.createChangeCipherSpec()})),g.state.current.write=g.state.pending.write,g.state.pending=null,n.queue(g,n.createRecord(g,{type:n.ContentType.handshake,data:n.createFinished(g)}))),g.expect=V?b:o,g.handshaking=!1,++g.handshakes,g.peerCertificate=V?g.session.serverCertificate:g.session.clientCertificate,n.flush(g),g.isConnected=!0,g.connected(g),g.process()},n.handleAlert=function(g,U){var L=U.fragment,p={level:L.getByte(),description:L.getByte()},N;switch(p.description){case n.Alert.Description.close_notify:N="Connection closed.";break;case n.Alert.Description.unexpected_message:N="Unexpected message.";break;case n.Alert.Description.bad_record_mac:N="Bad record MAC.";break;case n.Alert.Description.decryption_failed:N="Decryption failed.";break;case n.Alert.Description.record_overflow:N="Record overflow.";break;case n.Alert.Description.decompression_failure:N="Decompression failed.";break;case n.Alert.Description.handshake_failure:N="Handshake failure.";break;case n.Alert.Description.bad_certificate:N="Bad certificate.";break;case n.Alert.Description.unsupported_certificate:N="Unsupported certificate.";break;case n.Alert.Description.certificate_revoked:N="Certificate revoked.";break;case n.Alert.Description.certificate_expired:N="Certificate expired.";break;case n.Alert.Description.certificate_unknown:N="Certificate unknown.";break;case n.Alert.Description.illegal_parameter:N="Illegal parameter.";break;case n.Alert.Description.unknown_ca:N="Unknown certificate authority.";break;case n.Alert.Description.access_denied:N="Access denied.";break;case n.Alert.Description.decode_error:N="Decode error.";break;case n.Alert.Description.decrypt_error:N="Decrypt error.";break;case n.Alert.Description.export_restriction:N="Export restriction.";break;case n.Alert.Description.protocol_version:N="Unsupported protocol version.";break;case n.Alert.Description.insufficient_security:N="Insufficient security.";break;case n.Alert.Description.internal_error:N="Internal error.";break;case n.Alert.Description.user_canceled:N="User canceled.";break;case n.Alert.Description.no_renegotiation:N="Renegotiation not supported.";break;default:N="Unknown error.";break}if(p.description===n.Alert.Description.close_notify)return g.close();g.error(g,{message:N,send:!1,origin:g.entity===n.ConnectionEnd.client?"server":"client",alert:p}),g.process()},n.handleHandshake=function(g,U){var L=U.fragment,p=L.getByte(),N=L.getInt24();if(N>L.length())return g.fragmented=U,U.fragment=t.util.createBuffer(),L.read-=4,g.process();g.fragmented=null,L.read-=4;var M=L.bytes(N+4);L.read+=4,p in ge[g.entity][g.expect]?(g.entity===n.ConnectionEnd.server&&!g.open&&!g.fail&&(g.handshaking=!0,g.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:t.md.md5.create(),sha1:t.md.sha1.create()}),p!==n.HandshakeType.hello_request&&p!==n.HandshakeType.certificate_verify&&p!==n.HandshakeType.finished&&(g.session.md5.update(M),g.session.sha1.update(M)),ge[g.entity][g.expect][p](g,U,N)):n.handleUnexpected(g,U)},n.handleApplicationData=function(g,U){g.data.putBuffer(U.fragment),g.dataReady(g),g.process()},n.handleHeartbeat=function(g,U){var L=U.fragment,p=L.getByte(),N=L.getInt16(),M=L.getBytes(N);if(p===n.HeartbeatMessageType.heartbeat_request){if(g.handshaking||N>M.length)return g.process();n.queue(g,n.createRecord(g,{type:n.ContentType.heartbeat,data:n.createHeartbeat(n.HeartbeatMessageType.heartbeat_response,M)})),n.flush(g)}else if(p===n.HeartbeatMessageType.heartbeat_response){if(M!==g.expectedHeartbeatPayload)return g.process();g.heartbeatReceived&&g.heartbeatReceived(g,t.util.createBuffer(M))}g.process()};var m=0,h=1,I=2,x=3,A=4,y=5,T=6,b=7,S=8,s=0,E=1,C=2,_=3,k=4,v=5,o=6,a=n.handleUnexpected,w=n.handleChangeCipherSpec,P=n.handleAlert,K=n.handleHandshake,D=n.handleApplicationData,H=n.handleHeartbeat,G=[];G[n.ConnectionEnd.client]=[[a,P,K,a,H],[a,P,K,a,H],[a,P,K,a,H],[a,P,K,a,H],[a,P,K,a,H],[w,P,a,a,H],[a,P,K,a,H],[a,P,K,D,H],[a,P,K,a,H]],G[n.ConnectionEnd.server]=[[a,P,K,a,H],[a,P,K,a,H],[a,P,K,a,H],[a,P,K,a,H],[w,P,a,a,H],[a,P,K,a,H],[a,P,K,D,H],[a,P,K,a,H]];var q=n.handleHelloRequest,j=n.handleServerHello,Y=n.handleCertificate,J=n.handleServerKeyExchange,ee=n.handleCertificateRequest,ie=n.handleServerHelloDone,le=n.handleFinished,ge=[];ge[n.ConnectionEnd.client]=[[a,a,j,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[q,a,a,a,a,a,a,a,a,a,a,Y,J,ee,ie,a,a,a,a,a,a],[q,a,a,a,a,a,a,a,a,a,a,a,J,ee,ie,a,a,a,a,a,a],[q,a,a,a,a,a,a,a,a,a,a,a,a,ee,ie,a,a,a,a,a,a],[q,a,a,a,a,a,a,a,a,a,a,a,a,a,ie,a,a,a,a,a,a],[q,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[q,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,le],[q,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[q,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a]];var Se=n.handleClientHello,$=n.handleClientKeyExchange,me=n.handleCertificateVerify;ge[n.ConnectionEnd.server]=[[a,Se,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,Y,a,a,a,a,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,$,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,me,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,le],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a]],n.generateKeys=function(g,U){var L=e,p=U.client_random+U.server_random;g.session.resuming||(U.master_secret=L(U.pre_master_secret,"master secret",p,48).bytes(),U.pre_master_secret=null),p=U.server_random+U.client_random;var N=2*U.mac_key_length+2*U.enc_key_length,M=g.version.major===n.Versions.TLS_1_0.major&&g.version.minor===n.Versions.TLS_1_0.minor;M&&(N+=2*U.fixed_iv_length);var V=L(U.master_secret,"key expansion",p,N),W={client_write_MAC_key:V.getBytes(U.mac_key_length),server_write_MAC_key:V.getBytes(U.mac_key_length),client_write_key:V.getBytes(U.enc_key_length),server_write_key:V.getBytes(U.enc_key_length)};return M&&(W.client_write_IV=V.getBytes(U.fixed_iv_length),W.server_write_IV=V.getBytes(U.fixed_iv_length)),W},n.createConnectionState=function(g){var U=g.entity===n.ConnectionEnd.client,L=function(){var M={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(V){return!0},compressionState:null,compressFunction:function(V){return!0},updateSequenceNumber:function(){M.sequenceNumber[1]===4294967295?(M.sequenceNumber[1]=0,++M.sequenceNumber[0]):++M.sequenceNumber[1]}};return M},p={read:L(),write:L()};if(p.read.update=function(M,V){return p.read.cipherFunction(V,p.read)?p.read.compressFunction(M,V,p.read)||M.error(M,{message:"Could not decompress record.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.decompression_failure}}):M.error(M,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.bad_record_mac}}),!M.fail},p.write.update=function(M,V){return p.write.compressFunction(M,V,p.write)?p.write.cipherFunction(V,p.write)||M.error(M,{message:"Could not encrypt record.",send:!1,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}}):M.error(M,{message:"Could not compress record.",send:!1,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}}),!M.fail},g.session){var N=g.session.sp;switch(g.session.cipherSuite.initSecurityParameters(N),N.keys=n.generateKeys(g,N),p.read.macKey=U?N.keys.server_write_MAC_key:N.keys.client_write_MAC_key,p.write.macKey=U?N.keys.client_write_MAC_key:N.keys.server_write_MAC_key,g.session.cipherSuite.initConnectionState(p,g,N),N.compression_algorithm){case n.CompressionMethod.none:break;case n.CompressionMethod.deflate:p.read.compressFunction=f,p.write.compressFunction=u;break;default:throw new Error("Unsupported compression algorithm.")}}return p},n.createRandom=function(){var g=new Date,U=+g+g.getTimezoneOffset()*6e4,L=t.util.createBuffer();return L.putInt32(U),L.putBytes(t.random.getBytes(28)),L},n.createRecord=function(g,U){if(!U.data)return null;var L={type:U.type,version:{major:g.version.major,minor:g.version.minor},length:U.data.length(),fragment:U.data};return L},n.createAlert=function(g,U){var L=t.util.createBuffer();return L.putByte(U.level),L.putByte(U.description),n.createRecord(g,{type:n.ContentType.alert,data:L})},n.createClientHello=function(g){g.session.clientHelloVersion={major:g.version.major,minor:g.version.minor};for(var U=t.util.createBuffer(),L=0;L<g.cipherSuites.length;++L){var p=g.cipherSuites[L];U.putByte(p.id[0]),U.putByte(p.id[1])}var N=U.length(),M=t.util.createBuffer();M.putByte(n.CompressionMethod.none);var V=M.length(),W=t.util.createBuffer();if(g.virtualHost){var ae=t.util.createBuffer();ae.putByte(0),ae.putByte(0);var se=t.util.createBuffer();se.putByte(0),c(se,2,t.util.createBuffer(g.virtualHost));var z=t.util.createBuffer();c(z,2,se),c(ae,2,z),W.putBuffer(ae)}var re=W.length();re>0&&(re+=2);var ue=g.session.id,ye=ue.length+1+2+4+28+2+N+1+V+re,he=t.util.createBuffer();return he.putByte(n.HandshakeType.client_hello),he.putInt24(ye),he.putByte(g.version.major),he.putByte(g.version.minor),he.putBytes(g.session.sp.client_random),c(he,1,t.util.createBuffer(ue)),c(he,2,U),c(he,1,M),re>0&&c(he,2,W),he},n.createServerHello=function(g){var U=g.session.id,L=U.length+1+2+4+28+2+1,p=t.util.createBuffer();return p.putByte(n.HandshakeType.server_hello),p.putInt24(L),p.putByte(g.version.major),p.putByte(g.version.minor),p.putBytes(g.session.sp.server_random),c(p,1,t.util.createBuffer(U)),p.putByte(g.session.cipherSuite.id[0]),p.putByte(g.session.cipherSuite.id[1]),p.putByte(g.session.compressionMethod),p},n.createCertificate=function(g){var U=g.entity===n.ConnectionEnd.client,L=null;if(g.getCertificate){var p;U?p=g.session.certificateRequest:p=g.session.extensions.server_name.serverNameList,L=g.getCertificate(g,p)}var N=t.util.createBuffer();if(L!==null)try{t.util.isArray(L)||(L=[L]);for(var M=null,V=0;V<L.length;++V){var W=t.pem.decode(L[V])[0];if(W.type!=="CERTIFICATE"&&W.type!=="X509 CERTIFICATE"&&W.type!=="TRUSTED CERTIFICATE"){var ae=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw ae.headerType=W.type,ae}if(W.procType&&W.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var se=t.util.createBuffer(W.body);M===null&&(M=t.asn1.fromDer(se.bytes(),!1));var z=t.util.createBuffer();c(z,3,se),N.putBuffer(z)}L=t.pki.certificateFromAsn1(M),U?g.session.clientCertificate=L:g.session.serverCertificate=L}catch(ye){return g.error(g,{message:"Could not send certificate list.",cause:ye,send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.bad_certificate}})}var re=3+N.length(),ue=t.util.createBuffer();return ue.putByte(n.HandshakeType.certificate),ue.putInt24(re),c(ue,3,N),ue},n.createClientKeyExchange=function(g){var U=t.util.createBuffer();U.putByte(g.session.clientHelloVersion.major),U.putByte(g.session.clientHelloVersion.minor),U.putBytes(t.random.getBytes(46));var L=g.session.sp;L.pre_master_secret=U.getBytes();var p=g.session.serverCertificate.publicKey;U=p.encrypt(L.pre_master_secret);var N=U.length+2,M=t.util.createBuffer();return M.putByte(n.HandshakeType.client_key_exchange),M.putInt24(N),M.putInt16(U.length),M.putBytes(U),M},n.createServerKeyExchange=function(g){var U=0,L=t.util.createBuffer();return U>0&&(L.putByte(n.HandshakeType.server_key_exchange),L.putInt24(U)),L},n.getClientSignature=function(g,U){var L=t.util.createBuffer();L.putBuffer(g.session.md5.digest()),L.putBuffer(g.session.sha1.digest()),L=L.getBytes(),g.getSignature=g.getSignature||function(p,N,M){var V=null;if(p.getPrivateKey)try{V=p.getPrivateKey(p,p.session.clientCertificate),V=t.pki.privateKeyFromPem(V)}catch(W){p.error(p,{message:"Could not get private key.",cause:W,send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}})}V===null?p.error(p,{message:"No private key set.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}}):N=V.sign(N,null),M(p,N)},g.getSignature(g,L,U)},n.createCertificateVerify=function(g,U){var L=U.length+2,p=t.util.createBuffer();return p.putByte(n.HandshakeType.certificate_verify),p.putInt24(L),p.putInt16(U.length),p.putBytes(U),p},n.createCertificateRequest=function(g){var U=t.util.createBuffer();U.putByte(1);var L=t.util.createBuffer();for(var p in g.caStore.certs){var N=g.caStore.certs[p],M=t.pki.distinguishedNameToAsn1(N.subject),V=t.asn1.toDer(M);L.putInt16(V.length()),L.putBuffer(V)}var W=1+U.length()+2+L.length(),ae=t.util.createBuffer();return ae.putByte(n.HandshakeType.certificate_request),ae.putInt24(W),c(ae,1,U),c(ae,2,L),ae},n.createServerHelloDone=function(g){var U=t.util.createBuffer();return U.putByte(n.HandshakeType.server_hello_done),U.putInt24(0),U},n.createChangeCipherSpec=function(){var g=t.util.createBuffer();return g.putByte(1),g},n.createFinished=function(g){var U=t.util.createBuffer();U.putBuffer(g.session.md5.digest()),U.putBuffer(g.session.sha1.digest());var L=g.entity===n.ConnectionEnd.client,p=g.session.sp,N=12,M=e,V=L?"client finished":"server finished";U=M(p.master_secret,V,U.getBytes(),N);var W=t.util.createBuffer();return W.putByte(n.HandshakeType.finished),W.putInt24(U.length()),W.putBuffer(U),W},n.createHeartbeat=function(g,U,L){typeof L>"u"&&(L=U.length);var p=t.util.createBuffer();p.putByte(g),p.putInt16(L),p.putBytes(U);var N=p.length(),M=Math.max(16,N-L-3);return p.putBytes(t.random.getBytes(M)),p},n.queue=function(g,U){if(U&&!(U.fragment.length()===0&&(U.type===n.ContentType.handshake||U.type===n.ContentType.alert||U.type===n.ContentType.change_cipher_spec))){if(U.type===n.ContentType.handshake){var L=U.fragment.bytes();g.session.md5.update(L),g.session.sha1.update(L),L=null}var p;if(U.fragment.length()<=n.MaxFragment)p=[U];else{p=[];for(var N=U.fragment.bytes();N.length>n.MaxFragment;)p.push(n.createRecord(g,{type:U.type,data:t.util.createBuffer(N.slice(0,n.MaxFragment))})),N=N.slice(n.MaxFragment);N.length>0&&p.push(n.createRecord(g,{type:U.type,data:t.util.createBuffer(N)}))}for(var M=0;M<p.length&&!g.fail;++M){var V=p[M],W=g.state.current.write;W.update(g,V)&&g.records.push(V)}}},n.flush=function(g){for(var U=0;U<g.records.length;++U){var L=g.records[U];g.tlsData.putByte(L.type),g.tlsData.putByte(L.version.major),g.tlsData.putByte(L.version.minor),g.tlsData.putInt16(L.fragment.length()),g.tlsData.putBuffer(g.records[U].fragment)}return g.records=[],g.tlsDataReady(g)};var Z=function(g){switch(g){case!0:return!0;case t.pki.certificateError.bad_certificate:return n.Alert.Description.bad_certificate;case t.pki.certificateError.unsupported_certificate:return n.Alert.Description.unsupported_certificate;case t.pki.certificateError.certificate_revoked:return n.Alert.Description.certificate_revoked;case t.pki.certificateError.certificate_expired:return n.Alert.Description.certificate_expired;case t.pki.certificateError.certificate_unknown:return n.Alert.Description.certificate_unknown;case t.pki.certificateError.unknown_ca:return n.Alert.Description.unknown_ca;default:return n.Alert.Description.bad_certificate}},we=function(g){switch(g){case!0:return!0;case n.Alert.Description.bad_certificate:return t.pki.certificateError.bad_certificate;case n.Alert.Description.unsupported_certificate:return t.pki.certificateError.unsupported_certificate;case n.Alert.Description.certificate_revoked:return t.pki.certificateError.certificate_revoked;case n.Alert.Description.certificate_expired:return t.pki.certificateError.certificate_expired;case n.Alert.Description.certificate_unknown:return t.pki.certificateError.certificate_unknown;case n.Alert.Description.unknown_ca:return t.pki.certificateError.unknown_ca;default:return t.pki.certificateError.bad_certificate}};n.verifyCertificateChain=function(g,U){try{var L={};for(var p in g.verifyOptions)L[p]=g.verifyOptions[p];L.verify=function(M,V,W){var ae=Z(M),se=g.verify(g,M,V,W);if(se!==!0){if(typeof se=="object"&&!t.util.isArray(se)){var z=new Error("The application rejected the certificate.");throw z.send=!0,z.alert={level:n.Alert.Level.fatal,description:n.Alert.Description.bad_certificate},se.message&&(z.message=se.message),se.alert&&(z.alert.description=se.alert),z}se!==M&&(se=we(se))}return se},t.pki.verifyCertificateChain(g.caStore,U,L)}catch(M){var N=M;(typeof N!="object"||t.util.isArray(N))&&(N={send:!0,alert:{level:n.Alert.Level.fatal,description:Z(M)}}),"send"in N||(N.send=!0),"alert"in N||(N.alert={level:n.Alert.Level.fatal,description:Z(N.error)}),g.error(g,N)}return!g.fail},n.createSessionCache=function(g,U){var L=null;if(g&&g.getSession&&g.setSession&&g.order)L=g;else{L={},L.cache=g||{},L.capacity=Math.max(U||100,1),L.order=[];for(var p in g)L.order.length<=U?L.order.push(p):delete g[p];L.getSession=function(N){var M=null,V=null;if(N?V=t.util.bytesToHex(N):L.order.length>0&&(V=L.order[0]),V!==null&&V in L.cache){M=L.cache[V],delete L.cache[V];for(var W in L.order)if(L.order[W]===V){L.order.splice(W,1);break}}return M},L.setSession=function(N,M){if(L.order.length===L.capacity){var V=L.order.shift();delete L.cache[V]}var V=t.util.bytesToHex(N);L.order.push(V),L.cache[V]=M}}return L},n.createConnection=function(g){var U=null;g.caStore?t.util.isArray(g.caStore)?U=t.pki.createCaStore(g.caStore):U=g.caStore:U=t.pki.createCaStore();var L=g.cipherSuites||null;if(L===null){L=[];for(var p in n.CipherSuites)L.push(n.CipherSuites[p])}var N=g.server?n.ConnectionEnd.server:n.ConnectionEnd.client,M=g.sessionCache?n.createSessionCache(g.sessionCache):null,V={version:{major:n.Version.major,minor:n.Version.minor},entity:N,sessionId:g.sessionId,caStore:U,sessionCache:M,cipherSuites:L,connected:g.connected,virtualHost:g.virtualHost||null,verifyClient:g.verifyClient||!1,verify:g.verify||function(z,re,ue,ye){return re},verifyOptions:g.verifyOptions||{},getCertificate:g.getCertificate||null,getPrivateKey:g.getPrivateKey||null,getSignature:g.getSignature||null,input:t.util.createBuffer(),tlsData:t.util.createBuffer(),data:t.util.createBuffer(),tlsDataReady:g.tlsDataReady,dataReady:g.dataReady,heartbeatReceived:g.heartbeatReceived,closed:g.closed,error:function(z,re){re.origin=re.origin||(z.entity===n.ConnectionEnd.client?"client":"server"),re.send&&(n.queue(z,n.createAlert(z,re.alert)),n.flush(z));var ue=re.fatal!==!1;ue&&(z.fail=!0),g.error(z,re),ue&&z.close(!1)},deflate:g.deflate||null,inflate:g.inflate||null};V.reset=function(z){V.version={major:n.Version.major,minor:n.Version.minor},V.record=null,V.session=null,V.peerCertificate=null,V.state={pending:null,current:null},V.expect=V.entity===n.ConnectionEnd.client?m:s,V.fragmented=null,V.records=[],V.open=!1,V.handshakes=0,V.handshaking=!1,V.isConnected=!1,V.fail=!(z||typeof z>"u"),V.input.clear(),V.tlsData.clear(),V.data.clear(),V.state.current=n.createConnectionState(V)},V.reset();var W=function(z,re){var ue=re.type-n.ContentType.change_cipher_spec,ye=G[z.entity][z.expect];ue in ye?ye[ue](z,re):n.handleUnexpected(z,re)},ae=function(z){var re=0,ue=z.input,ye=ue.length();if(ye<5)re=5-ye;else{z.record={type:ue.getByte(),version:{major:ue.getByte(),minor:ue.getByte()},length:ue.getInt16(),fragment:t.util.createBuffer(),ready:!1};var he=z.record.version.major===z.version.major;he&&z.session&&z.session.version&&(he=z.record.version.minor===z.version.minor),he||z.error(z,{message:"Incompatible TLS version.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.protocol_version}})}return re},se=function(z){var re=0,ue=z.input,ye=ue.length();if(ye<z.record.length)re=z.record.length-ye;else{z.record.fragment.putBytes(ue.getBytes(z.record.length)),ue.compact();var he=z.state.current.read;he.update(z,z.record)&&(z.fragmented!==null&&(z.fragmented.type===z.record.type?(z.fragmented.fragment.putBuffer(z.record.fragment),z.record=z.fragmented):z.error(z,{message:"Invalid fragmented record.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.unexpected_message}})),z.record.ready=!0)}return re};return V.handshake=function(z){if(V.entity!==n.ConnectionEnd.client)V.error(V,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(V.handshaking)V.error(V,{message:"Handshake already in progress.",fatal:!1});else{V.fail&&!V.open&&V.handshakes===0&&(V.fail=!1),V.handshaking=!0,z=z||"";var re=null;z.length>0&&(V.sessionCache&&(re=V.sessionCache.getSession(z)),re===null&&(z="")),z.length===0&&V.sessionCache&&(re=V.sessionCache.getSession(),re!==null&&(z=re.id)),V.session={id:z,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:t.md.md5.create(),sha1:t.md.sha1.create()},re&&(V.version=re.version,V.session.sp=re.sp),V.session.sp.client_random=n.createRandom().getBytes(),V.open=!0,n.queue(V,n.createRecord(V,{type:n.ContentType.handshake,data:n.createClientHello(V)})),n.flush(V)}},V.process=function(z){var re=0;return z&&V.input.putBytes(z),V.fail||(V.record!==null&&V.record.ready&&V.record.fragment.isEmpty()&&(V.record=null),V.record===null&&(re=ae(V)),!V.fail&&V.record!==null&&!V.record.ready&&(re=se(V)),!V.fail&&V.record!==null&&V.record.ready&&W(V,V.record)),re},V.prepare=function(z){return n.queue(V,n.createRecord(V,{type:n.ContentType.application_data,data:t.util.createBuffer(z)})),n.flush(V)},V.prepareHeartbeatRequest=function(z,re){return z instanceof t.util.ByteBuffer&&(z=z.bytes()),typeof re>"u"&&(re=z.length),V.expectedHeartbeatPayload=z,n.queue(V,n.createRecord(V,{type:n.ContentType.heartbeat,data:n.createHeartbeat(n.HeartbeatMessageType.heartbeat_request,z,re)})),n.flush(V)},V.close=function(z){if(!V.fail&&V.sessionCache&&V.session){var re={id:V.session.id,version:V.session.version,sp:V.session.sp};re.sp.keys=null,V.sessionCache.setSession(re.id,re)}V.open&&(V.open=!1,V.input.clear(),(V.isConnected||V.handshaking)&&(V.isConnected=V.handshaking=!1,n.queue(V,n.createAlert(V,{level:n.Alert.Level.warning,description:n.Alert.Description.close_notify})),n.flush(V)),V.closed(V)),V.reset(z)},V},i.exports=t.tls=t.tls||{};for(de in n)typeof n[de]!="function"&&(t.tls[de]=n[de]);var de;t.tls.prf_tls1=e,t.tls.hmac_sha1=r,t.tls.createSessionCache=n.createSessionCache,t.tls.createConnection=n.createConnection}),cc=pe((l,i)=>{var t=fe();Ft(),ls();var e=i.exports=t.tls;e.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(m){m.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,m.cipher_type=e.CipherType.block,m.enc_key_length=16,m.block_length=16,m.fixed_iv_length=16,m.record_iv_length=16,m.mac_algorithm=e.MACAlgorithm.hmac_sha1,m.mac_length=20,m.mac_key_length=20},initConnectionState:r},e.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(m){m.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,m.cipher_type=e.CipherType.block,m.enc_key_length=32,m.block_length=16,m.fixed_iv_length=16,m.record_iv_length=16,m.mac_algorithm=e.MACAlgorithm.hmac_sha1,m.mac_length=20,m.mac_key_length=20},initConnectionState:r};function r(m,h,I){var x=h.entity===t.tls.ConnectionEnd.client;m.read.cipherState={init:!1,cipher:t.cipher.createDecipher("AES-CBC",x?I.keys.server_write_key:I.keys.client_write_key),iv:x?I.keys.server_write_IV:I.keys.client_write_IV},m.write.cipherState={init:!1,cipher:t.cipher.createCipher("AES-CBC",x?I.keys.client_write_key:I.keys.server_write_key),iv:x?I.keys.client_write_IV:I.keys.server_write_IV},m.read.cipherFunction=c,m.write.cipherFunction=u,m.read.macLength=m.write.macLength=I.mac_length,m.read.macFunction=m.write.macFunction=e.hmac_sha1}function u(m,h){var I=!1,x=h.macFunction(h.macKey,h.sequenceNumber,m);m.fragment.putBytes(x),h.updateSequenceNumber();var A;m.version.minor===e.Versions.TLS_1_0.minor?A=h.cipherState.init?null:h.cipherState.iv:A=t.random.getBytesSync(16),h.cipherState.init=!0;var y=h.cipherState.cipher;return y.start({iv:A}),m.version.minor>=e.Versions.TLS_1_1.minor&&y.output.putBytes(A),y.update(m.fragment),y.finish(f)&&(m.fragment=y.output,m.length=m.fragment.length(),I=!0),I}function f(m,h,I){if(!I){var x=m-h.length()%m;h.fillWithByte(x-1,x)}return!0}function d(m,h,I){var x=!0;if(I){for(var A=h.length(),y=h.last(),T=A-1-y;T<A-1;++T)x=x&&h.at(T)==y;x&&h.truncate(y+1)}return x}function c(m,h){var I=!1,x;m.version.minor===e.Versions.TLS_1_0.minor?x=h.cipherState.init?null:h.cipherState.iv:x=m.fragment.getBytes(16),h.cipherState.init=!0;var A=h.cipherState.cipher;A.start({iv:x}),A.update(m.fragment),I=A.finish(d);var y=h.macLength,T=t.random.getBytesSync(y),b=A.output.length();b>=y?(m.fragment=A.output.getBytes(b-y),T=A.output.getBytes(y)):m.fragment=A.output.getBytes(),m.fragment=t.util.createBuffer(m.fragment),m.length=m.fragment.length();var S=h.macFunction(h.macKey,h.sequenceNumber,m);return h.updateSequenceNumber(),I=n(h.macKey,T,S)&&I,I}function n(m,h,I){var x=t.hmac.create();return x.start("SHA1",m),x.update(h),h=x.digest().getBytes(),x.start(null,null),x.update(I),I=x.digest().getBytes(),h===I}}),ps=pe((l,i)=>{var t=fe();wt(),ve();var e=i.exports=t.sha512=t.sha512||{};t.md.sha512=t.md.algorithms.sha512=e;var r=t.sha384=t.sha512.sha384=t.sha512.sha384||{};r.create=function(){return e.create("SHA-384")},t.md.sha384=t.md.algorithms.sha384=r,t.sha512.sha256=t.sha512.sha256||{create:function(){return e.create("SHA-512/256")}},t.md["sha512/256"]=t.md.algorithms["sha512/256"]=t.sha512.sha256,t.sha512.sha224=t.sha512.sha224||{create:function(){return e.create("SHA-512/224")}},t.md["sha512/224"]=t.md.algorithms["sha512/224"]=t.sha512.sha224,e.create=function(h){if(f||n(),typeof h>"u"&&(h="SHA-512"),!(h in c))throw new Error("Invalid SHA-512 algorithm: "+h);for(var I=c[h],x=null,A=t.util.createBuffer(),y=new Array(80),T=0;T<80;++T)y[T]=new Array(2);var b=64;switch(h){case"SHA-384":b=48;break;case"SHA-512/256":b=32;break;case"SHA-512/224":b=28;break}var S={algorithm:h.replace("-","").toLowerCase(),blockLength:128,digestLength:b,messageLength:0,fullMessageLength:null,messageLengthSize:16};return S.start=function(){S.messageLength=0,S.fullMessageLength=S.messageLength128=[];for(var s=S.messageLengthSize/4,E=0;E<s;++E)S.fullMessageLength.push(0);A=t.util.createBuffer(),x=new Array(I.length);for(var E=0;E<I.length;++E)x[E]=I[E].slice(0);return S},S.start(),S.update=function(s,E){E==="utf8"&&(s=t.util.encodeUtf8(s));var C=s.length;S.messageLength+=C,C=[C/4294967296>>>0,C>>>0];for(var _=S.fullMessageLength.length-1;_>=0;--_)S.fullMessageLength[_]+=C[1],C[1]=C[0]+(S.fullMessageLength[_]/4294967296>>>0),S.fullMessageLength[_]=S.fullMessageLength[_]>>>0,C[0]=C[1]/4294967296>>>0;return A.putBytes(s),m(x,y,A),(A.read>2048||A.length()===0)&&A.compact(),S},S.digest=function(){var s=t.util.createBuffer();s.putBytes(A.bytes());var E=S.fullMessageLength[S.fullMessageLength.length-1]+S.messageLengthSize,C=E&S.blockLength-1;s.putBytes(u.substr(0,S.blockLength-C));for(var _,k,v=S.fullMessageLength[0]*8,o=0;o<S.fullMessageLength.length-1;++o)_=S.fullMessageLength[o+1]*8,k=_/4294967296>>>0,v+=k,s.putInt32(v>>>0),v=_>>>0;s.putInt32(v);for(var a=new Array(x.length),o=0;o<x.length;++o)a[o]=x[o].slice(0);m(a,y,s);var w=t.util.createBuffer(),P;h==="SHA-512"?P=a.length:h==="SHA-384"?P=a.length-2:P=a.length-4;for(var o=0;o<P;++o)w.putInt32(a[o][0]),(o!==P-1||h!=="SHA-512/224")&&w.putInt32(a[o][1]);return w},S};var u=null,f=!1,d=null,c=null;function n(){u="\x80",u+=t.util.fillString("\0",128),d=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],c={},c["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],c["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],c["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],c["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],f=!0}function m(h,I,x){for(var A,y,T,b,S,s,E,C,_,k,v,o,a,w,P,K,D,H,G,q,j,Y,J,ee,ie,le,ge,Se,$,me,Z,we,de,g,U,L=x.length();L>=128;){for($=0;$<16;++$)I[$][0]=x.getInt32()>>>0,I[$][1]=x.getInt32()>>>0;for(;$<80;++$)we=I[$-2],me=we[0],Z=we[1],A=((me>>>19|Z<<13)^(Z>>>29|me<<3)^me>>>6)>>>0,y=((me<<13|Z>>>19)^(Z<<3|me>>>29)^(me<<26|Z>>>6))>>>0,g=I[$-15],me=g[0],Z=g[1],T=((me>>>1|Z<<31)^(me>>>8|Z<<24)^me>>>7)>>>0,b=((me<<31|Z>>>1)^(me<<24|Z>>>8)^(me<<25|Z>>>7))>>>0,de=I[$-7],U=I[$-16],Z=y+de[1]+b+U[1],I[$][0]=A+de[0]+T+U[0]+(Z/4294967296>>>0)>>>0,I[$][1]=Z>>>0;for(a=h[0][0],w=h[0][1],P=h[1][0],K=h[1][1],D=h[2][0],H=h[2][1],G=h[3][0],q=h[3][1],j=h[4][0],Y=h[4][1],J=h[5][0],ee=h[5][1],ie=h[6][0],le=h[6][1],ge=h[7][0],Se=h[7][1],$=0;$<80;++$)E=((j>>>14|Y<<18)^(j>>>18|Y<<14)^(Y>>>9|j<<23))>>>0,C=((j<<18|Y>>>14)^(j<<14|Y>>>18)^(Y<<23|j>>>9))>>>0,_=(ie^j&(J^ie))>>>0,k=(le^Y&(ee^le))>>>0,S=((a>>>28|w<<4)^(w>>>2|a<<30)^(w>>>7|a<<25))>>>0,s=((a<<4|w>>>28)^(w<<30|a>>>2)^(w<<25|a>>>7))>>>0,v=(a&P|D&(a^P))>>>0,o=(w&K|H&(w^K))>>>0,Z=Se+C+k+d[$][1]+I[$][1],A=ge+E+_+d[$][0]+I[$][0]+(Z/4294967296>>>0)>>>0,y=Z>>>0,Z=s+o,T=S+v+(Z/4294967296>>>0)>>>0,b=Z>>>0,ge=ie,Se=le,ie=J,le=ee,J=j,ee=Y,Z=q+y,j=G+A+(Z/4294967296>>>0)>>>0,Y=Z>>>0,G=D,q=H,D=P,H=K,P=a,K=w,Z=y+b,a=A+T+(Z/4294967296>>>0)>>>0,w=Z>>>0;Z=h[0][1]+w,h[0][0]=h[0][0]+a+(Z/4294967296>>>0)>>>0,h[0][1]=Z>>>0,Z=h[1][1]+K,h[1][0]=h[1][0]+P+(Z/4294967296>>>0)>>>0,h[1][1]=Z>>>0,Z=h[2][1]+H,h[2][0]=h[2][0]+D+(Z/4294967296>>>0)>>>0,h[2][1]=Z>>>0,Z=h[3][1]+q,h[3][0]=h[3][0]+G+(Z/4294967296>>>0)>>>0,h[3][1]=Z>>>0,Z=h[4][1]+Y,h[4][0]=h[4][0]+j+(Z/4294967296>>>0)>>>0,h[4][1]=Z>>>0,Z=h[5][1]+ee,h[5][0]=h[5][0]+J+(Z/4294967296>>>0)>>>0,h[5][1]=Z>>>0,Z=h[6][1]+le,h[6][0]=h[6][0]+ie+(Z/4294967296>>>0)>>>0,h[6][1]=Z>>>0,Z=h[7][1]+Se,h[7][0]=h[7][0]+ge+(Z/4294967296>>>0)>>>0,h[7][1]=Z>>>0,L-=128}}}),uc=pe(l=>{var i=fe();Tt();var t=i.asn1;l.privateKeyValidator={name:"PrivateKeyInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},l.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:t.Class.UNIVERSAL,type:t.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}}),lc=pe((l,i)=>{var t=fe();Hr(),yt(),ps(),ve();var e=uc(),r=e.publicKeyValidator,u=e.privateKeyValidator;typeof f>"u"&&(f=t.jsbn.BigInteger);var f,d=t.util.ByteBuffer,c=typeof __Buffer$>"u"?Uint8Array:__Buffer$;t.pki=t.pki||{},i.exports=t.pki.ed25519=t.ed25519=t.ed25519||{};var n=t.ed25519;n.constants={},n.constants.PUBLIC_KEY_BYTE_LENGTH=32,n.constants.PRIVATE_KEY_BYTE_LENGTH=64,n.constants.SEED_BYTE_LENGTH=32,n.constants.SIGN_BYTE_LENGTH=64,n.constants.HASH_BYTE_LENGTH=64,n.generateKeyPair=function(g){g=g||{};var U=g.seed;if(U===void 0)U=t.random.getBytesSync(n.constants.SEED_BYTE_LENGTH);else if(typeof U=="string"){if(U.length!==n.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+n.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(U instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');U=m({message:U,encoding:"binary"});for(var L=new c(n.constants.PUBLIC_KEY_BYTE_LENGTH),p=new c(n.constants.PRIVATE_KEY_BYTE_LENGTH),N=0;N<32;++N)p[N]=U[N];return E(L,p),{publicKey:L,privateKey:p}},n.privateKeyFromAsn1=function(g){var U={},L=[],p=t.asn1.validate(g,u,U,L);if(!p){var N=new Error("Invalid Key.");throw N.errors=L,N}var M=t.asn1.derToOid(U.privateKeyOid),V=t.oids.EdDSA25519;if(M!==V)throw new Error('Invalid OID "'+M+'"; OID must be "'+V+'".');var W=U.privateKey,ae=m({message:t.asn1.fromDer(W).value,encoding:"binary"});return{privateKeyBytes:ae}},n.publicKeyFromAsn1=function(g){var U={},L=[],p=t.asn1.validate(g,r,U,L);if(!p){var N=new Error("Invalid Key.");throw N.errors=L,N}var M=t.asn1.derToOid(U.publicKeyOid),V=t.oids.EdDSA25519;if(M!==V)throw new Error('Invalid OID "'+M+'"; OID must be "'+V+'".');var W=U.ed25519PublicKey;if(W.length!==n.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return m({message:W,encoding:"binary"})},n.publicKeyFromPrivateKey=function(g){g=g||{};var U=m({message:g.privateKey,encoding:"binary"});if(U.length!==n.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+n.constants.PRIVATE_KEY_BYTE_LENGTH);for(var L=new c(n.constants.PUBLIC_KEY_BYTE_LENGTH),p=0;p<L.length;++p)L[p]=U[32+p];return L},n.sign=function(g){g=g||{};var U=m(g),L=m({message:g.privateKey,encoding:"binary"});if(L.length===n.constants.SEED_BYTE_LENGTH){var p=n.generateKeyPair({seed:L});L=p.privateKey}else if(L.length!==n.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+n.constants.SEED_BYTE_LENGTH+" or "+n.constants.PRIVATE_KEY_BYTE_LENGTH);var N=new c(n.constants.SIGN_BYTE_LENGTH+U.length);C(N,U,U.length,L);for(var M=new c(n.constants.SIGN_BYTE_LENGTH),V=0;V<M.length;++V)M[V]=N[V];return M},n.verify=function(g){g=g||{};var U=m(g);if(g.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var L=m({message:g.signature,encoding:"binary"});if(L.length!==n.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+n.constants.SIGN_BYTE_LENGTH);var p=m({message:g.publicKey,encoding:"binary"});if(p.length!==n.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+n.constants.PUBLIC_KEY_BYTE_LENGTH);var N=new c(n.constants.SIGN_BYTE_LENGTH+U.length),M=new c(n.constants.SIGN_BYTE_LENGTH+U.length),V;for(V=0;V<n.constants.SIGN_BYTE_LENGTH;++V)N[V]=L[V];for(V=0;V<U.length;++V)N[V+n.constants.SIGN_BYTE_LENGTH]=U[V];return _(M,N,N.length,p)>=0};function m(g){var U=g.message;if(U instanceof Uint8Array||U instanceof c)return U;var L=g.encoding;if(U===void 0)if(g.md)U=g.md.digest().getBytes(),L="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof U=="string"&&!L)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof U=="string"){if(typeof __Buffer$<"u")return __Buffer$.from(U,L);U=new d(U,L)}else if(!(U instanceof d))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var p=new c(U.length()),N=0;N<p.length;++N)p[N]=U.at(N);return p}var h=$(),I=$([1]),x=$([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),A=$([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),y=$([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),T=$([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),b=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),S=$([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function s(g,U){var L=t.md.sha512.create(),p=new d(g);L.update(p.getBytes(U),"binary");var N=L.digest().getBytes();if(typeof __Buffer$<"u")return __Buffer$.from(N,"binary");for(var M=new c(n.constants.HASH_BYTE_LENGTH),V=0;V<64;++V)M[V]=N.charCodeAt(V);return M}function E(g,U){var L=[$(),$(),$(),$()],p,N=s(U,32);for(N[0]&=248,N[31]&=127,N[31]|=64,ee(L,N),w(g,L),p=0;p<32;++p)U[p+32]=g[p];return 0}function C(g,U,L,p){var N,M,V=new Float64Array(64),W=[$(),$(),$(),$()],ae=s(p,32);ae[0]&=248,ae[31]&=127,ae[31]|=64;var se=L+64;for(N=0;N<L;++N)g[64+N]=U[N];for(N=0;N<32;++N)g[32+N]=ae[32+N];var z=s(g.subarray(32),L+32);for(v(z),ee(W,z),w(g,W),N=32;N<64;++N)g[N]=p[N];var re=s(g,L+64);for(v(re),N=32;N<64;++N)V[N]=0;for(N=0;N<32;++N)V[N]=z[N];for(N=0;N<32;++N)for(M=0;M<32;M++)V[N+M]+=re[N]*ae[M];return k(g.subarray(32),V),se}function _(g,U,L,p){var N,M,V=new c(32),W=[$(),$(),$(),$()],ae=[$(),$(),$(),$()];if(M=-1,L<64||K(ae,p))return-1;for(N=0;N<L;++N)g[N]=U[N];for(N=0;N<32;++N)g[N+32]=p[N];var se=s(g,L);if(v(se),J(W,ae,se),ee(ae,U.subarray(32)),o(W,ae),w(V,W),L-=64,q(U,0,V,0)){for(N=0;N<L;++N)g[N]=0;return-1}for(N=0;N<L;++N)g[N]=U[N+64];return M=L,M}function k(g,U){var L,p,N,M;for(p=63;p>=32;--p){for(L=0,N=p-32,M=p-12;N<M;++N)U[N]+=L-16*U[p]*b[N-(p-32)],L=U[N]+128>>8,U[N]-=L*256;U[N]+=L,U[p]=0}for(L=0,N=0;N<32;++N)U[N]+=L-(U[31]>>4)*b[N],L=U[N]>>8,U[N]&=255;for(N=0;N<32;++N)U[N]-=L*b[N];for(p=0;p<32;++p)U[p+1]+=U[p]>>8,g[p]=U[p]&255}function v(g){for(var U=new Float64Array(64),L=0;L<64;++L)U[L]=g[L],g[L]=0;k(g,U)}function o(g,U){var L=$(),p=$(),N=$(),M=$(),V=$(),W=$(),ae=$(),se=$(),z=$();Z(L,g[1],g[0]),Z(z,U[1],U[0]),de(L,L,z),me(p,g[0],g[1]),me(z,U[0],U[1]),de(p,p,z),de(N,g[3],U[3]),de(N,N,A),de(M,g[2],U[2]),me(M,M,M),Z(V,p,L),Z(W,M,N),me(ae,M,N),me(se,p,L),de(g[0],V,W),de(g[1],se,ae),de(g[2],ae,W),de(g[3],V,se)}function a(g,U,L){for(var p=0;p<4;++p)Se(g[p],U[p],L)}function w(g,U){var L=$(),p=$(),N=$();le(N,U[2]),de(L,U[0],N),de(p,U[1],N),P(g,p),g[31]^=Y(L)<<7}function P(g,U){var L,p,N,M=$(),V=$();for(L=0;L<16;++L)V[L]=U[L];for(ge(V),ge(V),ge(V),p=0;p<2;++p){for(M[0]=V[0]-65517,L=1;L<15;++L)M[L]=V[L]-65535-(M[L-1]>>16&1),M[L-1]&=65535;M[15]=V[15]-32767-(M[14]>>16&1),N=M[15]>>16&1,M[14]&=65535,Se(V,M,1-N)}for(L=0;L<16;L++)g[2*L]=V[L]&255,g[2*L+1]=V[L]>>8}function K(g,U){var L=$(),p=$(),N=$(),M=$(),V=$(),W=$(),ae=$();return ie(g[2],I),D(g[1],U),we(N,g[1]),de(M,N,x),Z(N,N,g[2]),me(M,g[2],M),we(V,M),we(W,V),de(ae,W,V),de(L,ae,N),de(L,L,M),H(L,L),de(L,L,N),de(L,L,M),de(L,L,M),de(g[0],L,M),we(p,g[0]),de(p,p,M),G(p,N)&&de(g[0],g[0],S),we(p,g[0]),de(p,p,M),G(p,N)?-1:(Y(g[0])===U[31]>>7&&Z(g[0],h,g[0]),de(g[3],g[0],g[1]),0)}function D(g,U){var L;for(L=0;L<16;++L)g[L]=U[2*L]+(U[2*L+1]<<8);g[15]&=32767}function H(g,U){var L=$(),p;for(p=0;p<16;++p)L[p]=U[p];for(p=250;p>=0;--p)we(L,L),p!==1&&de(L,L,U);for(p=0;p<16;++p)g[p]=L[p]}function G(g,U){var L=new c(32),p=new c(32);return P(L,g),P(p,U),q(L,0,p,0)}function q(g,U,L,p){return j(g,U,L,p,32)}function j(g,U,L,p,N){var M,V=0;for(M=0;M<N;++M)V|=g[U+M]^L[p+M];return(1&V-1>>>8)-1}function Y(g){var U=new c(32);return P(U,g),U[0]&1}function J(g,U,L){var p,N;for(ie(g[0],h),ie(g[1],I),ie(g[2],I),ie(g[3],h),N=255;N>=0;--N)p=L[N/8|0]>>(N&7)&1,a(g,U,p),o(U,g),o(g,g),a(g,U,p)}function ee(g,U){var L=[$(),$(),$(),$()];ie(L[0],y),ie(L[1],T),ie(L[2],I),de(L[3],y,T),J(g,L,U)}function ie(g,U){var L;for(L=0;L<16;L++)g[L]=U[L]|0}function le(g,U){var L=$(),p;for(p=0;p<16;++p)L[p]=U[p];for(p=253;p>=0;--p)we(L,L),p!==2&&p!==4&&de(L,L,U);for(p=0;p<16;++p)g[p]=L[p]}function ge(g){var U,L,p=1;for(U=0;U<16;++U)L=g[U]+p+65535,p=Math.floor(L/65536),g[U]=L-p*65536;g[0]+=p-1+37*(p-1)}function Se(g,U,L){for(var p,N=~(L-1),M=0;M<16;++M)p=N&(g[M]^U[M]),g[M]^=p,U[M]^=p}function $(g){var U,L=new Float64Array(16);if(g)for(U=0;U<g.length;++U)L[U]=g[U];return L}function me(g,U,L){for(var p=0;p<16;++p)g[p]=U[p]+L[p]}function Z(g,U,L){for(var p=0;p<16;++p)g[p]=U[p]-L[p]}function we(g,U){de(g,U,U)}function de(g,U,L){var p,N,M=0,V=0,W=0,ae=0,se=0,z=0,re=0,ue=0,ye=0,he=0,be=0,Ne=0,_e=0,Ae=0,Ce=0,Te=0,Le=0,Ye=0,ke=0,$e=0,Je=0,tt=0,rt=0,lt=0,gt=0,St=0,Nt=0,xt=0,jt=0,ar=0,Ir=0,xe=L[0],Ue=L[1],Pe=L[2],De=L[3],Oe=L[4],Ve=L[5],Ke=L[6],He=L[7],Me=L[8],Fe=L[9],Ge=L[10],qe=L[11],je=L[12],ze=L[13],Ie=L[14],Re=L[15];p=U[0],M+=p*xe,V+=p*Ue,W+=p*Pe,ae+=p*De,se+=p*Oe,z+=p*Ve,re+=p*Ke,ue+=p*He,ye+=p*Me,he+=p*Fe,be+=p*Ge,Ne+=p*qe,_e+=p*je,Ae+=p*ze,Ce+=p*Ie,Te+=p*Re,p=U[1],V+=p*xe,W+=p*Ue,ae+=p*Pe,se+=p*De,z+=p*Oe,re+=p*Ve,ue+=p*Ke,ye+=p*He,he+=p*Me,be+=p*Fe,Ne+=p*Ge,_e+=p*qe,Ae+=p*je,Ce+=p*ze,Te+=p*Ie,Le+=p*Re,p=U[2],W+=p*xe,ae+=p*Ue,se+=p*Pe,z+=p*De,re+=p*Oe,ue+=p*Ve,ye+=p*Ke,he+=p*He,be+=p*Me,Ne+=p*Fe,_e+=p*Ge,Ae+=p*qe,Ce+=p*je,Te+=p*ze,Le+=p*Ie,Ye+=p*Re,p=U[3],ae+=p*xe,se+=p*Ue,z+=p*Pe,re+=p*De,ue+=p*Oe,ye+=p*Ve,he+=p*Ke,be+=p*He,Ne+=p*Me,_e+=p*Fe,Ae+=p*Ge,Ce+=p*qe,Te+=p*je,Le+=p*ze,Ye+=p*Ie,ke+=p*Re,p=U[4],se+=p*xe,z+=p*Ue,re+=p*Pe,ue+=p*De,ye+=p*Oe,he+=p*Ve,be+=p*Ke,Ne+=p*He,_e+=p*Me,Ae+=p*Fe,Ce+=p*Ge,Te+=p*qe,Le+=p*je,Ye+=p*ze,ke+=p*Ie,$e+=p*Re,p=U[5],z+=p*xe,re+=p*Ue,ue+=p*Pe,ye+=p*De,he+=p*Oe,be+=p*Ve,Ne+=p*Ke,_e+=p*He,Ae+=p*Me,Ce+=p*Fe,Te+=p*Ge,Le+=p*qe,Ye+=p*je,ke+=p*ze,$e+=p*Ie,Je+=p*Re,p=U[6],re+=p*xe,ue+=p*Ue,ye+=p*Pe,he+=p*De,be+=p*Oe,Ne+=p*Ve,_e+=p*Ke,Ae+=p*He,Ce+=p*Me,Te+=p*Fe,Le+=p*Ge,Ye+=p*qe,ke+=p*je,$e+=p*ze,Je+=p*Ie,tt+=p*Re,p=U[7],ue+=p*xe,ye+=p*Ue,he+=p*Pe,be+=p*De,Ne+=p*Oe,_e+=p*Ve,Ae+=p*Ke,Ce+=p*He,Te+=p*Me,Le+=p*Fe,Ye+=p*Ge,ke+=p*qe,$e+=p*je,Je+=p*ze,tt+=p*Ie,rt+=p*Re,p=U[8],ye+=p*xe,he+=p*Ue,be+=p*Pe,Ne+=p*De,_e+=p*Oe,Ae+=p*Ve,Ce+=p*Ke,Te+=p*He,Le+=p*Me,Ye+=p*Fe,ke+=p*Ge,$e+=p*qe,Je+=p*je,tt+=p*ze,rt+=p*Ie,lt+=p*Re,p=U[9],he+=p*xe,be+=p*Ue,Ne+=p*Pe,_e+=p*De,Ae+=p*Oe,Ce+=p*Ve,Te+=p*Ke,Le+=p*He,Ye+=p*Me,ke+=p*Fe,$e+=p*Ge,Je+=p*qe,tt+=p*je,rt+=p*ze,lt+=p*Ie,gt+=p*Re,p=U[10],be+=p*xe,Ne+=p*Ue,_e+=p*Pe,Ae+=p*De,Ce+=p*Oe,Te+=p*Ve,Le+=p*Ke,Ye+=p*He,ke+=p*Me,$e+=p*Fe,Je+=p*Ge,tt+=p*qe,rt+=p*je,lt+=p*ze,gt+=p*Ie,St+=p*Re,p=U[11],Ne+=p*xe,_e+=p*Ue,Ae+=p*Pe,Ce+=p*De,Te+=p*Oe,Le+=p*Ve,Ye+=p*Ke,ke+=p*He,$e+=p*Me,Je+=p*Fe,tt+=p*Ge,rt+=p*qe,lt+=p*je,gt+=p*ze,St+=p*Ie,Nt+=p*Re,p=U[12],_e+=p*xe,Ae+=p*Ue,Ce+=p*Pe,Te+=p*De,Le+=p*Oe,Ye+=p*Ve,ke+=p*Ke,$e+=p*He,Je+=p*Me,tt+=p*Fe,rt+=p*Ge,lt+=p*qe,gt+=p*je,St+=p*ze,Nt+=p*Ie,xt+=p*Re,p=U[13],Ae+=p*xe,Ce+=p*Ue,Te+=p*Pe,Le+=p*De,Ye+=p*Oe,ke+=p*Ve,$e+=p*Ke,Je+=p*He,tt+=p*Me,rt+=p*Fe,lt+=p*Ge,gt+=p*qe,St+=p*je,Nt+=p*ze,xt+=p*Ie,jt+=p*Re,p=U[14],Ce+=p*xe,Te+=p*Ue,Le+=p*Pe,Ye+=p*De,ke+=p*Oe,$e+=p*Ve,Je+=p*Ke,tt+=p*He,rt+=p*Me,lt+=p*Fe,gt+=p*Ge,St+=p*qe,Nt+=p*je,xt+=p*ze,jt+=p*Ie,ar+=p*Re,p=U[15],Te+=p*xe,Le+=p*Ue,Ye+=p*Pe,ke+=p*De,$e+=p*Oe,Je+=p*Ve,tt+=p*Ke,rt+=p*He,lt+=p*Me,gt+=p*Fe,St+=p*Ge,Nt+=p*qe,xt+=p*je,jt+=p*ze,ar+=p*Ie,Ir+=p*Re,M+=38*Le,V+=38*Ye,W+=38*ke,ae+=38*$e,se+=38*Je,z+=38*tt,re+=38*rt,ue+=38*lt,ye+=38*gt,he+=38*St,be+=38*Nt,Ne+=38*xt,_e+=38*jt,Ae+=38*ar,Ce+=38*Ir,N=1,p=M+N+65535,N=Math.floor(p/65536),M=p-N*65536,p=V+N+65535,N=Math.floor(p/65536),V=p-N*65536,p=W+N+65535,N=Math.floor(p/65536),W=p-N*65536,p=ae+N+65535,N=Math.floor(p/65536),ae=p-N*65536,p=se+N+65535,N=Math.floor(p/65536),se=p-N*65536,p=z+N+65535,N=Math.floor(p/65536),z=p-N*65536,p=re+N+65535,N=Math.floor(p/65536),re=p-N*65536,p=ue+N+65535,N=Math.floor(p/65536),ue=p-N*65536,p=ye+N+65535,N=Math.floor(p/65536),ye=p-N*65536,p=he+N+65535,N=Math.floor(p/65536),he=p-N*65536,p=be+N+65535,N=Math.floor(p/65536),be=p-N*65536,p=Ne+N+65535,N=Math.floor(p/65536),Ne=p-N*65536,p=_e+N+65535,N=Math.floor(p/65536),_e=p-N*65536,p=Ae+N+65535,N=Math.floor(p/65536),Ae=p-N*65536,p=Ce+N+65535,N=Math.floor(p/65536),Ce=p-N*65536,p=Te+N+65535,N=Math.floor(p/65536),Te=p-N*65536,M+=N-1+37*(N-1),N=1,p=M+N+65535,N=Math.floor(p/65536),M=p-N*65536,p=V+N+65535,N=Math.floor(p/65536),V=p-N*65536,p=W+N+65535,N=Math.floor(p/65536),W=p-N*65536,p=ae+N+65535,N=Math.floor(p/65536),ae=p-N*65536,p=se+N+65535,N=Math.floor(p/65536),se=p-N*65536,p=z+N+65535,N=Math.floor(p/65536),z=p-N*65536,p=re+N+65535,N=Math.floor(p/65536),re=p-N*65536,p=ue+N+65535,N=Math.floor(p/65536),ue=p-N*65536,p=ye+N+65535,N=Math.floor(p/65536),ye=p-N*65536,p=he+N+65535,N=Math.floor(p/65536),he=p-N*65536,p=be+N+65535,N=Math.floor(p/65536),be=p-N*65536,p=Ne+N+65535,N=Math.floor(p/65536),Ne=p-N*65536,p=_e+N+65535,N=Math.floor(p/65536),_e=p-N*65536,p=Ae+N+65535,N=Math.floor(p/65536),Ae=p-N*65536,p=Ce+N+65535,N=Math.floor(p/65536),Ce=p-N*65536,p=Te+N+65535,N=Math.floor(p/65536),Te=p-N*65536,M+=N-1+37*(N-1),g[0]=M,g[1]=V,g[2]=W,g[3]=ae,g[4]=se,g[5]=z,g[6]=re,g[7]=ue,g[8]=ye,g[9]=he,g[10]=be,g[11]=Ne,g[12]=_e,g[13]=Ae,g[14]=Ce,g[15]=Te}}),pc=pe((l,i)=>{var t=fe();ve(),yt(),Hr(),i.exports=t.kem=t.kem||{};var e=t.jsbn.BigInteger;t.kem.rsa={},t.kem.rsa.create=function(u,f){f=f||{};var d=f.prng||t.random,c={};return c.encrypt=function(n,m){var h=Math.ceil(n.n.bitLength()/8),I;do I=new e(t.util.bytesToHex(d.getBytesSync(h)),16).mod(n.n);while(I.compareTo(e.ONE)<=0);I=t.util.hexToBytes(I.toString(16));var x=h-I.length;x>0&&(I=t.util.fillString("\0",x)+I);var A=n.encrypt(I,"NONE"),y=u.generate(I,m);return{encapsulation:A,key:y}},c.decrypt=function(n,m,h){var I=n.decrypt(m,"NONE");return u.generate(I,h)},c},t.kem.kdf1=function(u,f){r(this,u,0,f||u.digestLength)},t.kem.kdf2=function(u,f){r(this,u,1,f||u.digestLength)};function r(u,f,d,c){u.generate=function(n,m){for(var h=new t.util.ByteBuffer,I=Math.ceil(m/c)+d,x=new t.util.ByteBuffer,A=d;A<I;++A){x.putInt32(A),f.start(),f.update(n+x.getBytes());var y=f.digest();h.putBytes(y.getBytes(c))}return h.truncate(h.length()-m),h.getBytes()}}}),hc=pe((l,i)=>{var t=fe();ve(),i.exports=t.log=t.log||{},t.log.levels=["none","error","warning","info","debug","verbose","max"];var e={},r=[],u=null;for(t.log.LEVEL_LOCKED=2,t.log.NO_LEVEL_CHECK=4,t.log.INTERPOLATE=8,c=0;c<t.log.levels.length;++c)f=t.log.levels[c],e[f]={index:c,name:f.toUpperCase()};var f,c;for(t.log.logMessage=function(A){for(var y=e[A.level].index,T=0;T<r.length;++T){var b=r[T];if(b.flags&t.log.NO_LEVEL_CHECK)b.f(A);else{var S=e[b.level].index;y<=S&&b.f(b,A)}}},t.log.prepareStandard=function(A){"standard"in A||(A.standard=e[A.level].name+" ["+A.category+"] "+A.message)},t.log.prepareFull=function(A){if(!("full"in A)){var y=[A.message];y=y.concat([]),A.full=t.util.format.apply(this,y)}},t.log.prepareStandardFull=function(A){"standardFull"in A||(t.log.prepareStandard(A),A.standardFull=A.standard)},d=["error","warning","info","debug","verbose"],c=0;c<d.length;++c)(function(A){t.log[A]=function(y,T){var b=Array.prototype.slice.call(arguments).slice(2),S={timestamp:new Date,level:A,category:y,message:T,arguments:b};t.log.logMessage(S)}})(d[c]);var d,c;t.log.makeLogger=function(A){var y={flags:0,f:A};return t.log.setLevel(y,"none"),y},t.log.setLevel=function(A,y){var T=!1;if(A&&!(A.flags&t.log.LEVEL_LOCKED))for(var b=0;b<t.log.levels.length;++b){var S=t.log.levels[b];if(y==S){A.level=y,T=!0;break}}return T},t.log.lock=function(A,y){typeof y>"u"||y?A.flags|=t.log.LEVEL_LOCKED:A.flags&=~t.log.LEVEL_LOCKED},t.log.addLogger=function(A){r.push(A)},typeof console<"u"&&"log"in console?(console.error&&console.warn&&console.info&&console.debug?(m={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},h=function(A,y){t.log.prepareStandard(y);var T=m[y.level],b=[y.standard];b=b.concat(y.arguments.slice()),T.apply(console,b)},n=t.log.makeLogger(h)):(h=function(A,y){t.log.prepareStandardFull(y),console.log(y.standardFull)},n=t.log.makeLogger(h)),t.log.setLevel(n,"debug"),t.log.addLogger(n),u=n):console={log:function(){}};var n,m,h;u!==null&&typeof window<"u"&&window.location&&(I=new URL(window.location.href).searchParams,I.has("console.level")&&t.log.setLevel(u,I.get("console.level").slice(-1)[0]),I.has("console.lock")&&(x=I.get("console.lock").slice(-1)[0],x=="true"&&t.log.lock(u)));var I,x;t.log.consoleLogger=u}),fc=pe((l,i)=>{i.exports=wt(),bn(),Er(),es(),ps()}),dc=pe((l,i)=>{var t=fe();Ft(),Tt(),Kr(),Gt(),tr(),ss(),yt(),ve(),Bn();var e=t.asn1,r=i.exports=t.pkcs7=t.pkcs7||{};r.messageFromPem=function(y){var T=t.pem.decode(y)[0];if(T.type!=="PKCS7"){var b=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw b.headerType=T.type,b}if(T.procType&&T.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var S=e.fromDer(T.body);return r.messageFromAsn1(S)},r.messageToPem=function(y,T){var b={type:"PKCS7",body:e.toDer(y.toAsn1()).getBytes()};return t.pem.encode(b,{maxline:T})},r.messageFromAsn1=function(y){var T={},b=[];if(!e.validate(y,r.asn1.contentInfoValidator,T,b)){var S=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw S.errors=b,S}var s=e.derToOid(T.contentType),E;switch(s){case t.pki.oids.envelopedData:E=r.createEnvelopedData();break;case t.pki.oids.encryptedData:E=r.createEncryptedData();break;case t.pki.oids.signedData:E=r.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+s+" is not (yet) supported.")}return E.fromAsn1(T.content.value[0]),E},r.createSignedData=function(){var y=null;return y={type:t.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(S){if(x(y,S,r.asn1.signedDataValidator),y.certificates=[],y.crls=[],y.digestAlgorithmIdentifiers=[],y.contentInfo=null,y.signerInfos=[],y.rawCapture.certificates)for(var s=y.rawCapture.certificates.value,E=0;E<s.length;++E)y.certificates.push(t.pki.certificateFromAsn1(s[E]))},toAsn1:function(){y.contentInfo||y.sign();for(var S=[],s=0;s<y.certificates.length;++s)S.push(t.pki.certificateToAsn1(y.certificates[s]));var E=[],C=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(y.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,y.digestAlgorithmIdentifiers),y.contentInfo])]);return S.length>0&&C.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,S)),E.length>0&&C.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,E)),C.value[0].value.push(e.create(e.Class.UNIVERSAL,e.Type.SET,!0,y.signerInfos)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(y.type).getBytes()),C])},addSigner:function(S){var s=S.issuer,E=S.serialNumber;if(S.certificate){var C=S.certificate;typeof C=="string"&&(C=t.pki.certificateFromPem(C)),s=C.issuer.attributes,E=C.serialNumber}var _=S.key;if(!_)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof _=="string"&&(_=t.pki.privateKeyFromPem(_));var k=S.digestAlgorithm||t.pki.oids.sha1;switch(k){case t.pki.oids.sha1:case t.pki.oids.sha256:case t.pki.oids.sha384:case t.pki.oids.sha512:case t.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+k)}var v=S.authenticatedAttributes||[];if(v.length>0){for(var o=!1,a=!1,w=0;w<v.length;++w){var P=v[w];if(!o&&P.type===t.pki.oids.contentType){if(o=!0,a)break;continue}if(!a&&P.type===t.pki.oids.messageDigest){if(a=!0,o)break;continue}}if(!o||!a)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}y.signers.push({key:_,version:1,issuer:s,serialNumber:E,digestAlgorithm:k,signatureAlgorithm:t.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:v,unauthenticatedAttributes:[]})},sign:function(S){if(S=S||{},(typeof y.content!="object"||y.contentInfo===null)&&(y.contentInfo=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes())]),"content"in y)){var s;y.content instanceof t.util.ByteBuffer?s=y.content.bytes():typeof y.content=="string"&&(s=t.util.encodeUtf8(y.content)),S.detached?y.detachedContent=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,s):y.contentInfo.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,s)]))}if(y.signers.length!==0){var E=T();b(E)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(S){typeof S=="string"&&(S=t.pki.certificateFromPem(S)),y.certificates.push(S)},addCertificateRevokationList:function(S){throw new Error("PKCS#7 CRL support not yet implemented.")}},y;function T(){for(var S={},s=0;s<y.signers.length;++s){var E=y.signers[s],C=E.digestAlgorithm;C in S||(S[C]=t.md[t.pki.oids[C]].create()),E.authenticatedAttributes.length===0?E.md=S[C]:E.md=t.md[t.pki.oids[C]].create()}y.digestAlgorithmIdentifiers=[];for(var C in S)y.digestAlgorithmIdentifiers.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(C).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]));return S}function b(S){var s;if(y.detachedContent?s=y.detachedContent:(s=y.contentInfo.value[1],s=s.value[0]),!s)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var E=e.derToOid(y.contentInfo.value[0].value),C=e.toDer(s);C.getByte(),e.getBerValueLength(C),C=C.getBytes();for(var _ in S)S[_].start().update(C);for(var k=new Date,v=0;v<y.signers.length;++v){var o=y.signers[v];if(o.authenticatedAttributes.length===0){if(E!==t.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{o.authenticatedAttributesAsn1=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var a=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[]),w=0;w<o.authenticatedAttributes.length;++w){var P=o.authenticatedAttributes[w];P.type===t.pki.oids.messageDigest?P.value=S[o.digestAlgorithm].digest():P.type===t.pki.oids.signingTime&&(P.value||(P.value=k)),a.value.push(h(P)),o.authenticatedAttributesAsn1.value.push(h(P))}C=e.toDer(a).getBytes(),o.md.start().update(C)}o.signature=o.key.sign(o.md,"RSASSA-PKCS1-V1_5")}y.signerInfos=m(y.signers)}},r.createEncryptedData=function(){var y=null;return y={type:t.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(T){x(y,T,r.asn1.encryptedDataValidator)},decrypt:function(T){T!==void 0&&(y.encryptedContent.key=T),A(y)}},y},r.createEnvelopedData=function(){var y=null;return y={type:t.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(T){var b=x(y,T,r.asn1.envelopedDataValidator);y.recipients=d(b.recipientInfos.value)},toAsn1:function(){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(y.type).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(y.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,c(y.recipients)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,I(y.encryptedContent))])])])},findRecipient:function(T){for(var b=T.issuer.attributes,S=0;S<y.recipients.length;++S){var s=y.recipients[S],E=s.issuer;if(s.serialNumber===T.serialNumber&&E.length===b.length){for(var C=!0,_=0;_<b.length;++_)if(E[_].type!==b[_].type||E[_].value!==b[_].value){C=!1;break}if(C)return s}}return null},decrypt:function(T,b){if(y.encryptedContent.key===void 0&&T!==void 0&&b!==void 0)switch(T.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:case t.pki.oids.desCBC:var S=b.decrypt(T.encryptedContent.content);y.encryptedContent.key=t.util.createBuffer(S);break;default:throw new Error("Unsupported asymmetric cipher, OID "+T.encryptedContent.algorithm)}A(y)},addRecipient:function(T){y.recipients.push({version:0,issuer:T.issuer.attributes,serialNumber:T.serialNumber,encryptedContent:{algorithm:t.pki.oids.rsaEncryption,key:T.publicKey}})},encrypt:function(T,b){if(y.encryptedContent.content===void 0){b=b||y.encryptedContent.algorithm,T=T||y.encryptedContent.key;var S,s,E;switch(b){case t.pki.oids["aes128-CBC"]:S=16,s=16,E=t.aes.createEncryptionCipher;break;case t.pki.oids["aes192-CBC"]:S=24,s=16,E=t.aes.createEncryptionCipher;break;case t.pki.oids["aes256-CBC"]:S=32,s=16,E=t.aes.createEncryptionCipher;break;case t.pki.oids["des-EDE3-CBC"]:S=24,s=8,E=t.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+b)}if(T===void 0)T=t.util.createBuffer(t.random.getBytes(S));else if(T.length()!=S)throw new Error("Symmetric key has wrong length; got "+T.length()+" bytes, expected "+S+".");y.encryptedContent.algorithm=b,y.encryptedContent.key=T,y.encryptedContent.parameter=t.util.createBuffer(t.random.getBytes(s));var C=E(T);if(C.start(y.encryptedContent.parameter.copy()),C.update(y.content),!C.finish())throw new Error("Symmetric encryption failed.");y.encryptedContent.content=C.output}for(var _=0;_<y.recipients.length;++_){var k=y.recipients[_];if(k.encryptedContent.content===void 0)switch(k.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:k.encryptedContent.content=k.encryptedContent.key.encrypt(y.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+k.encryptedContent.algorithm)}}}},y};function u(y){var T={},b=[];if(!e.validate(y,r.asn1.recipientInfoValidator,T,b)){var S=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw S.errors=b,S}return{version:T.version.charCodeAt(0),issuer:t.pki.RDNAttributesAsArray(T.issuer),serialNumber:t.util.createBuffer(T.serial).toHex(),encryptedContent:{algorithm:e.derToOid(T.encAlgorithm),parameter:T.encParameter?T.encParameter.value:void 0,content:T.encKey}}}function f(y){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(y.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:y.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(y.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(y.encryptedContent.algorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,y.encryptedContent.content)])}function d(y){for(var T=[],b=0;b<y.length;++b)T.push(u(y[b]));return T}function c(y){for(var T=[],b=0;b<y.length;++b)T.push(f(y[b]));return T}function n(y){var T=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(y.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:y.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(y.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(y.digestAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])]);if(y.authenticatedAttributesAsn1&&T.value.push(y.authenticatedAttributesAsn1),T.value.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(y.signatureAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])),T.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,y.signature)),y.unauthenticatedAttributes.length>0){for(var b=e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[]),S=0;S<y.unauthenticatedAttributes.length;++S){var s=y.unauthenticatedAttributes[S];b.values.push(h(s))}T.value.push(b)}return T}function m(y){for(var T=[],b=0;b<y.length;++b)T.push(n(y[b]));return T}function h(y){var T;if(y.type===t.pki.oids.contentType)T=e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(y.value).getBytes());else if(y.type===t.pki.oids.messageDigest)T=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,y.value.bytes());else if(y.type===t.pki.oids.signingTime){var b=new Date("1950-01-01T00:00:00Z"),S=new Date("2050-01-01T00:00:00Z"),s=y.value;if(typeof s=="string"){var E=Date.parse(s);isNaN(E)?s.length===13?s=e.utcTimeToDate(s):s=e.generalizedTimeToDate(s):s=new Date(E)}s>=b&&s<S?T=e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(s)):T=e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(s))}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(y.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[T])])}function I(y){return[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(y.algorithm).getBytes()),y.parameter?e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,y.parameter.getBytes()):void 0]),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,y.content.getBytes())])]}function x(y,T,b){var S={},s=[];if(!e.validate(T,b,S,s)){var E=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw E.errors=E,E}var C=e.derToOid(S.contentType);if(C!==t.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(S.encryptedContent){var _="";if(t.util.isArray(S.encryptedContent))for(var k=0;k<S.encryptedContent.length;++k){if(S.encryptedContent[k].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");_+=S.encryptedContent[k].value}else _=S.encryptedContent;y.encryptedContent={algorithm:e.derToOid(S.encAlgorithm),parameter:t.util.createBuffer(S.encParameter.value),content:t.util.createBuffer(_)}}if(S.content){var _="";if(t.util.isArray(S.content))for(var k=0;k<S.content.length;++k){if(S.content[k].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");_+=S.content[k].value}else _=S.content;y.content=t.util.createBuffer(_)}return y.version=S.version.charCodeAt(0),y.rawCapture=S,S}function A(y){if(y.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(y.content===void 0){var T;switch(y.encryptedContent.algorithm){case t.pki.oids["aes128-CBC"]:case t.pki.oids["aes192-CBC"]:case t.pki.oids["aes256-CBC"]:T=t.aes.createDecryptionCipher(y.encryptedContent.key);break;case t.pki.oids.desCBC:case t.pki.oids["des-EDE3-CBC"]:T=t.des.createDecryptionCipher(y.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+y.encryptedContent.algorithm)}if(T.start(y.encryptedContent.parameter),T.update(y.encryptedContent.content),!T.finish())throw new Error("Symmetric decryption failed.");y.content=T.output}}}),yc=pe((l,i)=>{var t=fe();Ft(),vr(),bn(),Er(),ve();var e=i.exports=t.ssh=t.ssh||{};e.privateKeyToPutty=function(d,c,n){n=n||"",c=c||"";var m="ssh-rsa",h=c===""?"none":"aes256-cbc",I="PuTTY-User-Key-File-2: "+m+`\r
`;I+="Encryption: "+h+`\r
`,I+="Comment: "+n+`\r
`;var x=t.util.createBuffer();u(x,m),r(x,d.e),r(x,d.n);var A=t.util.encode64(x.bytes(),64),y=Math.floor(A.length/66)+1;I+="Public-Lines: "+y+`\r
`,I+=A;var T=t.util.createBuffer();r(T,d.d),r(T,d.p),r(T,d.q),r(T,d.qInv);var b;if(!c)b=t.util.encode64(T.bytes(),64);else{var S=T.length()+16-1;S-=S%16;var s=f(T.bytes());s.truncate(s.length()-S+T.length()),T.putBuffer(s);var E=t.util.createBuffer();E.putBuffer(f("\0\0\0\0",c)),E.putBuffer(f("\0\0\0",c));var C=t.aes.createEncryptionCipher(E.truncate(8),"CBC");C.start(t.util.createBuffer().fillWithByte(0,16)),C.update(T.copy()),C.finish();var _=C.output;_.truncate(16),b=t.util.encode64(_.bytes(),64)}y=Math.floor(b.length/66)+1,I+=`\r
Private-Lines: `+y+`\r
`,I+=b;var k=f("putty-private-key-file-mac-key",c),v=t.util.createBuffer();u(v,m),u(v,h),u(v,n),v.putInt32(x.length()),v.putBuffer(x),v.putInt32(T.length()),v.putBuffer(T);var o=t.hmac.create();return o.start("sha1",k),o.update(v.bytes()),I+=`\r
Private-MAC: `+o.digest().toHex()+`\r
`,I},e.publicKeyToOpenSSH=function(d,c){var n="ssh-rsa";c=c||"";var m=t.util.createBuffer();return u(m,n),r(m,d.e),r(m,d.n),n+" "+t.util.encode64(m.bytes())+" "+c},e.privateKeyToOpenSSH=function(d,c){return c?t.pki.encryptRsaPrivateKey(d,c,{legacy:!0,algorithm:"aes128"}):t.pki.privateKeyToPem(d)},e.getPublicKeyFingerprint=function(d,c){c=c||{};var n=c.md||t.md.md5.create(),m="ssh-rsa",h=t.util.createBuffer();u(h,m),r(h,d.e),r(h,d.n),n.start(),n.update(h.getBytes());var I=n.digest();if(c.encoding==="hex"){var x=I.toHex();return c.delimiter?x.match(/.{2}/g).join(c.delimiter):x}else{if(c.encoding==="binary")return I.getBytes();if(c.encoding)throw new Error('Unknown encoding "'+c.encoding+'".')}return I};function r(d,c){var n=c.toString(16);n[0]>="8"&&(n="00"+n);var m=t.util.hexToBytes(n);d.putInt32(m.length),d.putBytes(m)}function u(d,c){d.putInt32(c.length),d.putString(c)}function f(){for(var d=t.md.sha1.create(),c=arguments.length,n=0;n<c;++n)d.update(arguments[n]);return d.digest()}}),gc=pe((l,i)=>{i.exports=fe(),Ft(),cc(),Tt(),Sn(),Kr(),lc(),vr(),pc(),hc(),fc(),os(),An(),tr(),ns(),cs(),dc(),us(),as(),ts(),In(),yt(),rs(),yc(),ls(),ve()}),Cn=ic(gc()),{options:mc}=Cn,hs=Cn.default??Cn});var fs={};Kn(fs,{default:()=>hs,options:()=>mc});var ds=Jr(()=>{En();wn();wn()});var Xe={PROVIDER:"eip6963:requestProvider",ACCOUNTS:"eth_accounts",ACCOUNTS2:"eth_requestAccounts",UPGRADE:"upgrade",RSA_SIGN:"rsa_signatureRequest",ECDSA_SIGN:"ecdsa_signatureRequest",ETH_SIGN:"eth_sign",ETH_SEND:"eth_sendTransaction",PERSONAL_SIGN:"personal_sign",SIGN_TYPED_V1:"eth_signTypedData_v1",SIGN_TYPED_V3:"eth_signTypedData_v3",SIGN_TYPED_V4:"eth_signTypedData_v4",SEND_RAW_TX:"eth_sendRawTransaction",ACTION:"model_action"};var Hn="test";var Zs=[{id:"0x66eee",name:"Arbitrum Sepolia",nativeCurrency:{name:"Arbitrum Sepolia Ether",symbol:"ETH",decimals:18},rpcUrl:"https://sepolia-rollup.arbitrum.io/rpc"},{id:"0x14a34",name:"Base Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrl:"https://sepolia.base.org"},{id:"0xaa36a7",name:"Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrl:"https://sepolia.drpc.org"},{id:"0xaa37dc",name:"OP Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrl:"https://sepolia.optimism.io"}],_r=Hn=="test"?Zs:[{id:"0xa4b1",name:"Arbitrum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrl:"https://arb1.arbitrum.io/rpc",tokens:{link:"0xf97f4df75117a78c1A5a0DBb814Af92458539FB4"},contracts:{CCIPDirectory:{router:"0x141fa059441E0ca23ce184B6A78bafD2A517DdE8"},AutomationDirectory:{registry:"0x37D9dC70bfcd8BC77Ec2858836B923c560E891D1",registrar:"0x86EFBD0b6736Bed994962f9797049422A3A8E8Ad"}}},{id:"0x2105",name:"Base",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrl:"https://mainnet.base.org",tokens:{link:"0x88Fb150BDc53A65fe94Dea0c9BA0a6dAf8C6e196"},contracts:{CCIPDirectory:{router:"0x881e3A65B4d4a04dD529061dd0071cf975F58bCD"},AutomationDirectory:{registry:"0xf4bAb6A129164aBa9B113cB96BA4266dF49f8743",registrar:"0xE28Adc50c7551CFf69FCF32D45d037e5F6554264"}}},{id:"0xa",name:"OP Mainnet",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrl:"https://mainnet.optimism.io",tokens:{link:"0x350a791Bfc2C21F9Ed5d10980Dad2e2638ffa7f6",WETH:"0x4200000000000000000000000000000000000006"},contracts:{CCIPDirectory:{router:"0x3206695CaE29952f4b0c22a169725a865bc8Ce0f"},AutomationDirectory:{registry:"0x4F70c323b8B72AeffAF633Aa4D5e8B6Be5df4AEf",registrar:"0xe96057F85510292231e2C759752f012C87A8c8dd"}}}],eo=Hn=="test"?"0x14a34":"0x2105",Ic=_r.find(l=>l.id==eo)??{name:"base",id:"0x2105",rpcUrl:"https://mainnet.base.org"};var ir=class{constructor(i){this.options=i}db=null;log(...i){console.log(`[db-${this.options.dbName}/${this.options.storeName}]`,...i)}async connect(){return this.db?(this.log("Using cached connection"),this.db):new Promise((i,t)=>{this.log("Opening database...");let e=indexedDB.open(this.options.dbName,this.options.version||1);e.onupgradeneeded=r=>{this.log("Upgrading database...");let u=r.target.result;u.objectStoreNames.contains(this.options.storeName)||(u.createObjectStore(this.options.storeName,{keyPath:this.options.keyPath}),this.log(`Object store "${this.options.storeName}" created`))},e.onsuccess=()=>{this.db=e.result,i(this.db)},e.onerror=()=>{this.log("Error opening database:",e.error),t(e.error)}})}async getStore(i){return(await this.connect()).transaction(this.options.storeName,i).objectStore(this.options.storeName)}async put(i){this.log("Saving record:",i);let t=await this.getStore("readwrite");return new Promise((e,r)=>{let u=t.put(i);u.onsuccess=()=>{this.log("Record saved"),e()},u.onerror=()=>{this.log("Error saving record:",u.error),r(u.error)}})}async get(i){this.log("Fetching record by key:",i);let t=await this.getStore("readonly");return new Promise((e,r)=>{let u=t.get(i);u.onsuccess=()=>{this.log("Record fetched"),e(u.result)},u.onerror=()=>{this.log("Error fetching record:",u.error),r(u.error)}})}async getAll(){this.log("Fetching all records");let i=await this.getStore("readonly");return new Promise((t,e)=>{let r=i.getAll();r.onsuccess=()=>{this.log("Fetched records"),t(r.result)},r.onerror=()=>{this.log("Error fetching all records:",r.error),e(r.error)}})}async delete(i){this.log("Deleting record with key:",i);let t=await this.getStore("readwrite");return new Promise((e,r)=>{let u=t.delete(i);u.onsuccess=()=>{this.log("Record deleted"),e()},u.onerror=()=>{this.log("Error deleting record:",u.error),r(u.error)}})}async clear(){this.log("Clearing object store...");let i=await this.getStore("readwrite");return new Promise((t,e)=>{let r=i.clear();r.onsuccess=()=>{this.log("All records cleared"),t()},r.onerror=()=>{this.log("Error clearing records:",r.error),e(r.error)}})}async update(i,t){this.log("Updating record:",i,t);let e=await this.getStore("readwrite");return new Promise((r,u)=>{let f=e.get(i);f.onsuccess=()=>{let d=f.result;if(!d){this.log("No record found to update"),u(new Error(`Record with key "${String(i)}" not found`));return}let c={...d,...t},n=e.put(c);n.onsuccess=()=>{this.log("Record updated"),r()},n.onerror=()=>{this.log("Error updating record:",n.error),u(n.error)}},f.onerror=()=>{this.log("Error fetching record for update:",f.error),u(f.error)}})}};var to={p:0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2fn,n:0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141n,h:1n,a:0n,b:7n,Gx:0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798n,Gy:0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8n},{p:Pt,n:Et,Gx:ro,Gy:no,b:zn}=to,at=32,Dt=64,Be=(l="")=>{throw new Error(l)},Qn=l=>typeof l=="bigint",Wn=l=>typeof l=="string",ao=l=>l instanceof Uint8Array||ArrayBuffer.isView(l)&&l.constructor.name==="Uint8Array",Vt=(l,i)=>!ao(l)||typeof i=="number"&&i>0&&l.length!==i?Be("Uint8Array expected"):l,Ot=l=>new Uint8Array(l),io=l=>Uint8Array.from(l),Yn=(l,i)=>l.toString(16).padStart(i,"0"),kr=l=>Array.from(Vt(l)).map(i=>Yn(i,2)).join(""),At={_0:48,_9:57,A:65,F:70,a:97,f:102},Mn=l=>{if(l>=At._0&&l<=At._9)return l-At._0;if(l>=At.A&&l<=At.F)return l-(At.A-10);if(l>=At.a&&l<=At.f)return l-(At.a-10)},an=l=>{let i="hex invalid";if(!Wn(l))return Be(i);let t=l.length,e=t/2;if(t%2)return Be(i);let r=Ot(e);for(let u=0,f=0;u<e;u++,f+=2){let d=Mn(l.charCodeAt(f)),c=Mn(l.charCodeAt(f+1));if(d===void 0||c===void 0)return Be(i);r[u]=d*16+c}return r},mt=(l,i)=>Vt(Wn(l)?an(l):io(Vt(l)),i),Xn=()=>globalThis?.crypto,so=()=>Xn()?.subtle??Be("crypto.subtle must be defined"),Kt=(...l)=>{let i=Ot(l.reduce((e,r)=>e+Vt(r).length,0)),t=0;return l.forEach(e=>{i.set(e,t),t+=e.length}),i},sn=(l=at)=>Xn().getRandomValues(Ot(l)),Wt=BigInt,ur=(l,i,t,e="bad number: out of range")=>Qn(l)&&i<=l&&l<t?l:Be(e),oe=(l,i=Pt)=>{let t=l%i;return t>=0n?t:i+t},ct=l=>oe(l,Et),lr=(l,i)=>{(l===0n||i<=0n)&&Be("no inverse n="+l+" mod="+i);let t=oe(l,i),e=i,r=0n,u=1n,f=1n,d=0n;for(;t!==0n;){let c=e/t,n=e%t,m=r-f*c,h=u-d*c;e=t,t=n,r=f,u=d,f=m,d=h}return e===1n?oe(r,i):Be("no inverse")},oo=l=>{let i=hr[l];return typeof i!="function"&&Be("hashes."+l+" not set"),i},Fn=l=>l instanceof Ht?l:Be("Point expected"),$n=l=>oe(oe(l*l)*l+zn),Gn=l=>ur(l,0n,Pt),or=l=>ur(l,1n,Pt),en=l=>ur(l,1n,Et),tn=l=>(l&1n)===0n,Qt=l=>Uint8Array.of(l),Jn=l=>Qt(tn(l)?2:3),co=l=>{let i=$n(or(l)),t=1n;for(let e=i,r=(Pt+1n)/4n;r>0n;r>>=1n)r&1n&&(t=t*e%Pt),e=e*e%Pt;return oe(t*t)===i?t:Be("sqrt invalid")},ot,Ht=(ot=class{px;py;pz;constructor(i,t,e){this.px=Gn(i),this.py=or(t),this.pz=Gn(e),Object.freeze(this)}static fromBytes(i){Vt(i);let t,e=i[0],r=i.subarray(1),u=Nr(r,0,at),f=i.length;if(f===at+1&&[2,3].includes(e)){let d=co(u),c=tn(d);tn(Wt(e))!==c&&(d=oe(-d)),t=new ot(u,d,1n)}return f===Dt+1&&e===4&&(t=new ot(u,Nr(r,at,Dt),1n)),t?t.assertValidity():Be("bad point: not on curve")}equals(i){let{px:t,py:e,pz:r}=this,{px:u,py:f,pz:d}=Fn(i),c=oe(t*d),n=oe(u*r),m=oe(e*d),h=oe(f*r);return c===n&&m===h}is0(){return this.equals(Ut)}negate(){return new ot(this.px,oe(-this.py),this.pz)}double(){return this.add(this)}add(i){let{px:t,py:e,pz:r}=this,{px:u,py:f,pz:d}=Fn(i),c=0n,n=zn,m=0n,h=0n,I=0n,x=oe(n*3n),A=oe(t*u),y=oe(e*f),T=oe(r*d),b=oe(t+e),S=oe(u+f);b=oe(b*S),S=oe(A+y),b=oe(b-S),S=oe(t+r);let s=oe(u+d);return S=oe(S*s),s=oe(A+T),S=oe(S-s),s=oe(e+r),m=oe(f+d),s=oe(s*m),m=oe(y+T),s=oe(s-m),I=oe(c*S),m=oe(x*T),I=oe(m+I),m=oe(y-I),I=oe(y+I),h=oe(m*I),y=oe(A+A),y=oe(y+A),T=oe(c*T),S=oe(x*S),y=oe(y+T),T=oe(A-T),T=oe(c*T),S=oe(S+T),A=oe(y*S),h=oe(h+A),A=oe(s*S),m=oe(b*m),m=oe(m-A),A=oe(b*y),I=oe(s*I),I=oe(I+A),new ot(m,h,I)}multiply(i,t=!0){if(!t&&i===0n)return Ut;if(en(i),i===1n)return this;if(this.equals(vt))return Eo(i).p;let e=Ut,r=vt;for(let u=this;i>0n;u=u.double(),i>>=1n)i&1n?e=e.add(u):t&&(r=r.add(u));return e}toAffine(){let{px:i,py:t,pz:e}=this;if(this.equals(Ut))return{x:0n,y:0n};if(e===1n)return{x:i,y:t};let r=lr(e,Pt);return oe(e*r)!==1n&&Be("inverse invalid"),{x:oe(i*r),y:oe(t*r)}}assertValidity(){let{x:i,y:t}=this.toAffine();return or(i),or(t),oe(t*t)===$n(i)?this:Be("bad point: not on curve")}toBytes(i=!0){let{x:t,y:e}=this.assertValidity().toAffine(),r=Lt(t);return i?Kt(Jn(e),r):Kt(Qt(4),r,Lt(e))}static fromAffine(i){let{x:t,y:e}=i;return t===0n&&e===0n?Ut:new ot(t,e,1n)}toHex(i){return kr(this.toBytes(i))}static fromPrivateKey(i){return vt.multiply(cr(i))}static fromHex(i){return ot.fromBytes(mt(i))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}toRawBytes(i){return this.toBytes(i)}},Zr(ot,"BASE"),Zr(ot,"ZERO"),ot),vt=new Ht(ro,no,1n),Ut=new Ht(0n,1n,0n);Ht.BASE=vt;Ht.ZERO=Ut;var Zn=(l,i,t)=>vt.multiply(i,!1).add(l.multiply(t,!1)).assertValidity(),pr=l=>Wt("0x"+(kr(l)||"0")),Nr=(l,i,t)=>pr(l.subarray(i,t)),uo=2n**256n,Lt=l=>an(Yn(ur(l,0n,uo),Dt)),cr=l=>{let i=Qn(l)?l:pr(mt(l,at));return ur(i,1n,Et,"private key invalid 3")},Rr=l=>l>Et>>1n,Yt=(l,i=!0)=>vt.multiply(cr(l)).toBytes(i),rn=class sr{r;s;recovery;constructor(i,t,e){this.r=en(i),this.s=en(t),e!=null&&(this.recovery=e),Object.freeze(this)}static fromBytes(i){Vt(i,Dt);let t=Nr(i,0,at),e=Nr(i,at,Dt);return new sr(t,e)}toBytes(){let{r:i,s:t}=this;return Kt(Lt(i),Lt(t))}addRecoveryBit(i){return new sr(this.r,this.s,i)}hasHighS(){return Rr(this.s)}toCompactRawBytes(){return this.toBytes()}toCompactHex(){return kr(this.toBytes())}recoverPublicKey(i){return fo(this,i)}static fromCompact(i){return sr.fromBytes(mt(i,Dt))}assertValidity(){return this}normalizeS(){let{r:i,s:t,recovery:e}=this;return Rr(t)?new sr(i,ct(-t),e):this}},ea=l=>{let i=l.length*8-256;i>1024&&Be("msg invalid");let t=pr(l);return i>0?t>>Wt(i):t},on=l=>ct(ea(Vt(l))),ta={lowS:!0},lo={lowS:!0},po=(l,i,t=ta)=>{["der","recovered","canonical"].some(I=>I in t)&&Be("option not supported");let{lowS:e,extraEntropy:r}=t;e==null&&(e=!0);let u=Lt,f=on(mt(l)),d=u(f),c=cr(i),n=[u(c),d];r&&n.push(r===!0?sn(at):mt(r));let m=f,h=I=>{let x=ea(I);if(!(1n<=x&&x<Et))return;let A=vt.multiply(x).toAffine(),y=ct(A.x);if(y===0n)return;let T=lr(x,Et),b=ct(T*ct(m+ct(c*y)));if(b===0n)return;let S=b,s=(A.x===y?0:2)|Number(A.y&1n);return e&&Rr(b)&&(S=ct(-b),s^=1),new rn(y,S,s)};return{seed:Kt(...n),k2sig:h}},ho=l=>{let i=Ot(at),t=Ot(at),e=0,r=Ot(0),u=()=>{i.fill(1),t.fill(0),e=0},f=1e3,d="drbg: tried 1000 values";if(l){let c=(...h)=>hr.hmacSha256Async(t,i,...h),n=async(h=r)=>{t=await c(Qt(0),h),i=await c(),h.length!==0&&(t=await c(Qt(1),h),i=await c())},m=async()=>(e++>=f&&Be(d),i=await c(),i);return async(h,I)=>{u(),await n(h);let x;for(;!(x=I(await m()));)await n();return u(),x}}else{let c=(...h)=>oo("hmacSha256Sync")(t,i,...h),n=(h=r)=>{t=c(Qt(0),h),i=c(),h.length!==0&&(t=c(Qt(1),h),i=c())},m=()=>(e++>=f&&Be(d),i=c(),i);return(h,I)=>{u(),n(h);let x;for(;!(x=I(m()));)n();return u(),x}}};var cn=(l,i,t=ta)=>{let{seed:e,k2sig:r}=po(l,i,t);return ho(!1)(e,r)},xr=(l,i,t,e=lo)=>{let{lowS:r}=e;r==null&&(r=!0),"strict"in e&&Be("option not supported");let u,f=l&&typeof l=="object"&&"r"in l;!f&&mt(l).length!==Dt&&Be("signature must be 64 bytes");try{u=f?new rn(l.r,l.s):rn.fromCompact(l);let d=on(mt(i)),c=Ht.fromBytes(mt(t)),{r:n,s:m}=u;if(r&&Rr(m))return!1;let h=lr(m,Et),I=ct(d*h),x=ct(n*h),A=Zn(c,I,x).toAffine();return ct(A.x)===n}catch{return!1}},fo=(l,i)=>{let{r:t,s:e,recovery:r}=l;[0,1,2,3].includes(r)||Be("recovery id invalid");let u=on(mt(i,at)),f=r===2||r===3?t+Et:t;or(f);let d=Jn(Wt(r)),c=Kt(d,Lt(f)),n=Ht.fromBytes(c),m=lr(f,Et),h=ct(-u*m),I=ct(e*m);return Zn(n,h,I)};var ra=l=>{l=mt(l),(l.length<at+8||l.length>1024)&&Be("expected 40-1024b");let i=oe(pr(l),Et-1n);return Lt(i+1n)},yo=()=>ra(sn(at+16)),go="SHA-256",hr={hexToBytes:an,bytesToHex:kr,concatBytes:Kt,bytesToNumberBE:pr,numberToBytesBE:Lt,mod:oe,invert:lr,hmacSha256Async:async(l,...i)=>{let t=so(),e="HMAC",r=await t.importKey("raw",l,{name:e,hash:{name:go}},!1,["sign"]);return Ot(await t.sign(e,r,Kt(...i)))},hmacSha256Sync:void 0,hashToPrivateKey:ra,randomBytes:sn},na={normPrivateKeyToScalar:cr,isValidPrivateKey:l=>{try{return!!cr(l)}catch{return!1}},randomPrivateKey:yo,precompute:(l=8,i=vt)=>(i.multiply(3n),i)},Lr=8,mo=256,aa=Math.ceil(mo/Lr)+1,nn=2**(Lr-1),vo=()=>{let l=[],i=vt,t=i;for(let e=0;e<aa;e++){t=i,l.push(t);for(let r=1;r<nn;r++)t=t.add(i),l.push(t);i=t.double()}return l},qn,jn=(l,i)=>{let t=i.negate();return l?t:i},Eo=l=>{let i=qn||(qn=vo()),t=Ut,e=vt,r=2**Lr,u=r,f=Wt(r-1),d=Wt(Lr);for(let c=0;c<aa;c++){let n=Number(l&f);l>>=d,n>nn&&(n-=u,l+=1n);let m=c*nn,h=m,I=m+Math.abs(n)-1,x=c%2!==0,A=n<0;n===0?e=e.add(jn(x,i[h])):t=t.add(jn(A,i[I]))}return{p:t,f:e}};var Co=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function To(l){return l instanceof Uint8Array||ArrayBuffer.isView(l)&&l.constructor.name==="Uint8Array"}function Xt(l){if(!Number.isSafeInteger(l)||l<0)throw new Error("positive integer expected, got "+l)}function Ct(l,...i){if(!To(l))throw new Error("Uint8Array expected");if(i.length>0&&!i.includes(l.length))throw new Error("Uint8Array expected of length "+i+", got length="+l.length)}function ia(l){if(typeof l!="function"||typeof l.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Xt(l.outputLen),Xt(l.blockLen)}function Mt(l,i=!0){if(l.destroyed)throw new Error("Hash instance has been destroyed");if(i&&l.finished)throw new Error("Hash#digest() has already been called")}function un(l,i){Ct(l);let t=i.outputLen;if(l.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function sa(l){return new Uint32Array(l.buffer,l.byteOffset,Math.floor(l.byteLength/4))}function fr(...l){for(let i=0;i<l.length;i++)l[i].fill(0)}var So=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function bo(l){return l<<24&4278190080|l<<8&16711680|l>>>8&65280|l>>>24&255}function Ao(l){for(let i=0;i<l.length;i++)l[i]=bo(l[i]);return l}var ln=So?l=>l:Ao,Uc=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Pc=Array.from({length:256},(l,i)=>i.toString(16).padStart(2,"0"));function pn(l){if(typeof l!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(l))}function $t(l){return typeof l=="string"&&(l=pn(l)),Ct(l),l}function hn(...l){let i=0;for(let e=0;e<l.length;e++){let r=l[e];Ct(r),i+=r.length}let t=new Uint8Array(i);for(let e=0,r=0;e<l.length;e++){let u=l[e];t.set(u,r),r+=u.length}return t}var Ur=class{};function oa(l){let i=e=>l().update($t(e)).digest(),t=l();return i.outputLen=t.outputLen,i.blockLen=t.blockLen,i.create=()=>l(),i}function ca(l){let i=(e,r)=>l(r).update($t(e)).digest(),t=l({});return i.outputLen=t.outputLen,i.blockLen=t.blockLen,i.create=e=>l(e),i}var ua=class extends Ur{constructor(l,i){super(),this.finished=!1,this.destroyed=!1,ia(l);let t=$t(i);if(this.iHash=l.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let e=this.blockLen,r=new Uint8Array(e);r.set(t.length>e?l.create().update(t).digest():t);for(let u=0;u<r.length;u++)r[u]^=54;this.iHash.update(r),this.oHash=l.create();for(let u=0;u<r.length;u++)r[u]^=106;this.oHash.update(r),fr(r)}update(l){return Mt(this),this.iHash.update(l),this}digestInto(l){Mt(this),Ct(l,this.outputLen),this.finished=!0,this.iHash.digestInto(l),this.oHash.update(l),this.oHash.digestInto(l),this.destroy()}digest(){let l=new Uint8Array(this.oHash.outputLen);return this.digestInto(l),l}_cloneInto(l){l||(l=Object.create(Object.getPrototypeOf(this),{}));let{oHash:i,iHash:t,finished:e,destroyed:r,blockLen:u,outputLen:f}=this;return l=l,l.finished=e,l.destroyed=r,l.blockLen=u,l.outputLen=f,l.oHash=i._cloneInto(l.oHash),l.iHash=t._cloneInto(l.iHash),l}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},fn=(l,i,t)=>new ua(l,i).update(t).digest();fn.create=(l,i)=>new ua(l,i);var Pr=BigInt(4294967295),la=BigInt(32);function Io(l,i=!1){return i?{h:Number(l&Pr),l:Number(l>>la&Pr)}:{h:Number(l>>la&Pr)|0,l:Number(l&Pr)|0}}function Bo(l,i=!1){let t=l.length,e=new Uint32Array(t),r=new Uint32Array(t);for(let u=0;u<t;u++){let{h:f,l:d}=Io(l[u],i);[e[u],r[u]]=[f,d]}return[e,r]}var wo=(l,i,t)=>l<<t|i>>>32-t,_o=(l,i,t)=>i<<t|l>>>32-t,No=(l,i,t)=>i<<t-32|l>>>64-t,Ro=(l,i,t)=>l<<t-32|i>>>64-t,Lo=BigInt(0),dr=BigInt(1),ko=BigInt(2),xo=BigInt(7),Uo=BigInt(256),Po=BigInt(113),fa=[],da=[],ya=[];for(let l=0,i=dr,t=1,e=0;l<24;l++){[t,e]=[e,(2*t+3*e)%5],fa.push(2*(5*e+t)),da.push((l+1)*(l+2)/2%64);let r=Lo;for(let u=0;u<7;u++)i=(i<<dr^(i>>xo)*Po)%Uo,i&ko&&(r^=dr<<(dr<<BigInt(u))-dr);ya.push(r)}var ga=Bo(ya,!0),Do=ga[0],Oo=ga[1],pa=(l,i,t)=>t>32?No(l,i,t):wo(l,i,t),ha=(l,i,t)=>t>32?Ro(l,i,t):_o(l,i,t);function Vo(l,i=24){let t=new Uint32Array(10);for(let e=24-i;e<24;e++){for(let f=0;f<10;f++)t[f]=l[f]^l[f+10]^l[f+20]^l[f+30]^l[f+40];for(let f=0;f<10;f+=2){let d=(f+8)%10,c=(f+2)%10,n=t[c],m=t[c+1],h=pa(n,m,1)^t[d],I=ha(n,m,1)^t[d+1];for(let x=0;x<50;x+=10)l[f+x]^=h,l[f+x+1]^=I}let r=l[2],u=l[3];for(let f=0;f<24;f++){let d=da[f],c=pa(r,u,d),n=ha(r,u,d),m=fa[f];r=l[m],u=l[m+1],l[m]=c,l[m+1]=n}for(let f=0;f<50;f+=10){for(let d=0;d<10;d++)t[d]=l[f+d];for(let d=0;d<10;d++)l[f+d]^=~t[(d+2)%10]&t[(d+4)%10]}l[0]^=Do[e],l[1]^=Oo[e]}fr(t)}var ma=class va extends Ur{constructor(i,t,e,r=!1,u=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=i,this.suffix=t,this.outputLen=e,this.enableXOF=r,this.rounds=u,Xt(e),!(0<i&&i<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=sa(this.state)}clone(){return this._cloneInto()}keccak(){ln(this.state32),Vo(this.state32,this.rounds),ln(this.state32),this.posOut=0,this.pos=0}update(i){Mt(this),i=$t(i),Ct(i);let{blockLen:t,state:e}=this,r=i.length;for(let u=0;u<r;){let f=Math.min(t-this.pos,r-u);for(let d=0;d<f;d++)e[this.pos++]^=i[u++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:i,suffix:t,pos:e,blockLen:r}=this;i[e]^=t,t&128&&e===r-1&&this.keccak(),i[r-1]^=128,this.keccak()}writeInto(i){Mt(this,!1),Ct(i),this.finish();let t=this.state,{blockLen:e}=this;for(let r=0,u=i.length;r<u;){this.posOut>=e&&this.keccak();let f=Math.min(e-this.posOut,u-r);i.set(t.subarray(this.posOut,this.posOut+f),r),this.posOut+=f,r+=f}return i}xofInto(i){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(i)}xof(i){return Xt(i),this.xofInto(new Uint8Array(i))}digestInto(i){if(un(i,this),this.finished)throw new Error("digest() was already called");return this.writeInto(i),this.destroy(),i}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,fr(this.state)}_cloneInto(i){let{blockLen:t,suffix:e,outputLen:r,rounds:u,enableXOF:f}=this;return i||(i=new va(t,e,r,f,u)),i.state32.set(this.state32),i.pos=this.pos,i.posOut=this.posOut,i.finished=this.finished,i.rounds=u,i.suffix=e,i.outputLen=r,i.enableXOF=f,i.destroyed=this.destroyed,i}},kt=(l,i,t)=>oa(()=>new ma(i,l,t)),jc=kt(6,144,224/8),zc=kt(6,136,256/8),Qc=kt(6,104,384/8),Wc=kt(6,72,512/8),Ea=kt(1,144,224/8),yr=kt(1,136,256/8),Ca=kt(1,104,384/8),Ta=kt(1,72,512/8),Sa=(l,i,t)=>ca((e={})=>new ma(i,l,e.dkLen===void 0?t:e.dkLen,!0)),Yc=Sa(31,168,128/8),Xc=Sa(31,136,256/8);var Ko="ETHEREUMJS_DEFAULT_ERROR_CODE",Ho=class extends Error{constructor(l,i,t){super(i??l.code),this.type=l,t!==void 0&&(this.stack=t)}getMetadata(){return this.type}toObject(){return{type:this.getMetadata(),message:this.message??"",stack:this.stack??"",className:this.constructor.name}}};function Ze(l,i){return new Ho({code:Ko},l,i)}function ba(l){if(l[0]===0)throw Ze("invalid RLP: extra zeros");return Go(Fo(l))}function Aa(l,i){if(l<56)return Uint8Array.from([l+i]);let t=gn(l),e=t.length/2,r=gn(i+55+e);return Uint8Array.from(yn(r+t))}function Jt(l,i,t){if(t>l.length)throw Ze("invalid RLP (safeSlice): end slice of Uint8Array out-of-bounds");return l.slice(i,t)}function dn(l){let i,t,e,r,u,f=[],d=l[0];if(d<=127)return{data:l.slice(0,1),remainder:l.subarray(1)};if(d<=183){if(i=d-127,d===128?e=Uint8Array.from([]):e=Jt(l,1,i),i===2&&e[0]<128)throw Ze("invalid RLP encoding: invalid prefix, single byte < 0x80 are not prefixed");return{data:e,remainder:l.subarray(i)}}else if(d<=191){if(t=d-182,l.length-1<t)throw Ze("invalid RLP: not enough bytes for string length");if(i=ba(Jt(l,1,t)),i<=55)throw Ze("invalid RLP: expected string length to be greater than 55");return e=Jt(l,t,i+t),{data:e,remainder:l.subarray(i+t)}}else if(d<=247){for(i=d-191,r=Jt(l,1,i);r.length;)u=dn(r),f.push(u.data),r=u.remainder;return{data:f,remainder:l.subarray(i)}}else{if(t=d-246,i=ba(Jt(l,1,t)),i<56)throw Ze("invalid RLP: encoded list too short");let c=t+i;if(c>l.length)throw Ze("invalid RLP: total length is larger than the data");for(r=Jt(l,t,c);r.length;)u=dn(r),f.push(u.data),r=u.remainder;return{data:f,remainder:l.subarray(c)}}}var Mo=Array.from({length:256},(l,i)=>i.toString(16).padStart(2,"0"));function Fo(l){let i="";for(let t=0;t<l.length;t++)i+=Mo[l[t]];return i}function Go(l){let i=Number.parseInt(l,16);if(Number.isNaN(i))throw Ze("Invalid byte sequence");return i}var It={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function Ia(l){if(l>=It._0&&l<=It._9)return l-It._0;if(l>=It._A&&l<=It._F)return l-(It._A-10);if(l>=It._a&&l<=It._f)return l-(It._a-10)}function yn(l){if(l.slice(0,2)==="0x"&&(l=l.slice(0,2)),typeof l!="string")throw Ze("hex string expected, got "+typeof l);let i=l.length,t=i/2;if(i%2)throw Ze("padded hex string expected, got unpadded hex of length "+i);let e=new Uint8Array(t);for(let r=0,u=0;r<t;r++,u+=2){let f=Ia(l.charCodeAt(u)),d=Ia(l.charCodeAt(u+1));if(f===void 0||d===void 0){let c=l[u]+l[u+1];throw Ze('hex string expected, got non-hex character "'+c+'" at index '+u)}e[r]=f*16+d}return e}function Ba(...l){if(l.length===1)return l[0];let i=l.reduce((e,r)=>e+r.length,0),t=new Uint8Array(i);for(let e=0,r=0;e<l.length;e++){let u=l[e];t.set(u,r),r+=u.length}return t}function qo(l){return new TextEncoder().encode(l)}function gn(l){if(l<0)throw Ze("Invalid integer as argument, must be unsigned!");let i=l.toString(16);return i.length%2?`0${i}`:i}function jo(l){return l.length%2?`0${l}`:l}function wa(l){return l.length>=2&&l[0]==="0"&&l[1]==="x"}function zo(l){return typeof l!="string"?l:wa(l)?l.slice(2):l}function _a(l){if(l instanceof Uint8Array)return l;if(typeof l=="string")return wa(l)?yn(jo(zo(l))):qo(l);if(typeof l=="number"||typeof l=="bigint")return l?yn(gn(l)):Uint8Array.from([]);if(l==null)return Uint8Array.from([]);throw Ze("toBytes: received unsupported type "+typeof l)}function Na(l){if(Array.isArray(l)){let t=[],e=0;for(let r=0;r<l.length;r++){let u=Na(l[r]);t.push(u),e+=u.length}return Ba(Aa(e,192),...t)}let i=_a(l);return i.length===1&&i[0]<128?i:Ba(Aa(i.length,128),i)}function Qo(l,i=!1){if(typeof l>"u"||l===null||l.length===0)return Uint8Array.from([]);let t=_a(l),e=dn(t);if(i)return{data:e.data,remainder:e.remainder.slice()};if(e.remainder.length!==0)throw Ze("invalid RLP: remainder must be zero");return e.data}var Bt={encode:Na,decode:Qo};var iu=BigInt(0),su=BigInt(1);var ou=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",cu=Array.from({length:256},(l,i)=>i.toString(16).padStart(2,"0"));var Ra=Ct;function gr(l){return i=>(Ra(i),l(i))}var Su=gr(Ea),dt=(()=>{let l=gr(yr);return l.create=yr.create,l})(),bu=gr(Ca),Au=gr(Ta);var{randomPrivateKey:Mu}=na,{bytesToHex:Dr,hexToBytes:Fu}=hr;hr.hmacSha256Sync=(l,...i)=>fn(yr,l,hn(...i));var{subtle:Gu}=crypto;var Or=l=>btoa(String.fromCharCode(...l)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");var Vr=class{sign(i,t){return cn(i,t)}verify(i,t,e){let r=this.publicKeyFromPrivateKey(e),u=new Uint8Array(65);u[0]=4,u.set(r,1);let f=xr(i,t,u),d="0x"+Dr(dt(r).slice(-20));return{valid:f,address:d}}publicKeyFromPrivateKey(i){return Yt(i,!1).slice(1)}jwk(i){let t=Yt(i,!1).slice(1),e=t.slice(1,33),r=t.slice(33,65);return{kty:"EC",crv:"secp256k1",x:Or(e),y:Or(r),d:Or(i),ext:!0,key_ops:["sign","verify"]}}};var Zt=class extends EventTarget{id=0;chains=new Map;current={id:"",name:"",rpcUrl:""};constructor(i){super(),i.forEach(t=>this.chains.set(t.id,t)),this.current=i[0]}changeChain(i){let t=this.chains.get(i);if(!t)throw new Error(`Chain not supported: ${i}`);this.current=t}addChain(i){this.chains.set(i.id,i)}url(){return this.current.rpcUrl}on(i,t){this.addEventListener(i,t)}off(i,t){this.removeEventListener(i,t)}emit(i,t){this.dispatchEvent(new CustomEvent(i,{detail:t}))}async request(i,t=[]){let e={jsonrpc:"2.0",method:i,params:t,id:this.id++},u=await(await fetch(this.url(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(u.error)throw new Error(`[${u.error.code}] ${u.error.message}`);return u.result}web3_sha3(i){return this.request("web3_sha3",[i])}net_version(){return this.request("net_version")}net_listening(){return this.request("net_listening")}net_peerCount(){return this.request("net_peerCount")}eth_protocolVersion(){return this.request("eth_protocolVersion")}eth_syncing(){return this.request("eth_syncing")}eth_coinbase(){return this.request("eth_coinbase")}eth_mining(){return this.request("eth_mining")}eth_hashrate(){return this.request("eth_hashrate")}eth_gasPrice(){return this.request("eth_gasPrice")}eth_accounts(){return this.request("eth_accounts")}eth_blockNumber(){return this.request("eth_blockNumber")}eth_getBalance(i,t="latest"){return this.request("eth_getBalance",[i,t])}eth_getStorageAt(i,t,e="latest"){return this.request("eth_getStorageAt",[i,t,e])}eth_getTransactionCount(i,t="latest"){return this.request("eth_getTransactionCount",[i,t])}eth_getBlockTransactionCountByHash(i){return this.request("eth_getBlockTransactionCountByHash",[i])}eth_getBlockTransactionCountByNumber(i){return this.request("eth_getBlockTransactionCountByNumber",[i])}eth_getCode(i,t="latest"){return this.request("eth_getCode",[i,t])}eth_sendRawTransaction(i){return this.request("eth_sendRawTransaction",[i])}eth_call(i,t="latest"){return this.request("eth_call",[i,t])}eth_estimateGas(i){return this.request("eth_estimateGas",[i])}eth_feeHistory(i="0xa",t="latest",e=[50]){return this.request("eth_feeHistory",[i,t,e])}eth_getBlockByHash(i,t=!1){return this.request("eth_getBlockByHash",[i,t])}eth_getBlockByNumber(i,t=!1){return this.request("eth_getBlockByNumber",[i,t])}eth_getTransactionByHash(i){return this.request("eth_getTransactionByHash",[i])}eth_getTransactionByBlockHashAndIndex(i,t){return this.request("eth_getTransactionByBlockHashAndIndex",[i,t])}eth_getTransactionByBlockNumberAndIndex(i,t){return this.request("eth_getTransactionByBlockNumberAndIndex",[i,t])}eth_getTransactionReceipt(i){return this.request("eth_getTransactionReceipt",[i])}eth_getLogs(i){return this.request("eth_getLogs",[i])}eth_newFilter(i){return this.request("eth_newFilter",[i])}eth_newBlockFilter(){return this.request("eth_newBlockFilter")}eth_newPendingTransactionFilter(){return this.request("eth_newPendingTransactionFilter")}eth_uninstallFilter(i){return this.request("eth_uninstallFilter",[i])}eth_getFilterChanges(i){return this.request("eth_getFilterChanges",[i])}eth_getFilterLogs(i){return this.request("eth_getFilterLogs",[i])}eth_createAccessList(i,t="latest"){return this.request("eth_createAccessList",[i,t])}async populateTransaction(i,t){let e,r=[],u=i.type??"0x0";if(t&&(i.from=t),u==="0x0"||u==="0x1"){let{gasLimit:d,gasPrice:c}=await this.estimateGas(i);e={gasLimit:d,gasPrice:c}}else if(u==="0x2")i.accessList=(await this.eth_createAccessList(i)).accessList;else{let{gasLimit:d,maxFeePerGas:c,maxPriorityFeePerGas:n}=await this.estimateGas(i);e={gasLimit:d,maxFeePerGas:c,maxPriorityFeePerGas:n}}let f=await this.eth_getTransactionCount(i.from);return{...i,...e,accessList:r,nonce:f=="0x0"?"":f}}async estimateGas(i){let t=await this.eth_estimateGas(i),e=BigInt(t);e=e+e/5n;let r,u,f;try{let d=await this.eth_feeHistory(),c=d&&d.baseFeePerGas&&d.baseFeePerGas.length>0?BigInt(d.baseFeePerGas[0]):0n,n=d&&d.reward&&d.reward.length>0&&d.reward[0].length>0?BigInt(d.reward[0][0]):1500000000n;f=await this.eth_gasPrice(),u="0x"+n.toString(16),r="0x"+(c+n*2n).toString(16)}catch{r=await this.eth_gasPrice(),u="0x59682f00"}return{gasPrice:f,gasLimit:"0x"+e.toString(16),maxFeePerGas:r,maxPriorityFeePerGas:u}}};function it(l){try{if(typeof l=="string")return l.startsWith("0x")?l.toLowerCase():"0x"+[...new TextEncoder().encode(l)].map(e=>e.toString(16).padStart(2,"0")).join("");if(typeof l=="number"){if(!Number.isSafeInteger(l)||l<0)throw new Error("Only safe positive integers are supported for hexlify.");return"0x"+(l===0?"0":l.toString(16))}if(typeof l=="bigint"){if(l<0n)throw new Error("Negative bigints are not supported.");return"0x"+(l===0n?"0":l.toString(16))}if(l instanceof Uint8Array){let i=Array.from(l).map(t=>t.toString(16).padStart(2,"0")).join("");return"0x"+(i==="00"?"0":i)}return typeof l=="boolean"?l?"0x1":"0x0":l==null?"0x":Array.isArray(l)?l.map(rr):"0x"}catch(i){throw new Error(`Unsupported type for hexlify: ${i}`)}}function rr(l){let i={};return Object.entries(l).forEach(([t,e])=>{i[t]=it(e)}),i}function gs(l,i){if(!l)throw new Error("chainId is required to compute v");let t=BigInt(i??"0x0");return"0x"+(BigInt(l)*2n+35n+t).toString(16)}async function ys(l){let{decode64:i}=(await Promise.resolve().then(()=>(ds(),fs))).default.util;return i(l.replace(/-/g,"+").replace(/_/g,"/").padEnd(l.length+(4-l.length%4)%4,"="))}async function ms(l){let[i,t,e]=l.split(".");if(!i||!t||!e)throw new Error("Malformed token");return{header:JSON.parse(await ys(i)),payload:JSON.parse(await ys(t)),signature:e}}var _n="0x"+"".padStart(40,"0");var Nn="0x73656c6673656c6673656c6673656c6673656c66";function We(l){if(l.type==="string"||l.type==="bytes"||/\[\]$/.test(l.type))return!0;if(l.type==="tuple"){if(!l.components)throw new Error("Tuple must have components");return l.components.some(We)}return!1}function Rn(l){if(!l||l.length===0)return new Uint8Array(32);let i=new Uint8Array(Math.ceil(l.length/32)*32);return i.set(l),i}function _t(l){let i=l.reduce((r,u)=>r+u.length,0),t=new Uint8Array(i),e=0;for(let r of l)t.set(r,e),e+=r.length;return t}function Gr(l,i){let{type:t,components:e}=i;if(t==="string"){let u=l?new TextEncoder().encode(l):new Uint8Array(0),f=ut(u.length,{type:"uint256"});if(u.length==0)return f;let d=Rn(u);return _t([f,d])}if(t==="bytes"){let u;if(l instanceof Uint8Array)u=l;else if(typeof l=="string"&&l.startsWith("0x"))u=Tr(l.slice(2));else if(l===""||l===0)u=new Uint8Array(0);else throw new Error("Invalid bytes value");let f=ut(u.length,{type:"uint256"});if(u.length==0)return f;let d=Rn(u);return _t([f,d])}let r=t.match(/^(.*)\[(\d*)\]$/);if(r){let u=r[1],f=r[2],d=f==="";if(!Array.isArray(l))throw new Error(`Expected array value for type ${t}`);if(d)return xn(l,i);{let c=parseInt(f,10);if(l.length!==c)throw new Error(`Array length mismatch: expected ${c}, got ${l.length}`);let n=l.map(m=>We({type:u,components:e})?Gr(m,{type:u,components:e}):ut(m,{type:u,components:e}));return _t(n)}}if(t.startsWith("tuple")){if(!e)throw new Error("Tuple type requires components");return kn(l,e)}throw new Error(`Unsupported or unimplemented dynamic type: ${t}`)}function ut(l,i){if(i.type.startsWith("uint")||i.type.startsWith("int")||i.type==="address"||i.type==="bool"){let t;i.type==="bool"?t=l?1n:0n:(i.type,t=BigInt(l));let e=t.toString(16).padStart(64,"0");return Tr(e)}if(i.type.startsWith("bytes")){let t=i.type.match(/^bytes(\d+)$/);if(!t)throw new Error(`Invalid static bytes type: ${i.type}`);let e=Number(t[1]);if(e<1||e>32)throw new Error("bytesN must be between 1 and 32");let r;if(typeof l=="string"&&l.startsWith("0x"))r=Tr(l);else if(l instanceof Uint8Array)r=l;else throw new Error(`Invalid bytes input: ${l}`);if(r.length!==e)throw new Error(`Expected ${e} bytes, got ${r.length}`);let u=new Uint8Array(32);return u.set(r),u}if(i.type==="tuple"){if(!i.components||!Array.isArray(l))throw new Error("Invalid tuple input");if(!i.components.every(r=>!We(r)))throw new Error("Tuple contains dynamic types \u2014 use parseDynamic instead");let e=i.components.map((r,u)=>ut(l[u],r));return _t(e)}throw new Error(`Unsupported or dynamic type in encodeStatic: ${i.type}`)}function kn(l,i,t=0){let e=[],r=[],u=0;for(let f of i)We(f)?u+=32:u+=Cr(f)*32;for(let f=0;f<i.length;f++){let d=i[f],c=l[f];if(We(d)){e.push(ut(u,{type:"uint256"}));let n;if(d.type==="string"||d.type==="bytes")n=Gr(c,d);else if(d.type.endsWith("[]"))n=xn(c,d);else if(d.type.startsWith("tuple"))n=kn(c,d.components,t+u);else throw new Error(`Unsupported dynamic type in tuple: ${d.type}`);r.push(n),u+=n.length}else e.push(ut(c,d))}return _t([...e,...r])}function xn(l,i){if(!i.type.endsWith("[]"))throw new Error(`Type ${i.type} is not a dynamic array`);let t=i.type.slice(0,-2),e=i.components?{type:t,components:i.components}:{type:t},r=[],u=[],f=l.length*32;for(let c=0;c<l.length;c++){let n=l[c];if(We(e)){r.push(ut(f,{type:"uint256"}));let m;if(e.type==="string"||e.type==="bytes"){let h=new TextEncoder().encode(n);m=_t([ut(h.length,{type:"uint256"}),Rn(h)])}else if(e.type.startsWith("tuple"))m=kn(n,e.components);else if(e.type.endsWith("[]"))m=xn(n,e);else throw new Error(`Unsupported dynamic element type in array: ${e.type}`);u.push(m),f+=m.length}else{let m=ut(n,e);r.push(m)}}let d=ut(l.length,{type:"uint256"});return _t([d,...r,...u])}function Cr(l){if(We(l))return 0;let{type:i,components:t}=l;if(i.startsWith("uint")||i.startsWith("int")||i==="bool"||i==="address"||/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])$/.test(i))return 1;if(i==="tuple")return!t||t.length===0?0:t.reduce((r,u)=>{if(We(u))throw new Error(`Tuple has dynamic component: ${u.type}`);return r+Cr(u)},0);let e=i.match(/^(.*)\[(\d+)\]$/);if(e){let r=e[1],u=parseInt(e[2],10);if(isNaN(u))throw new Error(`Invalid fixed array length in type: ${i}`);let f={type:r,components:l.components};if(We(f))throw new Error(`Fixed array with dynamic base type: ${r}`);return u*Cr(f)}throw new Error(`Unsupported or non-static type in staticSizeInWords: ${i}`)}function Ln(l){return Array.from(l,i=>i.toString(16).padStart(2,"0")).join("")}function Tr(l){let i=new Uint8Array(l.length/2);for(let t=0;t<l.length;t+=2)i[t/2]=parseInt(l.substr(t,2),16);return i}function Sr(l,i,t){let{type:e,components:r}=t;if(e.startsWith("uint")||e.startsWith("int")||e==="address"||e==="bool"){let f=l.slice(i,i+32),d;if(e==="bool")d=f[31]!==0;else if(e==="address"){let c=f.slice(12,32);d="0x"+Ln(c)}else{d=0n;for(let c=0;c<32;c++)d=d<<8n|BigInt(f[c]);if(e.startsWith("int")){let c=parseInt(e.slice(3))||256,n=(1n<<BigInt(c-1))-1n;d>n&&(d=d-(1n<<BigInt(c)))}}return{value:d,newOffset:i+32}}if(e.startsWith("bytes")&&/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])$/.test(e)){let f=e.match(/^bytes(\d+)$/),d=Number(f[1]),n=l.slice(i,i+32).slice(0,d);return{value:"0x"+Ln(n),newOffset:i+32}}if(e==="tuple"){if(!r||r.length===0)return{value:[],newOffset:i};if(!r.every(n=>!We(n)))throw new Error("Tuple contains dynamic types - use decodeDynamic instead");let d=[],c=i;for(let n of r){let m=Sr(l,c,n);d.push(m.value),c=m.newOffset}return{value:d,newOffset:c}}let u=e.match(/^(.*)\[(\d+)\]$/);if(u){let f=u[1],d=parseInt(u[2],10),c={type:f,components:r};if(We(c))throw new Error(`Fixed array with dynamic base type: ${f}`);let n=[],m=i;for(let h=0;h<d;h++){let I=Sr(l,m,c);n.push(I.value),m=I.newOffset}return{value:n,newOffset:m}}throw new Error(`Unsupported static type: ${e}`)}function Fr(l,i,t){let{type:e,components:r}=t;if(e==="string"){let f=l.slice(i,i+32),d=0;for(let h=0;h<32;h++)d=d<<8|f[h];if(d===0)return{value:"",newOffset:i+32};let c=l.slice(i+32,i+32+d),n=new TextDecoder().decode(c),m=Math.ceil(d/32)*32;return{value:n,newOffset:i+32+m}}if(e==="bytes"){let f=l.slice(i,i+32),d=0;for(let h=0;h<32;h++)d=d<<8|f[h];if(d===0)return{value:"0x",newOffset:i+32};let c=l.slice(i+32,i+32+d),n="0x"+Ln(c),m=Math.ceil(d/32)*32;return{value:n,newOffset:i+32+m}}let u=e.match(/^(.*)\[(\d*)\]$/);if(u){let f=u[1];if(u[2]==="")return Ec(l,i,t);throw new Error(`Fixed-size array should use decodeStatic: ${e}`)}if(e.startsWith("tuple")){if(!r)throw new Error("Tuple type requires components");return vc(l,i,r)}throw new Error(`Unsupported dynamic type: ${e}`)}function vc(l,i,t){let e=[],r=i,u=i,f=[];for(let n=0;n<t.length;n++){let m=t[n];if(We(m)){let h=l.slice(r,r+32),I=0;for(let x=0;x<32;x++)I=I<<8|h[x];f.push(u+I),e.push(null),r+=32}else{let h=Sr(l,r,m);e[n]=h.value,r=h.newOffset}}let d=0;for(let n=0;n<t.length;n++){let m=t[n];if(We(m)){let h=f[d],I=Fr(l,h,m);e[n]=I.value,d++}}let c=r;if(f.length>0){let n=Math.max(...f),m=t.find((h,I)=>We(h)&&f[f.length-1]===n);m&&(c=Fr(l,n,m).newOffset)}return{value:e,newOffset:c}}function Ec(l,i,t){if(!t.type.endsWith("[]"))throw new Error(`Type ${t.type} is not a dynamic array`);let e=l.slice(i,i+32),r=0;for(let m=0;m<32;m++)r=r<<8|e[m];if(r===0)return{value:[],newOffset:i+32};let u=t.type.slice(0,-2),f=t.components?{type:u,components:t.components}:{type:u},d=[],c=i+32,n=c;if(We(f)){let m=[];for(let h=0;h<r;h++){let I=l.slice(c,c+32),x=0;for(let A=0;A<32;A++)x=x<<8|I[A];m.push(n+x),c+=32}for(let h=0;h<r;h++){let I=m[h],x=Fr(l,I,f);d.push(x.value),h===r-1&&(c=x.newOffset)}}else for(let m=0;m<r;m++){let h=Sr(l,c,f);d.push(h.value),c=h.newOffset}return{value:d,newOffset:c}}function vs(l,i){let t=[],e=0,r=[];for(let f=0;f<i.length;f++){let d=i[f];if(We(d)){let c=l.slice(e,e+32),n=0;for(let m=0;m<32;m++)n=n<<8|c[m];r.push(n),t.push(null),e+=32}else{let c=Sr(l,e,d);t[f]=c.value,e=c.newOffset}}let u=0;for(let f=0;f<i.length;f++){let d=i[f];if(We(d)){let c=r[u],n=Fr(l,c,d);t[f]=n.value,u++}}return t}var qr=class{dynamicParam(i,t){return Gr(i,t)}staticParam(i,t){return ut(i,t)}getHex(i){let t=i.length,e=Math.ceil(t/32)*32,r=i.slice(0,e);return"0x"+Array.from(r).map(u=>u.toString(16).padStart(2,"0")).join("")}ensureCapacity(i,t){if(t.length>=i)return t;let e=new Uint8Array(i);return e.set(t),e}isDynamicType(i){if(i.type==="string"||i.type==="bytes"||/\[\]$/.test(i.type))return!0;if(i.type==="tuple"){if(!i.components)throw new Error("Tuple must have components");return i.components.some(this.isDynamicType)}return!1}};var jr=class extends qr{buffer=new Uint8Array(0);abi;memory=new Map;constructor(i){super(),this.abi=i}save(i){this.memory.set(i,this.getHex(this.buffer))}delete(i){this.memory.set(i,"")}getCalldata(i){return this.encode(i)}encodeWithSelector(i){return this.getSelector()+this.encode(i).slice(2)}encode(i){let t=new Uint8Array(32*this.abi.inputs.length),e=new Uint8Array(0),r=0;for(let u of this.abi.inputs)this.isDynamicType(u)?r+=32:r+=Cr(u)*32;for(let u=0;u<this.abi.inputs.length;u++){let f=i[u],d=this.abi.inputs[u];if(this.isDynamicType(d)){let c=this.staticParam(t.length+e.length,{type:"uint256"});t.set(c,u*32);let n=this.dynamicParam(f,d);e=this.ensureCapacity(e.length+n.length,e),e.set(n,e.length-n.length)}else{let c=this.staticParam(f,d);t.set(c,u*32)}}return this.buffer=_t([t,e]),this.getHex(this.buffer)}decodeOutput(i,t=this.abi){let e=t.outputs??[];return e.length>0?vs(Tr(i.slice(2)),e):["0x"]}getSelector(i=this.abi){let t=i.inputs.map(u=>this.encodeParameterType(u)).join(","),e=`${i.name}(${t})`;return it(dt(new TextEncoder().encode(e))).slice(0,10)}printChunks32(i="Calldata",t=this.buffer){console.log(`
== ${i} (chunks of 32 bytes) ==`);for(let e=0;e<t.length;e+=32){let r=t.slice(e,e+32),u=Array.from(r).map(f=>f.toString(16).padStart(2,"0")).join("");console.log(`0x${e.toString(16).padStart(4,"0")}: ${u}`)}}encodeParameterType(i){if(i.type==="tuple")return`(${(i.components||[]).map(r=>this.encodeParameterType(r)).join(",")})`;let t=i.type.match(/(.*)(\[.*\])$/);if(t){let e=t[1],r=t[2];if(e==="tuple")return`(${(i.components||[]).map(f=>this.encodeParameterType(f)).join(",")})${r}`}return i.type}};var zr=class{fn=new Map;constructor(i){i.forEach(t=>this.fn.set(t.name,new jr(t)))}};var Es=[{type:"fallback",stateMutability:"payable"},{type:"receive",stateMutability:"payable"},{type:"function",name:"UPKEEPS_ID_SLOT",inputs:[],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"ccipReceive",inputs:[{name:"",type:"tuple",internalType:"struct Client.Any2EVMMessage",components:[{name:"messageId",type:"bytes32",internalType:"bytes32"},{name:"sourceChainSelector",type:"uint64",internalType:"uint64"},{name:"sender",type:"bytes",internalType:"bytes"},{name:"data",type:"bytes",internalType:"bytes"},{name:"destTokenAmounts",type:"tuple[]",internalType:"struct Client.EVMTokenAmount[]",components:[{name:"token",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"}]}]}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"checkUpkeep",inputs:[{name:"checkData",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bool",internalType:"bool"},{name:"",type:"bytes",internalType:"bytes"}],stateMutability:"view"},{type:"function",name:"createCronJobFromSpec",inputs:[{name:"calls",type:"tuple[]",internalType:"struct Call[]",components:[{name:"target",type:"address",internalType:"address"},{name:"value",type:"uint256",internalType:"uint256"},{name:"data",type:"bytes",internalType:"bytes"}]},{name:"spec",type:"tuple",internalType:"struct Spec",components:[{name:"minute",type:"tuple",internalType:"struct Field",components:[{name:"fieldType",type:"uint8",internalType:"enum FieldType"},{name:"singleValue",type:"uint8",internalType:"uint8"},{name:"interval",type:"uint8",internalType:"uint8"},{name:"rangeStart",type:"uint8",internalType:"uint8"},{name:"rangeEnd",type:"uint8",internalType:"uint8"},{name:"listLength",type:"uint8",internalType:"uint8"},{name:"list",type:"uint8[26]",internalType:"uint8[26]"}]},{name:"hour",type:"tuple",internalType:"struct Field",components:[{name:"fieldType",type:"uint8",internalType:"enum FieldType"},{name:"singleValue",type:"uint8",internalType:"uint8"},{name:"interval",type:"uint8",internalType:"uint8"},{name:"rangeStart",type:"uint8",internalType:"uint8"},{name:"rangeEnd",type:"uint8",internalType:"uint8"},{name:"listLength",type:"uint8",internalType:"uint8"},{name:"list",type:"uint8[26]",internalType:"uint8[26]"}]},{name:"day",type:"tuple",internalType:"struct Field",components:[{name:"fieldType",type:"uint8",internalType:"enum FieldType"},{name:"singleValue",type:"uint8",internalType:"uint8"},{name:"interval",type:"uint8",internalType:"uint8"},{name:"rangeStart",type:"uint8",internalType:"uint8"},{name:"rangeEnd",type:"uint8",internalType:"uint8"},{name:"listLength",type:"uint8",internalType:"uint8"},{name:"list",type:"uint8[26]",internalType:"uint8[26]"}]},{name:"month",type:"tuple",internalType:"struct Field",components:[{name:"fieldType",type:"uint8",internalType:"enum FieldType"},{name:"singleValue",type:"uint8",internalType:"uint8"},{name:"interval",type:"uint8",internalType:"uint8"},{name:"rangeStart",type:"uint8",internalType:"uint8"},{name:"rangeEnd",type:"uint8",internalType:"uint8"},{name:"listLength",type:"uint8",internalType:"uint8"},{name:"list",type:"uint8[26]",internalType:"uint8[26]"}]},{name:"dayOfWeek",type:"tuple",internalType:"struct Field",components:[{name:"fieldType",type:"uint8",internalType:"enum FieldType"},{name:"singleValue",type:"uint8",internalType:"uint8"},{name:"interval",type:"uint8",internalType:"uint8"},{name:"rangeStart",type:"uint8",internalType:"uint8"},{name:"rangeEnd",type:"uint8",internalType:"uint8"},{name:"listLength",type:"uint8",internalType:"uint8"},{name:"list",type:"uint8[26]",internalType:"uint8[26]"}]}]}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"deleteCronJob",inputs:[{name:"id",type:"uint256",internalType:"uint256"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"entryPoint",inputs:[],outputs:[{name:"",type:"address",internalType:"contract IEntryPoint"}],stateMutability:"pure"},{type:"function",name:"execute",inputs:[{name:"target",type:"address",internalType:"address"},{name:"value",type:"uint256",internalType:"uint256"},{name:"data",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"executeBatch",inputs:[{name:"calls",type:"tuple[]",internalType:"struct BaseAccount.Call[]",components:[{name:"target",type:"address",internalType:"address"},{name:"value",type:"uint256",internalType:"uint256"},{name:"data",type:"bytes",internalType:"bytes"}]}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"executeCCIP",inputs:[{name:"",type:"tuple[]",internalType:"struct BaseAccount.Call[]",components:[{name:"target",type:"address",internalType:"address"},{name:"value",type:"uint256",internalType:"uint256"},{name:"data",type:"bytes",internalType:"bytes"}]},{name:"",type:"tuple",internalType:"struct Config",components:[{name:"chain",type:"uint64",internalType:"uint64"},{name:"feeToken",type:"address",internalType:"address"},{name:"transferTokens",type:"tuple[]",internalType:"struct Client.EVMTokenAmount[]",components:[{name:"token",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"}]},{name:"extraArgs",type:"tuple",internalType:"struct Client.GenericExtraArgsV2",components:[{name:"gasLimit",type:"uint256",internalType:"uint256"},{name:"allowOutOfOrderExecution",type:"bool",internalType:"bool"}]}]}],outputs:[{name:"messageId",type:"bytes32",internalType:"bytes32"}],stateMutability:"nonpayable"},{type:"function",name:"feeTokenInfo",inputs:[],outputs:[{name:"maxFee",type:"uint96",internalType:"uint96"},{name:"token",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"getActiveCronJobIDs",inputs:[],outputs:[{name:"",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"getCronJob",inputs:[{name:"id",type:"uint256",internalType:"uint256"}],outputs:[{name:"calls",type:"tuple[]",internalType:"struct Call[]",components:[{name:"target",type:"address",internalType:"address"},{name:"value",type:"uint256",internalType:"uint256"},{name:"data",type:"bytes",internalType:"bytes"}]},{name:"cronString",type:"string",internalType:"string"},{name:"nextTick",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"getNonce",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"isValidSignature",inputs:[{name:"hash",type:"bytes32",internalType:"bytes32"},{name:"signature",type:"bytes",internalType:"bytes"}],outputs:[{name:"magicValue",type:"bytes4",internalType:"bytes4"}],stateMutability:"view"},{type:"function",name:"keeperRegister",inputs:[],outputs:[{name:"",type:"address",internalType:"contract IKeeperRegistryUI"}],stateMutability:"view"},{type:"function",name:"onERC1155BatchReceived",inputs:[{name:"",type:"address",internalType:"address"},{name:"",type:"address",internalType:"address"},{name:"",type:"uint256[]",internalType:"uint256[]"},{name:"",type:"uint256[]",internalType:"uint256[]"},{name:"",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"nonpayable"},{type:"function",name:"onERC1155Received",inputs:[{name:"",type:"address",internalType:"address"},{name:"",type:"address",internalType:"address"},{name:"",type:"uint256",internalType:"uint256"},{name:"",type:"uint256",internalType:"uint256"},{name:"",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"nonpayable"},{type:"function",name:"onERC721Received",inputs:[{name:"",type:"address",internalType:"address"},{name:"",type:"address",internalType:"address"},{name:"",type:"uint256",internalType:"uint256"},{name:"",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"nonpayable"},{type:"function",name:"performUpkeep",inputs:[{name:"performData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"registerUpkeep",inputs:[{name:"name",type:"string",internalType:"string"},{name:"gasLimit",type:"uint32",internalType:"uint32"},{name:"offchainConfig",type:"bytes",internalType:"bytes"},{name:"checkData",type:"bytes",internalType:"bytes"},{name:"amount",type:"uint96",internalType:"uint96"}],outputs:[],stateMutability:"payable"},{type:"function",name:"setConditionDelegatee",inputs:[{name:"delegatee",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setFeeTokenInfo",inputs:[{name:"maxFee",type:"uint96",internalType:"uint96"},{name:"token",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setForwarder",inputs:[{name:"newForwarder",type:"address",internalType:"address"},{name:"allowed",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"supportsInterface",inputs:[{name:"id",type:"bytes4",internalType:"bytes4"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"pure"},{type:"function",name:"unlockCallback",inputs:[{name:"",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes",internalType:"bytes"}],stateMutability:"nonpayable"},{type:"function",name:"updateCronJob",inputs:[{name:"id",type:"uint256",internalType:"uint256"},{name:"newCall",type:"tuple[]",internalType:"struct Call[]",components:[{name:"target",type:"address",internalType:"address"},{name:"value",type:"uint256",internalType:"uint256"},{name:"data",type:"bytes",internalType:"bytes"}]},{name:"newEncodedCronSpec",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"upkeeps",inputs:[{name:"",type:"bytes32",internalType:"bytes32"},{name:"",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"validateUserOp",inputs:[{name:"userOp",type:"tuple",internalType:"struct PackedUserOperation",components:[{name:"sender",type:"address",internalType:"address"},{name:"nonce",type:"uint256",internalType:"uint256"},{name:"initCode",type:"bytes",internalType:"bytes"},{name:"callData",type:"bytes",internalType:"bytes"},{name:"accountGasLimits",type:"bytes32",internalType:"bytes32"},{name:"preVerificationGas",type:"uint256",internalType:"uint256"},{name:"gasFees",type:"bytes32",internalType:"bytes32"},{name:"paymasterAndData",type:"bytes",internalType:"bytes"},{name:"signature",type:"bytes",internalType:"bytes"}]},{name:"userOpHash",type:"bytes32",internalType:"bytes32"},{name:"missingAccountFunds",type:"uint256",internalType:"uint256"}],outputs:[{name:"validationData",type:"uint256",internalType:"uint256"}],stateMutability:"nonpayable"},{type:"error",name:"CheckUpkeepError",inputs:[]},{type:"error",name:"CronJobIDNotFound",inputs:[{name:"id",type:"uint256",internalType:"uint256"}]},{type:"error",name:"ECDSAInvalidSignature",inputs:[]},{type:"error",name:"ECDSAInvalidSignatureLength",inputs:[{name:"length",type:"uint256",internalType:"uint256"}]},{type:"error",name:"ECDSAInvalidSignatureS",inputs:[{name:"s",type:"bytes32",internalType:"bytes32"}]},{type:"error",name:"ExecuteCCIPError",inputs:[]},{type:"error",name:"ExecuteError",inputs:[{name:"index",type:"uint256",internalType:"uint256"},{name:"error",type:"bytes",internalType:"bytes"}]},{type:"error",name:"FeeTokenError",inputs:[]},{type:"error",name:"InvalidHandler",inputs:[]},{type:"error",name:"NotPoolManager",inputs:[]},{type:"error",name:"PerformError",inputs:[]},{type:"error",name:"PerformUpkeepError",inputs:[]},{type:"error",name:"ReceiveCCIPError",inputs:[]},{type:"error",name:"TickDoesntMatchSpec",inputs:[]},{type:"error",name:"TickInFuture",inputs:[]},{type:"error",name:"TickTooOld",inputs:[]},{type:"error",name:"Unknown",inputs:[{name:"",type:"bytes",internalType:"bytes"}]},{type:"error",name:"UnknownFieldType",inputs:[]}];var Un=class{encoder=new zr(Es.filter(i=>i.name?.includes("execute")));batch=new Map;newBatch(i){let t=it(i.chainId),e=this.batch.get(t);e?(e.push(i),this.batch.set(t,e)):this.batch.set(t,[i])}setBatch(i,t){let e=it(i.chainId),r=this.batch.get(e);if(r)r[t]=i,this.batch.set(e,r);else throw new Error("[Transaction]: Not found or not defined")}removeBatch(i,t){let e=it(i),r=this.batch.get(e);if(!r)throw new Error(`[Transaction]: Batch for chainId ${e} not found`);if(t<0||t>=r.length)throw new Error(`[Transaction]: Index ${t} out of bounds`);return r.splice(t,1),this.batch.set(e,r),r}hasBatch(i){return this.batch.get(i)!=null}encodeBatch(i){let t=this.encoder.fn.get("executeBatch");if(!t)throw new Error("[Encoder]: Invalid encoder");return t.encodeWithSelector([this.batch.get(it(i)).map(e=>[e.to,e.value,e.data])])}},br=class extends Un{transactions=[];history=[];constructor(i){super(),i&&this.new(i)}new(i){let t=this.toHex(i),e=this.transactions.findIndex(r=>r.chainId==t.chainId);e>=0?this.batch.has(t.chainId)?(this.newBatch(i),this.set({type:t.type,chainId:t.chainId,data:this.encodeBatch(t.chainId),to:_n},e)):(this.newBatch(this.transactions[e]),this.newBatch(i),this.set({type:t.type,chainId:t.chainId,data:this.encodeBatch(t.chainId),to:_n},e)):this.transactions.push(t)}set(i,t){if(t<0||t>=this.transactions.length)throw new Error(`[Transaction]: Index ${t} is out of bounds`);this.transactions[t]=this.toHex(i)}remove(i){i>=0&&i<this.transactions.length&&this.transactions.splice(i,1)}filter(i){return this.transactions.filter(t=>t.chainId==i)}prepareForSigning(i=this.transactions){return i.map(t=>{let e=t;if(this.hasSignature(e))throw new Error("Transaction is signed");return dt(this.rlp(t))})}rawTransaction(i=0,t=this.transactions){if(!this.hasSignature(t[i]))throw new Error("Transaction is missing signature fields: yParity, r, s");return it(this.rlp(t[i],!0))}rlp(i,t=!1){switch(i.type){case"0x0":return Cs(i,t);case"0x1":{let e=i,r=[e.chainId,e.nonce,e.gasPrice,e.gasLimit,e.to,e.value=="0x0"?void 0:e.value,e.data,Qr(e.chainId,e.accessList)];return t&&r.push(e.yParity=="0x0"?void 0:e.yParity,e.r,e.s),Uint8Array.from([1,...Bt.encode(r)])}case"0x2":{let e=i,r=[e.chainId,e.nonce,e.maxPriorityFeePerGas,e.maxFeePerGas,e.gasLimit,e.to,e.value=="0x0"?void 0:e.value,e.data,Qr(e.chainId,e.accessList)];return t&&r.push(e.yParity=="0x0"?void 0:e.yParity,e.r,e.s),Uint8Array.from([2,...Bt.encode(r)])}case"0x3":{let e=i,r=[e.chainId,e.nonce,e.maxPriorityFeePerGas,e.maxFeePerGas,e.gasLimit,e.to,e.value=="0x0"?void 0:e.value,e.data,Qr(e.chainId,e.accessList),e.maxFeePerBlobGas,e.blobVersionedHashes];return t&&r.push(e.yParity=="0x0"?void 0:e.yParity,e.r,e.s),Uint8Array.from([3,...Bt.encode(r)])}case"0x4":{let e=i,r=[e.chainId,e.nonce,e.maxPriorityFeePerGas,e.maxFeePerGas,e.gasLimit,e.to,e.value=="0x0"?void 0:e.value,e.data,Qr(e.chainId,e.accessList),e.authorizationList.map(u=>[u.chainId,u.address,u.nonce,u.yParity=="0x0"?void 0:u.yParity,u.r,u.s])];return t&&r.push(e.yParity=="0x0"?void 0:e.yParity,e.r,e.s),console.log(r),Uint8Array.from([4,...Bt.encode(r)])}default:return Cs(i,t)}}toHex(i){return rr(i)}hasSignature(i){return typeof i.yParity=="string"&&typeof i.r=="string"&&typeof i.s=="string"&&i.yParity.startsWith("0x")&&i.r.startsWith("0x")&&i.s.startsWith("0x")}};function Cs(l,i){let t=l,e=gs(t.chainId,t.yParity),r=i?[t.nonce,t.gasPrice,t.gasLimit,t.to,t.value=="0x0"?void 0:t.value,t.data,e,t.r,t.s]:[t.nonce,t.gasPrice,t.gasLimit,t.to,t.value=="0x0"?void 0:t.value,t.data,t.chainId,"0x","0x"];return Bt.encode(r)}function Qr(l,i){return l==="0xa4b1"?[]:i.map(t=>[t.address,t.storageKeys])??[]}var Wr=class extends Vr{provider;transactions=new br;constructor(i){super(),this.provider=new Zt(i)}getAddress(i){let t=this.publicKeyFromPrivateKey(i);return"0x"+it(dt(t)).slice(-40)}async upgradeAccount(i,t,e){this.provider.changeChain(it(e));let r=this.getAddress(t),u=await this.provider.eth_getTransactionCount(r),f=it(parseInt(u,16)+1),d=dt(Uint8Array.from([5,...Bt.encode([e,i,f])])),c=this.sign(d,t),{s:n,r:m,recovery:h}=c;return{chainId:e,address:i,nonce:f,r:m,s:n,yParity:h,v:h+27}}async signTransaction(i,t,e=0){let r=this.getAddress(i);t.to==Nn&&(t.to=r);let u=await this.provider.populateTransaction(rr(t),r),f=new br(u),d=f.prepareForSigning()[e],c=this.sign(d,i),{r:n,s:m,recovery:h}=c;return f.set({...u,r:n,s:m,yParity:h,v:h+27},e),console.log(f.transactions),f.rawTransaction(e)}async signAll(i,t){try{let e=this.getAddress(i);for(let f=0;f<t.transactions.length;f++){let d=t.transactions[f];d.to==Nn&&(d.to=e),this.provider.changeChain(d.chainId);let c=await this.provider.populateTransaction(rr(d),e);t.set(c,f)}let r=t.prepareForSigning();return r.map(f=>this.sign(f,i)).map((f,d)=>{let{r:c,s:n,recovery:m}=f;return t.set({...t.transactions[d],r:c,s:n,yParity:m,v:m+27},d),t.rawTransaction(d),{chain:t.transactions[d].chainId,raw:t.rawTransaction(d),signed:t.transactions[d],signature:f,hash:r[d]}})}catch(e){throw new Error(`[Signature error]: ${e.message}`)}}};async function Ts(){let l={active:!0,lastFocusedWindow:!0},[i]=await chrome.tabs.query(l);return i.id}var Yr=class{source;listeners;constructor(i){this.source=i,this.listeners=new Map,globalThis.addEventListener("message",this._internalHandler)}log(...i){console.log(`[${this.source}]`,...i)}listen=(i,t)=>{this.listeners.set(i,t)};unlisten=i=>{this.listeners.delete(i)};send=(i,t={},e,r="*",u={})=>{let f={__mailbox__:!0,type:i,payload:t,source:this.source,dest:e,...u};this.source==="DOM"||this.source==="CONTENT SCRIPT"&&e!=="BACKGROUND"?globalThis.postMessage(f,r):e==="CONTENT SCRIPT"&&this.source!=="DOM"?Ts().then(d=>chrome.tabs.sendMessage(d,f,()=>this.log(`${i} send`))):chrome.runtime.sendMessage(f)};_internalHandler=i=>{if(!i.data||i.data.__mailbox__!==!0||i.data.source===this.source||i.data.dest!==this.source)return;this.log("Message accepted");let t=this.listeners.get(i.data.type);typeof t=="function"&&t(i.data.payload,i)}};var Xr=class extends Yr{pending;handlers;constructor(i){super(i),this.source=i,this.pending=new Map,this.handlers=new Map,globalThis.addEventListener("message",this._onglobalThisMessage.bind(this)),(i==="CONTENT SCRIPT"||i==="BACKGROUND"||i==="EXTENSION")&&chrome.runtime.onMessage.addListener((t,e,r)=>this._onRuntimeMessage(t,e,r))}_onglobalThisMessage(i){if(i.data.source===this.source||!i.data?.__mailbox__)return;this.log(i);let{source:t,type:e,payload:r,dest:u,requestId:f}=i.data,{data:d}=r;if(!(t===this.source||u!==this.source)){if(e?.startsWith("RESPONSE_")&&this.pending.has(f)){let c=this.pending.get(f);c&&(c.resolve(d),this.pending.delete(f));return}if(e?.startsWith("REQUEST_")){let c=e.replace("REQUEST_",""),n=this.handlers.get(c);if(!n){this.log(`No handler for request: ${c}`);return}Promise.resolve(n(r,i)).then(m=>{this.send(`RESPONSE_${e}`,m,"DOM","*",{requestId:f})})}if(e?.startsWith("NOTIFY_")){let c=e.replace("NOTIFY_",""),n=this.handlers.get(c);if(!n){this.log("No handler for this");return}n(r,c)}}}_onRuntimeMessage(i,t,e){if(!i?.__mailbox__||i.dest!==this.source)return this.log("Ignored runtime message"),!1;let{type:r,requestId:u,payload:f}=i;if(r?.startsWith("REQUEST_")){let d=r.replace("REQUEST_",""),c=this.handlers.get(d);if(!c)return e({ok:!1,error:`No handler for ${d}`}),!1;try{let n=c(f,t,e);return n&&typeof n.then=="function"?(n.then(m=>{this.log("Handler resolved with:",m),e({__mailbox__:!0,source:this.source,dest:i.source,requestId:u,type:`RESPONSE_${d}`,payload:m,ok:!0})}).catch(m=>{this.log("Handler rejected with:",m.message),e({ok:!1,error:m?.message||String(m)})}),!0):!1}catch(n){let m=n;return e({ok:!1,error:m?.message||String(m)}),!1}}return r?.startsWith("NOTIFY_")&&this.source==="CONTENT SCRIPT"?(this.send(r,f,"DOM"),!1):!0}request(i,t,e){let r=t?.method+"_"+crypto.randomUUID();return new Promise(u=>{this.pending.set(r,{resolve:u});let f={__mailbox__:!0,type:`REQUEST_${i}`,payload:t,requestId:r,source:this.source,dest:e};e==="BACKGROUND"||e==="EXTENSION"?chrome.runtime.sendMessage(f,d=>{if(chrome.runtime.lastError){console.error("No extension page open:",chrome.runtime.lastError.message);return}let c=this.pending.get(r);c&&(c.resolve(d),this.pending.delete(r))}):this.send(`REQUEST_${i}`,t,e,"*",{requestId:r})})}on(i,t){this.handlers.set(i,t),this.log("Registered handler for",i)}off(i){this.handlers.delete(i),this.log("Removed handler for",i)}};var Pn=new Zt(_r),Ar=new Xr("BACKGROUND"),Ss=new ir({dbName:"UserData",storeName:"account",keyPath:"id"}),bs=new ir({dbName:"Keys",storeName:"secrets",keyPath:"id"}),As=new Wr(_r);var Is=`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADIBAMAAABfdrOtAAAAMFBMVEX///8AAAAEBAT8/PxJSUmgoKCzs7NkZGQzMzN2dnYbGxv19fXS0tLm5ubBwcGIiIgIZ5ZQAAAF5klEQVR42u2ZPWikRRjH
X5jNbeLmgxk22ewSd5kXRDhcfWEb8ZpdC7FMKtsEhEMLSUBTiBwbETkbSezSGVJJENbqINVu47UxpVW20jLXWvl8zPuBpknm6e75w13msrn5ZWaeeb4mSVQqlUqlUqlUKpVKpVKpVCqVSqVSvd4agPKxqYzDZ9ld4wcpu3tskr
vH95//5enpoSnHX1Vmy56enn5j/j++P2THWnfFv362Z62dFksxK97ajTBx48za9YdD0tTv55A0TYclpO7SNEDMEowjIPDrbpkAgXG3mCmbwSIDJLuGcRTENUuI2yw/GvkScuAjIdbvZsVK/HbYL7PqipWYZWujIeNyu9x5/tFi
BVJz0ZDw3xnSM9VPNiqfxEFsZ1JMZdNg0Gi0xZkcCUD8cVZAgkGbNVdAzIKLPxPr+iZA4F/vmNxoi5Vc2mjIc+taAeI/dsGg0WifB0h2QuMYiD907E0Q8sxZf5Ox0fpPHUHQv/inLg4yPII/ATIceTJoMFrXXAyQunObtVjInq
fJCDLjbcnm3nYDBP1LNxoCE2yGMxnWHRs0rG4/h4z4Z+Igy+xNCIL7f5uR0V4xxDzCM4uGTMCSLsJKJmBJYNCX1rVNWAl8aTWiIXAnYEqGZJdo0NkrwAYI/Ajco2jIAG43hEeCDHCjprxpDAH/4m8H8SvBefYZkuGR4/E/zhKC
QFCEcfxKMrz3XcMrgb9d9w805AFBcC/XjQAEf+cmQ+gabuKVNLwS8C9+LLEStFK/OwEH+eMXAzBoB37yJvv9b/RdGBRvJCAUz8fs6rfRoDHumzPywjVymSIQ8Ca9BBMJf56Qk99qrDlMJPCbWzIQg97kioNsA8wJje2SYjwaG4
Q0EQhejGOA/OA6aNB4bV55jCcL7MskIAle8Tfn5Pa3J3DFe4D1L8G63uDUQgSCzqo1J7d/DoEQnNWSa8LEXYCfJ0IQdLvpifXDRddb8XDk02u7BdnW+hmnfjIrwawnBciq69DBDw/8PkAeQ+JqpFYSUhUYj/zX9u2f7HveQQyx
wHtXDkKZKELmaL9rzqUYQ4o8TAiC7gMgA5x5+gSsuM9ceyUHoUQLIashaPlj4mE0E4T8ydsFhwLh933XmfBKLhJBCOWiCDnwFzjnZjimX0VXcsLbtYw7hKFlm7erJQgpDr5O8R5uzXk4+Gkmb8IzrCTg/rteI/+W3GWcU3GCOd
iH9q3PXct3JrVKiSIDgQ361mI26V6gWxmP/C1A0lAPiznIzo7FZKgNHO93574PkLbnelhmJR/AIcwpq+8nBx7Ces210dVzBisXtH7m+uSYglYDrO0FBK3fBIMWht9tcMTfQ/WL4bczgUv5JUCWyKJlYvwSliiUSLQbWPfCeq7J
tDiDFUuJNjgl6nNK1IcEhlKiHbGUiIopTu6OOblrUbsLLsmiVHJnVsl9AOSX0wn5F0xNP/sHt4sy2Ewo4W6RVxxz3YvlwyCpUcI9yr8rUDr0GYKlA2ZgMP0ThsyESgfIrSEX5ZVQ3Qt3neIJFkFUD8uUc5CLEoQSsCuqhwcMod
JuIFKYrnNhOsbCtIeVDxSmNS5MqR6WKLFxnxhygnkp1cMNhlAG2xBpFuxys2BM/iUzVA8zhBoHU4m2RzP0VsZ1aoFgmYXHzxHrSKLtwcUUQ2bcGqZ6OECwHt6oCbSi9kMrajwK8QW9SYBQPRwLOWRvTpCPQoMNHY3/K0DwzCKb
atj5a+c9yLxVSPXwd+FMQqswstHJuSh7Yds3Rac+70FeW4FuKvfOQ8v2NgtvDmU+tCbQsg2vAAzphF79ii9bttyIjoTc1SzH1KL4ZCe+w52n3Hvl4wAlSWUbfTH+QSC8MfF23eRPGwuVV4dH0ZBgtPxI0yxfgo4qjzSj6Eeafu
W5aauEzCvPTbO4laQpvznww1n+iMaZaflwVo97OMtfT/gJMH8OzMuiHIIG/XDIfx4zD6uPmZ8IPWbyDHePxZ5l7/PAPEhUKpVKpVKpVCqVSqVSqVQqlUqlUr3e+he+RtF+DbQaYAAAAABJRU5ErkJggg==`;var Bs={name:"weywallet",icon:Is,rdns:"com.weywallet.io",uuid:crypto.randomUUID()};var ws={open_url:({url:l})=>chrome.windows.create({url:l}),read_file:({path:l})=>console.warn("Reading file:",l),sign_document:({document:l})=>console.warn("Signing doc:",l),search_query:({engine:l,query:i})=>{console.log(`Search requested: engine=${l}, query="${i}"`),l==="youtube"?chrome.tabs.create({url:`https://www.youtube.com/results?search_query=${encodeURIComponent(i)}`}):l==="google"?chrome.tabs.create({url:`https://www.google.com/search?q=${encodeURIComponent(i)}`}):console.warn(`Motor de b\xFAsqueda no soportado: ${l}`)}};var _s=(l="local")=>{let i=chrome.storage[l],t=(r,u)=>f=>{chrome.runtime.lastError?(console.error(`[${Dn(l)}Storage] Error:`,chrome.runtime.lastError),u(chrome.runtime.lastError)):r(f)},e=r=>r&&typeof r=="object"&&!Array.isArray(r);return{create:(r,u)=>new Promise((f,d)=>{i.set({[r]:u},t(()=>{console.log(`[${Dn(l)}Storage] Namespace ${r} created`),f()},d))}),read:r=>new Promise((u,f)=>{i.get([r],t(u,f))}),update:(r,u)=>new Promise((f,d)=>{i.get([r],t(c=>{let n=c[r],m;e(n)&&e(u)?m={...n,...u}:u==null?m=n:m=u,i.set({[r]:m},t(()=>{console.log(`[${Dn(l)}Storage] Namespace ${r} updated`),f()},d))},d))}),delete:r=>new Promise((u,f)=>{Array.isArray(r)||(r=[r]),i.remove(r,t(u,f))}),clear:()=>new Promise((r,u)=>{i.clear(t(r,u))})}};function Dn(l){return l.charAt(0).toUpperCase()+l.slice(1)}var Ns=_s("local"),op=_s("session");async function On(){let l=await Ns.read("session");if(l){let{payload:i}=await ms(l.session);return await Ss.get(i.sub)}return null}function qt(l){l>0?(chrome.action.setBadgeText({text:l.toString()}),chrome.action.setBadgeBackgroundColor({color:"#FF0000"}),chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!0})):(chrome.action.setBadgeText({text:""}),chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!1}))}async function Cc(l){let i=new TextEncoder;return await crypto.subtle.importKey("raw",i.encode(l),{name:"PBKDF2"},!1,["deriveKey"])}async function Tc(l,i){return await crypto.subtle.deriveKey({name:"PBKDF2",salt:i,iterations:1e5,hash:"SHA-256"},l,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function Rs(l,i){try{let t=new TextDecoder,{iv:e,salt:r,ciphertext:u}=l,f=await Cc(i),d=await Tc(f,r),c=await crypto.subtle.decrypt({name:"AES-GCM",iv:e},d,u);return JSON.parse(t.decode(c))}catch(t){return console.log(t),{}}}var nr=0,xs={[Xe.PROVIDER]:async()=>({data:Bs}),[Xe.ACCOUNTS]:async()=>Ls(),[Xe.ACCOUNTS2]:async()=>Ls(),[Xe.UPGRADE]:async()=>(console.log("Upgrade requested"),{status:"ok"}),[Xe.RSA_SIGN]:async(l,i)=>{qt(++nr);let t=await ks({type:"message",sender:i.origin,payload:l,timestamp:new Date(Date.now()).toISOString()});return qt(--nr),t},[Xe.ECDSA_SIGN]:async l=>ks(l),[Xe.ETH_SIGN]:async l=>console.log(l),[Xe.PERSONAL_SIGN]:async l=>console.log(l),[Xe.SIGN_TYPED_V1]:async l=>console.log(l),[Xe.SIGN_TYPED_V3]:async l=>console.log(l),[Xe.SIGN_TYPED_V4]:async l=>console.log(l),[Xe.SEND_RAW_TX]:async l=>console.log(l),[Xe.ACTION]:async l=>Sc(l),[Xe.ETH_SEND]:async(l,i)=>{qt(++nr);let t=await On();if(t){let e=await bs.get(t.activeAccount.public);if(e){let r=await Ar.request("APPROVAL",{type:"ethereum-tx",sender:i.origin,payload:l,timestamp:new Date(Date.now()).toISOString()},"EXTENSION"),{iv:u,salt:f,ciphertext:d}=e.secret;if(r.payload){let n=(await Rs({iv:new Uint8Array(u),ciphertext:new Uint8Array(d),salt:new Uint8Array(f)},r.payload)).secret,m=await As.signTransaction(n,{...l.params[0],chainId:Pn.current.id});return await Pn.eth_sendRawTransaction(m)}else throw qt(--nr),new Error("User rejected the request")}throw qt(--nr),new Error("Invalid account")}throw qt(--nr),new Error("Invalid account")}};async function Ls(){let l=await On();return l?{data:[l.activeAccount.public]}:{data:[]}}async function ks(l){let i=await Ar.request("APPROVAL",l,"EXTENSION");console.log({response:i})}function Sc(l){let{action:i,params:t}=l,e=ws[i];return e||console.error(`${i} not implemented`),e(t)}Object.values(Xe).forEach(l=>Ar.on(l,xs[l]));})();
/*! Bundled license information:

@noble/secp256k1/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
/*! Bundled license information:

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
