(()=>{var $a=Object.defineProperty;var _u=(i,r,t)=>r in i?$a(i,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[r]=t;var Kn=(i,r)=>()=>(i&&(r=i(i=0)),r);var Wa=(i,r)=>{for(var t in r)$a(i,t,{get:r[t],enumerable:!0})};var Hn=(i,r,t)=>(_u(i,typeof r!="symbol"?r+"":r,t),t);var Ca={};Wa(Ca,{Certificate:()=>oc,Cipher:()=>cc,Cipheriv:()=>uc,Decipher:()=>lc,Decipheriv:()=>pc,DiffieHellman:()=>fc,DiffieHellmanGroup:()=>dc,ECDH:()=>hc,Hash:()=>yc,Hmac:()=>mc,KeyObject:()=>gc,Sign:()=>vc,Verify:()=>bc,X509Certificate:()=>Ec,checkPrime:()=>lo,checkPrimeSync:()=>po,constants:()=>Tc,createCipher:()=>fo,createCipheriv:()=>mo,createDecipher:()=>ho,createDecipheriv:()=>go,createDiffieHellman:()=>vo,createDiffieHellmanGroup:()=>bo,createECDH:()=>Eo,createHash:()=>Co,createHmac:()=>To,createPrivateKey:()=>So,createPublicKey:()=>_o,createSecretKey:()=>Ao,createSign:()=>Io,createVerify:()=>wo,default:()=>Ql,diffieHellman:()=>Bo,fips:()=>uo,generateKey:()=>Fo,generateKeyPair:()=>Ko,generateKeyPairSync:()=>Ho,generateKeySync:()=>jo,generatePrime:()=>No,generatePrimeSync:()=>xo,getCipherInfo:()=>Ro,getCiphers:()=>ko,getCurves:()=>Lo,getDiffieHellman:()=>Po,getFips:()=>rc,getHashes:()=>Uo,getRandomValues:()=>Ea,hash:()=>sc,hkdf:()=>Do,hkdfSync:()=>Oo,pbkdf2:()=>Vo,pbkdf2Sync:()=>Mo,privateDecrypt:()=>qo,privateEncrypt:()=>Go,pseudoRandomBytes:()=>yo,publicDecrypt:()=>zo,publicEncrypt:()=>$o,randomBytes:()=>co,randomFill:()=>Wo,randomFillSync:()=>Qo,randomInt:()=>Yo,randomUUID:()=>io,scrypt:()=>Xo,scryptSync:()=>Jo,secureHeapUsed:()=>ic,setEngine:()=>ec,setFips:()=>nc,sign:()=>Zo,subtle:()=>ao,timingSafeEqual:()=>tc,verify:()=>ac,webcrypto:()=>oo});function zl(i){return new Error(`[unenv] ${i} is not implemented yet!`)}function le(i){return Object.assign(()=>{throw zl(i)},{__unenv__:!0})}function ot(i){return class{__unenv__=!0;constructor(){throw new Error(`[unenv] ${i} is not implemented yet!`)}}}var $l,ro,no,ao,io,Ea,so,to,oo,co,uo,Wl,lo,po,fo,ho,yo,mo,go,vo,bo,Eo,Co,To,So,_o,Ao,Io,wo,Bo,No,xo,ko,Ro,Lo,Po,Uo,Do,Oo,Vo,Mo,Ko,Ho,Fo,jo,qo,Go,zo,$o,Wo,Qo,Yo,Xo,Jo,Zo,ec,tc,rc,nc,ac,ic,sc,oc,cc,uc,lc,pc,fc,dc,hc,yc,mc,gc,vc,bc,Ec,Cc,Tc,Ql,Ta=Kn(()=>{$l=Object.defineProperty,ro=(i,r)=>{for(var t in r)$l(i,t,{get:r[t],enumerable:!0})},no={};ro(no,{getRandomValues:()=>Ea,randomUUID:()=>io,subtle:()=>ao});ao=globalThis.crypto?.subtle,io=()=>globalThis.crypto?.randomUUID(),Ea=i=>globalThis.crypto?.getRandomValues(i),so={};ro(so,{Certificate:()=>oc,Cipher:()=>cc,Cipheriv:()=>uc,Decipher:()=>lc,Decipheriv:()=>pc,DiffieHellman:()=>fc,DiffieHellmanGroup:()=>dc,ECDH:()=>hc,Hash:()=>yc,Hmac:()=>mc,KeyObject:()=>gc,Sign:()=>vc,Verify:()=>bc,X509Certificate:()=>Ec,checkPrime:()=>lo,checkPrimeSync:()=>po,constants:()=>Wl,createCipher:()=>fo,createCipheriv:()=>mo,createDecipher:()=>ho,createDecipheriv:()=>go,createDiffieHellman:()=>vo,createDiffieHellmanGroup:()=>bo,createECDH:()=>Eo,createHash:()=>Co,createHmac:()=>To,createPrivateKey:()=>So,createPublicKey:()=>_o,createSecretKey:()=>Ao,createSign:()=>Io,createVerify:()=>wo,diffieHellman:()=>Bo,fips:()=>uo,generateKey:()=>Fo,generateKeyPair:()=>Ko,generateKeyPairSync:()=>Ho,generateKeySync:()=>jo,generatePrime:()=>No,generatePrimeSync:()=>xo,getCipherInfo:()=>Ro,getCiphers:()=>ko,getCurves:()=>Lo,getDiffieHellman:()=>Po,getFips:()=>rc,getHashes:()=>Uo,hash:()=>sc,hkdf:()=>Do,hkdfSync:()=>Oo,pbkdf2:()=>Vo,pbkdf2Sync:()=>Mo,privateDecrypt:()=>qo,privateEncrypt:()=>Go,pseudoRandomBytes:()=>yo,publicDecrypt:()=>zo,publicEncrypt:()=>$o,randomBytes:()=>co,randomFill:()=>Wo,randomFillSync:()=>Qo,randomInt:()=>Yo,scrypt:()=>Xo,scryptSync:()=>Jo,secureHeapUsed:()=>ic,setEngine:()=>ec,setFips:()=>nc,sign:()=>Zo,timingSafeEqual:()=>tc,verify:()=>ac,webcrypto:()=>oo});to=65536,oo=new Proxy(globalThis.crypto,{get(i,r){return r==="CryptoKey"?globalThis.CryptoKey:typeof globalThis.crypto[r]=="function"?globalThis.crypto[r].bind(globalThis.crypto):globalThis.crypto[r]}}),co=(i,r)=>{let t=Buffer.alloc(i,0,void 0);for(let e=0;e<i;e+=to)Ea(Uint8Array.prototype.slice.call(t,e,e+to));if(typeof r=="function"){r(null,t);return}return t},uo=!1,Wl={},lo=le("crypto.checkPrime"),po=le("crypto.checkPrimeSync"),fo=le("crypto.createCipher"),ho=le("crypto.createDecipher"),yo=le("crypto.pseudoRandomBytes"),mo=le("crypto.createCipheriv"),go=le("crypto.createDecipheriv"),vo=le("crypto.createDiffieHellman"),bo=le("crypto.createDiffieHellmanGroup"),Eo=le("crypto.createECDH"),Co=le("crypto.createHash"),To=le("crypto.createHmac"),So=le("crypto.createPrivateKey"),_o=le("crypto.createPublicKey"),Ao=le("crypto.createSecretKey"),Io=le("crypto.createSign"),wo=le("crypto.createVerify"),Bo=le("crypto.diffieHellman"),No=le("crypto.generatePrime"),xo=le("crypto.generatePrimeSync"),ko=le("crypto.getCiphers"),Ro=le("crypto.getCipherInfo"),Lo=le("crypto.getCurves"),Po=le("crypto.getDiffieHellman"),Uo=le("crypto.getHashes"),Do=le("crypto.hkdf"),Oo=le("crypto.hkdfSync"),Vo=le("crypto.pbkdf2"),Mo=le("crypto.pbkdf2Sync"),Ko=le("crypto.generateKeyPair"),Ho=le("crypto.generateKeyPairSync"),Fo=le("crypto.generateKey"),jo=le("crypto.generateKeySync"),qo=le("crypto.privateDecrypt"),Go=le("crypto.privateEncrypt"),zo=le("crypto.publicDecrypt"),$o=le("crypto.publicEncrypt"),Wo=le("crypto.randomFill"),Qo=le("crypto.randomFillSync"),Yo=le("crypto.randomInt"),Xo=le("crypto.scrypt"),Jo=le("crypto.scryptSync"),Zo=le("crypto.sign"),ec=le("crypto.setEngine"),tc=le("crypto.timingSafeEqual"),rc=le("crypto.getFips"),nc=le("crypto.setFips"),ac=le("crypto.verify"),ic=le("crypto.secureHeapUsed"),sc=le("crypto.hash"),oc=ot("crypto.Certificate"),cc=ot("crypto.Cipher"),uc=ot("crypto.Cipheriv"),lc=ot("crypto.Decipher"),pc=ot("crypto.Decipheriv"),fc=ot("crypto.DiffieHellman"),dc=ot("crypto.DiffieHellmanGroup"),hc=ot("crypto.ECDH"),yc=ot("crypto.Hash"),mc=ot("crypto.Hmac"),gc=ot("crypto.KeyObject"),vc=ot("crypto.Sign"),bc=ot("crypto.Verify"),Ec=ot("crypto.X509Certificate"),Cc={ALPN_ENABLED:1,DH_CHECK_P_NOT_PRIME:1,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_NOT_SUITABLE_GENERATOR:8,DH_UNABLE_TO_CHECK_GENERATOR:4,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DH:4,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_DSA:2,ENGINE_METHOD_EC:2048,ENGINE_METHOD_NONE:0,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_RAND:8,ENGINE_METHOD_RSA:1,OPENSSL_VERSION_NUMBER:0,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_HYBRID:6,POINT_CONVERSION_UNCOMPRESSED:4,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_PKCS1_PADDING:1,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_AUTO:-2,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_X931_PADDING:5,SSL_OP_ALL:2147485776,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_NO_TLSv1:67108864,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,TLS1_1_VERSION:0,TLS1_2_VERSION:0,TLS1_3_VERSION:0,TLS1_VERSION:0,defaultCoreCipherList:"",get defaultCipherList(){return Cc.defaultCoreCipherList},set defaultCipherList(i){}},Tc=Cc,Ql={...no,...so,constants:Tc}});var Kr,br,Yl,Sc,Xl,Jl,Zl,ep,_a,he,tp,rp,me,np,Ce,Aa,_c,sr,or,Pt,Ht,Hr,Ia,Er,Bn,wa,Ac,Ic,It,wc,Nn,Fr,Bc,Nc,xn,xc,kc,Rc,ap,Ba,Na,Lc,Pc,Uc,ip,Dc,sp,op,cp,up,lp,pp,fp,dp,Sa,hp,Oc,xa=Kn(()=>{Ta();Kr=(i,...r)=>({$t:setTimeout(i,0,...r),[Symbol.dispose](){clearTimeout(this.t)}}),br=i=>{let r=e=>typeof e.default<"u"?e.default:e,t=e=>Object.assign({__esModule:!0},e);switch(i){case"node:crypto":return r(Ca);default:return console.error('module "'+i+'" not found'),null}},Yl=Object.create,Sc=Object.defineProperty,Xl=Object.getOwnPropertyDescriptor,Jl=Object.getOwnPropertyNames,Zl=Object.getPrototypeOf,ep=Object.prototype.hasOwnProperty,_a=(i=>typeof br<"u"?br:typeof Proxy<"u"?new Proxy(i,{get:(r,t)=>(typeof br<"u"?br:r)[t]}):i)(function(i){if(typeof br<"u")return br.apply(this,arguments);throw Error('Dynamic require of "'+i+'" is not supported')}),he=(i,r)=>()=>(r||i((r={exports:{}}).exports,r),r.exports),tp=(i,r,t,e)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of Jl(r))!ep.call(i,n)&&n!==t&&Sc(i,n,{get:()=>r[n],enumerable:!(e=Xl(r,n))||e.enumerable});return i},rp=(i,r,t)=>(t=i!=null?Yl(Zl(i)):{},tp(r||!i||!i.__esModule?Sc(t,"default",{value:i,enumerable:!0}):t,i)),me=he((i,r)=>{r.exports={options:{usePureJavaScript:!1}}}),np=he((i,r)=>{var t={};r.exports=t;var e={};t.encode=function(s,u,d){if(typeof u!="string")throw new TypeError('"alphabet" must be a string.');if(d!==void 0&&typeof d!="number")throw new TypeError('"maxline" must be a number.');var c="";if(!(s instanceof Uint8Array))c=n(s,u);else{var a=0,h=u.length,p=u.charAt(0),T=[0];for(a=0;a<s.length;++a){for(var I=0,A=s[a];I<T.length;++I)A+=T[I]<<8,T[I]=A%h,A=A/h|0;for(;A>0;)T.push(A%h),A=A/h|0}for(a=0;s[a]===0&&a<s.length-1;++a)c+=p;for(a=T.length-1;a>=0;--a)c+=u[T[a]]}if(d){var m=new RegExp(".{1,"+d+"}","g");c=c.match(m).join(`\r
`)}return c},t.decode=function(s,u){if(typeof s!="string")throw new TypeError('"input" must be a string.');if(typeof u!="string")throw new TypeError('"alphabet" must be a string.');var d=e[u];if(!d){d=e[u]=[];for(var c=0;c<u.length;++c)d[u.charCodeAt(c)]=c}s=s.replace(/\s/g,"");for(var a=u.length,h=u.charAt(0),p=[0],c=0;c<s.length;c++){var T=d[s.charCodeAt(c)];if(T===void 0)return;for(var I=0,A=T;I<p.length;++I)A+=p[I]*a,p[I]=A&255,A>>=8;for(;A>0;)p.push(A&255),A>>=8}for(var m=0;s[m]===h&&m<s.length-1;++m)p.push(0);return typeof __Buffer$<"u"?__Buffer$.from(p.reverse()):new Uint8Array(p.reverse())};function n(s,u){var d=0,c=u.length,a=u.charAt(0),h=[0];for(d=0;d<s.length();++d){for(var p=0,T=s.at(d);p<h.length;++p)T+=h[p]<<8,h[p]=T%c,T=T/c|0;for(;T>0;)h.push(T%c),T=T/c|0}var I="";for(d=0;s.at(d)===0&&d<s.length()-1;++d)I+=a;for(d=h.length-1;d>=0;--d)I+=u[h[d]];return I}}),Ce=he((i,r)=>{var t=me(),e=np(),n=r.exports=t.util=t.util||{};(function(){if(typeof __Process$<"u"&&__Process$.nextTick&&!__Process$.browser){n.nextTick=__Process$.nextTick,typeof Kr=="function"?n.setImmediate=Kr:n.setImmediate=n.nextTick;return}if(typeof Kr=="function"){n.setImmediate=function(){return Kr.apply(void 0,arguments)},n.nextTick=function(o){return Kr(o)};return}if(n.setImmediate=function(o){setTimeout(o,0)},typeof window<"u"&&typeof window.postMessage=="function"){let o=function(w){if(w.source===window&&w.data===v){w.stopPropagation();var U=_.slice();_.length=0,U.forEach(function(K){K()})}};var l=o,v="forge.setImmediate",_=[];n.setImmediate=function(w){_.push(w),_.length===1&&window.postMessage(v,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver<"u"){var B=Date.now(),L=!0,g=document.createElement("div"),_=[];new MutationObserver(function(){var w=_.slice();_.length=0,w.forEach(function(U){U()})}).observe(g,{attributes:!0});var f=n.setImmediate;n.setImmediate=function(w){Date.now()-B>15?(B=Date.now(),f(w)):(_.push(w),_.length===1&&g.setAttribute("a",L=!L))}}n.nextTick=n.setImmediate})(),n.isNodejs=typeof __Process$<"u"&&__Process$.versions&&__Process$.versions.node,n.globalScope=function(){return n.isNodejs?globalThis:typeof self>"u"?window:self}(),n.isArray=Array.isArray||function(l){return Object.prototype.toString.call(l)==="[object Array]"},n.isArrayBuffer=function(l){return typeof ArrayBuffer<"u"&&l instanceof ArrayBuffer},n.isArrayBufferView=function(l){return l&&n.isArrayBuffer(l.buffer)&&l.byteLength!==void 0};function s(l){if(!(l===8||l===16||l===24||l===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+l)}n.ByteBuffer=u;function u(l){if(this.data="",this.read=0,typeof l=="string")this.data=l;else if(n.isArrayBuffer(l)||n.isArrayBufferView(l))if(typeof __Buffer$<"u"&&l instanceof __Buffer$)this.data=l.toString("binary");else{var v=new Uint8Array(l);try{this.data=String.fromCharCode.apply(null,v)}catch{for(var _=0;_<v.length;++_)this.putByte(v[_])}}else(l instanceof u||typeof l=="object"&&typeof l.data=="string"&&typeof l.read=="number")&&(this.data=l.data,this.read=l.read);this._constructedStringLength=0}n.ByteStringBuffer=u;var d=4096;n.ByteStringBuffer.prototype._optimizeConstructedString=function(l){this._constructedStringLength+=l,this._constructedStringLength>d&&(this.data.substr(0,1),this._constructedStringLength=0)},n.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},n.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},n.ByteStringBuffer.prototype.putByte=function(l){return this.putBytes(String.fromCharCode(l))},n.ByteStringBuffer.prototype.fillWithByte=function(l,v){l=String.fromCharCode(l);for(var _=this.data;v>0;)v&1&&(_+=l),v>>>=1,v>0&&(l+=l);return this.data=_,this._optimizeConstructedString(v),this},n.ByteStringBuffer.prototype.putBytes=function(l){return this.data+=l,this._optimizeConstructedString(l.length),this},n.ByteStringBuffer.prototype.putString=function(l){return this.putBytes(n.encodeUtf8(l))},n.ByteStringBuffer.prototype.putInt16=function(l){return this.putBytes(String.fromCharCode(l>>8&255)+String.fromCharCode(l&255))},n.ByteStringBuffer.prototype.putInt24=function(l){return this.putBytes(String.fromCharCode(l>>16&255)+String.fromCharCode(l>>8&255)+String.fromCharCode(l&255))},n.ByteStringBuffer.prototype.putInt32=function(l){return this.putBytes(String.fromCharCode(l>>24&255)+String.fromCharCode(l>>16&255)+String.fromCharCode(l>>8&255)+String.fromCharCode(l&255))},n.ByteStringBuffer.prototype.putInt16Le=function(l){return this.putBytes(String.fromCharCode(l&255)+String.fromCharCode(l>>8&255))},n.ByteStringBuffer.prototype.putInt24Le=function(l){return this.putBytes(String.fromCharCode(l&255)+String.fromCharCode(l>>8&255)+String.fromCharCode(l>>16&255))},n.ByteStringBuffer.prototype.putInt32Le=function(l){return this.putBytes(String.fromCharCode(l&255)+String.fromCharCode(l>>8&255)+String.fromCharCode(l>>16&255)+String.fromCharCode(l>>24&255))},n.ByteStringBuffer.prototype.putInt=function(l,v){s(v);var _="";do v-=8,_+=String.fromCharCode(l>>v&255);while(v>0);return this.putBytes(_)},n.ByteStringBuffer.prototype.putSignedInt=function(l,v){return l<0&&(l+=2<<v-1),this.putInt(l,v)},n.ByteStringBuffer.prototype.putBuffer=function(l){return this.putBytes(l.getBytes())},n.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},n.ByteStringBuffer.prototype.getInt16=function(){var l=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,l},n.ByteStringBuffer.prototype.getInt24=function(){var l=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,l},n.ByteStringBuffer.prototype.getInt32=function(){var l=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,l},n.ByteStringBuffer.prototype.getInt16Le=function(){var l=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,l},n.ByteStringBuffer.prototype.getInt24Le=function(){var l=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,l},n.ByteStringBuffer.prototype.getInt32Le=function(){var l=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,l},n.ByteStringBuffer.prototype.getInt=function(l){s(l);var v=0;do v=(v<<8)+this.data.charCodeAt(this.read++),l-=8;while(l>0);return v},n.ByteStringBuffer.prototype.getSignedInt=function(l){var v=this.getInt(l),_=2<<l-2;return v>=_&&(v-=_<<1),v},n.ByteStringBuffer.prototype.getBytes=function(l){var v;return l?(l=Math.min(this.length(),l),v=this.data.slice(this.read,this.read+l),this.read+=l):l===0?v="":(v=this.read===0?this.data:this.data.slice(this.read),this.clear()),v},n.ByteStringBuffer.prototype.bytes=function(l){return typeof l>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+l)},n.ByteStringBuffer.prototype.at=function(l){return this.data.charCodeAt(this.read+l)},n.ByteStringBuffer.prototype.setAt=function(l,v){return this.data=this.data.substr(0,this.read+l)+String.fromCharCode(v)+this.data.substr(this.read+l+1),this},n.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},n.ByteStringBuffer.prototype.copy=function(){var l=n.createBuffer(this.data);return l.read=this.read,l},n.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},n.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},n.ByteStringBuffer.prototype.truncate=function(l){var v=Math.max(0,this.length()-l);return this.data=this.data.substr(this.read,v),this.read=0,this},n.ByteStringBuffer.prototype.toHex=function(){for(var l="",v=this.read;v<this.data.length;++v){var _=this.data.charCodeAt(v);_<16&&(l+="0"),l+=_.toString(16)}return l},n.ByteStringBuffer.prototype.toString=function(){return n.decodeUtf8(this.bytes())};function c(l,v){v=v||{},this.read=v.readOffset||0,this.growSize=v.growSize||1024;var _=n.isArrayBuffer(l),B=n.isArrayBufferView(l);if(_||B){_?this.data=new DataView(l):this.data=new DataView(l.buffer,l.byteOffset,l.byteLength),this.write="writeOffset"in v?v.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,l!=null&&this.putBytes(l),"writeOffset"in v&&(this.write=v.writeOffset)}n.DataBuffer=c,n.DataBuffer.prototype.length=function(){return this.write-this.read},n.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},n.DataBuffer.prototype.accommodate=function(l,v){if(this.length()>=l)return this;v=Math.max(v||this.growSize,l);var _=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),B=new Uint8Array(this.length()+v);return B.set(_),this.data=new DataView(B.buffer),this},n.DataBuffer.prototype.putByte=function(l){return this.accommodate(1),this.data.setUint8(this.write++,l),this},n.DataBuffer.prototype.fillWithByte=function(l,v){this.accommodate(v);for(var _=0;_<v;++_)this.data.setUint8(l);return this},n.DataBuffer.prototype.putBytes=function(l,v){if(n.isArrayBufferView(l)){var _=new Uint8Array(l.buffer,l.byteOffset,l.byteLength),B=_.byteLength-_.byteOffset;this.accommodate(B);var L=new Uint8Array(this.data.buffer,this.write);return L.set(_),this.write+=B,this}if(n.isArrayBuffer(l)){var _=new Uint8Array(l);this.accommodate(_.byteLength);var L=new Uint8Array(this.data.buffer);return L.set(_,this.write),this.write+=_.byteLength,this}if(l instanceof n.DataBuffer||typeof l=="object"&&typeof l.read=="number"&&typeof l.write=="number"&&n.isArrayBufferView(l.data)){var _=new Uint8Array(l.data.byteLength,l.read,l.length());this.accommodate(_.byteLength);var L=new Uint8Array(l.data.byteLength,this.write);return L.set(_),this.write+=_.byteLength,this}if(l instanceof n.ByteStringBuffer&&(l=l.data,v="binary"),v=v||"binary",typeof l=="string"){var g;if(v==="hex")return this.accommodate(Math.ceil(l.length/2)),g=new Uint8Array(this.data.buffer,this.write),this.write+=n.binary.hex.decode(l,g,this.write),this;if(v==="base64")return this.accommodate(Math.ceil(l.length/4)*3),g=new Uint8Array(this.data.buffer,this.write),this.write+=n.binary.base64.decode(l,g,this.write),this;if(v==="utf8"&&(l=n.encodeUtf8(l),v="binary"),v==="binary"||v==="raw")return this.accommodate(l.length),g=new Uint8Array(this.data.buffer,this.write),this.write+=n.binary.raw.decode(g),this;if(v==="utf16")return this.accommodate(l.length*2),g=new Uint16Array(this.data.buffer,this.write),this.write+=n.text.utf16.encode(g),this;throw new Error("Invalid encoding: "+v)}throw Error("Invalid parameter: "+l)},n.DataBuffer.prototype.putBuffer=function(l){return this.putBytes(l),l.clear(),this},n.DataBuffer.prototype.putString=function(l){return this.putBytes(l,"utf16")},n.DataBuffer.prototype.putInt16=function(l){return this.accommodate(2),this.data.setInt16(this.write,l),this.write+=2,this},n.DataBuffer.prototype.putInt24=function(l){return this.accommodate(3),this.data.setInt16(this.write,l>>8&65535),this.data.setInt8(this.write,l>>16&255),this.write+=3,this},n.DataBuffer.prototype.putInt32=function(l){return this.accommodate(4),this.data.setInt32(this.write,l),this.write+=4,this},n.DataBuffer.prototype.putInt16Le=function(l){return this.accommodate(2),this.data.setInt16(this.write,l,!0),this.write+=2,this},n.DataBuffer.prototype.putInt24Le=function(l){return this.accommodate(3),this.data.setInt8(this.write,l>>16&255),this.data.setInt16(this.write,l>>8&65535,!0),this.write+=3,this},n.DataBuffer.prototype.putInt32Le=function(l){return this.accommodate(4),this.data.setInt32(this.write,l,!0),this.write+=4,this},n.DataBuffer.prototype.putInt=function(l,v){s(v),this.accommodate(v/8);do v-=8,this.data.setInt8(this.write++,l>>v&255);while(v>0);return this},n.DataBuffer.prototype.putSignedInt=function(l,v){return s(v),this.accommodate(v/8),l<0&&(l+=2<<v-1),this.putInt(l,v)},n.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},n.DataBuffer.prototype.getInt16=function(){var l=this.data.getInt16(this.read);return this.read+=2,l},n.DataBuffer.prototype.getInt24=function(){var l=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,l},n.DataBuffer.prototype.getInt32=function(){var l=this.data.getInt32(this.read);return this.read+=4,l},n.DataBuffer.prototype.getInt16Le=function(){var l=this.data.getInt16(this.read,!0);return this.read+=2,l},n.DataBuffer.prototype.getInt24Le=function(){var l=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,l},n.DataBuffer.prototype.getInt32Le=function(){var l=this.data.getInt32(this.read,!0);return this.read+=4,l},n.DataBuffer.prototype.getInt=function(l){s(l);var v=0;do v=(v<<8)+this.data.getInt8(this.read++),l-=8;while(l>0);return v},n.DataBuffer.prototype.getSignedInt=function(l){var v=this.getInt(l),_=2<<l-2;return v>=_&&(v-=_<<1),v},n.DataBuffer.prototype.getBytes=function(l){var v;return l?(l=Math.min(this.length(),l),v=this.data.slice(this.read,this.read+l),this.read+=l):l===0?v="":(v=this.read===0?this.data:this.data.slice(this.read),this.clear()),v},n.DataBuffer.prototype.bytes=function(l){return typeof l>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+l)},n.DataBuffer.prototype.at=function(l){return this.data.getUint8(this.read+l)},n.DataBuffer.prototype.setAt=function(l,v){return this.data.setUint8(l,v),this},n.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},n.DataBuffer.prototype.copy=function(){return new n.DataBuffer(this)},n.DataBuffer.prototype.compact=function(){if(this.read>0){var l=new Uint8Array(this.data.buffer,this.read),v=new Uint8Array(l.byteLength);v.set(l),this.data=new DataView(v),this.write-=this.read,this.read=0}return this},n.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},n.DataBuffer.prototype.truncate=function(l){return this.write=Math.max(0,this.length()-l),this.read=Math.min(this.read,this.write),this},n.DataBuffer.prototype.toHex=function(){for(var l="",v=this.read;v<this.data.byteLength;++v){var _=this.data.getUint8(v);_<16&&(l+="0"),l+=_.toString(16)}return l},n.DataBuffer.prototype.toString=function(l){var v=new Uint8Array(this.data,this.read,this.length());if(l=l||"utf8",l==="binary"||l==="raw")return n.binary.raw.encode(v);if(l==="hex")return n.binary.hex.encode(v);if(l==="base64")return n.binary.base64.encode(v);if(l==="utf8")return n.text.utf8.decode(v);if(l==="utf16")return n.text.utf16.decode(v);throw new Error("Invalid encoding: "+l)},n.createBuffer=function(l,v){return v=v||"raw",l!==void 0&&v==="utf8"&&(l=n.encodeUtf8(l)),new n.ByteBuffer(l)},n.fillString=function(l,v){for(var _="";v>0;)v&1&&(_+=l),v>>>=1,v>0&&(l+=l);return _},n.xorBytes=function(l,v,_){for(var B="",L="",g="",f=0,o=0;_>0;--_,++f)L=l.charCodeAt(f)^v.charCodeAt(f),o>=10&&(B+=g,g="",o=0),g+=String.fromCharCode(L),++o;return B+=g,B},n.hexToBytes=function(l){var v="",_=0;for(l.length&!0&&(_=1,v+=String.fromCharCode(parseInt(l[0],16)));_<l.length;_+=2)v+=String.fromCharCode(parseInt(l.substr(_,2),16));return v},n.bytesToHex=function(l){return n.createBuffer(l).toHex()},n.int32ToBytes=function(l){return String.fromCharCode(l>>24&255)+String.fromCharCode(l>>16&255)+String.fromCharCode(l>>8&255)+String.fromCharCode(l&255)};var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],p="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";n.encode64=function(l,v){for(var _="",B="",L,g,f,o=0;o<l.length;)L=l.charCodeAt(o++),g=l.charCodeAt(o++),f=l.charCodeAt(o++),_+=a.charAt(L>>2),_+=a.charAt((L&3)<<4|g>>4),isNaN(g)?_+="==":(_+=a.charAt((g&15)<<2|f>>6),_+=isNaN(f)?"=":a.charAt(f&63)),v&&_.length>v&&(B+=_.substr(0,v)+`\r
`,_=_.substr(v));return B+=_,B},n.decode64=function(l){l=l.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var v="",_,B,L,g,f=0;f<l.length;)_=h[l.charCodeAt(f++)-43],B=h[l.charCodeAt(f++)-43],L=h[l.charCodeAt(f++)-43],g=h[l.charCodeAt(f++)-43],v+=String.fromCharCode(_<<2|B>>4),L!==64&&(v+=String.fromCharCode((B&15)<<4|L>>2),g!==64&&(v+=String.fromCharCode((L&3)<<6|g)));return v},n.encodeUtf8=function(l){return unescape(encodeURIComponent(l))},n.decodeUtf8=function(l){return decodeURIComponent(escape(l))},n.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:e.encode,decode:e.decode}},n.binary.raw.encode=function(l){return String.fromCharCode.apply(null,l)},n.binary.raw.decode=function(l,v,_){var B=v;B||(B=new Uint8Array(l.length)),_=_||0;for(var L=_,g=0;g<l.length;++g)B[L++]=l.charCodeAt(g);return v?L-_:B},n.binary.hex.encode=n.bytesToHex,n.binary.hex.decode=function(l,v,_){var B=v;B||(B=new Uint8Array(Math.ceil(l.length/2))),_=_||0;var L=0,g=_;for(l.length&1&&(L=1,B[g++]=parseInt(l[0],16));L<l.length;L+=2)B[g++]=parseInt(l.substr(L,2),16);return v?g-_:B},n.binary.base64.encode=function(l,v){for(var _="",B="",L,g,f,o=0;o<l.byteLength;)L=l[o++],g=l[o++],f=l[o++],_+=a.charAt(L>>2),_+=a.charAt((L&3)<<4|g>>4),isNaN(g)?_+="==":(_+=a.charAt((g&15)<<2|f>>6),_+=isNaN(f)?"=":a.charAt(f&63)),v&&_.length>v&&(B+=_.substr(0,v)+`\r
`,_=_.substr(v));return B+=_,B},n.binary.base64.decode=function(l,v,_){var B=v;B||(B=new Uint8Array(Math.ceil(l.length/4)*3)),l=l.replace(/[^A-Za-z0-9\+\/\=]/g,""),_=_||0;for(var L,g,f,o,w=0,U=_;w<l.length;)L=h[l.charCodeAt(w++)-43],g=h[l.charCodeAt(w++)-43],f=h[l.charCodeAt(w++)-43],o=h[l.charCodeAt(w++)-43],B[U++]=L<<2|g>>4,f!==64&&(B[U++]=(g&15)<<4|f>>2,o!==64&&(B[U++]=(f&3)<<6|o));return v?U-_:B.subarray(0,U)},n.binary.base58.encode=function(l,v){return n.binary.baseN.encode(l,p,v)},n.binary.base58.decode=function(l,v){return n.binary.baseN.decode(l,p,v)},n.text={utf8:{},utf16:{}},n.text.utf8.encode=function(l,v,_){l=n.encodeUtf8(l);var B=v;B||(B=new Uint8Array(l.length)),_=_||0;for(var L=_,g=0;g<l.length;++g)B[L++]=l.charCodeAt(g);return v?L-_:B},n.text.utf8.decode=function(l){return n.decodeUtf8(String.fromCharCode.apply(null,l))},n.text.utf16.encode=function(l,v,_){var B=v;B||(B=new Uint8Array(l.length*2));var L=new Uint16Array(B.buffer);_=_||0;for(var g=_,f=_,o=0;o<l.length;++o)L[f++]=l.charCodeAt(o),g+=2;return v?g-_:B},n.text.utf16.decode=function(l){return String.fromCharCode.apply(null,new Uint16Array(l.buffer))},n.deflate=function(l,v,_){if(v=n.decode64(l.deflate(n.encode64(v)).rval),_){var B=2,L=v.charCodeAt(1);L&32&&(B=6),v=v.substring(B,v.length-4)}return v},n.inflate=function(l,v,_){var B=l.inflate(n.encode64(v)).rval;return B===null?null:n.decode64(B)};var T=function(l,v,_){if(!l)throw new Error("WebStorage not available.");var B;if(_===null?B=l.removeItem(v):(_=n.encode64(JSON.stringify(_)),B=l.setItem(v,_)),typeof B<"u"&&B.rval!==!0){var L=new Error(B.error.message);throw L.id=B.error.id,L.name=B.error.name,L}},I=function(l,v){if(!l)throw new Error("WebStorage not available.");var _=l.getItem(v);if(l.init)if(_.rval===null){if(_.error){var B=new Error(_.error.message);throw B.id=_.error.id,B.name=_.error.name,B}_=null}else _=_.rval;return _!==null&&(_=JSON.parse(n.decode64(_))),_},A=function(l,v,_,B){var L=I(l,v);L===null&&(L={}),L[_]=B,T(l,v,L)},m=function(l,v,_){var B=I(l,v);return B!==null&&(B=_ in B?B[_]:null),B},S=function(l,v,_){var B=I(l,v);if(B!==null&&_ in B){delete B[_];var L=!0;for(var g in B){L=!1;break}L&&(B=null),T(l,v,B)}},C=function(l,v){T(l,v,null)},E=function(l,v,_){var B=null;typeof _>"u"&&(_=["web","flash"]);var L,g=!1,f=null;for(var o in _){L=_[o];try{if(L==="flash"||L==="both"){if(v[0]===null)throw new Error("Flash local storage not available.");B=l.apply(this,v),g=L==="flash"}(L==="web"||L==="both")&&(v[0]=localStorage,B=l.apply(this,v),g=!0)}catch(w){f=w}if(g)break}if(!g)throw f;return B};n.setItem=function(l,v,_,B,L){E(A,arguments,L)},n.getItem=function(l,v,_,B){return E(m,arguments,B)},n.removeItem=function(l,v,_,B){E(S,arguments,B)},n.clearItems=function(l,v,_){E(C,arguments,_)},n.isEmpty=function(l){for(var v in l)if(l.hasOwnProperty(v))return!1;return!0},n.format=function(l){for(var v=/%./g,_,B,L=0,g=[],f=0;_=v.exec(l);){B=l.substring(f,v.lastIndex-2),B.length>0&&g.push(B),f=v.lastIndex;var o=_[0][1];switch(o){case"s":case"o":L<arguments.length?g.push(arguments[L+++1]):g.push("<?>");break;case"%":g.push("%");break;default:g.push("<%"+o+"?>")}}return g.push(l.substring(f)),g.join("")},n.formatNumber=function(l,v,_,B){var L=l,g=isNaN(v=Math.abs(v))?2:v,f=_===void 0?",":_,o=B===void 0?".":B,w=L<0?"-":"",U=parseInt(L=Math.abs(+L||0).toFixed(g),10)+"",K=U.length>3?U.length%3:0;return w+(K?U.substr(0,K)+o:"")+U.substr(K).replace(/(\d{3})(?=\d)/g,"$1"+o)+(g?f+Math.abs(L-U).toFixed(g).slice(2):"")},n.formatSize=function(l){return l>=1073741824?l=n.formatNumber(l/1073741824,2,".","")+" GiB":l>=1048576?l=n.formatNumber(l/1048576,2,".","")+" MiB":l>=1024?l=n.formatNumber(l/1024,0)+" KiB":l=n.formatNumber(l,0)+" bytes",l},n.bytesFromIP=function(l){return l.indexOf(".")!==-1?n.bytesFromIPv4(l):l.indexOf(":")!==-1?n.bytesFromIPv6(l):null},n.bytesFromIPv4=function(l){if(l=l.split("."),l.length!==4)return null;for(var v=n.createBuffer(),_=0;_<l.length;++_){var B=parseInt(l[_],10);if(isNaN(B))return null;v.putByte(B)}return v.getBytes()},n.bytesFromIPv6=function(l){var v=0;l=l.split(":").filter(function(f){return f.length===0&&++v,!0});for(var _=(8-l.length+v)*2,B=n.createBuffer(),L=0;L<8;++L){if(!l[L]||l[L].length===0){B.fillWithByte(0,_),_=0;continue}var g=n.hexToBytes(l[L]);g.length<2&&B.putByte(0),B.putBytes(g)}return B.getBytes()},n.bytesToIP=function(l){return l.length===4?n.bytesToIPv4(l):l.length===16?n.bytesToIPv6(l):null},n.bytesToIPv4=function(l){if(l.length!==4)return null;for(var v=[],_=0;_<l.length;++_)v.push(l.charCodeAt(_));return v.join(".")},n.bytesToIPv6=function(l){if(l.length!==16)return null;for(var v=[],_=[],B=0,L=0;L<l.length;L+=2){for(var g=n.bytesToHex(l[L]+l[L+1]);g[0]==="0"&&g!=="0";)g=g.substr(1);if(g==="0"){var f=_[_.length-1],o=v.length;!f||o!==f.end+1?_.push({start:o,end:o}):(f.end=o,f.end-f.start>_[B].end-_[B].start&&(B=_.length-1))}v.push(g)}if(_.length>0){var w=_[B];w.end-w.start>0&&(v.splice(w.start,w.end-w.start+1,""),w.start===0&&v.unshift(""),w.end===7&&v.push(""))}return v.join(":")},n.estimateCores=function(l,v){if(typeof l=="function"&&(v=l,l={}),l=l||{},"cores"in n&&!l.update)return v(null,n.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return n.cores=navigator.hardwareConcurrency,v(null,n.cores);if(typeof Worker>"u")return n.cores=1,v(null,n.cores);if(typeof Blob>"u")return n.cores=2,v(null,n.cores);var _=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(f){for(var o=Date.now(),w=o+4;Date.now()<w;);self.postMessage({st:o,et:w})})}.toString(),")()"],{type:"application/javascript"}));B([],5,16);function B(f,o,w){if(o===0){var U=Math.floor(f.reduce(function(K,D){return K+D},0)/f.length);return n.cores=Math.max(1,U),URL.revokeObjectURL(_),v(null,n.cores)}L(w,function(K,D){f.push(g(w,D)),B(f,o-1,w)})}function L(f,o){for(var w=[],U=[],K=0;K<f;++K){var D=new Worker(_);D.addEventListener("message",function(H){if(U.push(H.data),U.length===f){for(var q=0;q<f;++q)w[q].terminate();o(null,U)}}),w.push(D)}for(var K=0;K<f;++K)w[K].postMessage(K)}function g(f,o){for(var w=[],U=0;U<f;++U)for(var K=o[U],D=w[U]=[],H=0;H<f;++H)if(U!==H){var q=o[H];(K.st>q.st&&K.st<q.et||q.st>K.st&&q.st<K.et)&&D.push(H)}return w.reduce(function(G,z){return Math.max(G,z.length)},0)}}}),Aa=he((i,r)=>{var t=me();Ce(),r.exports=t.cipher=t.cipher||{},t.cipher.algorithms=t.cipher.algorithms||{},t.cipher.createCipher=function(n,s){var u=n;if(typeof u=="string"&&(u=t.cipher.getAlgorithm(u),u&&(u=u())),!u)throw new Error("Unsupported algorithm: "+n);return new t.cipher.BlockCipher({algorithm:u,key:s,decrypt:!1})},t.cipher.createDecipher=function(n,s){var u=n;if(typeof u=="string"&&(u=t.cipher.getAlgorithm(u),u&&(u=u())),!u)throw new Error("Unsupported algorithm: "+n);return new t.cipher.BlockCipher({algorithm:u,key:s,decrypt:!0})},t.cipher.registerAlgorithm=function(n,s){n=n.toUpperCase(),t.cipher.algorithms[n]=s},t.cipher.getAlgorithm=function(n){return n=n.toUpperCase(),n in t.cipher.algorithms?t.cipher.algorithms[n]:null};var e=t.cipher.BlockCipher=function(n){this.algorithm=n.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=n.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=n.decrypt,this.algorithm.initialize(n)};e.prototype.start=function(n){n=n||{};var s={};for(var u in n)s[u]=n[u];s.decrypt=this._decrypt,this._finish=!1,this._input=t.util.createBuffer(),this.output=n.output||t.util.createBuffer(),this.mode.start(s)},e.prototype.update=function(n){for(n&&this._input.putBuffer(n);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},e.prototype.finish=function(n){n&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(u){return n(this.blockSize,u,!1)},this.mode.unpad=function(u){return n(this.blockSize,u,!0)});var s={};return s.decrypt=this._decrypt,s.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,s)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,s))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,s))}}),_c=he((i,r)=>{var t=me();Ce(),t.cipher=t.cipher||{};var e=r.exports=t.cipher.modes=t.cipher.modes||{};e.ecb=function(d){d=d||{},this.name="ECB",this.cipher=d.cipher,this.blockSize=d.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.ecb.prototype.start=function(d){},e.ecb.prototype.encrypt=function(d,c,a){if(d.length()<this.blockSize&&!(a&&d.length()>0))return!0;for(var h=0;h<this._ints;++h)this._inBlock[h]=d.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var h=0;h<this._ints;++h)c.putInt32(this._outBlock[h])},e.ecb.prototype.decrypt=function(d,c,a){if(d.length()<this.blockSize&&!(a&&d.length()>0))return!0;for(var h=0;h<this._ints;++h)this._inBlock[h]=d.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var h=0;h<this._ints;++h)c.putInt32(this._outBlock[h])},e.ecb.prototype.pad=function(d,c){var a=d.length()===this.blockSize?this.blockSize:this.blockSize-d.length();return d.fillWithByte(a,a),!0},e.ecb.prototype.unpad=function(d,c){if(c.overflow>0)return!1;var a=d.length(),h=d.at(a-1);return h>this.blockSize<<2?!1:(d.truncate(h),!0)},e.cbc=function(d){d=d||{},this.name="CBC",this.cipher=d.cipher,this.blockSize=d.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.cbc.prototype.start=function(d){if(d.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in d)this._iv=n(d.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},e.cbc.prototype.encrypt=function(d,c,a){if(d.length()<this.blockSize&&!(a&&d.length()>0))return!0;for(var h=0;h<this._ints;++h)this._inBlock[h]=this._prev[h]^d.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var h=0;h<this._ints;++h)c.putInt32(this._outBlock[h]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(d,c,a){if(d.length()<this.blockSize&&!(a&&d.length()>0))return!0;for(var h=0;h<this._ints;++h)this._inBlock[h]=d.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var h=0;h<this._ints;++h)c.putInt32(this._prev[h]^this._outBlock[h]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(d,c){var a=d.length()===this.blockSize?this.blockSize:this.blockSize-d.length();return d.fillWithByte(a,a),!0},e.cbc.prototype.unpad=function(d,c){if(c.overflow>0)return!1;var a=d.length(),h=d.at(a-1);return h>this.blockSize<<2?!1:(d.truncate(h),!0)},e.cfb=function(d){d=d||{},this.name="CFB",this.cipher=d.cipher,this.blockSize=d.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(d){if(!("iv"in d))throw new Error("Invalid IV parameter.");this._iv=n(d.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(d,c,a){var h=d.length();if(h===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&h>=this.blockSize){for(var p=0;p<this._ints;++p)this._inBlock[p]=d.getInt32()^this._outBlock[p],c.putInt32(this._inBlock[p]);return}var T=(this.blockSize-h)%this.blockSize;T>0&&(T=this.blockSize-T),this._partialOutput.clear();for(var p=0;p<this._ints;++p)this._partialBlock[p]=d.getInt32()^this._outBlock[p],this._partialOutput.putInt32(this._partialBlock[p]);if(T>0)d.read-=this.blockSize;else for(var p=0;p<this._ints;++p)this._inBlock[p]=this._partialBlock[p];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),T>0&&!a)return c.putBytes(this._partialOutput.getBytes(T-this._partialBytes)),this._partialBytes=T,!0;c.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0},e.cfb.prototype.decrypt=function(d,c,a){var h=d.length();if(h===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&h>=this.blockSize){for(var p=0;p<this._ints;++p)this._inBlock[p]=d.getInt32(),c.putInt32(this._inBlock[p]^this._outBlock[p]);return}var T=(this.blockSize-h)%this.blockSize;T>0&&(T=this.blockSize-T),this._partialOutput.clear();for(var p=0;p<this._ints;++p)this._partialBlock[p]=d.getInt32(),this._partialOutput.putInt32(this._partialBlock[p]^this._outBlock[p]);if(T>0)d.read-=this.blockSize;else for(var p=0;p<this._ints;++p)this._inBlock[p]=this._partialBlock[p];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),T>0&&!a)return c.putBytes(this._partialOutput.getBytes(T-this._partialBytes)),this._partialBytes=T,!0;c.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0},e.ofb=function(d){d=d||{},this.name="OFB",this.cipher=d.cipher,this.blockSize=d.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(d){if(!("iv"in d))throw new Error("Invalid IV parameter.");this._iv=n(d.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(d,c,a){var h=d.length();if(d.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&h>=this.blockSize){for(var p=0;p<this._ints;++p)c.putInt32(d.getInt32()^this._outBlock[p]),this._inBlock[p]=this._outBlock[p];return}var T=(this.blockSize-h)%this.blockSize;T>0&&(T=this.blockSize-T),this._partialOutput.clear();for(var p=0;p<this._ints;++p)this._partialOutput.putInt32(d.getInt32()^this._outBlock[p]);if(T>0)d.read-=this.blockSize;else for(var p=0;p<this._ints;++p)this._inBlock[p]=this._outBlock[p];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),T>0&&!a)return c.putBytes(this._partialOutput.getBytes(T-this._partialBytes)),this._partialBytes=T,!0;c.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(d){d=d||{},this.name="CTR",this.cipher=d.cipher,this.blockSize=d.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(d){if(!("iv"in d))throw new Error("Invalid IV parameter.");this._iv=n(d.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(d,c,a){var h=d.length();if(h===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&h>=this.blockSize)for(var p=0;p<this._ints;++p)c.putInt32(d.getInt32()^this._outBlock[p]);else{var T=(this.blockSize-h)%this.blockSize;T>0&&(T=this.blockSize-T),this._partialOutput.clear();for(var p=0;p<this._ints;++p)this._partialOutput.putInt32(d.getInt32()^this._outBlock[p]);if(T>0&&(d.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),T>0&&!a)return c.putBytes(this._partialOutput.getBytes(T-this._partialBytes)),this._partialBytes=T,!0;c.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0}s(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(d){d=d||{},this.name="GCM",this.cipher=d.cipher,this.blockSize=d.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(d){if(!("iv"in d))throw new Error("Invalid IV parameter.");var c=t.util.createBuffer(d.iv);this._cipherLength=0;var a;if("additionalData"in d?a=t.util.createBuffer(d.additionalData):a=t.util.createBuffer(),"tagLength"in d?this._tagLength=d.tagLength:this._tagLength=128,this._tag=null,d.decrypt&&(this._tag=t.util.createBuffer(d.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var h=c.length();if(h===12)this._j0=[c.getInt32(),c.getInt32(),c.getInt32(),1];else{for(this._j0=[0,0,0,0];c.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[c.getInt32(),c.getInt32(),c.getInt32(),c.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(u(h*8)))}this._inBlock=this._j0.slice(0),s(this._inBlock),this._partialBytes=0,a=t.util.createBuffer(a),this._aDataLength=u(a.length()*8);var p=a.length()%this.blockSize;for(p&&a.fillWithByte(0,this.blockSize-p),this._s=[0,0,0,0];a.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[a.getInt32(),a.getInt32(),a.getInt32(),a.getInt32()])},e.gcm.prototype.encrypt=function(d,c,a){var h=d.length();if(h===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&h>=this.blockSize){for(var p=0;p<this._ints;++p)c.putInt32(this._outBlock[p]^=d.getInt32());this._cipherLength+=this.blockSize}else{var T=(this.blockSize-h)%this.blockSize;T>0&&(T=this.blockSize-T),this._partialOutput.clear();for(var p=0;p<this._ints;++p)this._partialOutput.putInt32(d.getInt32()^this._outBlock[p]);if(T<=0||a){if(a){var I=h%this.blockSize;this._cipherLength+=I,this._partialOutput.truncate(this.blockSize-I)}else this._cipherLength+=this.blockSize;for(var p=0;p<this._ints;++p)this._outBlock[p]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),T>0&&!a)return d.read-=this.blockSize,c.putBytes(this._partialOutput.getBytes(T-this._partialBytes)),this._partialBytes=T,!0;c.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),s(this._inBlock)},e.gcm.prototype.decrypt=function(d,c,a){var h=d.length();if(h<this.blockSize&&!(a&&h>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),s(this._inBlock),this._hashBlock[0]=d.getInt32(),this._hashBlock[1]=d.getInt32(),this._hashBlock[2]=d.getInt32(),this._hashBlock[3]=d.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var p=0;p<this._ints;++p)c.putInt32(this._outBlock[p]^this._hashBlock[p]);h<this.blockSize?this._cipherLength+=h%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(d,c){var a=!0;c.decrypt&&c.overflow&&d.truncate(this.blockSize-c.overflow),this.tag=t.util.createBuffer();var h=this._aDataLength.concat(u(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,h);var p=[];this.cipher.encrypt(this._j0,p);for(var T=0;T<this._ints;++T)this.tag.putInt32(this._s[T]^p[T]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),c.decrypt&&this.tag.bytes()!==this._tag&&(a=!1),a},e.gcm.prototype.multiply=function(d,c){for(var a=[0,0,0,0],h=c.slice(0),p=0;p<128;++p){var T=d[p/32|0]&1<<31-p%32;T&&(a[0]^=h[0],a[1]^=h[1],a[2]^=h[2],a[3]^=h[3]),this.pow(h,h)}return a},e.gcm.prototype.pow=function(d,c){for(var a=d[3]&1,h=3;h>0;--h)c[h]=d[h]>>>1|(d[h-1]&1)<<31;c[0]=d[0]>>>1,a&&(c[0]^=this._R)},e.gcm.prototype.tableMultiply=function(d){for(var c=[0,0,0,0],a=0;a<32;++a){var h=a/8|0,p=d[h]>>>(7-a%8)*4&15,T=this._m[a][p];c[0]^=T[0],c[1]^=T[1],c[2]^=T[2],c[3]^=T[3]}return c},e.gcm.prototype.ghash=function(d,c,a){return c[0]^=a[0],c[1]^=a[1],c[2]^=a[2],c[3]^=a[3],this.tableMultiply(c)},e.gcm.prototype.generateHashTable=function(d,c){for(var a=8/c,h=4*a,p=16*a,T=new Array(p),I=0;I<p;++I){var A=[0,0,0,0],m=I/h|0,S=(h-1-I%h)*c;A[m]=1<<c-1<<S,T[I]=this.generateSubHashTable(this.multiply(A,d),c)}return T},e.gcm.prototype.generateSubHashTable=function(d,c){var a=1<<c,h=a>>>1,p=new Array(a);p[h]=d.slice(0);for(var T=h>>>1;T>0;)this.pow(p[2*T],p[T]=[]),T>>=1;for(T=2;T<h;){for(var I=1;I<T;++I){var A=p[T],m=p[I];p[T+I]=[A[0]^m[0],A[1]^m[1],A[2]^m[2],A[3]^m[3]]}T*=2}for(p[0]=[0,0,0,0],T=h+1;T<a;++T){var S=p[T^h];p[T]=[d[0]^S[0],d[1]^S[1],d[2]^S[2],d[3]^S[3]]}return p};function n(d,c){if(typeof d=="string"&&(d=t.util.createBuffer(d)),t.util.isArray(d)&&d.length>4){var a=d;d=t.util.createBuffer();for(var h=0;h<a.length;++h)d.putByte(a[h])}if(d.length()<c)throw new Error("Invalid IV length; got "+d.length()+" bytes and expected "+c+" bytes.");if(!t.util.isArray(d)){for(var p=[],T=c/4,h=0;h<T;++h)p.push(d.getInt32());d=p}return d}function s(d){d[d.length-1]=d[d.length-1]+1&4294967295}function u(d){return[d/4294967296|0,d&4294967295]}}),sr=he((i,r)=>{var t=me();Aa(),_c(),Ce(),r.exports=t.aes=t.aes||{},t.aes.startEncrypting=function(m,S,C,E){var l=A({key:m,output:C,decrypt:!1,mode:E});return l.start(S),l},t.aes.createEncryptionCipher=function(m,S){return A({key:m,output:null,decrypt:!1,mode:S})},t.aes.startDecrypting=function(m,S,C,E){var l=A({key:m,output:C,decrypt:!0,mode:E});return l.start(S),l},t.aes.createDecryptionCipher=function(m,S){return A({key:m,output:null,decrypt:!0,mode:S})},t.aes.Algorithm=function(m,S){n||p();var C=this;C.name=m,C.mode=new S({blockSize:16,cipher:{encrypt:function(E,l){return I(C._w,E,l,!1)},decrypt:function(E,l){return I(C._w,E,l,!0)}}}),C._init=!1},t.aes.Algorithm.prototype.initialize=function(m){if(!this._init){var S=m.key,C;if(typeof S=="string"&&(S.length===16||S.length===24||S.length===32))S=t.util.createBuffer(S);else if(t.util.isArray(S)&&(S.length===16||S.length===24||S.length===32)){C=S,S=t.util.createBuffer();for(var E=0;E<C.length;++E)S.putByte(C[E])}if(!t.util.isArray(S)){C=S,S=[];var l=C.length();if(l===16||l===24||l===32){l=l>>>2;for(var E=0;E<l;++E)S.push(C.getInt32())}}if(!t.util.isArray(S)||!(S.length===4||S.length===6||S.length===8))throw new Error("Invalid key parameter.");var v=this.mode.name,_=["CFB","OFB","CTR","GCM"].indexOf(v)!==-1;this._w=T(S,m.decrypt&&!_),this._init=!0}},t.aes._expandKey=function(m,S){return n||p(),T(m,S)},t.aes._updateBlock=I,e("AES-ECB",t.cipher.modes.ecb),e("AES-CBC",t.cipher.modes.cbc),e("AES-CFB",t.cipher.modes.cfb),e("AES-OFB",t.cipher.modes.ofb),e("AES-CTR",t.cipher.modes.ctr),e("AES-GCM",t.cipher.modes.gcm);function e(m,S){var C=function(){return new t.aes.Algorithm(m,S)};t.cipher.registerAlgorithm(m,C)}var n=!1,s=4,u,d,c,a,h;function p(){n=!0,c=[0,1,2,4,8,16,32,64,128,27,54];for(var m=new Array(256),S=0;S<128;++S)m[S]=S<<1,m[S+128]=S+128<<1^283;u=new Array(256),d=new Array(256),a=new Array(4),h=new Array(4);for(var S=0;S<4;++S)a[S]=new Array(256),h[S]=new Array(256);for(var C=0,E=0,l,v,_,B,L,g,f,S=0;S<256;++S){B=E^E<<1^E<<2^E<<3^E<<4,B=B>>8^B&255^99,u[C]=B,d[B]=C,L=m[B],l=m[C],v=m[l],_=m[v],g=L<<24^B<<16^B<<8^(B^L),f=(l^v^_)<<24^(C^_)<<16^(C^v^_)<<8^(C^l^_);for(var o=0;o<4;++o)a[o][C]=g,h[o][B]=f,g=g<<24|g>>>8,f=f<<24|f>>>8;C===0?C=E=1:(C=l^m[m[m[l^_]]],E^=m[m[E]])}}function T(m,S){for(var C=m.slice(0),E,l=1,v=C.length,_=v+6+1,B=s*_,L=v;L<B;++L)E=C[L-1],L%v===0?(E=u[E>>>16&255]<<24^u[E>>>8&255]<<16^u[E&255]<<8^u[E>>>24]^c[l]<<24,l++):v>6&&L%v===4&&(E=u[E>>>24]<<24^u[E>>>16&255]<<16^u[E>>>8&255]<<8^u[E&255]),C[L]=C[L-v]^E;if(S){var g,f=h[0],o=h[1],w=h[2],U=h[3],K=C.slice(0);B=C.length;for(var L=0,D=B-s;L<B;L+=s,D-=s)if(L===0||L===B-s)K[L]=C[D],K[L+1]=C[D+3],K[L+2]=C[D+2],K[L+3]=C[D+1];else for(var H=0;H<s;++H)g=C[D+H],K[L+(3&-H)]=f[u[g>>>24]]^o[u[g>>>16&255]]^w[u[g>>>8&255]]^U[u[g&255]];C=K}return C}function I(m,S,C,E){var l=m.length/4-1,v,_,B,L,g;E?(v=h[0],_=h[1],B=h[2],L=h[3],g=d):(v=a[0],_=a[1],B=a[2],L=a[3],g=u);var f,o,w,U,K,D,H;f=S[0]^m[0],o=S[E?3:1]^m[1],w=S[2]^m[2],U=S[E?1:3]^m[3];for(var q=3,G=1;G<l;++G)K=v[f>>>24]^_[o>>>16&255]^B[w>>>8&255]^L[U&255]^m[++q],D=v[o>>>24]^_[w>>>16&255]^B[U>>>8&255]^L[f&255]^m[++q],H=v[w>>>24]^_[U>>>16&255]^B[f>>>8&255]^L[o&255]^m[++q],U=v[U>>>24]^_[f>>>16&255]^B[o>>>8&255]^L[w&255]^m[++q],f=K,o=D,w=H;C[0]=g[f>>>24]<<24^g[o>>>16&255]<<16^g[w>>>8&255]<<8^g[U&255]^m[++q],C[E?3:1]=g[o>>>24]<<24^g[w>>>16&255]<<16^g[U>>>8&255]<<8^g[f&255]^m[++q],C[2]=g[w>>>24]<<24^g[U>>>16&255]<<16^g[f>>>8&255]<<8^g[o&255]^m[++q],C[E?1:3]=g[U>>>24]<<24^g[f>>>16&255]<<16^g[o>>>8&255]<<8^g[w&255]^m[++q]}function A(m){m=m||{};var S=(m.mode||"CBC").toUpperCase(),C="AES-"+S,E;m.decrypt?E=t.cipher.createDecipher(C,m.key):E=t.cipher.createCipher(C,m.key);var l=E.start;return E.start=function(v,_){var B=null;_ instanceof t.util.ByteBuffer&&(B=_,_={}),_=_||{},_.output=B,_.iv=v,l.call(E,_)},E}}),or=he((i,r)=>{var t=me();t.pki=t.pki||{};var e=r.exports=t.pki.oids=t.oids=t.oids||{};function n(u,d){e[u]=d,e[d]=u}function s(u,d){e[u]=d}n("1.2.840.113549.1.1.1","rsaEncryption"),n("1.2.840.113549.1.1.4","md5WithRSAEncryption"),n("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),n("1.2.840.113549.1.1.7","RSAES-OAEP"),n("1.2.840.113549.1.1.8","mgf1"),n("1.2.840.113549.1.1.9","pSpecified"),n("1.2.840.113549.1.1.10","RSASSA-PSS"),n("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),n("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),n("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),n("1.3.101.112","EdDSA25519"),n("1.2.840.10040.4.3","dsa-with-sha1"),n("1.3.14.3.2.7","desCBC"),n("1.3.14.3.2.26","sha1"),n("1.3.14.3.2.29","sha1WithRSASignature"),n("2.16.840.1.101.3.4.2.1","sha256"),n("2.16.840.1.101.3.4.2.2","sha384"),n("2.16.840.1.101.3.4.2.3","sha512"),n("2.16.840.1.101.3.4.2.4","sha224"),n("2.16.840.1.101.3.4.2.5","sha512-224"),n("2.16.840.1.101.3.4.2.6","sha512-256"),n("1.2.840.113549.2.2","md2"),n("1.2.840.113549.2.5","md5"),n("1.2.840.113549.1.7.1","data"),n("1.2.840.113549.1.7.2","signedData"),n("1.2.840.113549.1.7.3","envelopedData"),n("1.2.840.113549.1.7.4","signedAndEnvelopedData"),n("1.2.840.113549.1.7.5","digestedData"),n("1.2.840.113549.1.7.6","encryptedData"),n("1.2.840.113549.1.9.1","emailAddress"),n("1.2.840.113549.1.9.2","unstructuredName"),n("1.2.840.113549.1.9.3","contentType"),n("1.2.840.113549.1.9.4","messageDigest"),n("1.2.840.113549.1.9.5","signingTime"),n("1.2.840.113549.1.9.6","counterSignature"),n("1.2.840.113549.1.9.7","challengePassword"),n("1.2.840.113549.1.9.8","unstructuredAddress"),n("1.2.840.113549.1.9.14","extensionRequest"),n("1.2.840.113549.1.9.20","friendlyName"),n("1.2.840.113549.1.9.21","localKeyId"),n("1.2.840.113549.1.9.22.1","x509Certificate"),n("1.2.840.113549.1.12.10.1.1","keyBag"),n("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),n("1.2.840.113549.1.12.10.1.3","certBag"),n("1.2.840.113549.1.12.10.1.4","crlBag"),n("1.2.840.113549.1.12.10.1.5","secretBag"),n("1.2.840.113549.1.12.10.1.6","safeContentsBag"),n("1.2.840.113549.1.5.13","pkcs5PBES2"),n("1.2.840.113549.1.5.12","pkcs5PBKDF2"),n("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),n("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),n("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),n("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),n("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),n("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),n("1.2.840.113549.2.7","hmacWithSHA1"),n("1.2.840.113549.2.8","hmacWithSHA224"),n("1.2.840.113549.2.9","hmacWithSHA256"),n("1.2.840.113549.2.10","hmacWithSHA384"),n("1.2.840.113549.2.11","hmacWithSHA512"),n("1.2.840.113549.3.7","des-EDE3-CBC"),n("2.16.840.1.101.3.4.1.2","aes128-CBC"),n("2.16.840.1.101.3.4.1.22","aes192-CBC"),n("2.16.840.1.101.3.4.1.42","aes256-CBC"),n("2.5.4.3","commonName"),n("2.5.4.4","surname"),n("2.5.4.5","serialNumber"),n("2.5.4.6","countryName"),n("2.5.4.7","localityName"),n("2.5.4.8","stateOrProvinceName"),n("2.5.4.9","streetAddress"),n("2.5.4.10","organizationName"),n("2.5.4.11","organizationalUnitName"),n("2.5.4.12","title"),n("2.5.4.13","description"),n("2.5.4.15","businessCategory"),n("2.5.4.17","postalCode"),n("2.5.4.42","givenName"),n("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),n("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),n("2.16.840.1.113730.1.1","nsCertType"),n("2.16.840.1.113730.1.13","nsComment"),s("2.5.29.1","authorityKeyIdentifier"),s("2.5.29.2","keyAttributes"),s("2.5.29.3","certificatePolicies"),s("2.5.29.4","keyUsageRestriction"),s("2.5.29.5","policyMapping"),s("2.5.29.6","subtreesConstraint"),s("2.5.29.7","subjectAltName"),s("2.5.29.8","issuerAltName"),s("2.5.29.9","subjectDirectoryAttributes"),s("2.5.29.10","basicConstraints"),s("2.5.29.11","nameConstraints"),s("2.5.29.12","policyConstraints"),s("2.5.29.13","basicConstraints"),n("2.5.29.14","subjectKeyIdentifier"),n("2.5.29.15","keyUsage"),s("2.5.29.16","privateKeyUsagePeriod"),n("2.5.29.17","subjectAltName"),n("2.5.29.18","issuerAltName"),n("2.5.29.19","basicConstraints"),s("2.5.29.20","cRLNumber"),s("2.5.29.21","cRLReason"),s("2.5.29.22","expirationDate"),s("2.5.29.23","instructionCode"),s("2.5.29.24","invalidityDate"),s("2.5.29.25","cRLDistributionPoints"),s("2.5.29.26","issuingDistributionPoint"),s("2.5.29.27","deltaCRLIndicator"),s("2.5.29.28","issuingDistributionPoint"),s("2.5.29.29","certificateIssuer"),s("2.5.29.30","nameConstraints"),n("2.5.29.31","cRLDistributionPoints"),n("2.5.29.32","certificatePolicies"),s("2.5.29.33","policyMappings"),s("2.5.29.34","policyConstraints"),n("2.5.29.35","authorityKeyIdentifier"),s("2.5.29.36","policyConstraints"),n("2.5.29.37","extKeyUsage"),s("2.5.29.46","freshestCRL"),s("2.5.29.54","inhibitAnyPolicy"),n("1.3.6.1.4.1.11129.2.4.2","timestampList"),n("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),n("1.3.6.1.5.5.7.3.1","serverAuth"),n("1.3.6.1.5.5.7.3.2","clientAuth"),n("1.3.6.1.5.5.7.3.3","codeSigning"),n("1.3.6.1.5.5.7.3.4","emailProtection"),n("1.3.6.1.5.5.7.3.8","timeStamping")}),Pt=he((i,r)=>{var t=me();Ce(),or();var e=r.exports=t.asn1=t.asn1||{};e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},e.create=function(c,a,h,p,T){if(t.util.isArray(p)){for(var I=[],A=0;A<p.length;++A)p[A]!==void 0&&I.push(p[A]);p=I}var m={tagClass:c,type:a,constructed:h,composed:h||t.util.isArray(p),value:p};return T&&"bitStringContents"in T&&(m.bitStringContents=T.bitStringContents,m.original=e.copy(m)),m},e.copy=function(c,a){var h;if(t.util.isArray(c)){h=[];for(var p=0;p<c.length;++p)h.push(e.copy(c[p],a));return h}return typeof c=="string"?c:(h={tagClass:c.tagClass,type:c.type,constructed:c.constructed,composed:c.composed,value:e.copy(c.value,a)},a&&!a.excludeBitStringContents&&(h.bitStringContents=c.bitStringContents),h)},e.equals=function(c,a,h){if(t.util.isArray(c)){if(!t.util.isArray(a)||c.length!==a.length)return!1;for(var p=0;p<c.length;++p)if(!e.equals(c[p],a[p]))return!1;return!0}if(typeof c!=typeof a)return!1;if(typeof c=="string")return c===a;var T=c.tagClass===a.tagClass&&c.type===a.type&&c.constructed===a.constructed&&c.composed===a.composed&&e.equals(c.value,a.value);return h&&h.includeBitStringContents&&(T=T&&c.bitStringContents===a.bitStringContents),T},e.getBerValueLength=function(c){var a=c.getByte();if(a!==128){var h,p=a&128;return p?h=c.getInt((a&127)<<3):h=a,h}};function n(c,a,h){if(h>a){var p=new Error("Too few bytes to parse DER.");throw p.available=c.length(),p.remaining=a,p.requested=h,p}}var s=function(c,a){var h=c.getByte();if(a--,h!==128){var p,T=h&128;if(!T)p=h;else{var I=h&127;n(c,a,I),p=c.getInt(I<<3)}if(p<0)throw new Error("Negative length: "+p);return p}};e.fromDer=function(c,a){a===void 0&&(a={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof a=="boolean"&&(a={strict:a,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in a||(a.strict=!0),"parseAllBytes"in a||(a.parseAllBytes=!0),"decodeBitStrings"in a||(a.decodeBitStrings=!0),typeof c=="string"&&(c=t.util.createBuffer(c));var h=c.length(),p=u(c,c.length(),0,a);if(a.parseAllBytes&&c.length()!==0){var T=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw T.byteCount=h,T.remaining=c.length(),T}return p};function u(c,a,h,p){var T;n(c,a,2);var I=c.getByte();a--;var A=I&192,m=I&31;T=c.length();var S=s(c,a);if(a-=T-c.length(),S!==void 0&&S>a){if(p.strict){var C=new Error("Too few bytes to read ASN.1 value.");throw C.available=c.length(),C.remaining=a,C.requested=S,C}S=a}var E,l,v=(I&32)===32;if(v)if(E=[],S===void 0)for(;;){if(n(c,a,2),c.bytes(2)==="\0\0"){c.getBytes(2),a-=2;break}T=c.length(),E.push(u(c,a,h+1,p)),a-=T-c.length()}else for(;S>0;)T=c.length(),E.push(u(c,S,h+1,p)),a-=T-c.length(),S-=T-c.length();if(E===void 0&&A===e.Class.UNIVERSAL&&m===e.Type.BITSTRING&&(l=c.bytes(S)),E===void 0&&p.decodeBitStrings&&A===e.Class.UNIVERSAL&&m===e.Type.BITSTRING&&S>1){var _=c.read,B=a,L=0;if(m===e.Type.BITSTRING&&(n(c,a,1),L=c.getByte(),a--),L===0)try{T=c.length();var g={strict:!0,decodeBitStrings:!0},f=u(c,a,h+1,g),o=T-c.length();a-=o,m==e.Type.BITSTRING&&o++;var w=f.tagClass;o===S&&(w===e.Class.UNIVERSAL||w===e.Class.CONTEXT_SPECIFIC)&&(E=[f])}catch{}E===void 0&&(c.read=_,a=B)}if(E===void 0){if(S===void 0){if(p.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");S=a}if(m===e.Type.BMPSTRING)for(E="";S>0;S-=2)n(c,a,2),E+=String.fromCharCode(c.getInt16()),a-=2;else E=c.getBytes(S),a-=S}var U=l===void 0?null:{bitStringContents:l};return e.create(A,m,v,E,U)}e.toDer=function(c){var a=t.util.createBuffer(),h=c.tagClass|c.type,p=t.util.createBuffer(),T=!1;if("bitStringContents"in c&&(T=!0,c.original&&(T=e.equals(c,c.original))),T)p.putBytes(c.bitStringContents);else if(c.composed){c.constructed?h|=32:p.putByte(0);for(var I=0;I<c.value.length;++I)c.value[I]!==void 0&&p.putBuffer(e.toDer(c.value[I]))}else if(c.type===e.Type.BMPSTRING)for(var I=0;I<c.value.length;++I)p.putInt16(c.value.charCodeAt(I));else c.type===e.Type.INTEGER&&c.value.length>1&&(c.value.charCodeAt(0)===0&&!(c.value.charCodeAt(1)&128)||c.value.charCodeAt(0)===255&&(c.value.charCodeAt(1)&128)===128)?p.putBytes(c.value.substr(1)):p.putBytes(c.value);if(a.putByte(h),p.length()<=127)a.putByte(p.length()&127);else{var A=p.length(),m="";do m+=String.fromCharCode(A&255),A=A>>>8;while(A>0);a.putByte(m.length|128);for(var I=m.length-1;I>=0;--I)a.putByte(m.charCodeAt(I))}return a.putBuffer(p),a},e.oidToDer=function(c){var a=c.split("."),h=t.util.createBuffer();h.putByte(40*parseInt(a[0],10)+parseInt(a[1],10));for(var p,T,I,A,m=2;m<a.length;++m){p=!0,T=[],I=parseInt(a[m],10);do A=I&127,I=I>>>7,p||(A|=128),T.push(A),p=!1;while(I>0);for(var S=T.length-1;S>=0;--S)h.putByte(T[S])}return h},e.derToOid=function(c){var a;typeof c=="string"&&(c=t.util.createBuffer(c));var h=c.getByte();a=Math.floor(h/40)+"."+h%40;for(var p=0;c.length()>0;)h=c.getByte(),p=p<<7,h&128?p+=h&127:(a+="."+(p+h),p=0);return a},e.utcTimeToDate=function(c){var a=new Date,h=parseInt(c.substr(0,2),10);h=h>=50?1900+h:2e3+h;var p=parseInt(c.substr(2,2),10)-1,T=parseInt(c.substr(4,2),10),I=parseInt(c.substr(6,2),10),A=parseInt(c.substr(8,2),10),m=0;if(c.length>11){var S=c.charAt(10),C=10;S!=="+"&&S!=="-"&&(m=parseInt(c.substr(10,2),10),C+=2)}if(a.setUTCFullYear(h,p,T),a.setUTCHours(I,A,m,0),C&&(S=c.charAt(C),S==="+"||S==="-")){var E=parseInt(c.substr(C+1,2),10),l=parseInt(c.substr(C+4,2),10),v=E*60+l;v*=6e4,S==="+"?a.setTime(+a-v):a.setTime(+a+v)}return a},e.generalizedTimeToDate=function(c){var a=new Date,h=parseInt(c.substr(0,4),10),p=parseInt(c.substr(4,2),10)-1,T=parseInt(c.substr(6,2),10),I=parseInt(c.substr(8,2),10),A=parseInt(c.substr(10,2),10),m=parseInt(c.substr(12,2),10),S=0,C=0,E=!1;c.charAt(c.length-1)==="Z"&&(E=!0);var l=c.length-5,v=c.charAt(l);if(v==="+"||v==="-"){var _=parseInt(c.substr(l+1,2),10),B=parseInt(c.substr(l+4,2),10);C=_*60+B,C*=6e4,v==="+"&&(C*=-1),E=!0}return c.charAt(14)==="."&&(S=parseFloat(c.substr(14),10)*1e3),E?(a.setUTCFullYear(h,p,T),a.setUTCHours(I,A,m,S),a.setTime(+a+C)):(a.setFullYear(h,p,T),a.setHours(I,A,m,S)),a},e.dateToUtcTime=function(c){if(typeof c=="string")return c;var a="",h=[];h.push((""+c.getUTCFullYear()).substr(2)),h.push(""+(c.getUTCMonth()+1)),h.push(""+c.getUTCDate()),h.push(""+c.getUTCHours()),h.push(""+c.getUTCMinutes()),h.push(""+c.getUTCSeconds());for(var p=0;p<h.length;++p)h[p].length<2&&(a+="0"),a+=h[p];return a+="Z",a},e.dateToGeneralizedTime=function(c){if(typeof c=="string")return c;var a="",h=[];h.push(""+c.getUTCFullYear()),h.push(""+(c.getUTCMonth()+1)),h.push(""+c.getUTCDate()),h.push(""+c.getUTCHours()),h.push(""+c.getUTCMinutes()),h.push(""+c.getUTCSeconds());for(var p=0;p<h.length;++p)h[p].length<2&&(a+="0"),a+=h[p];return a+="Z",a},e.integerToDer=function(c){var a=t.util.createBuffer();if(c>=-128&&c<128)return a.putSignedInt(c,8);if(c>=-32768&&c<32768)return a.putSignedInt(c,16);if(c>=-8388608&&c<8388608)return a.putSignedInt(c,24);if(c>=-2147483648&&c<2147483648)return a.putSignedInt(c,32);var h=new Error("Integer too large; max is 32-bits.");throw h.integer=c,h},e.derToInteger=function(c){typeof c=="string"&&(c=t.util.createBuffer(c));var a=c.length()*8;if(a>32)throw new Error("Integer too large; max is 32-bits.");return c.getSignedInt(a)},e.validate=function(c,a,h,p){var T=!1;if((c.tagClass===a.tagClass||typeof a.tagClass>"u")&&(c.type===a.type||typeof a.type>"u"))if(c.constructed===a.constructed||typeof a.constructed>"u"){if(T=!0,a.value&&t.util.isArray(a.value))for(var I=0,A=0;T&&A<a.value.length;++A)T=a.value[A].optional||!1,c.value[I]&&(T=e.validate(c.value[I],a.value[A],h,p),T?++I:a.value[A].optional&&(T=!0)),!T&&p&&p.push("["+a.name+'] Tag class "'+a.tagClass+'", type "'+a.type+'" expected value length "'+a.value.length+'", got "'+c.value.length+'"');if(T&&h&&(a.capture&&(h[a.capture]=c.value),a.captureAsn1&&(h[a.captureAsn1]=c),a.captureBitStringContents&&"bitStringContents"in c&&(h[a.captureBitStringContents]=c.bitStringContents),a.captureBitStringValue&&"bitStringContents"in c)){var m;if(c.bitStringContents.length<2)h[a.captureBitStringValue]="";else{var S=c.bitStringContents.charCodeAt(0);if(S!==0)throw new Error("captureBitStringValue only supported for zero unused bits");h[a.captureBitStringValue]=c.bitStringContents.slice(1)}}}else p&&p.push("["+a.name+'] Expected constructed "'+a.constructed+'", got "'+c.constructed+'"');else p&&(c.tagClass!==a.tagClass&&p.push("["+a.name+'] Expected tag class "'+a.tagClass+'", got "'+c.tagClass+'"'),c.type!==a.type&&p.push("["+a.name+'] Expected type "'+a.type+'", got "'+c.type+'"'));return T};var d=/[^\\u0000-\\u00ff]/;e.prettyPrint=function(c,a,h){var p="";a=a||0,h=h||2,a>0&&(p+=`
`);for(var T="",I=0;I<a*h;++I)T+=" ";switch(p+=T+"Tag: ",c.tagClass){case e.Class.UNIVERSAL:p+="Universal:";break;case e.Class.APPLICATION:p+="Application:";break;case e.Class.CONTEXT_SPECIFIC:p+="Context-Specific:";break;case e.Class.PRIVATE:p+="Private:";break}if(c.tagClass===e.Class.UNIVERSAL)switch(p+=c.type,c.type){case e.Type.NONE:p+=" (None)";break;case e.Type.BOOLEAN:p+=" (Boolean)";break;case e.Type.INTEGER:p+=" (Integer)";break;case e.Type.BITSTRING:p+=" (Bit string)";break;case e.Type.OCTETSTRING:p+=" (Octet string)";break;case e.Type.NULL:p+=" (Null)";break;case e.Type.OID:p+=" (Object Identifier)";break;case e.Type.ODESC:p+=" (Object Descriptor)";break;case e.Type.EXTERNAL:p+=" (External or Instance of)";break;case e.Type.REAL:p+=" (Real)";break;case e.Type.ENUMERATED:p+=" (Enumerated)";break;case e.Type.EMBEDDED:p+=" (Embedded PDV)";break;case e.Type.UTF8:p+=" (UTF8)";break;case e.Type.ROID:p+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:p+=" (Sequence)";break;case e.Type.SET:p+=" (Set)";break;case e.Type.PRINTABLESTRING:p+=" (Printable String)";break;case e.Type.IA5String:p+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:p+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:p+=" (Generalized time)";break;case e.Type.BMPSTRING:p+=" (BMP String)";break}else p+=c.type;if(p+=`
`,p+=T+"Constructed: "+c.constructed+`
`,c.composed){for(var A=0,m="",I=0;I<c.value.length;++I)c.value[I]!==void 0&&(A+=1,m+=e.prettyPrint(c.value[I],a+1,h),I+1<c.value.length&&(m+=","));p+=T+"Sub values: "+A+m}else{if(p+=T+"Value: ",c.type===e.Type.OID){var S=e.derToOid(c.value);p+=S,t.pki&&t.pki.oids&&S in t.pki.oids&&(p+=" ("+t.pki.oids[S]+") ")}if(c.type===e.Type.INTEGER)try{p+=e.derToInteger(c.value)}catch{p+="0x"+t.util.bytesToHex(c.value)}else if(c.type===e.Type.BITSTRING){if(c.value.length>1?p+="0x"+t.util.bytesToHex(c.value.slice(1)):p+="(none)",c.value.length>0){var C=c.value.charCodeAt(0);C==1?p+=" (1 unused bit shown)":C>1&&(p+=" ("+C+" unused bits shown)")}}else if(c.type===e.Type.OCTETSTRING)d.test(c.value)||(p+="("+c.value+") "),p+="0x"+t.util.bytesToHex(c.value);else if(c.type===e.Type.UTF8)try{p+=t.util.decodeUtf8(c.value)}catch(E){if(E.message==="URI malformed")p+="0x"+t.util.bytesToHex(c.value)+" (malformed UTF8)";else throw E}else c.type===e.Type.PRINTABLESTRING||c.type===e.Type.IA5String?p+=c.value:d.test(c.value)?p+="0x"+t.util.bytesToHex(c.value):c.value.length===0?p+="[null]":p+=c.value}return p}}),Ht=he((i,r)=>{var t=me();r.exports=t.md=t.md||{},t.md.algorithms=t.md.algorithms||{}}),Hr=he((i,r)=>{var t=me();Ht(),Ce();var e=r.exports=t.hmac=t.hmac||{};e.create=function(){var n=null,s=null,u=null,d=null,c={};return c.start=function(a,h){if(a!==null)if(typeof a=="string")if(a=a.toLowerCase(),a in t.md.algorithms)s=t.md.algorithms[a].create();else throw new Error('Unknown hash algorithm "'+a+'"');else s=a;if(h===null)h=n;else{if(typeof h=="string")h=t.util.createBuffer(h);else if(t.util.isArray(h)){var p=h;h=t.util.createBuffer();for(var T=0;T<p.length;++T)h.putByte(p[T])}var I=h.length();I>s.blockLength&&(s.start(),s.update(h.bytes()),h=s.digest()),u=t.util.createBuffer(),d=t.util.createBuffer(),I=h.length();for(var T=0;T<I;++T){var p=h.at(T);u.putByte(54^p),d.putByte(92^p)}if(I<s.blockLength)for(var p=s.blockLength-I,T=0;T<p;++T)u.putByte(54),d.putByte(92);n=h,u=u.bytes(),d=d.bytes()}s.start(),s.update(u)},c.update=function(a){s.update(a)},c.getMac=function(){var a=s.digest().bytes();return s.start(),s.update(d),s.update(a),s.digest()},c.digest=c.getMac,c}}),Ia=he((i,r)=>{var t=me();Ht(),Ce();var e=r.exports=t.md5=t.md5||{};t.md.md5=t.md.algorithms.md5=e,e.create=function(){c||a();var p=null,T=t.util.createBuffer(),I=new Array(16),A={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return A.start=function(){A.messageLength=0,A.fullMessageLength=A.messageLength64=[];for(var m=A.messageLengthSize/4,S=0;S<m;++S)A.fullMessageLength.push(0);return T=t.util.createBuffer(),p={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},A},A.start(),A.update=function(m,S){S==="utf8"&&(m=t.util.encodeUtf8(m));var C=m.length;A.messageLength+=C,C=[C/4294967296>>>0,C>>>0];for(var E=A.fullMessageLength.length-1;E>=0;--E)A.fullMessageLength[E]+=C[1],C[1]=C[0]+(A.fullMessageLength[E]/4294967296>>>0),A.fullMessageLength[E]=A.fullMessageLength[E]>>>0,C[0]=C[1]/4294967296>>>0;return T.putBytes(m),h(p,I,T),(T.read>2048||T.length()===0)&&T.compact(),A},A.digest=function(){var m=t.util.createBuffer();m.putBytes(T.bytes());var S=A.fullMessageLength[A.fullMessageLength.length-1]+A.messageLengthSize,C=S&A.blockLength-1;m.putBytes(n.substr(0,A.blockLength-C));for(var E,l=0,v=A.fullMessageLength.length-1;v>=0;--v)E=A.fullMessageLength[v]*8+l,l=E/4294967296>>>0,m.putInt32Le(E>>>0);var _={h0:p.h0,h1:p.h1,h2:p.h2,h3:p.h3};h(_,I,m);var B=t.util.createBuffer();return B.putInt32Le(_.h0),B.putInt32Le(_.h1),B.putInt32Le(_.h2),B.putInt32Le(_.h3),B},A};var n=null,s=null,u=null,d=null,c=!1;function a(){n="\x80",n+=t.util.fillString("\0",64),s=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],u=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],d=new Array(64);for(var p=0;p<64;++p)d[p]=Math.floor(Math.abs(Math.sin(p+1))*4294967296);c=!0}function h(p,T,I){for(var A,m,S,C,E,l,v,_,B=I.length();B>=64;){for(m=p.h0,S=p.h1,C=p.h2,E=p.h3,_=0;_<16;++_)T[_]=I.getInt32Le(),l=E^S&(C^E),A=m+l+d[_]+T[_],v=u[_],m=E,E=C,C=S,S+=A<<v|A>>>32-v;for(;_<32;++_)l=C^E&(S^C),A=m+l+d[_]+T[s[_]],v=u[_],m=E,E=C,C=S,S+=A<<v|A>>>32-v;for(;_<48;++_)l=S^C^E,A=m+l+d[_]+T[s[_]],v=u[_],m=E,E=C,C=S,S+=A<<v|A>>>32-v;for(;_<64;++_)l=C^(S|~E),A=m+l+d[_]+T[s[_]],v=u[_],m=E,E=C,C=S,S+=A<<v|A>>>32-v;p.h0=p.h0+m|0,p.h1=p.h1+S|0,p.h2=p.h2+C|0,p.h3=p.h3+E|0,B-=64}}}),Er=he((i,r)=>{var t=me();Ce();var e=r.exports=t.pem=t.pem||{};e.encode=function(u,d){d=d||{};var c="-----BEGIN "+u.type+`-----\r
`,a;if(u.procType&&(a={name:"Proc-Type",values:[String(u.procType.version),u.procType.type]},c+=n(a)),u.contentDomain&&(a={name:"Content-Domain",values:[u.contentDomain]},c+=n(a)),u.dekInfo&&(a={name:"DEK-Info",values:[u.dekInfo.algorithm]},u.dekInfo.parameters&&a.values.push(u.dekInfo.parameters),c+=n(a)),u.headers)for(var h=0;h<u.headers.length;++h)c+=n(u.headers[h]);return u.procType&&(c+=`\r
`),c+=t.util.encode64(u.body,d.maxline||64)+`\r
`,c+="-----END "+u.type+`-----\r
`,c},e.decode=function(u){for(var d=[],c=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,a=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,h=/\r?\n/,p;p=c.exec(u),!!p;){var T=p[1];T==="NEW CERTIFICATE REQUEST"&&(T="CERTIFICATE REQUEST");var I={type:T,procType:null,contentDomain:null,dekInfo:null,headers:[],body:t.util.decode64(p[3])};if(d.push(I),!!p[2]){for(var A=p[2].split(h),m=0;p&&m<A.length;){for(var S=A[m].replace(/\s+$/,""),C=m+1;C<A.length;++C){var E=A[C];if(!/\s/.test(E[0]))break;S+=E,m=C}if(p=S.match(a),p){for(var l={name:p[1],values:[]},v=p[2].split(","),_=0;_<v.length;++_)l.values.push(s(v[_]));if(I.procType)if(!I.contentDomain&&l.name==="Content-Domain")I.contentDomain=v[0]||"";else if(!I.dekInfo&&l.name==="DEK-Info"){if(l.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');I.dekInfo={algorithm:v[0],parameters:v[1]||null}}else I.headers.push(l);else{if(l.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(l.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');I.procType={version:v[0],type:v[1]}}}++m}if(I.procType==="ENCRYPTED"&&!I.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(d.length===0)throw new Error("Invalid PEM formatted message.");return d};function n(u){for(var d=u.name+": ",c=[],a=function(A,m){return" "+m},h=0;h<u.values.length;++h)c.push(u.values[h].replace(/^(\S+\r\n)/,a));d+=c.join(",")+`\r
`;for(var p=0,T=-1,h=0;h<d.length;++h,++p)if(p>65&&T!==-1){var I=d[T];I===","?(++T,d=d.substr(0,T)+`\r
 `+d.substr(T)):d=d.substr(0,T)+`\r
`+I+d.substr(T+1),p=h-T-1,T=-1,++h}else(d[h]===" "||d[h]==="	"||d[h]===",")&&(T=h);return d}function s(u){return u.replace(/^\s+/,"")}}),Bn=he((i,r)=>{var t=me();Aa(),_c(),Ce(),r.exports=t.des=t.des||{},t.des.startEncrypting=function(m,S,C,E){var l=A({key:m,output:C,decrypt:!1,mode:E||(S===null?"ECB":"CBC")});return l.start(S),l},t.des.createEncryptionCipher=function(m,S){return A({key:m,output:null,decrypt:!1,mode:S})},t.des.startDecrypting=function(m,S,C,E){var l=A({key:m,output:C,decrypt:!0,mode:E||(S===null?"ECB":"CBC")});return l.start(S),l},t.des.createDecryptionCipher=function(m,S){return A({key:m,output:null,decrypt:!0,mode:S})},t.des.Algorithm=function(m,S){var C=this;C.name=m,C.mode=new S({blockSize:8,cipher:{encrypt:function(E,l){return I(C._keys,E,l,!1)},decrypt:function(E,l){return I(C._keys,E,l,!0)}}}),C._init=!1},t.des.Algorithm.prototype.initialize=function(m){if(!this._init){var S=t.util.createBuffer(m.key);if(this.name.indexOf("3DES")===0&&S.length()!==24)throw new Error("Invalid Triple-DES key size: "+S.length()*8);this._keys=T(S),this._init=!0}},e("DES-ECB",t.cipher.modes.ecb),e("DES-CBC",t.cipher.modes.cbc),e("DES-CFB",t.cipher.modes.cfb),e("DES-OFB",t.cipher.modes.ofb),e("DES-CTR",t.cipher.modes.ctr),e("3DES-ECB",t.cipher.modes.ecb),e("3DES-CBC",t.cipher.modes.cbc),e("3DES-CFB",t.cipher.modes.cfb),e("3DES-OFB",t.cipher.modes.ofb),e("3DES-CTR",t.cipher.modes.ctr);function e(m,S){var C=function(){return new t.des.Algorithm(m,S)};t.cipher.registerAlgorithm(m,C)}var n=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],s=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],u=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],d=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],c=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],a=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],h=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],p=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function T(m){for(var S=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],C=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],E=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],l=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],v=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],_=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],B=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],L=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],g=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],f=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],o=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],w=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],U=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],K=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],D=m.length()>8?3:1,H=[],q=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],G=0,z,Y=0;Y<D;Y++){var Z=m.getInt32(),te=m.getInt32();z=(Z>>>4^te)&252645135,te^=z,Z^=z<<4,z=(te>>>-16^Z)&65535,Z^=z,te^=z<<-16,z=(Z>>>2^te)&858993459,te^=z,Z^=z<<2,z=(te>>>-16^Z)&65535,Z^=z,te^=z<<-16,z=(Z>>>1^te)&1431655765,te^=z,Z^=z<<1,z=(te>>>8^Z)&16711935,Z^=z,te^=z<<8,z=(Z>>>1^te)&1431655765,te^=z,Z^=z<<1,z=Z<<8|te>>>20&240,Z=te<<24|te<<8&16711680|te>>>8&65280|te>>>24&240,te=z;for(var se=0;se<q.length;++se){q[se]?(Z=Z<<2|Z>>>26,te=te<<2|te>>>26):(Z=Z<<1|Z>>>27,te=te<<1|te>>>27),Z&=-15,te&=-15;var de=S[Z>>>28]|C[Z>>>24&15]|E[Z>>>20&15]|l[Z>>>16&15]|v[Z>>>12&15]|_[Z>>>8&15]|B[Z>>>4&15],be=L[te>>>28]|g[te>>>24&15]|f[te>>>20&15]|o[te>>>16&15]|w[te>>>12&15]|U[te>>>8&15]|K[te>>>4&15];z=(be>>>16^de)&65535,H[G++]=de^z,H[G++]=be^z<<16}}return H}function I(m,S,C,E){var l=m.length===32?3:9,v;l===3?v=E?[30,-2,-2]:[0,32,2]:v=E?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var _,B=S[0],L=S[1];_=(B>>>4^L)&252645135,L^=_,B^=_<<4,_=(B>>>16^L)&65535,L^=_,B^=_<<16,_=(L>>>2^B)&858993459,B^=_,L^=_<<2,_=(L>>>8^B)&16711935,B^=_,L^=_<<8,_=(B>>>1^L)&1431655765,L^=_,B^=_<<1,B=B<<1|B>>>31,L=L<<1|L>>>31;for(var g=0;g<l;g+=3){for(var f=v[g+1],o=v[g+2],w=v[g];w!=f;w+=o){var U=L^m[w],K=(L>>>4|L<<28)^m[w+1];_=B,B=L,L=_^(s[U>>>24&63]|d[U>>>16&63]|a[U>>>8&63]|p[U&63]|n[K>>>24&63]|u[K>>>16&63]|c[K>>>8&63]|h[K&63])}_=B,B=L,L=_}B=B>>>1|B<<31,L=L>>>1|L<<31,_=(B>>>1^L)&1431655765,L^=_,B^=_<<1,_=(L>>>8^B)&16711935,B^=_,L^=_<<8,_=(L>>>2^B)&858993459,B^=_,L^=_<<2,_=(B>>>16^L)&65535,L^=_,B^=_<<16,_=(B>>>4^L)&252645135,L^=_,B^=_<<4,C[0]=B,C[1]=L}function A(m){m=m||{};var S=(m.mode||"CBC").toUpperCase(),C="DES-"+S,E;m.decrypt?E=t.cipher.createDecipher(C,m.key):E=t.cipher.createCipher(C,m.key);var l=E.start;return E.start=function(v,_){var B=null;_ instanceof t.util.ByteBuffer&&(B=_,_={}),_=_||{},_.output=B,_.iv=v,l.call(E,_)},E}}),wa=he((i,r)=>{var t=me();Hr(),Ht(),Ce();var e=t.pkcs5=t.pkcs5||{},n;t.util.isNodejs&&!t.options.usePureJavaScript&&(n=_a("node:crypto")),r.exports=t.pbkdf2=e.pbkdf2=function(s,u,d,c,a,h){if(typeof a=="function"&&(h=a,a=null),t.util.isNodejs&&!t.options.usePureJavaScript&&n.pbkdf2&&(a===null||typeof a!="object")&&(n.pbkdf2Sync.length>4||!a||a==="sha1"))return typeof a!="string"&&(a="sha1"),s=__Buffer$.from(s,"binary"),u=__Buffer$.from(u,"binary"),h?n.pbkdf2Sync.length===4?n.pbkdf2(s,u,d,c,function(g,f){if(g)return h(g);h(null,f.toString("binary"))}):n.pbkdf2(s,u,d,c,a,function(g,f){if(g)return h(g);h(null,f.toString("binary"))}):n.pbkdf2Sync.length===4?n.pbkdf2Sync(s,u,d,c).toString("binary"):n.pbkdf2Sync(s,u,d,c,a).toString("binary");if((typeof a>"u"||a===null)&&(a="sha1"),typeof a=="string"){if(!(a in t.md.algorithms))throw new Error("Unknown hash algorithm: "+a);a=t.md[a].create()}var p=a.digestLength;if(c>4294967295*p){var T=new Error("Derived key is too long.");if(h)return h(T);throw T}var I=Math.ceil(c/p),A=c-(I-1)*p,m=t.hmac.create();m.start(a,s);var S="",C,E,l;if(!h){for(var v=1;v<=I;++v){m.start(null,null),m.update(u),m.update(t.util.int32ToBytes(v)),C=l=m.digest().getBytes();for(var _=2;_<=d;++_)m.start(null,null),m.update(l),E=m.digest().getBytes(),C=t.util.xorBytes(C,E,p),l=E;S+=v<I?C:C.substr(0,A)}return S}var v=1,_;function B(){if(v>I)return h(null,S);m.start(null,null),m.update(u),m.update(t.util.int32ToBytes(v)),C=l=m.digest().getBytes(),_=2,L()}function L(){if(_<=d)return m.start(null,null),m.update(l),E=m.digest().getBytes(),C=t.util.xorBytes(C,E,p),l=E,++_,t.util.setImmediate(L);S+=v<I?C:C.substr(0,A),++v,B()}B()}}),Ac=he((i,r)=>{var t=me();Ht(),Ce();var e=r.exports=t.sha256=t.sha256||{};t.md.sha256=t.md.algorithms.sha256=e,e.create=function(){s||d();var a=null,h=t.util.createBuffer(),p=new Array(64),T={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return T.start=function(){T.messageLength=0,T.fullMessageLength=T.messageLength64=[];for(var I=T.messageLengthSize/4,A=0;A<I;++A)T.fullMessageLength.push(0);return h=t.util.createBuffer(),a={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},T},T.start(),T.update=function(I,A){A==="utf8"&&(I=t.util.encodeUtf8(I));var m=I.length;T.messageLength+=m,m=[m/4294967296>>>0,m>>>0];for(var S=T.fullMessageLength.length-1;S>=0;--S)T.fullMessageLength[S]+=m[1],m[1]=m[0]+(T.fullMessageLength[S]/4294967296>>>0),T.fullMessageLength[S]=T.fullMessageLength[S]>>>0,m[0]=m[1]/4294967296>>>0;return h.putBytes(I),c(a,p,h),(h.read>2048||h.length()===0)&&h.compact(),T},T.digest=function(){var I=t.util.createBuffer();I.putBytes(h.bytes());var A=T.fullMessageLength[T.fullMessageLength.length-1]+T.messageLengthSize,m=A&T.blockLength-1;I.putBytes(n.substr(0,T.blockLength-m));for(var S,C,E=T.fullMessageLength[0]*8,l=0;l<T.fullMessageLength.length-1;++l)S=T.fullMessageLength[l+1]*8,C=S/4294967296>>>0,E+=C,I.putInt32(E>>>0),E=S>>>0;I.putInt32(E);var v={h0:a.h0,h1:a.h1,h2:a.h2,h3:a.h3,h4:a.h4,h5:a.h5,h6:a.h6,h7:a.h7};c(v,p,I);var _=t.util.createBuffer();return _.putInt32(v.h0),_.putInt32(v.h1),_.putInt32(v.h2),_.putInt32(v.h3),_.putInt32(v.h4),_.putInt32(v.h5),_.putInt32(v.h6),_.putInt32(v.h7),_},T};var n=null,s=!1,u=null;function d(){n="\x80",n+=t.util.fillString("\0",64),u=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=!0}function c(a,h,p){for(var T,I,A,m,S,C,E,l,v,_,B,L,g,f,o,w=p.length();w>=64;){for(E=0;E<16;++E)h[E]=p.getInt32();for(;E<64;++E)T=h[E-2],T=(T>>>17|T<<15)^(T>>>19|T<<13)^T>>>10,I=h[E-15],I=(I>>>7|I<<25)^(I>>>18|I<<14)^I>>>3,h[E]=T+h[E-7]+I+h[E-16]|0;for(l=a.h0,v=a.h1,_=a.h2,B=a.h3,L=a.h4,g=a.h5,f=a.h6,o=a.h7,E=0;E<64;++E)m=(L>>>6|L<<26)^(L>>>11|L<<21)^(L>>>25|L<<7),S=f^L&(g^f),A=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),C=l&v|_&(l^v),T=o+m+S+u[E]+h[E],I=A+C,o=f,f=g,g=L,L=B+T>>>0,B=_,_=v,v=l,l=T+I>>>0;a.h0=a.h0+l|0,a.h1=a.h1+v|0,a.h2=a.h2+_|0,a.h3=a.h3+B|0,a.h4=a.h4+L|0,a.h5=a.h5+g|0,a.h6=a.h6+f|0,a.h7=a.h7+o|0,w-=64}}}),Ic=he((i,r)=>{var t=me();Ce();var e=null;t.util.isNodejs&&!t.options.usePureJavaScript&&!__Process$.versions["node-webkit"]&&(e=_a("node:crypto"));var n=r.exports=t.prng=t.prng||{};n.create=function(s){for(var u={plugin:s,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},d=s.md,c=new Array(32),a=0;a<32;++a)c[a]=d.create();u.pools=c,u.pool=0,u.generate=function(A,m){if(!m)return u.generateSync(A);var S=u.plugin.cipher,C=u.plugin.increment,E=u.plugin.formatKey,l=u.plugin.formatSeed,v=t.util.createBuffer();u.key=null,_();function _(B){if(B)return m(B);if(v.length()>=A)return m(null,v.getBytes(A));if(u.generated>1048575&&(u.key=null),u.key===null)return t.util.nextTick(function(){h(_)});var L=S(u.key,u.seed);u.generated+=L.length,v.putBytes(L),u.key=E(S(u.key,C(u.seed))),u.seed=l(S(u.key,u.seed)),t.util.setImmediate(_)}},u.generateSync=function(A){var m=u.plugin.cipher,S=u.plugin.increment,C=u.plugin.formatKey,E=u.plugin.formatSeed;u.key=null;for(var l=t.util.createBuffer();l.length()<A;){u.generated>1048575&&(u.key=null),u.key===null&&p();var v=m(u.key,u.seed);u.generated+=v.length,l.putBytes(v),u.key=C(m(u.key,S(u.seed))),u.seed=E(m(u.key,u.seed))}return l.getBytes(A)};function h(A){if(u.pools[0].messageLength>=32)return T(),A();var m=32-u.pools[0].messageLength<<5;u.seedFile(m,function(S,C){if(S)return A(S);u.collect(C),T(),A()})}function p(){if(u.pools[0].messageLength>=32)return T();var A=32-u.pools[0].messageLength<<5;u.collect(u.seedFileSync(A)),T()}function T(){u.reseeds=u.reseeds===4294967295?0:u.reseeds+1;var A=u.plugin.md.create();A.update(u.keyBytes);for(var m=1,S=0;S<32;++S)u.reseeds%m===0&&(A.update(u.pools[S].digest().getBytes()),u.pools[S].start()),m=m<<1;u.keyBytes=A.digest().getBytes(),A.start(),A.update(u.keyBytes);var C=A.digest().getBytes();u.key=u.plugin.formatKey(u.keyBytes),u.seed=u.plugin.formatSeed(C),u.generated=0}function I(A){var m=null,S=t.util.globalScope,C=S.crypto||S.msCrypto;C&&C.getRandomValues&&(m=function(o){return C.getRandomValues(o)});var E=t.util.createBuffer();if(m)for(;E.length()<A;){var l=Math.max(1,Math.min(A-E.length(),65536)/4),v=new Uint32Array(Math.floor(l));try{m(v);for(var _=0;_<v.length;++_)E.putInt32(v[_])}catch(o){if(!(typeof QuotaExceededError<"u"&&o instanceof QuotaExceededError))throw o}}if(E.length()<A)for(var B,L,g,f=Math.floor(Math.random()*65536);E.length()<A;){L=16807*(f&65535),B=16807*(f>>16),L+=(B&32767)<<16,L+=B>>15,L=(L&2147483647)+(L>>31),f=L&4294967295;for(var _=0;_<3;++_)g=f>>>(_<<3),g^=Math.floor(Math.random()*256),E.putByte(g&255)}return E.getBytes(A)}return e?(u.seedFile=function(A,m){e.randomBytes(A,function(S,C){if(S)return m(S);m(null,C.toString())})},u.seedFileSync=function(A){return e.randomBytes(A).toString()}):(u.seedFile=function(A,m){try{m(null,I(A))}catch(S){m(S)}},u.seedFileSync=I),u.collect=function(A){for(var m=A.length,S=0;S<m;++S)u.pools[u.pool].update(A.substr(S,1)),u.pool=u.pool===31?0:u.pool+1},u.collectInt=function(A,m){for(var S="",C=0;C<m;C+=8)S+=String.fromCharCode(A>>C&255);u.collect(S)},u.registerWorker=function(A){if(A===self)u.seedFile=function(S,C){function E(l){var v=l.data;v.forge&&v.forge.prng&&(self.removeEventListener("message",E),C(v.forge.prng.err,v.forge.prng.bytes))}self.addEventListener("message",E),self.postMessage({forge:{prng:{needed:S}}})};else{var m=function(S){var C=S.data;C.forge&&C.forge.prng&&u.seedFile(C.forge.prng.needed,function(E,l){A.postMessage({forge:{prng:{err:E,bytes:l}}})})};A.addEventListener("message",m)}},u}}),It=he((i,r)=>{var t=me();sr(),Ac(),Ic(),Ce(),function(){if(t.random&&t.random.getBytes){r.exports=t.random;return}(function(e){var n={},s=new Array(4),u=t.util.createBuffer();n.formatKey=function(A){var m=t.util.createBuffer(A);return A=new Array(4),A[0]=m.getInt32(),A[1]=m.getInt32(),A[2]=m.getInt32(),A[3]=m.getInt32(),t.aes._expandKey(A,!1)},n.formatSeed=function(A){var m=t.util.createBuffer(A);return A=new Array(4),A[0]=m.getInt32(),A[1]=m.getInt32(),A[2]=m.getInt32(),A[3]=m.getInt32(),A},n.cipher=function(A,m){return t.aes._updateBlock(A,m,s,!1),u.putInt32(s[0]),u.putInt32(s[1]),u.putInt32(s[2]),u.putInt32(s[3]),u.getBytes()},n.increment=function(A){return++A[3],A},n.md=t.md.sha256;function d(){var A=t.prng.create(n);return A.getBytes=function(m,S){return A.generate(m,S)},A.getBytesSync=function(m){return A.generate(m)},A}var c=d(),a=null,h=t.util.globalScope,p=h.crypto||h.msCrypto;if(p&&p.getRandomValues&&(a=function(A){return p.getRandomValues(A)}),t.options.usePureJavaScript||!t.util.isNodejs&&!a){if(typeof window>"u"||window.document,c.collectInt(+new Date,32),typeof navigator<"u"){var T="";for(var I in navigator)try{typeof navigator[I]=="string"&&(T+=navigator[I])}catch{}c.collect(T),T=null}e&&(e().mousemove(function(A){c.collectInt(A.clientX,16),c.collectInt(A.clientY,16)}),e().keypress(function(A){c.collectInt(A.charCode,8)}))}if(!t.random)t.random=c;else for(var I in c)t.random[I]=c[I];t.random.createInstance=d,r.exports=t.random})(typeof jQuery<"u"?jQuery:null)}()}),wc=he((i,r)=>{var t=me();Ce();var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],n=[1,2,3,5],s=function(c,a){return c<<a&65535|(c&65535)>>16-a},u=function(c,a){return(c&65535)>>a|c<<16-a&65535};r.exports=t.rc2=t.rc2||{},t.rc2.expandKey=function(c,a){typeof c=="string"&&(c=t.util.createBuffer(c)),a=a||128;var h=c,p=c.length(),T=a,I=Math.ceil(T/8),A=255>>(T&7),m;for(m=p;m<128;m++)h.putByte(e[h.at(m-1)+h.at(m-p)&255]);for(h.setAt(128-I,e[h.at(128-I)&A]),m=127-I;m>=0;m--)h.setAt(m,e[h.at(m+1)^h.at(m+I)]);return h};var d=function(c,a,h){var p=!1,T=null,I=null,A=null,m,S,C,E,l=[];for(c=t.rc2.expandKey(c,a),C=0;C<64;C++)l.push(c.getInt16Le());h?(m=function(B){for(C=0;C<4;C++)B[C]+=l[E]+(B[(C+3)%4]&B[(C+2)%4])+(~B[(C+3)%4]&B[(C+1)%4]),B[C]=s(B[C],n[C]),E++},S=function(B){for(C=0;C<4;C++)B[C]+=l[B[(C+3)%4]&63]}):(m=function(B){for(C=3;C>=0;C--)B[C]=u(B[C],n[C]),B[C]-=l[E]+(B[(C+3)%4]&B[(C+2)%4])+(~B[(C+3)%4]&B[(C+1)%4]),E--},S=function(B){for(C=3;C>=0;C--)B[C]-=l[B[(C+3)%4]&63]});var v=function(B){var L=[];for(C=0;C<4;C++){var g=T.getInt16Le();A!==null&&(h?g^=A.getInt16Le():A.putInt16Le(g)),L.push(g&65535)}E=h?0:63;for(var f=0;f<B.length;f++)for(var o=0;o<B[f][0];o++)B[f][1](L);for(C=0;C<4;C++)A!==null&&(h?A.putInt16Le(L[C]):L[C]^=A.getInt16Le()),I.putInt16Le(L[C])},_=null;return _={start:function(B,L){B&&typeof B=="string"&&(B=t.util.createBuffer(B)),p=!1,T=t.util.createBuffer(),I=L||new t.util.createBuffer,A=B,_.output=I},update:function(B){for(p||T.putBuffer(B);T.length()>=8;)v([[5,m],[1,S],[6,m],[1,S],[5,m]])},finish:function(B){var L=!0;if(h)if(B)L=B(8,T,!h);else{var g=T.length()===8?8:8-T.length();T.fillWithByte(g,g)}if(L&&(p=!0,_.update()),!h&&(L=T.length()===0,L))if(B)L=B(8,I,!h);else{var f=I.length(),o=I.at(f-1);o>f?L=!1:I.truncate(o)}return L}},_};t.rc2.startEncrypting=function(c,a,h){var p=t.rc2.createEncryptionCipher(c,128);return p.start(a,h),p},t.rc2.createEncryptionCipher=function(c,a){return d(c,a,!0)},t.rc2.startDecrypting=function(c,a,h){var p=t.rc2.createDecryptionCipher(c,128);return p.start(a,h),p},t.rc2.createDecryptionCipher=function(c,a){return d(c,a,!1)}}),Nn=he((i,r)=>{var t=me();r.exports=t.jsbn=t.jsbn||{};var e,n=0xdeadbeefcafe,s=(n&16777215)==15715070;function u(N,k,O){this.data=[],N!=null&&(typeof N=="number"?this.fromNumber(N,k,O):k==null&&typeof N!="string"?this.fromString(N,256):this.fromString(N,k))}t.jsbn.BigInteger=u;function d(){return new u(null)}function c(N,k,O,j,W,X){for(;--X>=0;){var ae=k*this.data[N++]+O.data[j]+W;W=Math.floor(ae/67108864),O.data[j++]=ae&67108863}return W}function a(N,k,O,j,W,X){for(var ae=k&32767,re=k>>15;--X>=0;){var Te=this.data[N]&32767,et=this.data[N++]>>15,ft=re*Te+et*ae;Te=ae*Te+((ft&32767)<<15)+O.data[j]+(W&1073741823),W=(Te>>>30)+(ft>>>15)+re*et+(W>>>30),O.data[j++]=Te&1073741823}return W}function h(N,k,O,j,W,X){for(var ae=k&16383,re=k>>14;--X>=0;){var Te=this.data[N]&16383,et=this.data[N++]>>14,ft=re*Te+et*ae;Te=ae*Te+((ft&16383)<<14)+O.data[j]+W,W=(Te>>28)+(ft>>14)+re*et,O.data[j++]=Te&268435455}return W}typeof navigator>"u"?(u.prototype.am=h,e=28):s&&navigator.appName=="Microsoft Internet Explorer"?(u.prototype.am=a,e=30):s&&navigator.appName!="Netscape"?(u.prototype.am=c,e=26):(u.prototype.am=h,e=28),u.prototype.DB=e,u.prototype.DM=(1<<e)-1,u.prototype.DV=1<<e;var p=52;u.prototype.FV=Math.pow(2,p),u.prototype.F1=p-e,u.prototype.F2=2*e-p;var T="0123456789abcdefghijklmnopqrstuvwxyz",I=new Array,A,m;for(A=48,m=0;m<=9;++m)I[A++]=m;for(A=97,m=10;m<36;++m)I[A++]=m;for(A=65,m=10;m<36;++m)I[A++]=m;function S(N){return T.charAt(N)}function C(N,k){var O=I[N.charCodeAt(k)];return O??-1}function E(N){for(var k=this.t-1;k>=0;--k)N.data[k]=this.data[k];N.t=this.t,N.s=this.s}function l(N){this.t=1,this.s=N<0?-1:0,N>0?this.data[0]=N:N<-1?this.data[0]=N+this.DV:this.t=0}function v(N){var k=d();return k.fromInt(N),k}function _(N,k){var O;if(k==16)O=4;else if(k==8)O=3;else if(k==256)O=8;else if(k==2)O=1;else if(k==32)O=5;else if(k==4)O=2;else{this.fromRadix(N,k);return}this.t=0,this.s=0;for(var j=N.length,W=!1,X=0;--j>=0;){var ae=O==8?N[j]&255:C(N,j);if(ae<0){N.charAt(j)=="-"&&(W=!0);continue}W=!1,X==0?this.data[this.t++]=ae:X+O>this.DB?(this.data[this.t-1]|=(ae&(1<<this.DB-X)-1)<<X,this.data[this.t++]=ae>>this.DB-X):this.data[this.t-1]|=ae<<X,X+=O,X>=this.DB&&(X-=this.DB)}O==8&&N[0]&128&&(this.s=-1,X>0&&(this.data[this.t-1]|=(1<<this.DB-X)-1<<X)),this.clamp(),W&&u.ZERO.subTo(this,this)}function B(){for(var N=this.s&this.DM;this.t>0&&this.data[this.t-1]==N;)--this.t}function L(N){if(this.s<0)return"-"+this.negate().toString(N);var k;if(N==16)k=4;else if(N==8)k=3;else if(N==2)k=1;else if(N==32)k=5;else if(N==4)k=2;else return this.toRadix(N);var O=(1<<k)-1,j,W=!1,X="",ae=this.t,re=this.DB-ae*this.DB%k;if(ae-- >0)for(re<this.DB&&(j=this.data[ae]>>re)>0&&(W=!0,X=S(j));ae>=0;)re<k?(j=(this.data[ae]&(1<<re)-1)<<k-re,j|=this.data[--ae]>>(re+=this.DB-k)):(j=this.data[ae]>>(re-=k)&O,re<=0&&(re+=this.DB,--ae)),j>0&&(W=!0),W&&(X+=S(j));return W?X:"0"}function g(){var N=d();return u.ZERO.subTo(this,N),N}function f(){return this.s<0?this.negate():this}function o(N){var k=this.s-N.s;if(k!=0)return k;var O=this.t;if(k=O-N.t,k!=0)return this.s<0?-k:k;for(;--O>=0;)if((k=this.data[O]-N.data[O])!=0)return k;return 0}function w(N){var k=1,O;return(O=N>>>16)!=0&&(N=O,k+=16),(O=N>>8)!=0&&(N=O,k+=8),(O=N>>4)!=0&&(N=O,k+=4),(O=N>>2)!=0&&(N=O,k+=2),(O=N>>1)!=0&&(N=O,k+=1),k}function U(){return this.t<=0?0:this.DB*(this.t-1)+w(this.data[this.t-1]^this.s&this.DM)}function K(N,k){var O;for(O=this.t-1;O>=0;--O)k.data[O+N]=this.data[O];for(O=N-1;O>=0;--O)k.data[O]=0;k.t=this.t+N,k.s=this.s}function D(N,k){for(var O=N;O<this.t;++O)k.data[O-N]=this.data[O];k.t=Math.max(this.t-N,0),k.s=this.s}function H(N,k){var O=N%this.DB,j=this.DB-O,W=(1<<j)-1,X=Math.floor(N/this.DB),ae=this.s<<O&this.DM,re;for(re=this.t-1;re>=0;--re)k.data[re+X+1]=this.data[re]>>j|ae,ae=(this.data[re]&W)<<O;for(re=X-1;re>=0;--re)k.data[re]=0;k.data[X]=ae,k.t=this.t+X+1,k.s=this.s,k.clamp()}function q(N,k){k.s=this.s;var O=Math.floor(N/this.DB);if(O>=this.t){k.t=0;return}var j=N%this.DB,W=this.DB-j,X=(1<<j)-1;k.data[0]=this.data[O]>>j;for(var ae=O+1;ae<this.t;++ae)k.data[ae-O-1]|=(this.data[ae]&X)<<W,k.data[ae-O]=this.data[ae]>>j;j>0&&(k.data[this.t-O-1]|=(this.s&X)<<W),k.t=this.t-O,k.clamp()}function G(N,k){for(var O=0,j=0,W=Math.min(N.t,this.t);O<W;)j+=this.data[O]-N.data[O],k.data[O++]=j&this.DM,j>>=this.DB;if(N.t<this.t){for(j-=N.s;O<this.t;)j+=this.data[O],k.data[O++]=j&this.DM,j>>=this.DB;j+=this.s}else{for(j+=this.s;O<N.t;)j-=N.data[O],k.data[O++]=j&this.DM,j>>=this.DB;j-=N.s}k.s=j<0?-1:0,j<-1?k.data[O++]=this.DV+j:j>0&&(k.data[O++]=j),k.t=O,k.clamp()}function z(N,k){var O=this.abs(),j=N.abs(),W=O.t;for(k.t=W+j.t;--W>=0;)k.data[W]=0;for(W=0;W<j.t;++W)k.data[W+O.t]=O.am(0,j.data[W],k,W,0,O.t);k.s=0,k.clamp(),this.s!=N.s&&u.ZERO.subTo(k,k)}function Y(N){for(var k=this.abs(),O=N.t=2*k.t;--O>=0;)N.data[O]=0;for(O=0;O<k.t-1;++O){var j=k.am(O,k.data[O],N,2*O,0,1);(N.data[O+k.t]+=k.am(O+1,2*k.data[O],N,2*O+1,j,k.t-O-1))>=k.DV&&(N.data[O+k.t]-=k.DV,N.data[O+k.t+1]=1)}N.t>0&&(N.data[N.t-1]+=k.am(O,k.data[O],N,2*O,0,1)),N.s=0,N.clamp()}function Z(N,k,O){var j=N.abs();if(!(j.t<=0)){var W=this.abs();if(W.t<j.t){k?.fromInt(0),O!=null&&this.copyTo(O);return}O==null&&(O=d());var X=d(),ae=this.s,re=N.s,Te=this.DB-w(j.data[j.t-1]);Te>0?(j.lShiftTo(Te,X),W.lShiftTo(Te,O)):(j.copyTo(X),W.copyTo(O));var et=X.t,ft=X.data[et-1];if(ft!=0){var lt=ft*(1<<this.F1)+(et>1?X.data[et-2]>>this.F2:0),Dt=this.FV/lt,tn=(1<<this.F1)/lt,Tt=1<<this.F2,St=O.t,rn=St-et,qt=k??d();for(X.dlShiftTo(rn,qt),O.compareTo(qt)>=0&&(O.data[O.t++]=1,O.subTo(qt,O)),u.ONE.dlShiftTo(et,qt),qt.subTo(X,X);X.t<et;)X.data[X.t++]=0;for(;--rn>=0;){var Mn=O.data[--St]==ft?this.DM:Math.floor(O.data[St]*Dt+(O.data[St-1]+Tt)*tn);if((O.data[St]+=X.am(0,Mn,O,rn,0,et))<Mn)for(X.dlShiftTo(rn,qt),O.subTo(qt,O);O.data[St]<--Mn;)O.subTo(qt,O)}k!=null&&(O.drShiftTo(et,k),ae!=re&&u.ZERO.subTo(k,k)),O.t=et,O.clamp(),Te>0&&O.rShiftTo(Te,O),ae<0&&u.ZERO.subTo(O,O)}}}function te(N){var k=d();return this.abs().divRemTo(N,null,k),this.s<0&&k.compareTo(u.ZERO)>0&&N.subTo(k,k),k}function se(N){this.m=N}function de(N){return N.s<0||N.compareTo(this.m)>=0?N.mod(this.m):N}function be(N){return N}function we(N){N.divRemTo(this.m,null,N)}function J(N,k,O){N.multiplyTo(k,O),this.reduce(O)}function Ee(N,k){N.squareTo(k),this.reduce(k)}se.prototype.convert=de,se.prototype.revert=be,se.prototype.reduce=we,se.prototype.mulTo=J,se.prototype.sqrTo=Ee;function ee(){if(this.t<1)return 0;var N=this.data[0];if(!(N&1))return 0;var k=N&3;return k=k*(2-(N&15)*k)&15,k=k*(2-(N&255)*k)&255,k=k*(2-((N&65535)*k&65535))&65535,k=k*(2-N*k%this.DV)%this.DV,k>0?this.DV-k:-k}function Le(N){this.m=N,this.mp=N.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<N.DB-15)-1,this.mt2=2*N.t}function ge(N){var k=d();return N.abs().dlShiftTo(this.m.t,k),k.divRemTo(this.m,null,k),N.s<0&&k.compareTo(u.ZERO)>0&&this.m.subTo(k,k),k}function b(N){var k=d();return N.copyTo(k),this.reduce(k),k}function P(N){for(;N.t<=this.mt2;)N.data[N.t++]=0;for(var k=0;k<this.m.t;++k){var O=N.data[k]&32767,j=O*this.mpl+((O*this.mph+(N.data[k]>>15)*this.mpl&this.um)<<15)&N.DM;for(O=k+this.m.t,N.data[O]+=this.m.am(0,j,N,k,0,this.m.t);N.data[O]>=N.DV;)N.data[O]-=N.DV,N.data[++O]++}N.clamp(),N.drShiftTo(this.m.t,N),N.compareTo(this.m)>=0&&N.subTo(this.m,N)}function R(N,k){N.squareTo(k),this.reduce(k)}function y(N,k,O){N.multiplyTo(k,O),this.reduce(O)}Le.prototype.convert=ge,Le.prototype.revert=b,Le.prototype.reduce=P,Le.prototype.mulTo=y,Le.prototype.sqrTo=R;function x(){return(this.t>0?this.data[0]&1:this.s)==0}function F(N,k){if(N>4294967295||N<1)return u.ONE;var O=d(),j=d(),W=k.convert(this),X=w(N)-1;for(W.copyTo(O);--X>=0;)if(k.sqrTo(O,j),(N&1<<X)>0)k.mulTo(j,W,O);else{var ae=O;O=j,j=ae}return k.revert(O)}function M(N,k){var O;return N<256||k.isEven()?O=new se(k):O=new Le(k),this.exp(N,O)}u.prototype.copyTo=E,u.prototype.fromInt=l,u.prototype.fromString=_,u.prototype.clamp=B,u.prototype.dlShiftTo=K,u.prototype.drShiftTo=D,u.prototype.lShiftTo=H,u.prototype.rShiftTo=q,u.prototype.subTo=G,u.prototype.multiplyTo=z,u.prototype.squareTo=Y,u.prototype.divRemTo=Z,u.prototype.invDigit=ee,u.prototype.isEven=x,u.prototype.exp=F,u.prototype.toString=L,u.prototype.negate=g,u.prototype.abs=f,u.prototype.compareTo=o,u.prototype.bitLength=U,u.prototype.mod=te,u.prototype.modPowInt=M,u.ZERO=v(0),u.ONE=v(1);function Q(){var N=d();return this.copyTo(N),N}function ie(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function oe(){return this.t==0?this.s:this.data[0]<<24>>24}function $(){return this.t==0?this.s:this.data[0]<<16>>16}function ne(N){return Math.floor(Math.LN2*this.DB/Math.log(N))}function pe(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function ve(N){if(N==null&&(N=10),this.signum()==0||N<2||N>36)return"0";var k=this.chunkSize(N),O=Math.pow(N,k),j=v(O),W=d(),X=d(),ae="";for(this.divRemTo(j,W,X);W.signum()>0;)ae=(O+X.intValue()).toString(N).substr(1)+ae,W.divRemTo(j,W,X);return X.intValue().toString(N)+ae}function ye(N,k){this.fromInt(0),k==null&&(k=10);for(var O=this.chunkSize(k),j=Math.pow(k,O),W=!1,X=0,ae=0,re=0;re<N.length;++re){var Te=C(N,re);if(Te<0){N.charAt(re)=="-"&&this.signum()==0&&(W=!0);continue}ae=k*ae+Te,++X>=O&&(this.dMultiply(j),this.dAddOffset(ae,0),X=0,ae=0)}X>0&&(this.dMultiply(Math.pow(k,X)),this.dAddOffset(ae,0)),W&&u.ZERO.subTo(this,this)}function Be(N,k,O){if(typeof k=="number")if(N<2)this.fromInt(1);else for(this.fromNumber(N,O),this.testBit(N-1)||this.bitwiseTo(u.ONE.shiftLeft(N-1),Me,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(k);)this.dAddOffset(2,0),this.bitLength()>N&&this.subTo(u.ONE.shiftLeft(N-1),this);else{var j=new Array,W=N&7;j.length=(N>>3)+1,k.nextBytes(j),W>0?j[0]&=(1<<W)-1:j[0]=0,this.fromString(j,256)}}function Ue(){var N=this.t,k=new Array;k[0]=this.s;var O=this.DB-N*this.DB%8,j,W=0;if(N-- >0)for(O<this.DB&&(j=this.data[N]>>O)!=(this.s&this.DM)>>O&&(k[W++]=j|this.s<<this.DB-O);N>=0;)O<8?(j=(this.data[N]&(1<<O)-1)<<8-O,j|=this.data[--N]>>(O+=this.DB-8)):(j=this.data[N]>>(O-=8)&255,O<=0&&(O+=this.DB,--N)),j&128&&(j|=-256),W==0&&(this.s&128)!=(j&128)&&++W,(W>0||j!=this.s)&&(k[W++]=j);return k}function Pe(N){return this.compareTo(N)==0}function Ne(N){return this.compareTo(N)<0?this:N}function _e(N){return this.compareTo(N)>0?this:N}function Ae(N,k,O){var j,W,X=Math.min(N.t,this.t);for(j=0;j<X;++j)O.data[j]=k(this.data[j],N.data[j]);if(N.t<this.t){for(W=N.s&this.DM,j=X;j<this.t;++j)O.data[j]=k(this.data[j],W);O.t=this.t}else{for(W=this.s&this.DM,j=X;j<N.t;++j)O.data[j]=k(W,N.data[j]);O.t=N.t}O.s=k(this.s,N.s),O.clamp()}function Ve(N,k){return N&k}function rt(N){var k=d();return this.bitwiseTo(N,Ve,k),k}function Me(N,k){return N|k}function at(N){var k=d();return this.bitwiseTo(N,Me,k),k}function it(N,k){return N^k}function ct(N){var k=d();return this.bitwiseTo(N,it,k),k}function ut(N,k){return N&~k}function Et(N){var k=d();return this.bitwiseTo(N,ut,k),k}function wt(){for(var N=d(),k=0;k<this.t;++k)N.data[k]=this.DM&~this.data[k];return N.t=this.t,N.s=~this.s,N}function Ut(N){var k=d();return N<0?this.rShiftTo(-N,k):this.lShiftTo(N,k),k}function jt(N){var k=d();return N<0?this.lShiftTo(-N,k):this.rShiftTo(N,k),k}function Wt(N){if(N==0)return-1;var k=0;return N&65535||(N>>=16,k+=16),N&255||(N>>=8,k+=8),N&15||(N>>=4,k+=4),N&3||(N>>=2,k+=2),N&1||++k,k}function cr(){for(var N=0;N<this.t;++N)if(this.data[N]!=0)return N*this.DB+Wt(this.data[N]);return this.s<0?this.t*this.DB:-1}function Sr(N){for(var k=0;N!=0;)N&=N-1,++k;return k}function en(){for(var N=0,k=this.s&this.DM,O=0;O<this.t;++O)N+=Sr(this.data[O]^k);return N}function Ke(N){var k=Math.floor(N/this.DB);return k>=this.t?this.s!=0:(this.data[k]&1<<N%this.DB)!=0}function He(N,k){var O=u.ONE.shiftLeft(N);return this.bitwiseTo(O,k,O),O}function Fe(N){return this.changeBit(N,Me)}function je(N){return this.changeBit(N,ut)}function qe(N){return this.changeBit(N,it)}function Ge(N,k){for(var O=0,j=0,W=Math.min(N.t,this.t);O<W;)j+=this.data[O]+N.data[O],k.data[O++]=j&this.DM,j>>=this.DB;if(N.t<this.t){for(j+=N.s;O<this.t;)j+=this.data[O],k.data[O++]=j&this.DM,j>>=this.DB;j+=this.s}else{for(j+=this.s;O<N.t;)j+=N.data[O],k.data[O++]=j&this.DM,j>>=this.DB;j+=N.s}k.s=j<0?-1:0,j>0?k.data[O++]=j:j<-1&&(k.data[O++]=this.DV+j),k.t=O,k.clamp()}function ze(N){var k=d();return this.addTo(N,k),k}function $e(N){var k=d();return this.subTo(N,k),k}function We(N){var k=d();return this.multiplyTo(N,k),k}function Qe(N){var k=d();return this.divRemTo(N,k,null),k}function Ye(N){var k=d();return this.divRemTo(N,null,k),k}function Xe(N){var k=d(),O=d();return this.divRemTo(N,k,O),new Array(k,O)}function Je(N){this.data[this.t]=this.am(0,N-1,this,0,0,this.t),++this.t,this.clamp()}function Ze(N,k){if(N!=0){for(;this.t<=k;)this.data[this.t++]=0;for(this.data[k]+=N;this.data[k]>=this.DV;)this.data[k]-=this.DV,++k>=this.t&&(this.data[this.t++]=0),++this.data[k]}}function xe(){}function Oe(N){return N}function su(N,k,O){N.multiplyTo(k,O)}function ou(N,k){N.squareTo(k)}xe.prototype.convert=Oe,xe.prototype.revert=Oe,xe.prototype.mulTo=su,xe.prototype.sqrTo=ou;function cu(N){return this.exp(N,new xe)}function uu(N,k,O){var j=Math.min(this.t+N.t,k);for(O.s=0,O.t=j;j>0;)O.data[--j]=0;var W;for(W=O.t-this.t;j<W;++j)O.data[j+this.t]=this.am(0,N.data[j],O,j,0,this.t);for(W=Math.min(N.t,k);j<W;++j)this.am(0,N.data[j],O,j,0,k-j);O.clamp()}function lu(N,k,O){--k;var j=O.t=this.t+N.t-k;for(O.s=0;--j>=0;)O.data[j]=0;for(j=Math.max(k-this.t,0);j<N.t;++j)O.data[this.t+j-k]=this.am(k-j,N.data[j],O,0,0,this.t+j-k);O.clamp(),O.drShiftTo(1,O)}function ur(N){this.r2=d(),this.q3=d(),u.ONE.dlShiftTo(2*N.t,this.r2),this.mu=this.r2.divide(N),this.m=N}function pu(N){if(N.s<0||N.t>2*this.m.t)return N.mod(this.m);if(N.compareTo(this.m)<0)return N;var k=d();return N.copyTo(k),this.reduce(k),k}function fu(N){return N}function du(N){for(N.drShiftTo(this.m.t-1,this.r2),N.t>this.m.t+1&&(N.t=this.m.t+1,N.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);N.compareTo(this.r2)<0;)N.dAddOffset(1,this.m.t+1);for(N.subTo(this.r2,N);N.compareTo(this.m)>=0;)N.subTo(this.m,N)}function hu(N,k){N.squareTo(k),this.reduce(k)}function yu(N,k,O){N.multiplyTo(k,O),this.reduce(O)}ur.prototype.convert=pu,ur.prototype.revert=fu,ur.prototype.reduce=du,ur.prototype.mulTo=yu,ur.prototype.sqrTo=hu;function mu(N,k){var O=N.bitLength(),j,W=v(1),X;if(O<=0)return W;O<18?j=1:O<48?j=3:O<144?j=4:O<768?j=5:j=6,O<8?X=new se(k):k.isEven()?X=new ur(k):X=new Le(k);var ae=new Array,re=3,Te=j-1,et=(1<<j)-1;if(ae[1]=X.convert(this),j>1){var ft=d();for(X.sqrTo(ae[1],ft);re<=et;)ae[re]=d(),X.mulTo(ft,ae[re-2],ae[re]),re+=2}var lt=N.t-1,Dt,tn=!0,Tt=d(),St;for(O=w(N.data[lt])-1;lt>=0;){for(O>=Te?Dt=N.data[lt]>>O-Te&et:(Dt=(N.data[lt]&(1<<O+1)-1)<<Te-O,lt>0&&(Dt|=N.data[lt-1]>>this.DB+O-Te)),re=j;!(Dt&1);)Dt>>=1,--re;if((O-=re)<0&&(O+=this.DB,--lt),tn)ae[Dt].copyTo(W),tn=!1;else{for(;re>1;)X.sqrTo(W,Tt),X.sqrTo(Tt,W),re-=2;re>0?X.sqrTo(W,Tt):(St=W,W=Tt,Tt=St),X.mulTo(Tt,ae[Dt],W)}for(;lt>=0&&!(N.data[lt]&1<<O);)X.sqrTo(W,Tt),St=W,W=Tt,Tt=St,--O<0&&(O=this.DB-1,--lt)}return X.revert(W)}function gu(N){var k=this.s<0?this.negate():this.clone(),O=N.s<0?N.negate():N.clone();if(k.compareTo(O)<0){var j=k;k=O,O=j}var W=k.getLowestSetBit(),X=O.getLowestSetBit();if(X<0)return k;for(W<X&&(X=W),X>0&&(k.rShiftTo(X,k),O.rShiftTo(X,O));k.signum()>0;)(W=k.getLowestSetBit())>0&&k.rShiftTo(W,k),(W=O.getLowestSetBit())>0&&O.rShiftTo(W,O),k.compareTo(O)>=0?(k.subTo(O,k),k.rShiftTo(1,k)):(O.subTo(k,O),O.rShiftTo(1,O));return X>0&&O.lShiftTo(X,O),O}function vu(N){if(N<=0)return 0;var k=this.DV%N,O=this.s<0?N-1:0;if(this.t>0)if(k==0)O=this.data[0]%N;else for(var j=this.t-1;j>=0;--j)O=(k*O+this.data[j])%N;return O}function bu(N){var k=N.isEven();if(this.isEven()&&k||N.signum()==0)return u.ZERO;for(var O=N.clone(),j=this.clone(),W=v(1),X=v(0),ae=v(0),re=v(1);O.signum()!=0;){for(;O.isEven();)O.rShiftTo(1,O),k?((!W.isEven()||!X.isEven())&&(W.addTo(this,W),X.subTo(N,X)),W.rShiftTo(1,W)):X.isEven()||X.subTo(N,X),X.rShiftTo(1,X);for(;j.isEven();)j.rShiftTo(1,j),k?((!ae.isEven()||!re.isEven())&&(ae.addTo(this,ae),re.subTo(N,re)),ae.rShiftTo(1,ae)):re.isEven()||re.subTo(N,re),re.rShiftTo(1,re);O.compareTo(j)>=0?(O.subTo(j,O),k&&W.subTo(ae,W),X.subTo(re,X)):(j.subTo(O,j),k&&ae.subTo(W,ae),re.subTo(X,re))}if(j.compareTo(u.ONE)!=0)return u.ZERO;if(re.compareTo(N)>=0)return re.subtract(N);if(re.signum()<0)re.addTo(N,re);else return re;return re.signum()<0?re.add(N):re}var Ct=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Eu=(1<<26)/Ct[Ct.length-1];function Cu(N){var k,O=this.abs();if(O.t==1&&O.data[0]<=Ct[Ct.length-1]){for(k=0;k<Ct.length;++k)if(O.data[0]==Ct[k])return!0;return!1}if(O.isEven())return!1;for(k=1;k<Ct.length;){for(var j=Ct[k],W=k+1;W<Ct.length&&j<Eu;)j*=Ct[W++];for(j=O.modInt(j);k<W;)if(j%Ct[k++]==0)return!1}return O.millerRabin(N)}function Tu(N){var k=this.subtract(u.ONE),O=k.getLowestSetBit();if(O<=0)return!1;for(var j=k.shiftRight(O),W=Su(),X,ae=0;ae<N;++ae){do X=new u(this.bitLength(),W);while(X.compareTo(u.ONE)<=0||X.compareTo(k)>=0);var re=X.modPow(j,this);if(re.compareTo(u.ONE)!=0&&re.compareTo(k)!=0){for(var Te=1;Te++<O&&re.compareTo(k)!=0;)if(re=re.modPowInt(2,this),re.compareTo(u.ONE)==0)return!1;if(re.compareTo(k)!=0)return!1}}return!0}function Su(){return{nextBytes:function(N){for(var k=0;k<N.length;++k)N[k]=Math.floor(Math.random()*256)}}}u.prototype.chunkSize=ne,u.prototype.toRadix=ve,u.prototype.fromRadix=ye,u.prototype.fromNumber=Be,u.prototype.bitwiseTo=Ae,u.prototype.changeBit=He,u.prototype.addTo=Ge,u.prototype.dMultiply=Je,u.prototype.dAddOffset=Ze,u.prototype.multiplyLowerTo=uu,u.prototype.multiplyUpperTo=lu,u.prototype.modInt=vu,u.prototype.millerRabin=Tu,u.prototype.clone=Q,u.prototype.intValue=ie,u.prototype.byteValue=oe,u.prototype.shortValue=$,u.prototype.signum=pe,u.prototype.toByteArray=Ue,u.prototype.equals=Pe,u.prototype.min=Ne,u.prototype.max=_e,u.prototype.and=rt,u.prototype.or=at,u.prototype.xor=ct,u.prototype.andNot=Et,u.prototype.not=wt,u.prototype.shiftLeft=Ut,u.prototype.shiftRight=jt,u.prototype.getLowestSetBit=cr,u.prototype.bitCount=en,u.prototype.testBit=Ke,u.prototype.setBit=Fe,u.prototype.clearBit=je,u.prototype.flipBit=qe,u.prototype.add=ze,u.prototype.subtract=$e,u.prototype.multiply=We,u.prototype.divide=Qe,u.prototype.remainder=Ye,u.prototype.divideAndRemainder=Xe,u.prototype.modPow=mu,u.prototype.modInverse=bu,u.prototype.pow=cu,u.prototype.gcd=gu,u.prototype.isProbablePrime=Cu}),Fr=he((i,r)=>{var t=me();Ht(),Ce();var e=r.exports=t.sha1=t.sha1||{};t.md.sha1=t.md.algorithms.sha1=e,e.create=function(){s||u();var c=null,a=t.util.createBuffer(),h=new Array(80),p={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return p.start=function(){p.messageLength=0,p.fullMessageLength=p.messageLength64=[];for(var T=p.messageLengthSize/4,I=0;I<T;++I)p.fullMessageLength.push(0);return a=t.util.createBuffer(),c={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},p},p.start(),p.update=function(T,I){I==="utf8"&&(T=t.util.encodeUtf8(T));var A=T.length;p.messageLength+=A,A=[A/4294967296>>>0,A>>>0];for(var m=p.fullMessageLength.length-1;m>=0;--m)p.fullMessageLength[m]+=A[1],A[1]=A[0]+(p.fullMessageLength[m]/4294967296>>>0),p.fullMessageLength[m]=p.fullMessageLength[m]>>>0,A[0]=A[1]/4294967296>>>0;return a.putBytes(T),d(c,h,a),(a.read>2048||a.length()===0)&&a.compact(),p},p.digest=function(){var T=t.util.createBuffer();T.putBytes(a.bytes());var I=p.fullMessageLength[p.fullMessageLength.length-1]+p.messageLengthSize,A=I&p.blockLength-1;T.putBytes(n.substr(0,p.blockLength-A));for(var m,S,C=p.fullMessageLength[0]*8,E=0;E<p.fullMessageLength.length-1;++E)m=p.fullMessageLength[E+1]*8,S=m/4294967296>>>0,C+=S,T.putInt32(C>>>0),C=m>>>0;T.putInt32(C);var l={h0:c.h0,h1:c.h1,h2:c.h2,h3:c.h3,h4:c.h4};d(l,h,T);var v=t.util.createBuffer();return v.putInt32(l.h0),v.putInt32(l.h1),v.putInt32(l.h2),v.putInt32(l.h3),v.putInt32(l.h4),v},p};var n=null,s=!1;function u(){n="\x80",n+=t.util.fillString("\0",64),s=!0}function d(c,a,h){for(var p,T,I,A,m,S,C,E,l=h.length();l>=64;){for(T=c.h0,I=c.h1,A=c.h2,m=c.h3,S=c.h4,E=0;E<16;++E)p=h.getInt32(),a[E]=p,C=m^I&(A^m),p=(T<<5|T>>>27)+C+S+1518500249+p,S=m,m=A,A=(I<<30|I>>>2)>>>0,I=T,T=p;for(;E<20;++E)p=a[E-3]^a[E-8]^a[E-14]^a[E-16],p=p<<1|p>>>31,a[E]=p,C=m^I&(A^m),p=(T<<5|T>>>27)+C+S+1518500249+p,S=m,m=A,A=(I<<30|I>>>2)>>>0,I=T,T=p;for(;E<32;++E)p=a[E-3]^a[E-8]^a[E-14]^a[E-16],p=p<<1|p>>>31,a[E]=p,C=I^A^m,p=(T<<5|T>>>27)+C+S+1859775393+p,S=m,m=A,A=(I<<30|I>>>2)>>>0,I=T,T=p;for(;E<40;++E)p=a[E-6]^a[E-16]^a[E-28]^a[E-32],p=p<<2|p>>>30,a[E]=p,C=I^A^m,p=(T<<5|T>>>27)+C+S+1859775393+p,S=m,m=A,A=(I<<30|I>>>2)>>>0,I=T,T=p;for(;E<60;++E)p=a[E-6]^a[E-16]^a[E-28]^a[E-32],p=p<<2|p>>>30,a[E]=p,C=I&A|m&(I^A),p=(T<<5|T>>>27)+C+S+2400959708+p,S=m,m=A,A=(I<<30|I>>>2)>>>0,I=T,T=p;for(;E<80;++E)p=a[E-6]^a[E-16]^a[E-28]^a[E-32],p=p<<2|p>>>30,a[E]=p,C=I^A^m,p=(T<<5|T>>>27)+C+S+3395469782+p,S=m,m=A,A=(I<<30|I>>>2)>>>0,I=T,T=p;c.h0=c.h0+T|0,c.h1=c.h1+I|0,c.h2=c.h2+A|0,c.h3=c.h3+m|0,c.h4=c.h4+S|0,l-=64}}}),Bc=he((i,r)=>{var t=me();Ce(),It(),Fr();var e=r.exports=t.pkcs1=t.pkcs1||{};e.encode_rsa_oaep=function(s,u,d){var c,a,h,p;typeof d=="string"?(c=d,a=arguments[3]||void 0,h=arguments[4]||void 0):d&&(c=d.label||void 0,a=d.seed||void 0,h=d.md||void 0,d.mgf1&&d.mgf1.md&&(p=d.mgf1.md)),h?h.start():h=t.md.sha1.create(),p||(p=h);var T=Math.ceil(s.n.bitLength()/8),I=T-2*h.digestLength-2;if(u.length>I){var A=new Error("RSAES-OAEP input message length is too long.");throw A.length=u.length,A.maxLength=I,A}c||(c=""),h.update(c,"raw");for(var m=h.digest(),S="",C=I-u.length,E=0;E<C;E++)S+="\0";var l=m.getBytes()+S+""+u;if(!a)a=t.random.getBytes(h.digestLength);else if(a.length!==h.digestLength){var A=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw A.seedLength=a.length,A.digestLength=h.digestLength,A}var v=n(a,T-h.digestLength-1,p),_=t.util.xorBytes(l,v,l.length),B=n(_,h.digestLength,p),L=t.util.xorBytes(a,B,a.length);return"\0"+L+_},e.decode_rsa_oaep=function(s,u,d){var c,a,h;typeof d=="string"?(c=d,a=arguments[3]||void 0):d&&(c=d.label||void 0,a=d.md||void 0,d.mgf1&&d.mgf1.md&&(h=d.mgf1.md));var p=Math.ceil(s.n.bitLength()/8);if(u.length!==p){var T=new Error("RSAES-OAEP encoded message length is invalid.");throw T.length=u.length,T.expectedLength=p,T}if(a===void 0?a=t.md.sha1.create():a.start(),h||(h=a),p<2*a.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");c||(c=""),a.update(c,"raw");for(var I=a.digest().getBytes(),A=u.charAt(0),m=u.substring(1,a.digestLength+1),S=u.substring(1+a.digestLength),C=n(S,a.digestLength,h),E=t.util.xorBytes(m,C,m.length),l=n(E,p-a.digestLength-1,h),v=t.util.xorBytes(S,l,S.length),_=v.substring(0,a.digestLength),T=A!=="\0",B=0;B<a.digestLength;++B)T|=I.charAt(B)!==_.charAt(B);for(var L=1,g=a.digestLength,f=a.digestLength;f<v.length;f++){var o=v.charCodeAt(f),w=o&1^1,U=L?65534:0;T|=o&U,L=L&w,g+=L}if(T||v.charCodeAt(g)!==1)throw new Error("Invalid RSAES-OAEP padding.");return v.substring(g+1)};function n(s,u,d){d||(d=t.md.sha1.create());for(var c="",a=Math.ceil(u/d.digestLength),h=0;h<a;++h){var p=String.fromCharCode(h>>24&255,h>>16&255,h>>8&255,h&255);d.start(),d.update(s+p),c+=d.digest().getBytes()}return c.substring(0,u)}}),Nc=he((i,r)=>{var t=me();Ce(),Nn(),It(),function(){if(t.prime){r.exports=t.prime;return}var e=r.exports=t.prime=t.prime||{},n=t.jsbn.BigInteger,s=[6,4,2,4,2,4,6,2],u=new n(null);u.fromInt(30);var d=function(A,m){return A|m};e.generateProbablePrime=function(A,m,S){typeof m=="function"&&(S=m,m={}),m=m||{};var C=m.algorithm||"PRIMEINC";typeof C=="string"&&(C={name:C}),C.options=C.options||{};var E=m.prng||t.random,l={nextBytes:function(v){for(var _=E.getBytesSync(v.length),B=0;B<v.length;++B)v[B]=_.charCodeAt(B)}};if(C.name==="PRIMEINC")return c(A,l,C.options,S);throw new Error("Invalid prime generation algorithm: "+C.name)};function c(A,m,S,C){return"workers"in S?p(A,m,S,C):a(A,m,S,C)}function a(A,m,S,C){var E=T(A,m),l=0,v=I(E.bitLength());"millerRabinTests"in S&&(v=S.millerRabinTests);var _=10;"maxBlockTime"in S&&(_=S.maxBlockTime),h(E,A,m,l,v,_,C)}function h(A,m,S,C,E,l,v){var _=+new Date;do{if(A.bitLength()>m&&(A=T(m,S)),A.isProbablePrime(E))return v(null,A);A.dAddOffset(s[C++%8],0)}while(l<0||+new Date-_<l);t.util.setImmediate(function(){h(A,m,S,C,E,l,v)})}function p(A,m,S,C){if(typeof Worker>"u")return a(A,m,S,C);var E=T(A,m),l=S.workers,v=S.workLoad||100,_=v*30/8,B=S.workerScript||"forge/prime.worker.js";if(l===-1)return t.util.estimateCores(function(g,f){g&&(f=2),l=f-1,L()});L();function L(){l=Math.max(1,l);for(var g=[],f=0;f<l;++f)g[f]=new Worker(B);for(var o=l,f=0;f<l;++f)g[f].addEventListener("message",U);var w=!1;function U(K){if(!w){--o;var D=K.data;if(D.found){for(var H=0;H<g.length;++H)g[H].terminate();return w=!0,C(null,new n(D.prime,16))}E.bitLength()>A&&(E=T(A,m));var q=E.toString(16);K.target.postMessage({hex:q,workLoad:v}),E.dAddOffset(_,0)}}}}function T(A,m){var S=new n(A,m),C=A-1;return S.testBit(C)||S.bitwiseTo(n.ONE.shiftLeft(C),d,S),S.dAddOffset(31-S.mod(u).byteValue(),0),S}function I(A){return A<=100?27:A<=150?18:A<=200?15:A<=250?12:A<=300?9:A<=350?8:A<=400?7:A<=500?6:A<=600?5:A<=800?4:A<=1250?3:2}}()}),xn=he((i,r)=>{var t=me();Pt(),Nn(),or(),Bc(),Nc(),It(),Ce(),typeof e>"u"&&(e=t.jsbn.BigInteger);var e,n=t.util.isNodejs?_a("node:crypto"):null,s=t.asn1,u=t.util;t.pki=t.pki||{},r.exports=t.pki.rsa=t.rsa=t.rsa||{};var d=t.pki,c=[6,4,2,4,2,4,6,2],a={name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},h={name:"RSAPrivateKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},p={name:"RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},T=t.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},I={name:"DigestInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:s.Class.UNIVERSAL,type:s.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},A=function(f){var o;if(f.algorithm in d.oids)o=d.oids[f.algorithm];else{var w=new Error("Unknown message digest algorithm.");throw w.algorithm=f.algorithm,w}var U=s.oidToDer(o).getBytes(),K=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]),D=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);D.value.push(s.create(s.Class.UNIVERSAL,s.Type.OID,!1,U)),D.value.push(s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,""));var H=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,f.digest().getBytes());return K.value.push(D),K.value.push(H),s.toDer(K).getBytes()},m=function(f,o,w){if(w)return f.modPow(o.e,o.n);if(!o.p||!o.q)return f.modPow(o.d,o.n);o.dP||(o.dP=o.d.mod(o.p.subtract(e.ONE))),o.dQ||(o.dQ=o.d.mod(o.q.subtract(e.ONE))),o.qInv||(o.qInv=o.q.modInverse(o.p));var U;do U=new e(t.util.bytesToHex(t.random.getBytes(o.n.bitLength()/8)),16);while(U.compareTo(o.n)>=0||!U.gcd(o.n).equals(e.ONE));f=f.multiply(U.modPow(o.e,o.n)).mod(o.n);for(var K=f.mod(o.p).modPow(o.dP,o.p),D=f.mod(o.q).modPow(o.dQ,o.q);K.compareTo(D)<0;)K=K.add(o.p);var H=K.subtract(D).multiply(o.qInv).mod(o.p).multiply(o.q).add(D);return H=H.multiply(U.modInverse(o.n)).mod(o.n),H};d.rsa.encrypt=function(f,o,w){var U=w,K,D=Math.ceil(o.n.bitLength()/8);w!==!1&&w!==!0?(U=w===2,K=S(f,o,w)):(K=t.util.createBuffer(),K.putBytes(f));for(var H=new e(K.toHex(),16),q=m(H,o,U),G=q.toString(16),z=t.util.createBuffer(),Y=D-Math.ceil(G.length/2);Y>0;)z.putByte(0),--Y;return z.putBytes(t.util.hexToBytes(G)),z.getBytes()},d.rsa.decrypt=function(f,o,w,U){var K=Math.ceil(o.n.bitLength()/8);if(f.length!==K){var D=new Error("Encrypted message length is invalid.");throw D.length=f.length,D.expected=K,D}var H=new e(t.util.createBuffer(f).toHex(),16);if(H.compareTo(o.n)>=0)throw new Error("Encrypted message is invalid.");for(var q=m(H,o,w),G=q.toString(16),z=t.util.createBuffer(),Y=K-Math.ceil(G.length/2);Y>0;)z.putByte(0),--Y;return z.putBytes(t.util.hexToBytes(G)),U!==!1?C(z.getBytes(),o,w):z.getBytes()},d.rsa.createKeyPairGenerationState=function(f,o,w){typeof f=="string"&&(f=parseInt(f,10)),f=f||2048,w=w||{};var U=w.prng||t.random,K={nextBytes:function(q){for(var G=U.getBytesSync(q.length),z=0;z<q.length;++z)q[z]=G.charCodeAt(z)}},D=w.algorithm||"PRIMEINC",H;if(D==="PRIMEINC")H={algorithm:D,state:0,bits:f,rng:K,eInt:o||65537,e:new e(null),p:null,q:null,qBits:f>>1,pBits:f-(f>>1),pqState:0,num:null,keys:null},H.e.fromInt(H.eInt);else throw new Error("Invalid key generation algorithm: "+D);return H},d.rsa.stepKeyPairGenerationState=function(f,o){"algorithm"in f||(f.algorithm="PRIMEINC");var w=new e(null);w.fromInt(30);for(var U=0,K=function(Z,te){return Z|te},D=+new Date,H,q=0;f.keys===null&&(o<=0||q<o);){if(f.state===0){var G=f.p===null?f.pBits:f.qBits,z=G-1;f.pqState===0?(f.num=new e(G,f.rng),f.num.testBit(z)||f.num.bitwiseTo(e.ONE.shiftLeft(z),K,f.num),f.num.dAddOffset(31-f.num.mod(w).byteValue(),0),U=0,++f.pqState):f.pqState===1?f.num.bitLength()>G?f.pqState=0:f.num.isProbablePrime(v(f.num.bitLength()))?++f.pqState:f.num.dAddOffset(c[U++%8],0):f.pqState===2?f.pqState=f.num.subtract(e.ONE).gcd(f.e).compareTo(e.ONE)===0?3:0:f.pqState===3&&(f.pqState=0,f.p===null?f.p=f.num:f.q=f.num,f.p!==null&&f.q!==null&&++f.state,f.num=null)}else if(f.state===1)f.p.compareTo(f.q)<0&&(f.num=f.p,f.p=f.q,f.q=f.num),++f.state;else if(f.state===2)f.p1=f.p.subtract(e.ONE),f.q1=f.q.subtract(e.ONE),f.phi=f.p1.multiply(f.q1),++f.state;else if(f.state===3)f.phi.gcd(f.e).compareTo(e.ONE)===0?++f.state:(f.p=null,f.q=null,f.state=0);else if(f.state===4)f.n=f.p.multiply(f.q),f.n.bitLength()===f.bits?++f.state:(f.q=null,f.state=0);else if(f.state===5){var Y=f.e.modInverse(f.phi);f.keys={privateKey:d.rsa.setPrivateKey(f.n,f.e,Y,f.p,f.q,Y.mod(f.p1),Y.mod(f.q1),f.q.modInverse(f.p)),publicKey:d.rsa.setPublicKey(f.n,f.e)}}H=+new Date,q+=H-D,D=H}return f.keys!==null},d.rsa.generateKeyPair=function(f,o,w,U){if(arguments.length===1?typeof f=="object"?(w=f,f=void 0):typeof f=="function"&&(U=f,f=void 0):arguments.length===2?typeof f=="number"?typeof o=="function"?(U=o,o=void 0):typeof o!="number"&&(w=o,o=void 0):(w=f,U=o,f=void 0,o=void 0):arguments.length===3&&(typeof o=="number"?typeof w=="function"&&(U=w,w=void 0):(U=w,w=o,o=void 0)),w=w||{},f===void 0&&(f=w.bits||2048),o===void 0&&(o=w.e||65537),!t.options.usePureJavaScript&&!w.prng&&f>=256&&f<=16384&&(o===65537||o===3)){if(U){if(_("generateKeyPair"))return n.generateKeyPair("rsa",{modulusLength:f,publicExponent:o,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(q,G,z){if(q)return U(q);U(null,{privateKey:d.privateKeyFromPem(z),publicKey:d.publicKeyFromPem(G)})});if(B("generateKey")&&B("exportKey"))return u.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:f,publicExponent:g(o),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(q){return u.globalScope.crypto.subtle.exportKey("pkcs8",q.privateKey)}).then(void 0,function(q){U(q)}).then(function(q){if(q){var G=d.privateKeyFromAsn1(s.fromDer(t.util.createBuffer(q)));U(null,{privateKey:G,publicKey:d.setRsaPublicKey(G.n,G.e)})}});if(L("generateKey")&&L("exportKey")){var K=u.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:f,publicExponent:g(o),hash:{name:"SHA-256"}},!0,["sign","verify"]);K.oncomplete=function(q){var G=q.target.result,z=u.globalScope.msCrypto.subtle.exportKey("pkcs8",G.privateKey);z.oncomplete=function(Y){var Z=Y.target.result,te=d.privateKeyFromAsn1(s.fromDer(t.util.createBuffer(Z)));U(null,{privateKey:te,publicKey:d.setRsaPublicKey(te.n,te.e)})},z.onerror=function(Y){U(Y)}},K.onerror=function(q){U(q)};return}}else if(_("generateKeyPairSync")){var D=n.generateKeyPairSync("rsa",{modulusLength:f,publicExponent:o,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:d.privateKeyFromPem(D.privateKey),publicKey:d.publicKeyFromPem(D.publicKey)}}}var H=d.rsa.createKeyPairGenerationState(f,o,w);if(!U)return d.rsa.stepKeyPairGenerationState(H,0),H.keys;E(H,w,U)},d.setRsaPublicKey=d.rsa.setPublicKey=function(f,o){var w={n:f,e:o};return w.encrypt=function(U,K,D){if(typeof K=="string"?K=K.toUpperCase():K===void 0&&(K="RSAES-PKCS1-V1_5"),K==="RSAES-PKCS1-V1_5")K={encode:function(q,G,z){return S(q,G,2).getBytes()}};else if(K==="RSA-OAEP"||K==="RSAES-OAEP")K={encode:function(q,G){return t.pkcs1.encode_rsa_oaep(G,q,D)}};else if(["RAW","NONE","NULL",null].indexOf(K)!==-1)K={encode:function(q){return q}};else if(typeof K=="string")throw new Error('Unsupported encryption scheme: "'+K+'".');var H=K.encode(U,w,!0);return d.rsa.encrypt(H,w,!0)},w.verify=function(U,K,D,H){typeof D=="string"?D=D.toUpperCase():D===void 0&&(D="RSASSA-PKCS1-V1_5"),H===void 0&&(H={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in H||(H._parseAllDigestBytes=!0),D==="RSASSA-PKCS1-V1_5"?D={verify:function(G,z){z=C(z,w,!0);var Y=s.fromDer(z,{parseAllBytes:H._parseAllDigestBytes}),Z={},te=[];if(!s.validate(Y,I,Z,te)){var se=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw se.errors=te,se}var de=s.derToOid(Z.algorithmIdentifier);if(!(de===t.oids.md2||de===t.oids.md5||de===t.oids.sha1||de===t.oids.sha224||de===t.oids.sha256||de===t.oids.sha384||de===t.oids.sha512||de===t.oids["sha512-224"]||de===t.oids["sha512-256"])){var se=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw se.oid=de,se}if((de===t.oids.md2||de===t.oids.md5)&&!("parameters"in Z))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return G===Z.digest}}:(D==="NONE"||D==="NULL"||D===null)&&(D={verify:function(G,z){return z=C(z,w,!0),G===z}});var q=d.rsa.decrypt(K,w,!0,!1);return D.verify(U,q,w.n.bitLength())},w},d.setRsaPrivateKey=d.rsa.setPrivateKey=function(f,o,w,U,K,D,H,q){var G={n:f,e:o,d:w,p:U,q:K,dP:D,dQ:H,qInv:q};return G.decrypt=function(z,Y,Z){typeof Y=="string"?Y=Y.toUpperCase():Y===void 0&&(Y="RSAES-PKCS1-V1_5");var te=d.rsa.decrypt(z,G,!1,!1);if(Y==="RSAES-PKCS1-V1_5")Y={decode:C};else if(Y==="RSA-OAEP"||Y==="RSAES-OAEP")Y={decode:function(se,de){return t.pkcs1.decode_rsa_oaep(de,se,Z)}};else if(["RAW","NONE","NULL",null].indexOf(Y)!==-1)Y={decode:function(se){return se}};else throw new Error('Unsupported encryption scheme: "'+Y+'".');return Y.decode(te,G,!1)},G.sign=function(z,Y){var Z=!1;typeof Y=="string"&&(Y=Y.toUpperCase()),Y===void 0||Y==="RSASSA-PKCS1-V1_5"?(Y={encode:A},Z=1):(Y==="NONE"||Y==="NULL"||Y===null)&&(Y={encode:function(){return z}},Z=1);var te=Y.encode(z,G.n.bitLength());return d.rsa.encrypt(te,G,Z)},G},d.wrapRsaPrivateKey=function(f){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(d.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,s.toDer(f).getBytes())])},d.privateKeyFromAsn1=function(f){var o={},w=[];if(s.validate(f,a,o,w)&&(f=s.fromDer(t.util.createBuffer(o.privateKey))),o={},w=[],!s.validate(f,h,o,w)){var U=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw U.errors=w,U}var K,D,H,q,G,z,Y,Z;return K=t.util.createBuffer(o.privateKeyModulus).toHex(),D=t.util.createBuffer(o.privateKeyPublicExponent).toHex(),H=t.util.createBuffer(o.privateKeyPrivateExponent).toHex(),q=t.util.createBuffer(o.privateKeyPrime1).toHex(),G=t.util.createBuffer(o.privateKeyPrime2).toHex(),z=t.util.createBuffer(o.privateKeyExponent1).toHex(),Y=t.util.createBuffer(o.privateKeyExponent2).toHex(),Z=t.util.createBuffer(o.privateKeyCoefficient).toHex(),d.setRsaPrivateKey(new e(K,16),new e(D,16),new e(H,16),new e(q,16),new e(G,16),new e(z,16),new e(Y,16),new e(Z,16))},d.privateKeyToAsn1=d.privateKeyToRSAPrivateKey=function(f){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,l(f.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,l(f.e)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,l(f.d)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,l(f.p)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,l(f.q)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,l(f.dP)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,l(f.dQ)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,l(f.qInv))])},d.publicKeyFromAsn1=function(f){var o={},w=[];if(s.validate(f,T,o,w)){var U=s.derToOid(o.publicKeyOid);if(U!==d.oids.rsaEncryption){var K=new Error("Cannot read public key. Unknown OID.");throw K.oid=U,K}f=o.rsaPublicKey}if(w=[],!s.validate(f,p,o,w)){var K=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw K.errors=w,K}var D=t.util.createBuffer(o.publicKeyModulus).toHex(),H=t.util.createBuffer(o.publicKeyExponent).toHex();return d.setRsaPublicKey(new e(D,16),new e(H,16))},d.publicKeyToAsn1=d.publicKeyToSubjectPublicKeyInfo=function(f){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(d.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,[d.publicKeyToRSAPublicKey(f)])])},d.publicKeyToRSAPublicKey=function(f){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,l(f.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,l(f.e))])};function S(f,o,w){var U=t.util.createBuffer(),K=Math.ceil(o.n.bitLength()/8);if(f.length>K-11){var D=new Error("Message is too long for PKCS#1 v1.5 padding.");throw D.length=f.length,D.max=K-11,D}U.putByte(0),U.putByte(w);var H=K-3-f.length,q;if(w===0||w===1){q=w===0?0:255;for(var G=0;G<H;++G)U.putByte(q)}else for(;H>0;){for(var z=0,Y=t.random.getBytes(H),G=0;G<H;++G)q=Y.charCodeAt(G),q===0?++z:U.putByte(q);H=z}return U.putByte(0),U.putBytes(f),U}function C(f,o,w,U){var K=Math.ceil(o.n.bitLength()/8),D=t.util.createBuffer(f),H=D.getByte(),q=D.getByte();if(H!==0||w&&q!==0&&q!==1||!w&&q!=2||w&&q===0&&typeof U>"u")throw new Error("Encryption block is invalid.");var G=0;if(q===0){G=K-3-U;for(var z=0;z<G;++z)if(D.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(q===1)for(G=0;D.length()>1;){if(D.getByte()!==255){--D.read;break}++G}else if(q===2)for(G=0;D.length()>1;){if(D.getByte()===0){--D.read;break}++G}var Y=D.getByte();if(Y!==0||G!==K-3-D.length())throw new Error("Encryption block is invalid.");return D.getBytes()}function E(f,o,w){typeof o=="function"&&(w=o,o={}),o=o||{};var U={algorithm:{name:o.algorithm||"PRIMEINC",options:{workers:o.workers||2,workLoad:o.workLoad||100,workerScript:o.workerScript}}};"prng"in o&&(U.prng=o.prng),K();function K(){D(f.pBits,function(q,G){if(q)return w(q);if(f.p=G,f.q!==null)return H(q,f.q);D(f.qBits,H)})}function D(q,G){t.prime.generateProbablePrime(q,U,G)}function H(q,G){if(q)return w(q);if(f.q=G,f.p.compareTo(f.q)<0){var z=f.p;f.p=f.q,f.q=z}if(f.p.subtract(e.ONE).gcd(f.e).compareTo(e.ONE)!==0){f.p=null,K();return}if(f.q.subtract(e.ONE).gcd(f.e).compareTo(e.ONE)!==0){f.q=null,D(f.qBits,H);return}if(f.p1=f.p.subtract(e.ONE),f.q1=f.q.subtract(e.ONE),f.phi=f.p1.multiply(f.q1),f.phi.gcd(f.e).compareTo(e.ONE)!==0){f.p=f.q=null,K();return}if(f.n=f.p.multiply(f.q),f.n.bitLength()!==f.bits){f.q=null,D(f.qBits,H);return}var Y=f.e.modInverse(f.phi);f.keys={privateKey:d.rsa.setPrivateKey(f.n,f.e,Y,f.p,f.q,Y.mod(f.p1),Y.mod(f.q1),f.q.modInverse(f.p)),publicKey:d.rsa.setPublicKey(f.n,f.e)},w(null,f.keys)}}function l(f){var o=f.toString(16);o[0]>="8"&&(o="00"+o);var w=t.util.hexToBytes(o);return w.length>1&&(w.charCodeAt(0)===0&&!(w.charCodeAt(1)&128)||w.charCodeAt(0)===255&&(w.charCodeAt(1)&128)===128)?w.substr(1):w}function v(f){return f<=100?27:f<=150?18:f<=200?15:f<=250?12:f<=300?9:f<=350?8:f<=400?7:f<=500?6:f<=600?5:f<=800?4:f<=1250?3:2}function _(f){return t.util.isNodejs&&typeof n[f]=="function"}function B(f){return typeof u.globalScope<"u"&&typeof u.globalScope.crypto=="object"&&typeof u.globalScope.crypto.subtle=="object"&&typeof u.globalScope.crypto.subtle[f]=="function"}function L(f){return typeof u.globalScope<"u"&&typeof u.globalScope.msCrypto=="object"&&typeof u.globalScope.msCrypto.subtle=="object"&&typeof u.globalScope.msCrypto.subtle[f]=="function"}function g(f){for(var o=t.util.hexToBytes(f.toString(16)),w=new Uint8Array(o.length),U=0;U<o.length;++U)w[U]=o.charCodeAt(U);return w}}),xc=he((i,r)=>{var t=me();sr(),Pt(),Bn(),Ht(),or(),wa(),Er(),It(),wc(),xn(),Ce(),typeof e>"u"&&(e=t.jsbn.BigInteger);var e,n=t.asn1,s=t.pki=t.pki||{};r.exports=s.pbe=t.pbe=t.pbe||{};var u=s.oids,d={name:"EncryptedPrivateKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},c={name:"PBES2Algorithms",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},a={name:"pkcs-12PbeParams",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"iterations"}]};s.encryptPrivateKeyInfo=function(A,m,S){S=S||{},S.saltSize=S.saltSize||8,S.count=S.count||2048,S.algorithm=S.algorithm||"aes128",S.prfAlgorithm=S.prfAlgorithm||"sha1";var C=t.random.getBytesSync(S.saltSize),E=S.count,l=n.integerToDer(E),v,_,B;if(S.algorithm.indexOf("aes")===0||S.algorithm==="des"){var L,g,f;switch(S.algorithm){case"aes128":v=16,L=16,g=u["aes128-CBC"],f=t.aes.createEncryptionCipher;break;case"aes192":v=24,L=16,g=u["aes192-CBC"],f=t.aes.createEncryptionCipher;break;case"aes256":v=32,L=16,g=u["aes256-CBC"],f=t.aes.createEncryptionCipher;break;case"des":v=8,L=8,g=u.desCBC,f=t.des.createEncryptionCipher;break;default:var o=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw o.algorithm=S.algorithm,o}var w="hmacWith"+S.prfAlgorithm.toUpperCase(),U=T(w),K=t.pkcs5.pbkdf2(m,C,E,v,U),D=t.random.getBytesSync(L),H=f(K);H.start(D),H.update(n.toDer(A)),H.finish(),B=H.output.getBytes();var q=I(C,l,v,w);_=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(u.pkcs5PBES2).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(u.pkcs5PBKDF2).getBytes()),q]),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(g).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,D)])])])}else if(S.algorithm==="3des"){v=24;var G=new t.util.ByteBuffer(C),K=s.pbe.generatePkcs12Key(m,G,1,E,v),D=s.pbe.generatePkcs12Key(m,G,2,E,v),H=t.des.createEncryptionCipher(K);H.start(D),H.update(n.toDer(A)),H.finish(),B=H.output.getBytes(),_=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(u["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,C),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,l.getBytes())])])}else{var o=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw o.algorithm=S.algorithm,o}var z=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[_,n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,B)]);return z},s.decryptPrivateKeyInfo=function(A,m){var S=null,C={},E=[];if(!n.validate(A,d,C,E)){var l=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw l.errors=E,l}var v=n.derToOid(C.encryptionOid),_=s.pbe.getCipher(v,C.encryptionParams,m),B=t.util.createBuffer(C.encryptedData);return _.update(B),_.finish()&&(S=n.fromDer(_.output)),S},s.encryptedPrivateKeyToPem=function(A,m){var S={type:"ENCRYPTED PRIVATE KEY",body:n.toDer(A).getBytes()};return t.pem.encode(S,{maxline:m})},s.encryptedPrivateKeyFromPem=function(A){var m=t.pem.decode(A)[0];if(m.type!=="ENCRYPTED PRIVATE KEY"){var S=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw S.headerType=m.type,S}if(m.procType&&m.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return n.fromDer(m.body)},s.encryptRsaPrivateKey=function(A,m,S){if(S=S||{},!S.legacy){var C=s.wrapRsaPrivateKey(s.privateKeyToAsn1(A));return C=s.encryptPrivateKeyInfo(C,m,S),s.encryptedPrivateKeyToPem(C)}var E,l,v,_;switch(S.algorithm){case"aes128":E="AES-128-CBC",v=16,l=t.random.getBytesSync(16),_=t.aes.createEncryptionCipher;break;case"aes192":E="AES-192-CBC",v=24,l=t.random.getBytesSync(16),_=t.aes.createEncryptionCipher;break;case"aes256":E="AES-256-CBC",v=32,l=t.random.getBytesSync(16),_=t.aes.createEncryptionCipher;break;case"3des":E="DES-EDE3-CBC",v=24,l=t.random.getBytesSync(8),_=t.des.createEncryptionCipher;break;case"des":E="DES-CBC",v=8,l=t.random.getBytesSync(8),_=t.des.createEncryptionCipher;break;default:var B=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+S.algorithm+'".');throw B.algorithm=S.algorithm,B}var L=t.pbe.opensslDeriveBytes(m,l.substr(0,8),v),g=_(L);g.start(l),g.update(n.toDer(s.privateKeyToAsn1(A))),g.finish();var f={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:E,parameters:t.util.bytesToHex(l).toUpperCase()},body:g.output.getBytes()};return t.pem.encode(f)},s.decryptRsaPrivateKey=function(A,m){var S=null,C=t.pem.decode(A)[0];if(C.type!=="ENCRYPTED PRIVATE KEY"&&C.type!=="PRIVATE KEY"&&C.type!=="RSA PRIVATE KEY"){var E=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw E.headerType=E,E}if(C.procType&&C.procType.type==="ENCRYPTED"){var l,v;switch(C.dekInfo.algorithm){case"DES-CBC":l=8,v=t.des.createDecryptionCipher;break;case"DES-EDE3-CBC":l=24,v=t.des.createDecryptionCipher;break;case"AES-128-CBC":l=16,v=t.aes.createDecryptionCipher;break;case"AES-192-CBC":l=24,v=t.aes.createDecryptionCipher;break;case"AES-256-CBC":l=32,v=t.aes.createDecryptionCipher;break;case"RC2-40-CBC":l=5,v=function(f){return t.rc2.createDecryptionCipher(f,40)};break;case"RC2-64-CBC":l=8,v=function(f){return t.rc2.createDecryptionCipher(f,64)};break;case"RC2-128-CBC":l=16,v=function(f){return t.rc2.createDecryptionCipher(f,128)};break;default:var E=new Error('Could not decrypt private key; unsupported encryption algorithm "'+C.dekInfo.algorithm+'".');throw E.algorithm=C.dekInfo.algorithm,E}var _=t.util.hexToBytes(C.dekInfo.parameters),B=t.pbe.opensslDeriveBytes(m,_.substr(0,8),l),L=v(B);if(L.start(_),L.update(t.util.createBuffer(C.body)),L.finish())S=L.output.getBytes();else return S}else S=C.body;return C.type==="ENCRYPTED PRIVATE KEY"?S=s.decryptPrivateKeyInfo(n.fromDer(S),m):S=n.fromDer(S),S!==null&&(S=s.privateKeyFromAsn1(S)),S},s.pbe.generatePkcs12Key=function(A,m,S,C,E,l){var v,_;if(typeof l>"u"||l===null){if(!("sha1"in t.md))throw new Error('"sha1" hash algorithm unavailable.');l=t.md.sha1.create()}var B=l.digestLength,L=l.blockLength,g=new t.util.ByteBuffer,f=new t.util.ByteBuffer;if(A!=null){for(_=0;_<A.length;_++)f.putInt16(A.charCodeAt(_));f.putInt16(0)}var o=f.length(),w=m.length(),U=new t.util.ByteBuffer;U.fillWithByte(S,L);var K=L*Math.ceil(w/L),D=new t.util.ByteBuffer;for(_=0;_<K;_++)D.putByte(m.at(_%w));var H=L*Math.ceil(o/L),q=new t.util.ByteBuffer;for(_=0;_<H;_++)q.putByte(f.at(_%o));var G=D;G.putBuffer(q);for(var z=Math.ceil(E/B),Y=1;Y<=z;Y++){var Z=new t.util.ByteBuffer;Z.putBytes(U.bytes()),Z.putBytes(G.bytes());for(var te=0;te<C;te++)l.start(),l.update(Z.getBytes()),Z=l.digest();var se=new t.util.ByteBuffer;for(_=0;_<L;_++)se.putByte(Z.at(_%B));var de=Math.ceil(w/L)+Math.ceil(o/L),be=new t.util.ByteBuffer;for(v=0;v<de;v++){var we=new t.util.ByteBuffer(G.getBytes(L)),J=511;for(_=se.length()-1;_>=0;_--)J=J>>8,J+=se.at(_)+we.at(_),we.setAt(_,J&255);be.putBuffer(we)}G=be,g.putBuffer(Z)}return g.truncate(g.length()-E),g},s.pbe.getCipher=function(A,m,S){switch(A){case s.oids.pkcs5PBES2:return s.pbe.getCipherForPBES2(A,m,S);case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case s.oids["pbewithSHAAnd40BitRC2-CBC"]:return s.pbe.getCipherForPKCS12PBE(A,m,S);default:var C=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw C.oid=A,C.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],C}},s.pbe.getCipherForPBES2=function(A,m,S){var C={},E=[];if(!n.validate(m,c,C,E)){var l=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw l.errors=E,l}if(A=n.derToOid(C.kdfOid),A!==s.oids.pkcs5PBKDF2){var l=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw l.oid=A,l.supportedOids=["pkcs5PBKDF2"],l}if(A=n.derToOid(C.encOid),A!==s.oids["aes128-CBC"]&&A!==s.oids["aes192-CBC"]&&A!==s.oids["aes256-CBC"]&&A!==s.oids["des-EDE3-CBC"]&&A!==s.oids.desCBC){var l=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw l.oid=A,l.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],l}var v=C.kdfSalt,_=t.util.createBuffer(C.kdfIterationCount);_=_.getInt(_.length()<<3);var B,L;switch(s.oids[A]){case"aes128-CBC":B=16,L=t.aes.createDecryptionCipher;break;case"aes192-CBC":B=24,L=t.aes.createDecryptionCipher;break;case"aes256-CBC":B=32,L=t.aes.createDecryptionCipher;break;case"des-EDE3-CBC":B=24,L=t.des.createDecryptionCipher;break;case"desCBC":B=8,L=t.des.createDecryptionCipher;break}var g=p(C.prfOid),f=t.pkcs5.pbkdf2(S,v,_,B,g),o=C.encIv,w=L(f);return w.start(o),w},s.pbe.getCipherForPKCS12PBE=function(A,m,S){var C={},E=[];if(!n.validate(m,a,C,E)){var l=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw l.errors=E,l}var v=t.util.createBuffer(C.salt),_=t.util.createBuffer(C.iterations);_=_.getInt(_.length()<<3);var B,L,g;switch(A){case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:B=24,L=8,g=t.des.startDecrypting;break;case s.oids["pbewithSHAAnd40BitRC2-CBC"]:B=5,L=8,g=function(K,D){var H=t.rc2.createDecryptionCipher(K,40);return H.start(D,null),H};break;default:var l=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw l.oid=A,l}var f=p(C.prfOid),o=s.pbe.generatePkcs12Key(S,v,1,_,B,f);f.start();var w=s.pbe.generatePkcs12Key(S,v,2,_,L,f);return g(o,w)},s.pbe.opensslDeriveBytes=function(A,m,S,C){if(typeof C>"u"||C===null){if(!("md5"in t.md))throw new Error('"md5" hash algorithm unavailable.');C=t.md.md5.create()}m===null&&(m="");for(var E=[h(C,A+m)],l=16,v=1;l<S;++v,l+=16)E.push(h(C,E[v-1]+A+m));return E.join("").substr(0,S)};function h(A,m){return A.start().update(m).digest().getBytes()}function p(A){var m;if(!A)m="hmacWithSHA1";else if(m=s.oids[n.derToOid(A)],!m){var S=new Error("Unsupported PRF OID.");throw S.oid=A,S.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],S}return T(m)}function T(A){var m=t.md;switch(A){case"hmacWithSHA224":m=t.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":A=A.substr(8).toLowerCase();break;default:var S=new Error("Unsupported PRF algorithm.");throw S.algorithm=A,S.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],S}if(!m||!(A in m))throw new Error("Unknown hash algorithm: "+A);return m[A].create()}function I(A,m,S,C){var E=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,A),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,m.getBytes())]);return C!=="hmacWithSHA1"&&E.value.push(n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,t.util.hexToBytes(S.toString(16))),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(s.oids[C]).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")])),E}}),kc=he((i,r)=>{var t=me();Pt(),Ce();var e=t.asn1,n=r.exports=t.pkcs7asn1=t.pkcs7asn1||{};t.pkcs7=t.pkcs7||{},t.pkcs7.asn1=n;var s={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};n.contentInfoValidator=s;var u={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};n.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(u)},n.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(u)};var d={name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};n.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},s,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[d]}]},n.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}}),Rc=he((i,r)=>{var t=me();Ce(),t.mgf=t.mgf||{};var e=r.exports=t.mgf.mgf1=t.mgf1=t.mgf1||{};e.create=function(n){var s={generate:function(u,d){for(var c=new t.util.ByteBuffer,a=Math.ceil(d/n.digestLength),h=0;h<a;h++){var p=new t.util.ByteBuffer;p.putInt32(h),n.start(),n.update(u+p.getBytes()),c.putBuffer(n.digest())}return c.truncate(c.length()-d),c.getBytes()}};return s}}),ap=he((i,r)=>{var t=me();Rc(),r.exports=t.mgf=t.mgf||{},t.mgf.mgf1=t.mgf1}),Ba=he((i,r)=>{var t=me();It(),Ce();var e=r.exports=t.pss=t.pss||{};e.create=function(n){arguments.length===3&&(n={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var s=n.md,u=n.mgf,d=s.digestLength,c=n.salt||null;typeof c=="string"&&(c=t.util.createBuffer(c));var a;if("saltLength"in n)a=n.saltLength;else if(c!==null)a=c.length();else throw new Error("Salt length not specified or specific salt not given.");if(c!==null&&c.length()!==a)throw new Error("Given salt length does not match length of given salt.");var h=n.prng||t.random,p={};return p.encode=function(T,I){var A,m=I-1,S=Math.ceil(m/8),C=T.digest().getBytes();if(S<d+a+2)throw new Error("Message is too long to encrypt.");var E;c===null?E=h.getBytesSync(a):E=c.bytes();var l=new t.util.ByteBuffer;l.fillWithByte(0,8),l.putBytes(C),l.putBytes(E),s.start(),s.update(l.getBytes());var v=s.digest().getBytes(),_=new t.util.ByteBuffer;_.fillWithByte(0,S-a-d-2),_.putByte(1),_.putBytes(E);var B=_.getBytes(),L=S-d-1,g=u.generate(v,L),f="";for(A=0;A<L;A++)f+=String.fromCharCode(B.charCodeAt(A)^g.charCodeAt(A));var o=65280>>8*S-m&255;return f=String.fromCharCode(f.charCodeAt(0)&~o)+f.substr(1),f+v+"\xBC"},p.verify=function(T,I,A){var m,S=A-1,C=Math.ceil(S/8);if(I=I.substr(-C),C<d+a+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(I.charCodeAt(C-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var E=C-d-1,l=I.substr(0,E),v=I.substr(E,d),_=65280>>8*C-S&255;if(l.charCodeAt(0)&_)throw new Error("Bits beyond keysize not zero as expected.");var B=u.generate(v,E),L="";for(m=0;m<E;m++)L+=String.fromCharCode(l.charCodeAt(m)^B.charCodeAt(m));L=String.fromCharCode(L.charCodeAt(0)&~_)+L.substr(1);var g=C-d-a-2;for(m=0;m<g;m++)if(L.charCodeAt(m)!==0)throw new Error("Leftmost octets not zero as expected");if(L.charCodeAt(g)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var f=L.substr(-a),o=new t.util.ByteBuffer;o.fillWithByte(0,8),o.putBytes(T),o.putBytes(f),s.start(),s.update(o.getBytes());var w=s.digest().getBytes();return v===w},p}}),Na=he((i,r)=>{var t=me();sr(),Pt(),Bn(),Ht(),ap(),or(),Er(),Ba(),xn(),Ce();var e=t.asn1,n=r.exports=t.pki=t.pki||{},s=n.oids,u={};u.CN=s.commonName,u.commonName="CN",u.C=s.countryName,u.countryName="C",u.L=s.localityName,u.localityName="L",u.ST=s.stateOrProvinceName,u.stateOrProvinceName="ST",u.O=s.organizationName,u.organizationName="O",u.OU=s.organizationalUnitName,u.organizationalUnitName="OU",u.E=s.emailAddress,u.emailAddress="E";var d=t.pki.rsa.publicKeyValidator,c={name:"Certificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},d,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},a={name:"rsapss",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},h={name:"CertificationRequestInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},d,{name:"CertificationRequestInfo.attributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0}]}]}]},p={name:"CertificationRequest",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[h,{name:"CertificationRequest.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};n.RDNAttributesAsArray=function(g,f){for(var o=[],w,U,K,D=0;D<g.value.length;++D){w=g.value[D];for(var H=0;H<w.value.length;++H)K={},U=w.value[H],K.type=e.derToOid(U.value[0].value),K.value=U.value[1].value,K.valueTagClass=U.value[1].type,K.type in s&&(K.name=s[K.type],K.name in u&&(K.shortName=u[K.name])),f&&(f.update(K.type),f.update(K.value)),o.push(K)}return o},n.CRIAttributesAsArray=function(g){for(var f=[],o=0;o<g.length;++o)for(var w=g[o],U=e.derToOid(w.value[0].value),K=w.value[1].value,D=0;D<K.length;++D){var H={};if(H.type=U,H.value=K[D].value,H.valueTagClass=K[D].type,H.type in s&&(H.name=s[H.type],H.name in u&&(H.shortName=u[H.name])),H.type===s.extensionRequest){H.extensions=[];for(var q=0;q<H.value.length;++q)H.extensions.push(n.certificateExtensionFromAsn1(H.value[q]))}f.push(H)}return f};function T(g,f){typeof f=="string"&&(f={shortName:f});for(var o=null,w,U=0;o===null&&U<g.attributes.length;++U)w=g.attributes[U],(f.type&&f.type===w.type||f.name&&f.name===w.name||f.shortName&&f.shortName===w.shortName)&&(o=w);return o}var I=function(g,f,o){var w={};if(g!==s["RSASSA-PSS"])return w;o&&(w={hash:{algorithmOid:s.sha1},mgf:{algorithmOid:s.mgf1,hash:{algorithmOid:s.sha1}},saltLength:20});var U={},K=[];if(!e.validate(f,a,U,K)){var D=new Error("Cannot read RSASSA-PSS parameter block.");throw D.errors=K,D}return U.hashOid!==void 0&&(w.hash=w.hash||{},w.hash.algorithmOid=e.derToOid(U.hashOid)),U.maskGenOid!==void 0&&(w.mgf=w.mgf||{},w.mgf.algorithmOid=e.derToOid(U.maskGenOid),w.mgf.hash=w.mgf.hash||{},w.mgf.hash.algorithmOid=e.derToOid(U.maskGenHashOid)),U.saltLength!==void 0&&(w.saltLength=U.saltLength.charCodeAt(0)),w},A=function(g){switch(s[g.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return t.md.sha1.create();case"md5WithRSAEncryption":return t.md.md5.create();case"sha256WithRSAEncryption":return t.md.sha256.create();case"sha384WithRSAEncryption":return t.md.sha384.create();case"sha512WithRSAEncryption":return t.md.sha512.create();case"RSASSA-PSS":return t.md.sha256.create();default:var f=new Error("Could not compute "+g.type+" digest. Unknown signature OID.");throw f.signatureOid=g.signatureOid,f}},m=function(g){var f=g.certificate,o;switch(f.signatureOid){case s.sha1WithRSAEncryption:case s.sha1WithRSASignature:break;case s["RSASSA-PSS"]:var w,U;if(w=s[f.signatureParameters.mgf.hash.algorithmOid],w===void 0||t.md[w]===void 0){var K=new Error("Unsupported MGF hash function.");throw K.oid=f.signatureParameters.mgf.hash.algorithmOid,K.name=w,K}if(U=s[f.signatureParameters.mgf.algorithmOid],U===void 0||t.mgf[U]===void 0){var K=new Error("Unsupported MGF function.");throw K.oid=f.signatureParameters.mgf.algorithmOid,K.name=U,K}if(U=t.mgf[U].create(t.md[w].create()),w=s[f.signatureParameters.hash.algorithmOid],w===void 0||t.md[w]===void 0){var K=new Error("Unsupported RSASSA-PSS hash function.");throw K.oid=f.signatureParameters.hash.algorithmOid,K.name=w,K}o=t.pss.create(t.md[w].create(),U,f.signatureParameters.saltLength);break}return f.publicKey.verify(g.md.digest().getBytes(),g.signature,o)};n.certificateFromPem=function(g,f,o){var w=t.pem.decode(g)[0];if(w.type!=="CERTIFICATE"&&w.type!=="X509 CERTIFICATE"&&w.type!=="TRUSTED CERTIFICATE"){var U=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw U.headerType=w.type,U}if(w.procType&&w.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var K=e.fromDer(w.body,o);return n.certificateFromAsn1(K,f)},n.certificateToPem=function(g,f){var o={type:"CERTIFICATE",body:e.toDer(n.certificateToAsn1(g)).getBytes()};return t.pem.encode(o,{maxline:f})},n.publicKeyFromPem=function(g){var f=t.pem.decode(g)[0];if(f.type!=="PUBLIC KEY"&&f.type!=="RSA PUBLIC KEY"){var o=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw o.headerType=f.type,o}if(f.procType&&f.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var w=e.fromDer(f.body);return n.publicKeyFromAsn1(w)},n.publicKeyToPem=function(g,f){var o={type:"PUBLIC KEY",body:e.toDer(n.publicKeyToAsn1(g)).getBytes()};return t.pem.encode(o,{maxline:f})},n.publicKeyToRSAPublicKeyPem=function(g,f){var o={type:"RSA PUBLIC KEY",body:e.toDer(n.publicKeyToRSAPublicKey(g)).getBytes()};return t.pem.encode(o,{maxline:f})},n.getPublicKeyFingerprint=function(g,f){f=f||{};var o=f.md||t.md.sha1.create(),w=f.type||"RSAPublicKey",U;switch(w){case"RSAPublicKey":U=e.toDer(n.publicKeyToRSAPublicKey(g)).getBytes();break;case"SubjectPublicKeyInfo":U=e.toDer(n.publicKeyToAsn1(g)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+f.type+'".')}o.start(),o.update(U);var K=o.digest();if(f.encoding==="hex"){var D=K.toHex();return f.delimiter?D.match(/.{2}/g).join(f.delimiter):D}else{if(f.encoding==="binary")return K.getBytes();if(f.encoding)throw new Error('Unknown encoding "'+f.encoding+'".')}return K},n.certificationRequestFromPem=function(g,f,o){var w=t.pem.decode(g)[0];if(w.type!=="CERTIFICATE REQUEST"){var U=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw U.headerType=w.type,U}if(w.procType&&w.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var K=e.fromDer(w.body,o);return n.certificationRequestFromAsn1(K,f)},n.certificationRequestToPem=function(g,f){var o={type:"CERTIFICATE REQUEST",body:e.toDer(n.certificationRequestToAsn1(g)).getBytes()};return t.pem.encode(o,{maxline:f})},n.createCertificate=function(){var g={};return g.version=2,g.serialNumber="00",g.signatureOid=null,g.signature=null,g.siginfo={},g.siginfo.algorithmOid=null,g.validity={},g.validity.notBefore=new Date,g.validity.notAfter=new Date,g.issuer={},g.issuer.getField=function(f){return T(g.issuer,f)},g.issuer.addField=function(f){C([f]),g.issuer.attributes.push(f)},g.issuer.attributes=[],g.issuer.hash=null,g.subject={},g.subject.getField=function(f){return T(g.subject,f)},g.subject.addField=function(f){C([f]),g.subject.attributes.push(f)},g.subject.attributes=[],g.subject.hash=null,g.extensions=[],g.publicKey=null,g.md=null,g.setSubject=function(f,o){C(f),g.subject.attributes=f,delete g.subject.uniqueId,o&&(g.subject.uniqueId=o),g.subject.hash=null},g.setIssuer=function(f,o){C(f),g.issuer.attributes=f,delete g.issuer.uniqueId,o&&(g.issuer.uniqueId=o),g.issuer.hash=null},g.setExtensions=function(f){for(var o=0;o<f.length;++o)E(f[o],{cert:g});g.extensions=f},g.getExtension=function(f){typeof f=="string"&&(f={name:f});for(var o=null,w,U=0;o===null&&U<g.extensions.length;++U)w=g.extensions[U],(f.id&&w.id===f.id||f.name&&w.name===f.name)&&(o=w);return o},g.sign=function(f,o){g.md=o||t.md.sha1.create();var w=s[g.md.algorithm+"WithRSAEncryption"];if(!w){var U=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw U.algorithm=g.md.algorithm,U}g.signatureOid=g.siginfo.algorithmOid=w,g.tbsCertificate=n.getTBSCertificate(g);var K=e.toDer(g.tbsCertificate);g.md.update(K.getBytes()),g.signature=f.sign(g.md)},g.verify=function(f){var o=!1;if(!g.issued(f)){var w=f.issuer,U=g.subject,K=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw K.expectedIssuer=U.attributes,K.actualIssuer=w.attributes,K}var D=f.md;if(D===null){D=A({signatureOid:f.signatureOid,type:"certificate"});var H=f.tbsCertificate||n.getTBSCertificate(f),q=e.toDer(H);D.update(q.getBytes())}return D!==null&&(o=m({certificate:g,md:D,signature:f.signature})),o},g.isIssuer=function(f){var o=!1,w=g.issuer,U=f.subject;if(w.hash&&U.hash)o=w.hash===U.hash;else if(w.attributes.length===U.attributes.length){o=!0;for(var K,D,H=0;o&&H<w.attributes.length;++H)K=w.attributes[H],D=U.attributes[H],(K.type!==D.type||K.value!==D.value)&&(o=!1)}return o},g.issued=function(f){return f.isIssuer(g)},g.generateSubjectKeyIdentifier=function(){return n.getPublicKeyFingerprint(g.publicKey,{type:"RSAPublicKey"})},g.verifySubjectKeyIdentifier=function(){for(var f=s.subjectKeyIdentifier,o=0;o<g.extensions.length;++o){var w=g.extensions[o];if(w.id===f){var U=g.generateSubjectKeyIdentifier().getBytes();return t.util.hexToBytes(w.subjectKeyIdentifier)===U}}return!1},g},n.certificateFromAsn1=function(g,f){var o={},w=[];if(!e.validate(g,c,o,w)){var U=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw U.errors=w,U}var K=e.derToOid(o.publicKeyOid);if(K!==n.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var D=n.createCertificate();D.version=o.certVersion?o.certVersion.charCodeAt(0):0;var H=t.util.createBuffer(o.certSerialNumber);D.serialNumber=H.toHex(),D.signatureOid=t.asn1.derToOid(o.certSignatureOid),D.signatureParameters=I(D.signatureOid,o.certSignatureParams,!0),D.siginfo.algorithmOid=t.asn1.derToOid(o.certinfoSignatureOid),D.siginfo.parameters=I(D.siginfo.algorithmOid,o.certinfoSignatureParams,!1),D.signature=o.certSignature;var q=[];if(o.certValidity1UTCTime!==void 0&&q.push(e.utcTimeToDate(o.certValidity1UTCTime)),o.certValidity2GeneralizedTime!==void 0&&q.push(e.generalizedTimeToDate(o.certValidity2GeneralizedTime)),o.certValidity3UTCTime!==void 0&&q.push(e.utcTimeToDate(o.certValidity3UTCTime)),o.certValidity4GeneralizedTime!==void 0&&q.push(e.generalizedTimeToDate(o.certValidity4GeneralizedTime)),q.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(q.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(D.validity.notBefore=q[0],D.validity.notAfter=q[1],D.tbsCertificate=o.tbsCertificate,f){D.md=A({signatureOid:D.signatureOid,type:"certificate"});var G=e.toDer(D.tbsCertificate);D.md.update(G.getBytes())}var z=t.md.sha1.create(),Y=e.toDer(o.certIssuer);z.update(Y.getBytes()),D.issuer.getField=function(se){return T(D.issuer,se)},D.issuer.addField=function(se){C([se]),D.issuer.attributes.push(se)},D.issuer.attributes=n.RDNAttributesAsArray(o.certIssuer),o.certIssuerUniqueId&&(D.issuer.uniqueId=o.certIssuerUniqueId),D.issuer.hash=z.digest().toHex();var Z=t.md.sha1.create(),te=e.toDer(o.certSubject);return Z.update(te.getBytes()),D.subject.getField=function(se){return T(D.subject,se)},D.subject.addField=function(se){C([se]),D.subject.attributes.push(se)},D.subject.attributes=n.RDNAttributesAsArray(o.certSubject),o.certSubjectUniqueId&&(D.subject.uniqueId=o.certSubjectUniqueId),D.subject.hash=Z.digest().toHex(),o.certExtensions?D.extensions=n.certificateExtensionsFromAsn1(o.certExtensions):D.extensions=[],D.publicKey=n.publicKeyFromAsn1(o.subjectPublicKeyInfo),D},n.certificateExtensionsFromAsn1=function(g){for(var f=[],o=0;o<g.value.length;++o)for(var w=g.value[o],U=0;U<w.value.length;++U)f.push(n.certificateExtensionFromAsn1(w.value[U]));return f},n.certificateExtensionFromAsn1=function(g){var f={};if(f.id=e.derToOid(g.value[0].value),f.critical=!1,g.value[1].type===e.Type.BOOLEAN?(f.critical=g.value[1].value.charCodeAt(0)!==0,f.value=g.value[2].value):f.value=g.value[1].value,f.id in s){if(f.name=s[f.id],f.name==="keyUsage"){var o=e.fromDer(f.value),w=0,U=0;o.value.length>1&&(w=o.value.charCodeAt(1),U=o.value.length>2?o.value.charCodeAt(2):0),f.digitalSignature=(w&128)===128,f.nonRepudiation=(w&64)===64,f.keyEncipherment=(w&32)===32,f.dataEncipherment=(w&16)===16,f.keyAgreement=(w&8)===8,f.keyCertSign=(w&4)===4,f.cRLSign=(w&2)===2,f.encipherOnly=(w&1)===1,f.decipherOnly=(U&128)===128}else if(f.name==="basicConstraints"){var o=e.fromDer(f.value);o.value.length>0&&o.value[0].type===e.Type.BOOLEAN?f.cA=o.value[0].value.charCodeAt(0)!==0:f.cA=!1;var K=null;o.value.length>0&&o.value[0].type===e.Type.INTEGER?K=o.value[0].value:o.value.length>1&&(K=o.value[1].value),K!==null&&(f.pathLenConstraint=e.derToInteger(K))}else if(f.name==="extKeyUsage")for(var o=e.fromDer(f.value),D=0;D<o.value.length;++D){var H=e.derToOid(o.value[D].value);H in s?f[s[H]]=!0:f[H]=!0}else if(f.name==="nsCertType"){var o=e.fromDer(f.value),w=0;o.value.length>1&&(w=o.value.charCodeAt(1)),f.client=(w&128)===128,f.server=(w&64)===64,f.email=(w&32)===32,f.objsign=(w&16)===16,f.reserved=(w&8)===8,f.sslCA=(w&4)===4,f.emailCA=(w&2)===2,f.objCA=(w&1)===1}else if(f.name==="subjectAltName"||f.name==="issuerAltName"){f.altNames=[];for(var q,o=e.fromDer(f.value),G=0;G<o.value.length;++G){q=o.value[G];var z={type:q.type,value:q.value};switch(f.altNames.push(z),q.type){case 1:case 2:case 6:break;case 7:z.ip=t.util.bytesToIP(q.value);break;case 8:z.oid=e.derToOid(q.value);break;default:}}}else if(f.name==="subjectKeyIdentifier"){var o=e.fromDer(f.value);f.subjectKeyIdentifier=t.util.bytesToHex(o.value)}}return f},n.certificationRequestFromAsn1=function(g,f){var o={},w=[];if(!e.validate(g,p,o,w)){var U=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw U.errors=w,U}var K=e.derToOid(o.publicKeyOid);if(K!==n.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var D=n.createCertificationRequest();if(D.version=o.csrVersion?o.csrVersion.charCodeAt(0):0,D.signatureOid=t.asn1.derToOid(o.csrSignatureOid),D.signatureParameters=I(D.signatureOid,o.csrSignatureParams,!0),D.siginfo.algorithmOid=t.asn1.derToOid(o.csrSignatureOid),D.siginfo.parameters=I(D.siginfo.algorithmOid,o.csrSignatureParams,!1),D.signature=o.csrSignature,D.certificationRequestInfo=o.certificationRequestInfo,f){D.md=A({signatureOid:D.signatureOid,type:"certification request"});var H=e.toDer(D.certificationRequestInfo);D.md.update(H.getBytes())}var q=t.md.sha1.create();return D.subject.getField=function(G){return T(D.subject,G)},D.subject.addField=function(G){C([G]),D.subject.attributes.push(G)},D.subject.attributes=n.RDNAttributesAsArray(o.certificationRequestInfoSubject,q),D.subject.hash=q.digest().toHex(),D.publicKey=n.publicKeyFromAsn1(o.subjectPublicKeyInfo),D.getAttribute=function(G){return T(D,G)},D.addAttribute=function(G){C([G]),D.attributes.push(G)},D.attributes=n.CRIAttributesAsArray(o.certificationRequestInfoAttributes||[]),D},n.createCertificationRequest=function(){var g={};return g.version=0,g.signatureOid=null,g.signature=null,g.siginfo={},g.siginfo.algorithmOid=null,g.subject={},g.subject.getField=function(f){return T(g.subject,f)},g.subject.addField=function(f){C([f]),g.subject.attributes.push(f)},g.subject.attributes=[],g.subject.hash=null,g.publicKey=null,g.attributes=[],g.getAttribute=function(f){return T(g,f)},g.addAttribute=function(f){C([f]),g.attributes.push(f)},g.md=null,g.setSubject=function(f){C(f),g.subject.attributes=f,g.subject.hash=null},g.setAttributes=function(f){C(f),g.attributes=f},g.sign=function(f,o){g.md=o||t.md.sha1.create();var w=s[g.md.algorithm+"WithRSAEncryption"];if(!w){var U=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw U.algorithm=g.md.algorithm,U}g.signatureOid=g.siginfo.algorithmOid=w,g.certificationRequestInfo=n.getCertificationRequestInfo(g);var K=e.toDer(g.certificationRequestInfo);g.md.update(K.getBytes()),g.signature=f.sign(g.md)},g.verify=function(){var f=!1,o=g.md;if(o===null){o=A({signatureOid:g.signatureOid,type:"certification request"});var w=g.certificationRequestInfo||n.getCertificationRequestInfo(g),U=e.toDer(w);o.update(U.getBytes())}return o!==null&&(f=m({certificate:g,md:o,signature:g.signature})),f},g};function S(g){for(var f=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),o,w,U=g.attributes,K=0;K<U.length;++K){o=U[K];var D=o.value,H=e.Type.PRINTABLESTRING;"valueTagClass"in o&&(H=o.valueTagClass,H===e.Type.UTF8&&(D=t.util.encodeUtf8(D))),w=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.type).getBytes()),e.create(e.Class.UNIVERSAL,H,!1,D)])]),f.value.push(w)}return f}function C(g){for(var f,o=0;o<g.length;++o){if(f=g[o],typeof f.name>"u"&&(f.type&&f.type in n.oids?f.name=n.oids[f.type]:f.shortName&&f.shortName in u&&(f.name=n.oids[u[f.shortName]])),typeof f.type>"u")if(f.name&&f.name in n.oids)f.type=n.oids[f.name];else{var w=new Error("Attribute type not specified.");throw w.attribute=f,w}if(typeof f.shortName>"u"&&f.name&&f.name in u&&(f.shortName=u[f.name]),f.type===s.extensionRequest&&(f.valueConstructed=!0,f.valueTagClass=e.Type.SEQUENCE,!f.value&&f.extensions)){f.value=[];for(var U=0;U<f.extensions.length;++U)f.value.push(n.certificateExtensionToAsn1(E(f.extensions[U])))}if(typeof f.value>"u"){var w=new Error("Attribute value not specified.");throw w.attribute=f,w}}}function E(g,f){if(f=f||{},typeof g.name>"u"&&g.id&&g.id in n.oids&&(g.name=n.oids[g.id]),typeof g.id>"u")if(g.name&&g.name in n.oids)g.id=n.oids[g.name];else{var o=new Error("Extension ID not specified.");throw o.extension=g,o}if(typeof g.value<"u")return g;if(g.name==="keyUsage"){var w=0,U=0,K=0;g.digitalSignature&&(U|=128,w=7),g.nonRepudiation&&(U|=64,w=6),g.keyEncipherment&&(U|=32,w=5),g.dataEncipherment&&(U|=16,w=4),g.keyAgreement&&(U|=8,w=3),g.keyCertSign&&(U|=4,w=2),g.cRLSign&&(U|=2,w=1),g.encipherOnly&&(U|=1,w=0),g.decipherOnly&&(K|=128,w=7);var D=String.fromCharCode(w);K!==0?D+=String.fromCharCode(U)+String.fromCharCode(K):U!==0&&(D+=String.fromCharCode(U)),g.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,D)}else if(g.name==="basicConstraints")g.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),g.cA&&g.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"\xFF")),"pathLenConstraint"in g&&g.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(g.pathLenConstraint).getBytes()));else if(g.name==="extKeyUsage"){g.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var H=g.value.value;for(var q in g)g[q]===!0&&(q in s?H.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(s[q]).getBytes())):q.indexOf(".")!==-1&&H.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(q).getBytes())))}else if(g.name==="nsCertType"){var w=0,U=0;g.client&&(U|=128,w=7),g.server&&(U|=64,w=6),g.email&&(U|=32,w=5),g.objsign&&(U|=16,w=4),g.reserved&&(U|=8,w=3),g.sslCA&&(U|=4,w=2),g.emailCA&&(U|=2,w=1),g.objCA&&(U|=1,w=0);var D=String.fromCharCode(w);U!==0&&(D+=String.fromCharCode(U)),g.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,D)}else if(g.name==="subjectAltName"||g.name==="issuerAltName"){g.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var G,z=0;z<g.altNames.length;++z){G=g.altNames[z];var D=G.value;if(G.type===7&&G.ip){if(D=t.util.bytesFromIP(G.ip),D===null){var o=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw o.extension=g,o}}else G.type===8&&(G.oid?D=e.oidToDer(e.oidToDer(G.oid)):D=e.oidToDer(D));g.value.value.push(e.create(e.Class.CONTEXT_SPECIFIC,G.type,!1,D))}}else if(g.name==="nsComment"&&f.cert){if(!/^[\x00-\x7F]*$/.test(g.comment)||g.comment.length<1||g.comment.length>128)throw new Error('Invalid "nsComment" content.');g.value=e.create(e.Class.UNIVERSAL,e.Type.IA5STRING,!1,g.comment)}else if(g.name==="subjectKeyIdentifier"&&f.cert){var Y=f.cert.generateSubjectKeyIdentifier();g.subjectKeyIdentifier=Y.toHex(),g.value=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,Y.getBytes())}else if(g.name==="authorityKeyIdentifier"&&f.cert){g.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var H=g.value.value;if(g.keyIdentifier){var Z=g.keyIdentifier===!0?f.cert.generateSubjectKeyIdentifier().getBytes():g.keyIdentifier;H.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!1,Z))}if(g.authorityCertIssuer){var te=[e.create(e.Class.CONTEXT_SPECIFIC,4,!0,[S(g.authorityCertIssuer===!0?f.cert.issuer:g.authorityCertIssuer)])];H.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,te))}if(g.serialNumber){var se=t.util.hexToBytes(g.serialNumber===!0?f.cert.serialNumber:g.serialNumber);H.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!1,se))}}else if(g.name==="cRLDistributionPoints"){g.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var H=g.value.value,de=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),be=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]),G,z=0;z<g.altNames.length;++z){G=g.altNames[z];var D=G.value;if(G.type===7&&G.ip){if(D=t.util.bytesFromIP(G.ip),D===null){var o=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw o.extension=g,o}}else G.type===8&&(G.oid?D=e.oidToDer(e.oidToDer(G.oid)):D=e.oidToDer(D));be.value.push(e.create(e.Class.CONTEXT_SPECIFIC,G.type,!1,D))}de.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[be])),H.push(de)}if(typeof g.value>"u"){var o=new Error("Extension value not specified.");throw o.extension=g,o}return g}function l(g,f){switch(g){case s["RSASSA-PSS"]:var o=[];return f.hash.algorithmOid!==void 0&&o.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(f.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])),f.mgf.algorithmOid!==void 0&&o.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(f.mgf.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(f.mgf.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])])),f.saltLength!==void 0&&o.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(f.saltLength).getBytes())])),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,o);default:return e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")}}function v(g){var f=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);if(g.attributes.length===0)return f;for(var o=g.attributes,w=0;w<o.length;++w){var U=o[w],K=U.value,D=e.Type.UTF8;"valueTagClass"in U&&(D=U.valueTagClass),D===e.Type.UTF8&&(K=t.util.encodeUtf8(K));var H=!1;"valueConstructed"in U&&(H=U.valueConstructed);var q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(U.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,D,H,K)])]);f.value.push(q)}return f}var _=new Date("1950-01-01T00:00:00Z"),B=new Date("2050-01-01T00:00:00Z");function L(g){return g>=_&&g<B?e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(g)):e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(g))}n.getTBSCertificate=function(g){var f=L(g.validity.notBefore),o=L(g.validity.notAfter),w=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(g.version).getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(g.serialNumber)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g.siginfo.algorithmOid).getBytes()),l(g.siginfo.algorithmOid,g.siginfo.parameters)]),S(g.issuer),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[f,o]),S(g.subject),n.publicKeyToAsn1(g.publicKey)]);return g.issuer.uniqueId&&w.value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+g.issuer.uniqueId)])),g.subject.uniqueId&&w.value.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+g.subject.uniqueId)])),g.extensions.length>0&&w.value.push(n.certificateExtensionsToAsn1(g.extensions)),w},n.getCertificationRequestInfo=function(g){var f=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(g.version).getBytes()),S(g.subject),n.publicKeyToAsn1(g.publicKey),v(g)]);return f},n.distinguishedNameToAsn1=function(g){return S(g)},n.certificateToAsn1=function(g){var f=g.tbsCertificate||n.getTBSCertificate(g);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[f,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g.signatureOid).getBytes()),l(g.signatureOid,g.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+g.signature)])},n.certificateExtensionsToAsn1=function(g){var f=e.create(e.Class.CONTEXT_SPECIFIC,3,!0,[]),o=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);f.value.push(o);for(var w=0;w<g.length;++w)o.value.push(n.certificateExtensionToAsn1(g[w]));return f},n.certificateExtensionToAsn1=function(g){var f=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);f.value.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g.id).getBytes())),g.critical&&f.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"\xFF"));var o=g.value;return typeof g.value!="string"&&(o=e.toDer(o).getBytes()),f.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,o)),f},n.certificationRequestToAsn1=function(g){var f=g.certificationRequestInfo||n.getCertificationRequestInfo(g);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[f,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g.signatureOid).getBytes()),l(g.signatureOid,g.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+g.signature)])},n.createCaStore=function(g){var f={certs:{}};f.getIssuer=function(D){var H=o(D.issuer);return H},f.addCertificate=function(D){if(typeof D=="string"&&(D=t.pki.certificateFromPem(D)),w(D.subject),!f.hasCertificate(D))if(D.subject.hash in f.certs){var H=f.certs[D.subject.hash];t.util.isArray(H)||(H=[H]),H.push(D),f.certs[D.subject.hash]=H}else f.certs[D.subject.hash]=D},f.hasCertificate=function(D){typeof D=="string"&&(D=t.pki.certificateFromPem(D));var H=o(D.subject);if(!H)return!1;t.util.isArray(H)||(H=[H]);for(var q=e.toDer(n.certificateToAsn1(D)).getBytes(),G=0;G<H.length;++G){var z=e.toDer(n.certificateToAsn1(H[G])).getBytes();if(q===z)return!0}return!1},f.listAllCertificates=function(){var D=[];for(var H in f.certs)if(f.certs.hasOwnProperty(H)){var q=f.certs[H];if(!t.util.isArray(q))D.push(q);else for(var G=0;G<q.length;++G)D.push(q[G])}return D},f.removeCertificate=function(D){var H;if(typeof D=="string"&&(D=t.pki.certificateFromPem(D)),w(D.subject),!f.hasCertificate(D))return null;var q=o(D.subject);if(!t.util.isArray(q))return H=f.certs[D.subject.hash],delete f.certs[D.subject.hash],H;for(var G=e.toDer(n.certificateToAsn1(D)).getBytes(),z=0;z<q.length;++z){var Y=e.toDer(n.certificateToAsn1(q[z])).getBytes();G===Y&&(H=q[z],q.splice(z,1))}return q.length===0&&delete f.certs[D.subject.hash],H};function o(D){return w(D),f.certs[D.hash]||null}function w(D){if(!D.hash){var H=t.md.sha1.create();D.attributes=n.RDNAttributesAsArray(S(D),H),D.hash=H.digest().toHex()}}if(g)for(var U=0;U<g.length;++U){var K=g[U];f.addCertificate(K)}return f},n.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},n.verifyCertificateChain=function(g,f,o){typeof o=="function"&&(o={verify:o}),o=o||{},f=f.slice(0);var w=f.slice(0),U=o.validityCheckDate;typeof U>"u"&&(U=new Date);var K=!0,D=null,H=0;do{var q=f.shift(),G=null,z=!1;if(U&&(U<q.validity.notBefore||U>q.validity.notAfter)&&(D={message:"Certificate is not valid yet or has expired.",error:n.certificateError.certificate_expired,notBefore:q.validity.notBefore,notAfter:q.validity.notAfter,now:U}),D===null){if(G=f[0]||g.getIssuer(q),G===null&&q.isIssuer(q)&&(z=!0,G=q),G){var Y=G;t.util.isArray(Y)||(Y=[Y]);for(var Z=!1;!Z&&Y.length>0;){G=Y.shift();try{Z=G.verify(q)}catch{}}Z||(D={message:"Certificate signature is invalid.",error:n.certificateError.bad_certificate})}D===null&&(!G||z)&&!g.hasCertificate(q)&&(D={message:"Certificate is not trusted.",error:n.certificateError.unknown_ca})}if(D===null&&G&&!q.isIssuer(G)&&(D={message:"Certificate issuer is invalid.",error:n.certificateError.bad_certificate}),D===null)for(var te={keyUsage:!0,basicConstraints:!0},se=0;D===null&&se<q.extensions.length;++se){var de=q.extensions[se];de.critical&&!(de.name in te)&&(D={message:"Certificate has an unsupported critical extension.",error:n.certificateError.unsupported_certificate})}if(D===null&&(!K||f.length===0&&(!G||z))){var be=q.getExtension("basicConstraints"),we=q.getExtension("keyUsage");if(we!==null&&(!we.keyCertSign||be===null)&&(D={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:n.certificateError.bad_certificate}),D===null&&be!==null&&!be.cA&&(D={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:n.certificateError.bad_certificate}),D===null&&we!==null&&"pathLenConstraint"in be){var J=H-1;J>be.pathLenConstraint&&(D={message:"Certificate basicConstraints pathLenConstraint violated.",error:n.certificateError.bad_certificate})}}var Ee=D===null?!0:D.error,ee=o.verify?o.verify(Ee,H,w):Ee;if(ee===!0)D=null;else throw Ee===!0&&(D={message:"The application rejected the certificate.",error:n.certificateError.bad_certificate}),(ee||ee===0)&&(typeof ee=="object"&&!t.util.isArray(ee)?(ee.message&&(D.message=ee.message),ee.error&&(D.error=ee.error)):typeof ee=="string"&&(D.error=ee)),D;K=!1,++H}while(f.length>0);return!0}}),Lc=he((i,r)=>{var t=me();Pt(),Hr(),or(),kc(),xc(),It(),xn(),Fr(),Ce(),Na();var e=t.asn1,n=t.pki,s=r.exports=t.pkcs12=t.pkcs12||{},u={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},d={name:"PFX",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},u,{name:"PFX.macData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},c={name:"SafeBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},a={name:"Attribute",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,capture:"values"}]},h={name:"CertBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:e.Class.UNIVERSAL,type:e.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function p(C,E,l,v){for(var _=[],B=0;B<C.length;B++)for(var L=0;L<C[B].safeBags.length;L++){var g=C[B].safeBags[L];if(!(v!==void 0&&g.type!==v)){if(E===null){_.push(g);continue}g.attributes[E]!==void 0&&g.attributes[E].indexOf(l)>=0&&_.push(g)}}return _}s.pkcs12FromAsn1=function(C,E,l){typeof E=="string"?(l=E,E=!0):E===void 0&&(E=!0);var v={},_=[];if(!e.validate(C,d,v,_)){var B=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw B.errors=B,B}var L={version:v.version.charCodeAt(0),safeContents:[],getBags:function(G){var z={},Y;return"localKeyId"in G?Y=G.localKeyId:"localKeyIdHex"in G&&(Y=t.util.hexToBytes(G.localKeyIdHex)),Y===void 0&&!("friendlyName"in G)&&"bagType"in G&&(z[G.bagType]=p(L.safeContents,null,null,G.bagType)),Y!==void 0&&(z.localKeyId=p(L.safeContents,"localKeyId",Y,G.bagType)),"friendlyName"in G&&(z.friendlyName=p(L.safeContents,"friendlyName",G.friendlyName,G.bagType)),z},getBagsByFriendlyName:function(G,z){return p(L.safeContents,"friendlyName",G,z)},getBagsByLocalKeyId:function(G,z){return p(L.safeContents,"localKeyId",G,z)}};if(v.version.charCodeAt(0)!==3){var B=new Error("PKCS#12 PFX of version other than 3 not supported.");throw B.version=v.version.charCodeAt(0),B}if(e.derToOid(v.contentType)!==n.oids.data){var B=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw B.oid=e.derToOid(v.contentType),B}var g=v.content.value[0];if(g.tagClass!==e.Class.UNIVERSAL||g.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(g=T(g),v.mac){var f=null,o=0,w=e.derToOid(v.macAlgorithm);switch(w){case n.oids.sha1:f=t.md.sha1.create(),o=20;break;case n.oids.sha256:f=t.md.sha256.create(),o=32;break;case n.oids.sha384:f=t.md.sha384.create(),o=48;break;case n.oids.sha512:f=t.md.sha512.create(),o=64;break;case n.oids.md5:f=t.md.md5.create(),o=16;break}if(f===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+w);var U=new t.util.ByteBuffer(v.macSalt),K="macIterations"in v?parseInt(t.util.bytesToHex(v.macIterations),16):1,D=s.generateKey(l,U,3,K,o,f),H=t.hmac.create();H.start(f,D),H.update(g.value);var q=H.getMac();if(q.getBytes()!==v.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return I(L,g.value,E,l),L};function T(C){if(C.composed||C.constructed){for(var E=t.util.createBuffer(),l=0;l<C.value.length;++l)E.putBytes(C.value[l].value);C.composed=C.constructed=!1,C.value=E.getBytes()}return C}function I(C,E,l,v){if(E=e.fromDer(E,l),E.tagClass!==e.Class.UNIVERSAL||E.type!==e.Type.SEQUENCE||E.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var _=0;_<E.value.length;_++){var B=E.value[_],L={},g=[];if(!e.validate(B,u,L,g)){var f=new Error("Cannot read ContentInfo.");throw f.errors=g,f}var o={encrypted:!1},w=null,U=L.content.value[0];switch(e.derToOid(L.contentType)){case n.oids.data:if(U.tagClass!==e.Class.UNIVERSAL||U.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");w=T(U).value;break;case n.oids.encryptedData:w=A(U,v),o.encrypted=!0;break;default:var f=new Error("Unsupported PKCS#12 contentType.");throw f.contentType=e.derToOid(L.contentType),f}o.safeBags=m(w,l,v),C.safeContents.push(o)}}function A(C,E){var l={},v=[];if(!e.validate(C,t.pkcs7.asn1.encryptedDataValidator,l,v)){var _=new Error("Cannot read EncryptedContentInfo.");throw _.errors=v,_}var B=e.derToOid(l.contentType);if(B!==n.oids.data){var _=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw _.oid=B,_}B=e.derToOid(l.encAlgorithm);var L=n.pbe.getCipher(B,l.encParameter,E),g=T(l.encryptedContentAsn1),f=t.util.createBuffer(g.value);if(L.update(f),!L.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return L.output.getBytes()}function m(C,E,l){if(!E&&C.length===0)return[];if(C=e.fromDer(C,E),C.tagClass!==e.Class.UNIVERSAL||C.type!==e.Type.SEQUENCE||C.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var v=[],_=0;_<C.value.length;_++){var B=C.value[_],L={},g=[];if(!e.validate(B,c,L,g)){var f=new Error("Cannot read SafeBag.");throw f.errors=g,f}var o={type:e.derToOid(L.bagId),attributes:S(L.bagAttributes)};v.push(o);var w,U,K=L.bagValue.value[0];switch(o.type){case n.oids.pkcs8ShroudedKeyBag:if(K=n.decryptPrivateKeyInfo(K,l),K===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case n.oids.keyBag:try{o.key=n.privateKeyFromAsn1(K)}catch{o.key=null,o.asn1=K}continue;case n.oids.certBag:w=h,U=function(){if(e.derToOid(L.certId)!==n.oids.x509Certificate){var H=new Error("Unsupported certificate type, only X.509 supported.");throw H.oid=e.derToOid(L.certId),H}var q=e.fromDer(L.cert,E);try{o.cert=n.certificateFromAsn1(q,!0)}catch{o.cert=null,o.asn1=q}};break;default:var f=new Error("Unsupported PKCS#12 SafeBag type.");throw f.oid=o.type,f}if(w!==void 0&&!e.validate(K,w,L,g)){var f=new Error("Cannot read PKCS#12 "+w.name);throw f.errors=g,f}U()}return v}function S(C){var E={};if(C!==void 0)for(var l=0;l<C.length;++l){var v={},_=[];if(!e.validate(C[l],a,v,_)){var B=new Error("Cannot read PKCS#12 BagAttribute.");throw B.errors=_,B}var L=e.derToOid(v.oid);if(n.oids[L]!==void 0){E[n.oids[L]]=[];for(var g=0;g<v.values.length;++g)E[n.oids[L]].push(v.values[g].value)}}return E}s.toPkcs12Asn1=function(C,E,l,v){v=v||{},v.saltSize=v.saltSize||8,v.count=v.count||2048,v.algorithm=v.algorithm||v.encAlgorithm||"aes128","useMac"in v||(v.useMac=!0),"localKeyId"in v||(v.localKeyId=null),"generateLocalKeyId"in v||(v.generateLocalKeyId=!0);var _=v.localKeyId,B;if(_!==null)_=t.util.hexToBytes(_);else if(v.generateLocalKeyId)if(E){var L=t.util.isArray(E)?E[0]:E;typeof L=="string"&&(L=n.certificateFromPem(L));var g=t.md.sha1.create();g.update(e.toDer(n.certificateToAsn1(L)).getBytes()),_=g.digest().getBytes()}else _=t.random.getBytes(20);var f=[];_!==null&&f.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.localKeyId).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,_)])])),"friendlyName"in v&&f.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.friendlyName).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.BMPSTRING,!1,v.friendlyName)])])),f.length>0&&(B=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,f));var o=[],w=[];E!==null&&(t.util.isArray(E)?w=E:w=[E]);for(var U=[],K=0;K<w.length;++K){E=w[K],typeof E=="string"&&(E=n.certificateFromPem(E));var D=K===0?B:void 0,H=n.certificateToAsn1(E),q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.certBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.x509Certificate).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(H).getBytes())])])]),D]);U.push(q)}if(U.length>0){var G=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,U),z=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(G).getBytes())])]);o.push(z)}var Y=null;if(C!==null){var Z=n.wrapRsaPrivateKey(n.privateKeyToAsn1(C));l===null?Y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.keyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[Z]),B]):Y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.pkcs8ShroudedKeyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[n.encryptPrivateKeyInfo(Z,l,v)]),B]);var te=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[Y]),se=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(te).getBytes())])]);o.push(se)}var de=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,o),be;if(v.useMac){var g=t.md.sha1.create(),we=new t.util.ByteBuffer(t.random.getBytes(v.saltSize)),J=v.count,C=s.generateKey(l,we,3,J,20),Ee=t.hmac.create();Ee.start(g,C),Ee.update(e.toDer(de).getBytes());var ee=Ee.getMac();be=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.sha1).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,ee.getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,we.getBytes()),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(J).getBytes())])}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(3).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(de).getBytes())])]),be])},s.generateKey=t.pbe.generatePkcs12Key}),Pc=he((i,r)=>{var t=me();Pt(),or(),xc(),Er(),wa(),Lc(),Ba(),xn(),Ce(),Na();var e=t.asn1,n=r.exports=t.pki=t.pki||{};n.pemToDer=function(s){var u=t.pem.decode(s)[0];if(u.procType&&u.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return t.util.createBuffer(u.body)},n.privateKeyFromPem=function(s){var u=t.pem.decode(s)[0];if(u.type!=="PRIVATE KEY"&&u.type!=="RSA PRIVATE KEY"){var d=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw d.headerType=u.type,d}if(u.procType&&u.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var c=e.fromDer(u.body);return n.privateKeyFromAsn1(c)},n.privateKeyToPem=function(s,u){var d={type:"RSA PRIVATE KEY",body:e.toDer(n.privateKeyToAsn1(s)).getBytes()};return t.pem.encode(d,{maxline:u})},n.privateKeyInfoToPem=function(s,u){var d={type:"PRIVATE KEY",body:e.toDer(s).getBytes()};return t.pem.encode(d,{maxline:u})}}),Uc=he((i,r)=>{var t=me();Pt(),Hr(),Ia(),Er(),Pc(),It(),Fr(),Ce();var e=function(b,P,R,y){var x=t.util.createBuffer(),F=b.length>>1,M=F+(b.length&1),Q=b.substr(0,M),ie=b.substr(F,M),oe=t.util.createBuffer(),$=t.hmac.create();R=P+R;var ne=Math.ceil(y/16),pe=Math.ceil(y/20);$.start("MD5",Q);var ve=t.util.createBuffer();oe.putBytes(R);for(var ye=0;ye<ne;++ye)$.start(null,null),$.update(oe.getBytes()),oe.putBuffer($.digest()),$.start(null,null),$.update(oe.bytes()+R),ve.putBuffer($.digest());$.start("SHA1",ie);var Be=t.util.createBuffer();oe.clear(),oe.putBytes(R);for(var ye=0;ye<pe;++ye)$.start(null,null),$.update(oe.getBytes()),oe.putBuffer($.digest()),$.start(null,null),$.update(oe.bytes()+R),Be.putBuffer($.digest());return x.putBytes(t.util.xorBytes(ve.getBytes(),Be.getBytes(),y)),x},n=function(b,P,R){var y=t.hmac.create();y.start("SHA1",b);var x=t.util.createBuffer();return x.putInt32(P[0]),x.putInt32(P[1]),x.putByte(R.type),x.putByte(R.version.major),x.putByte(R.version.minor),x.putInt16(R.length),x.putBytes(R.fragment.bytes()),y.update(x.getBytes()),y.digest().getBytes()},s=function(b,P,R){var y=!1;try{var x=b.deflate(P.fragment.getBytes());P.fragment=t.util.createBuffer(x),P.length=x.length,y=!0}catch{}return y},u=function(b,P,R){var y=!1;try{var x=b.inflate(P.fragment.getBytes());P.fragment=t.util.createBuffer(x),P.length=x.length,y=!0}catch{}return y},d=function(b,P){var R=0;switch(P){case 1:R=b.getByte();break;case 2:R=b.getInt16();break;case 3:R=b.getInt24();break;case 4:R=b.getInt32();break}return t.util.createBuffer(b.getBytes(R))},c=function(b,P,R){b.putInt(R.length(),P<<3),b.putBuffer(R)},a={};a.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},a.SupportedVersions=[a.Versions.TLS_1_1,a.Versions.TLS_1_0],a.Version=a.SupportedVersions[0],a.MaxFragment=15360,a.ConnectionEnd={server:0,client:1},a.PRFAlgorithm={tls_prf_sha256:0},a.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},a.CipherType={stream:0,block:1,aead:2},a.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},a.CompressionMethod={none:0,deflate:1},a.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},a.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},a.Alert={},a.Alert.Level={warning:1,fatal:2},a.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},a.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},a.CipherSuites={},a.getCipherSuite=function(b){var P=null;for(var R in a.CipherSuites){var y=a.CipherSuites[R];if(y.id[0]===b.charCodeAt(0)&&y.id[1]===b.charCodeAt(1)){P=y;break}}return P},a.handleUnexpected=function(b,P){var R=!b.open&&b.entity===a.ConnectionEnd.client;R||b.error(b,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unexpected_message}})},a.handleHelloRequest=function(b,P,R){!b.handshaking&&b.handshakes>0&&(a.queue(b,a.createAlert(b,{level:a.Alert.Level.warning,description:a.Alert.Description.no_renegotiation})),a.flush(b)),b.process()},a.parseHelloMessage=function(b,P,R){var y=null,x=b.entity===a.ConnectionEnd.client;if(R<38)b.error(b,{message:x?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});else{var F=P.fragment,M=F.length();if(y={version:{major:F.getByte(),minor:F.getByte()},random:t.util.createBuffer(F.getBytes(32)),session_id:d(F,1),extensions:[]},x?(y.cipher_suite=F.getBytes(2),y.compression_method=F.getByte()):(y.cipher_suites=d(F,2),y.compression_methods=d(F,1)),M=R-(M-F.length()),M>0){for(var Q=d(F,2);Q.length()>0;)y.extensions.push({type:[Q.getByte(),Q.getByte()],data:d(Q,2)});if(!x)for(var ie=0;ie<y.extensions.length;++ie){var oe=y.extensions[ie];if(oe.type[0]===0&&oe.type[1]===0)for(var $=d(oe.data,2);$.length()>0;){var ne=$.getByte();if(ne!==0)break;b.session.extensions.server_name.serverNameList.push(d($,2).getBytes())}}}if(b.session.version&&(y.version.major!==b.session.version.major||y.version.minor!==b.session.version.minor))return b.error(b,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.protocol_version}});if(x)b.session.cipherSuite=a.getCipherSuite(y.cipher_suite);else for(var pe=t.util.createBuffer(y.cipher_suites.bytes());pe.length()>0&&(b.session.cipherSuite=a.getCipherSuite(pe.getBytes(2)),b.session.cipherSuite===null););if(b.session.cipherSuite===null)return b.error(b,{message:"No cipher suites in common.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.handshake_failure},cipherSuite:t.util.bytesToHex(y.cipher_suite)});x?b.session.compressionMethod=y.compression_method:b.session.compressionMethod=a.CompressionMethod.none}return y},a.createSecurityParameters=function(b,P){var R=b.entity===a.ConnectionEnd.client,y=P.random.bytes(),x=R?b.session.sp.client_random:y,F=R?y:a.createRandom().getBytes();b.session.sp={entity:b.entity,prf_algorithm:a.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:b.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:x,server_random:F}},a.handleServerHello=function(b,P,R){var y=a.parseHelloMessage(b,P,R);if(!b.fail){if(y.version.minor<=b.version.minor)b.version.minor=y.version.minor;else return b.error(b,{message:"Incompatible TLS version.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.protocol_version}});b.session.version=b.version;var x=y.session_id.bytes();x.length>0&&x===b.session.id?(b.expect=m,b.session.resuming=!0,b.session.sp.server_random=y.random.bytes()):(b.expect=p,b.session.resuming=!1,a.createSecurityParameters(b,y)),b.session.id=x,b.process()}},a.handleClientHello=function(b,P,R){var y=a.parseHelloMessage(b,P,R);if(!b.fail){var x=y.session_id.bytes(),F=null;if(b.sessionCache&&(F=b.sessionCache.getSession(x),F===null?x="":(F.version.major!==y.version.major||F.version.minor>y.version.minor)&&(F=null,x="")),x.length===0&&(x=t.random.getBytes(32)),b.session.id=x,b.session.clientHelloVersion=y.version,b.session.sp={},F)b.version=b.session.version=F.version,b.session.sp=F.sp;else{for(var M,Q=1;Q<a.SupportedVersions.length&&(M=a.SupportedVersions[Q],!(M.minor<=y.version.minor));++Q);b.version={major:M.major,minor:M.minor},b.session.version=b.version}F!==null?(b.expect=L,b.session.resuming=!0,b.session.sp.client_random=y.random.bytes()):(b.expect=b.verifyClient!==!1?v:_,b.session.resuming=!1,a.createSecurityParameters(b,y)),b.open=!0,a.queue(b,a.createRecord(b,{type:a.ContentType.handshake,data:a.createServerHello(b)})),b.session.resuming?(a.queue(b,a.createRecord(b,{type:a.ContentType.change_cipher_spec,data:a.createChangeCipherSpec()})),b.state.pending=a.createConnectionState(b),b.state.current.write=b.state.pending.write,a.queue(b,a.createRecord(b,{type:a.ContentType.handshake,data:a.createFinished(b)}))):(a.queue(b,a.createRecord(b,{type:a.ContentType.handshake,data:a.createCertificate(b)})),b.fail||(a.queue(b,a.createRecord(b,{type:a.ContentType.handshake,data:a.createServerKeyExchange(b)})),b.verifyClient!==!1&&a.queue(b,a.createRecord(b,{type:a.ContentType.handshake,data:a.createCertificateRequest(b)})),a.queue(b,a.createRecord(b,{type:a.ContentType.handshake,data:a.createServerHelloDone(b)})))),a.flush(b),b.process()}},a.handleCertificate=function(b,P,R){if(R<3)return b.error(b,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var y=P.fragment,x={certificate_list:d(y,3)},F,M,Q=[];try{for(;x.certificate_list.length()>0;)F=d(x.certificate_list,3),M=t.asn1.fromDer(F),F=t.pki.certificateFromAsn1(M,!0),Q.push(F)}catch(oe){return b.error(b,{message:"Could not parse certificate list.",cause:oe,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.bad_certificate}})}var ie=b.entity===a.ConnectionEnd.client;(ie||b.verifyClient===!0)&&Q.length===0?b.error(b,{message:ie?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}}):Q.length===0?b.expect=ie?T:_:(ie?b.session.serverCertificate=Q[0]:b.session.clientCertificate=Q[0],a.verifyCertificateChain(b,Q)&&(b.expect=ie?T:_)),b.process()},a.handleServerKeyExchange=function(b,P,R){if(R>0)return b.error(b,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unsupported_certificate}});b.expect=I,b.process()},a.handleClientKeyExchange=function(b,P,R){if(R<48)return b.error(b,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unsupported_certificate}});var y=P.fragment,x={enc_pre_master_secret:d(y,2).getBytes()},F=null;if(b.getPrivateKey)try{F=b.getPrivateKey(b,b.session.serverCertificate),F=t.pki.privateKeyFromPem(F)}catch(ie){b.error(b,{message:"Could not get private key.",cause:ie,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}})}if(F===null)return b.error(b,{message:"No private key set.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}});try{var M=b.session.sp;M.pre_master_secret=F.decrypt(x.enc_pre_master_secret);var Q=b.session.clientHelloVersion;if(Q.major!==M.pre_master_secret.charCodeAt(0)||Q.minor!==M.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{M.pre_master_secret=t.random.getBytes(48)}b.expect=L,b.session.clientCertificate!==null&&(b.expect=B),b.process()},a.handleCertificateRequest=function(b,P,R){if(R<3)return b.error(b,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var y=P.fragment,x={certificate_types:d(y,1),certificate_authorities:d(y,2)};b.session.certificateRequest=x,b.expect=A,b.process()},a.handleCertificateVerify=function(b,P,R){if(R<2)return b.error(b,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var y=P.fragment;y.read-=4;var x=y.bytes();y.read+=4;var F={signature:d(y,2).getBytes()},M=t.util.createBuffer();M.putBuffer(b.session.md5.digest()),M.putBuffer(b.session.sha1.digest()),M=M.getBytes();try{var Q=b.session.clientCertificate;if(!Q.publicKey.verify(M,F.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");b.session.md5.update(x),b.session.sha1.update(x)}catch{return b.error(b,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.handshake_failure}})}b.expect=L,b.process()},a.handleServerHelloDone=function(b,P,R){if(R>0)return b.error(b,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.record_overflow}});if(b.serverCertificate===null){var y={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.insufficient_security}},x=0,F=b.verify(b,y.alert.description,x,[]);if(F!==!0)return(F||F===0)&&(typeof F=="object"&&!t.util.isArray(F)?(F.message&&(y.message=F.message),F.alert&&(y.alert.description=F.alert)):typeof F=="number"&&(y.alert.description=F)),b.error(b,y)}b.session.certificateRequest!==null&&(P=a.createRecord(b,{type:a.ContentType.handshake,data:a.createCertificate(b)}),a.queue(b,P)),P=a.createRecord(b,{type:a.ContentType.handshake,data:a.createClientKeyExchange(b)}),a.queue(b,P),b.expect=E;var M=function(Q,ie){Q.session.certificateRequest!==null&&Q.session.clientCertificate!==null&&a.queue(Q,a.createRecord(Q,{type:a.ContentType.handshake,data:a.createCertificateVerify(Q,ie)})),a.queue(Q,a.createRecord(Q,{type:a.ContentType.change_cipher_spec,data:a.createChangeCipherSpec()})),Q.state.pending=a.createConnectionState(Q),Q.state.current.write=Q.state.pending.write,a.queue(Q,a.createRecord(Q,{type:a.ContentType.handshake,data:a.createFinished(Q)})),Q.expect=m,a.flush(Q),Q.process()};if(b.session.certificateRequest===null||b.session.clientCertificate===null)return M(b,null);a.getClientSignature(b,M)},a.handleChangeCipherSpec=function(b,P){if(P.fragment.getByte()!==1)return b.error(b,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var R=b.entity===a.ConnectionEnd.client;(b.session.resuming&&R||!b.session.resuming&&!R)&&(b.state.pending=a.createConnectionState(b)),b.state.current.read=b.state.pending.read,(!b.session.resuming&&R||b.session.resuming&&!R)&&(b.state.pending=null),b.expect=R?S:g,b.process()},a.handleFinished=function(b,P,R){var y=P.fragment;y.read-=4;var x=y.bytes();y.read+=4;var F=P.fragment.getBytes();y=t.util.createBuffer(),y.putBuffer(b.session.md5.digest()),y.putBuffer(b.session.sha1.digest());var M=b.entity===a.ConnectionEnd.client,Q=M?"server finished":"client finished",ie=b.session.sp,oe=12,$=e;if(y=$(ie.master_secret,Q,y.getBytes(),oe),y.getBytes()!==F)return b.error(b,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.decrypt_error}});b.session.md5.update(x),b.session.sha1.update(x),(b.session.resuming&&M||!b.session.resuming&&!M)&&(a.queue(b,a.createRecord(b,{type:a.ContentType.change_cipher_spec,data:a.createChangeCipherSpec()})),b.state.current.write=b.state.pending.write,b.state.pending=null,a.queue(b,a.createRecord(b,{type:a.ContentType.handshake,data:a.createFinished(b)}))),b.expect=M?C:f,b.handshaking=!1,++b.handshakes,b.peerCertificate=M?b.session.serverCertificate:b.session.clientCertificate,a.flush(b),b.isConnected=!0,b.connected(b),b.process()},a.handleAlert=function(b,P){var R=P.fragment,y={level:R.getByte(),description:R.getByte()},x;switch(y.description){case a.Alert.Description.close_notify:x="Connection closed.";break;case a.Alert.Description.unexpected_message:x="Unexpected message.";break;case a.Alert.Description.bad_record_mac:x="Bad record MAC.";break;case a.Alert.Description.decryption_failed:x="Decryption failed.";break;case a.Alert.Description.record_overflow:x="Record overflow.";break;case a.Alert.Description.decompression_failure:x="Decompression failed.";break;case a.Alert.Description.handshake_failure:x="Handshake failure.";break;case a.Alert.Description.bad_certificate:x="Bad certificate.";break;case a.Alert.Description.unsupported_certificate:x="Unsupported certificate.";break;case a.Alert.Description.certificate_revoked:x="Certificate revoked.";break;case a.Alert.Description.certificate_expired:x="Certificate expired.";break;case a.Alert.Description.certificate_unknown:x="Certificate unknown.";break;case a.Alert.Description.illegal_parameter:x="Illegal parameter.";break;case a.Alert.Description.unknown_ca:x="Unknown certificate authority.";break;case a.Alert.Description.access_denied:x="Access denied.";break;case a.Alert.Description.decode_error:x="Decode error.";break;case a.Alert.Description.decrypt_error:x="Decrypt error.";break;case a.Alert.Description.export_restriction:x="Export restriction.";break;case a.Alert.Description.protocol_version:x="Unsupported protocol version.";break;case a.Alert.Description.insufficient_security:x="Insufficient security.";break;case a.Alert.Description.internal_error:x="Internal error.";break;case a.Alert.Description.user_canceled:x="User canceled.";break;case a.Alert.Description.no_renegotiation:x="Renegotiation not supported.";break;default:x="Unknown error.";break}if(y.description===a.Alert.Description.close_notify)return b.close();b.error(b,{message:x,send:!1,origin:b.entity===a.ConnectionEnd.client?"server":"client",alert:y}),b.process()},a.handleHandshake=function(b,P){var R=P.fragment,y=R.getByte(),x=R.getInt24();if(x>R.length())return b.fragmented=P,P.fragment=t.util.createBuffer(),R.read-=4,b.process();b.fragmented=null,R.read-=4;var F=R.bytes(x+4);R.read+=4,y in be[b.entity][b.expect]?(b.entity===a.ConnectionEnd.server&&!b.open&&!b.fail&&(b.handshaking=!0,b.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:t.md.md5.create(),sha1:t.md.sha1.create()}),y!==a.HandshakeType.hello_request&&y!==a.HandshakeType.certificate_verify&&y!==a.HandshakeType.finished&&(b.session.md5.update(F),b.session.sha1.update(F)),be[b.entity][b.expect][y](b,P,x)):a.handleUnexpected(b,P)},a.handleApplicationData=function(b,P){b.data.putBuffer(P.fragment),b.dataReady(b),b.process()},a.handleHeartbeat=function(b,P){var R=P.fragment,y=R.getByte(),x=R.getInt16(),F=R.getBytes(x);if(y===a.HeartbeatMessageType.heartbeat_request){if(b.handshaking||x>F.length)return b.process();a.queue(b,a.createRecord(b,{type:a.ContentType.heartbeat,data:a.createHeartbeat(a.HeartbeatMessageType.heartbeat_response,F)})),a.flush(b)}else if(y===a.HeartbeatMessageType.heartbeat_response){if(F!==b.expectedHeartbeatPayload)return b.process();b.heartbeatReceived&&b.heartbeatReceived(b,t.util.createBuffer(F))}b.process()};var h=0,p=1,T=2,I=3,A=4,m=5,S=6,C=7,E=8,l=0,v=1,_=2,B=3,L=4,g=5,f=6,o=a.handleUnexpected,w=a.handleChangeCipherSpec,U=a.handleAlert,K=a.handleHandshake,D=a.handleApplicationData,H=a.handleHeartbeat,q=[];q[a.ConnectionEnd.client]=[[o,U,K,o,H],[o,U,K,o,H],[o,U,K,o,H],[o,U,K,o,H],[o,U,K,o,H],[w,U,o,o,H],[o,U,K,o,H],[o,U,K,D,H],[o,U,K,o,H]],q[a.ConnectionEnd.server]=[[o,U,K,o,H],[o,U,K,o,H],[o,U,K,o,H],[o,U,K,o,H],[w,U,o,o,H],[o,U,K,o,H],[o,U,K,D,H],[o,U,K,o,H]];var G=a.handleHelloRequest,z=a.handleServerHello,Y=a.handleCertificate,Z=a.handleServerKeyExchange,te=a.handleCertificateRequest,se=a.handleServerHelloDone,de=a.handleFinished,be=[];be[a.ConnectionEnd.client]=[[o,o,z,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o],[G,o,o,o,o,o,o,o,o,o,o,Y,Z,te,se,o,o,o,o,o,o],[G,o,o,o,o,o,o,o,o,o,o,o,Z,te,se,o,o,o,o,o,o],[G,o,o,o,o,o,o,o,o,o,o,o,o,te,se,o,o,o,o,o,o],[G,o,o,o,o,o,o,o,o,o,o,o,o,o,se,o,o,o,o,o,o],[G,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o],[G,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,de],[G,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o],[G,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o]];var we=a.handleClientHello,J=a.handleClientKeyExchange,Ee=a.handleCertificateVerify;be[a.ConnectionEnd.server]=[[o,we,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o,o,o,Y,o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,J,o,o,o,o],[o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,Ee,o,o,o,o,o],[o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,de],[o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o],[o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o,o]],a.generateKeys=function(b,P){var R=e,y=P.client_random+P.server_random;b.session.resuming||(P.master_secret=R(P.pre_master_secret,"master secret",y,48).bytes(),P.pre_master_secret=null),y=P.server_random+P.client_random;var x=2*P.mac_key_length+2*P.enc_key_length,F=b.version.major===a.Versions.TLS_1_0.major&&b.version.minor===a.Versions.TLS_1_0.minor;F&&(x+=2*P.fixed_iv_length);var M=R(P.master_secret,"key expansion",y,x),Q={client_write_MAC_key:M.getBytes(P.mac_key_length),server_write_MAC_key:M.getBytes(P.mac_key_length),client_write_key:M.getBytes(P.enc_key_length),server_write_key:M.getBytes(P.enc_key_length)};return F&&(Q.client_write_IV=M.getBytes(P.fixed_iv_length),Q.server_write_IV=M.getBytes(P.fixed_iv_length)),Q},a.createConnectionState=function(b){var P=b.entity===a.ConnectionEnd.client,R=function(){var F={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(M){return!0},compressionState:null,compressFunction:function(M){return!0},updateSequenceNumber:function(){F.sequenceNumber[1]===4294967295?(F.sequenceNumber[1]=0,++F.sequenceNumber[0]):++F.sequenceNumber[1]}};return F},y={read:R(),write:R()};if(y.read.update=function(F,M){return y.read.cipherFunction(M,y.read)?y.read.compressFunction(F,M,y.read)||F.error(F,{message:"Could not decompress record.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.decompression_failure}}):F.error(F,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.bad_record_mac}}),!F.fail},y.write.update=function(F,M){return y.write.compressFunction(F,M,y.write)?y.write.cipherFunction(M,y.write)||F.error(F,{message:"Could not encrypt record.",send:!1,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}}):F.error(F,{message:"Could not compress record.",send:!1,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}}),!F.fail},b.session){var x=b.session.sp;switch(b.session.cipherSuite.initSecurityParameters(x),x.keys=a.generateKeys(b,x),y.read.macKey=P?x.keys.server_write_MAC_key:x.keys.client_write_MAC_key,y.write.macKey=P?x.keys.client_write_MAC_key:x.keys.server_write_MAC_key,b.session.cipherSuite.initConnectionState(y,b,x),x.compression_algorithm){case a.CompressionMethod.none:break;case a.CompressionMethod.deflate:y.read.compressFunction=u,y.write.compressFunction=s;break;default:throw new Error("Unsupported compression algorithm.")}}return y},a.createRandom=function(){var b=new Date,P=+b+b.getTimezoneOffset()*6e4,R=t.util.createBuffer();return R.putInt32(P),R.putBytes(t.random.getBytes(28)),R},a.createRecord=function(b,P){if(!P.data)return null;var R={type:P.type,version:{major:b.version.major,minor:b.version.minor},length:P.data.length(),fragment:P.data};return R},a.createAlert=function(b,P){var R=t.util.createBuffer();return R.putByte(P.level),R.putByte(P.description),a.createRecord(b,{type:a.ContentType.alert,data:R})},a.createClientHello=function(b){b.session.clientHelloVersion={major:b.version.major,minor:b.version.minor};for(var P=t.util.createBuffer(),R=0;R<b.cipherSuites.length;++R){var y=b.cipherSuites[R];P.putByte(y.id[0]),P.putByte(y.id[1])}var x=P.length(),F=t.util.createBuffer();F.putByte(a.CompressionMethod.none);var M=F.length(),Q=t.util.createBuffer();if(b.virtualHost){var ie=t.util.createBuffer();ie.putByte(0),ie.putByte(0);var oe=t.util.createBuffer();oe.putByte(0),c(oe,2,t.util.createBuffer(b.virtualHost));var $=t.util.createBuffer();c($,2,oe),c(ie,2,$),Q.putBuffer(ie)}var ne=Q.length();ne>0&&(ne+=2);var pe=b.session.id,ve=pe.length+1+2+4+28+2+x+1+M+ne,ye=t.util.createBuffer();return ye.putByte(a.HandshakeType.client_hello),ye.putInt24(ve),ye.putByte(b.version.major),ye.putByte(b.version.minor),ye.putBytes(b.session.sp.client_random),c(ye,1,t.util.createBuffer(pe)),c(ye,2,P),c(ye,1,F),ne>0&&c(ye,2,Q),ye},a.createServerHello=function(b){var P=b.session.id,R=P.length+1+2+4+28+2+1,y=t.util.createBuffer();return y.putByte(a.HandshakeType.server_hello),y.putInt24(R),y.putByte(b.version.major),y.putByte(b.version.minor),y.putBytes(b.session.sp.server_random),c(y,1,t.util.createBuffer(P)),y.putByte(b.session.cipherSuite.id[0]),y.putByte(b.session.cipherSuite.id[1]),y.putByte(b.session.compressionMethod),y},a.createCertificate=function(b){var P=b.entity===a.ConnectionEnd.client,R=null;if(b.getCertificate){var y;P?y=b.session.certificateRequest:y=b.session.extensions.server_name.serverNameList,R=b.getCertificate(b,y)}var x=t.util.createBuffer();if(R!==null)try{t.util.isArray(R)||(R=[R]);for(var F=null,M=0;M<R.length;++M){var Q=t.pem.decode(R[M])[0];if(Q.type!=="CERTIFICATE"&&Q.type!=="X509 CERTIFICATE"&&Q.type!=="TRUSTED CERTIFICATE"){var ie=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw ie.headerType=Q.type,ie}if(Q.procType&&Q.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var oe=t.util.createBuffer(Q.body);F===null&&(F=t.asn1.fromDer(oe.bytes(),!1));var $=t.util.createBuffer();c($,3,oe),x.putBuffer($)}R=t.pki.certificateFromAsn1(F),P?b.session.clientCertificate=R:b.session.serverCertificate=R}catch(ve){return b.error(b,{message:"Could not send certificate list.",cause:ve,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.bad_certificate}})}var ne=3+x.length(),pe=t.util.createBuffer();return pe.putByte(a.HandshakeType.certificate),pe.putInt24(ne),c(pe,3,x),pe},a.createClientKeyExchange=function(b){var P=t.util.createBuffer();P.putByte(b.session.clientHelloVersion.major),P.putByte(b.session.clientHelloVersion.minor),P.putBytes(t.random.getBytes(46));var R=b.session.sp;R.pre_master_secret=P.getBytes();var y=b.session.serverCertificate.publicKey;P=y.encrypt(R.pre_master_secret);var x=P.length+2,F=t.util.createBuffer();return F.putByte(a.HandshakeType.client_key_exchange),F.putInt24(x),F.putInt16(P.length),F.putBytes(P),F},a.createServerKeyExchange=function(b){var P=0,R=t.util.createBuffer();return P>0&&(R.putByte(a.HandshakeType.server_key_exchange),R.putInt24(P)),R},a.getClientSignature=function(b,P){var R=t.util.createBuffer();R.putBuffer(b.session.md5.digest()),R.putBuffer(b.session.sha1.digest()),R=R.getBytes(),b.getSignature=b.getSignature||function(y,x,F){var M=null;if(y.getPrivateKey)try{M=y.getPrivateKey(y,y.session.clientCertificate),M=t.pki.privateKeyFromPem(M)}catch(Q){y.error(y,{message:"Could not get private key.",cause:Q,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}})}M===null?y.error(y,{message:"No private key set.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}}):x=M.sign(x,null),F(y,x)},b.getSignature(b,R,P)},a.createCertificateVerify=function(b,P){var R=P.length+2,y=t.util.createBuffer();return y.putByte(a.HandshakeType.certificate_verify),y.putInt24(R),y.putInt16(P.length),y.putBytes(P),y},a.createCertificateRequest=function(b){var P=t.util.createBuffer();P.putByte(1);var R=t.util.createBuffer();for(var y in b.caStore.certs){var x=b.caStore.certs[y],F=t.pki.distinguishedNameToAsn1(x.subject),M=t.asn1.toDer(F);R.putInt16(M.length()),R.putBuffer(M)}var Q=1+P.length()+2+R.length(),ie=t.util.createBuffer();return ie.putByte(a.HandshakeType.certificate_request),ie.putInt24(Q),c(ie,1,P),c(ie,2,R),ie},a.createServerHelloDone=function(b){var P=t.util.createBuffer();return P.putByte(a.HandshakeType.server_hello_done),P.putInt24(0),P},a.createChangeCipherSpec=function(){var b=t.util.createBuffer();return b.putByte(1),b},a.createFinished=function(b){var P=t.util.createBuffer();P.putBuffer(b.session.md5.digest()),P.putBuffer(b.session.sha1.digest());var R=b.entity===a.ConnectionEnd.client,y=b.session.sp,x=12,F=e,M=R?"client finished":"server finished";P=F(y.master_secret,M,P.getBytes(),x);var Q=t.util.createBuffer();return Q.putByte(a.HandshakeType.finished),Q.putInt24(P.length()),Q.putBuffer(P),Q},a.createHeartbeat=function(b,P,R){typeof R>"u"&&(R=P.length);var y=t.util.createBuffer();y.putByte(b),y.putInt16(R),y.putBytes(P);var x=y.length(),F=Math.max(16,x-R-3);return y.putBytes(t.random.getBytes(F)),y},a.queue=function(b,P){if(P&&!(P.fragment.length()===0&&(P.type===a.ContentType.handshake||P.type===a.ContentType.alert||P.type===a.ContentType.change_cipher_spec))){if(P.type===a.ContentType.handshake){var R=P.fragment.bytes();b.session.md5.update(R),b.session.sha1.update(R),R=null}var y;if(P.fragment.length()<=a.MaxFragment)y=[P];else{y=[];for(var x=P.fragment.bytes();x.length>a.MaxFragment;)y.push(a.createRecord(b,{type:P.type,data:t.util.createBuffer(x.slice(0,a.MaxFragment))})),x=x.slice(a.MaxFragment);x.length>0&&y.push(a.createRecord(b,{type:P.type,data:t.util.createBuffer(x)}))}for(var F=0;F<y.length&&!b.fail;++F){var M=y[F],Q=b.state.current.write;Q.update(b,M)&&b.records.push(M)}}},a.flush=function(b){for(var P=0;P<b.records.length;++P){var R=b.records[P];b.tlsData.putByte(R.type),b.tlsData.putByte(R.version.major),b.tlsData.putByte(R.version.minor),b.tlsData.putInt16(R.fragment.length()),b.tlsData.putBuffer(b.records[P].fragment)}return b.records=[],b.tlsDataReady(b)};var ee=function(b){switch(b){case!0:return!0;case t.pki.certificateError.bad_certificate:return a.Alert.Description.bad_certificate;case t.pki.certificateError.unsupported_certificate:return a.Alert.Description.unsupported_certificate;case t.pki.certificateError.certificate_revoked:return a.Alert.Description.certificate_revoked;case t.pki.certificateError.certificate_expired:return a.Alert.Description.certificate_expired;case t.pki.certificateError.certificate_unknown:return a.Alert.Description.certificate_unknown;case t.pki.certificateError.unknown_ca:return a.Alert.Description.unknown_ca;default:return a.Alert.Description.bad_certificate}},Le=function(b){switch(b){case!0:return!0;case a.Alert.Description.bad_certificate:return t.pki.certificateError.bad_certificate;case a.Alert.Description.unsupported_certificate:return t.pki.certificateError.unsupported_certificate;case a.Alert.Description.certificate_revoked:return t.pki.certificateError.certificate_revoked;case a.Alert.Description.certificate_expired:return t.pki.certificateError.certificate_expired;case a.Alert.Description.certificate_unknown:return t.pki.certificateError.certificate_unknown;case a.Alert.Description.unknown_ca:return t.pki.certificateError.unknown_ca;default:return t.pki.certificateError.bad_certificate}};a.verifyCertificateChain=function(b,P){try{var R={};for(var y in b.verifyOptions)R[y]=b.verifyOptions[y];R.verify=function(F,M,Q){var ie=ee(F),oe=b.verify(b,F,M,Q);if(oe!==!0){if(typeof oe=="object"&&!t.util.isArray(oe)){var $=new Error("The application rejected the certificate.");throw $.send=!0,$.alert={level:a.Alert.Level.fatal,description:a.Alert.Description.bad_certificate},oe.message&&($.message=oe.message),oe.alert&&($.alert.description=oe.alert),$}oe!==F&&(oe=Le(oe))}return oe},t.pki.verifyCertificateChain(b.caStore,P,R)}catch(F){var x=F;(typeof x!="object"||t.util.isArray(x))&&(x={send:!0,alert:{level:a.Alert.Level.fatal,description:ee(F)}}),"send"in x||(x.send=!0),"alert"in x||(x.alert={level:a.Alert.Level.fatal,description:ee(x.error)}),b.error(b,x)}return!b.fail},a.createSessionCache=function(b,P){var R=null;if(b&&b.getSession&&b.setSession&&b.order)R=b;else{R={},R.cache=b||{},R.capacity=Math.max(P||100,1),R.order=[];for(var y in b)R.order.length<=P?R.order.push(y):delete b[y];R.getSession=function(x){var F=null,M=null;if(x?M=t.util.bytesToHex(x):R.order.length>0&&(M=R.order[0]),M!==null&&M in R.cache){F=R.cache[M],delete R.cache[M];for(var Q in R.order)if(R.order[Q]===M){R.order.splice(Q,1);break}}return F},R.setSession=function(x,F){if(R.order.length===R.capacity){var M=R.order.shift();delete R.cache[M]}var M=t.util.bytesToHex(x);R.order.push(M),R.cache[M]=F}}return R},a.createConnection=function(b){var P=null;b.caStore?t.util.isArray(b.caStore)?P=t.pki.createCaStore(b.caStore):P=b.caStore:P=t.pki.createCaStore();var R=b.cipherSuites||null;if(R===null){R=[];for(var y in a.CipherSuites)R.push(a.CipherSuites[y])}var x=b.server?a.ConnectionEnd.server:a.ConnectionEnd.client,F=b.sessionCache?a.createSessionCache(b.sessionCache):null,M={version:{major:a.Version.major,minor:a.Version.minor},entity:x,sessionId:b.sessionId,caStore:P,sessionCache:F,cipherSuites:R,connected:b.connected,virtualHost:b.virtualHost||null,verifyClient:b.verifyClient||!1,verify:b.verify||function($,ne,pe,ve){return ne},verifyOptions:b.verifyOptions||{},getCertificate:b.getCertificate||null,getPrivateKey:b.getPrivateKey||null,getSignature:b.getSignature||null,input:t.util.createBuffer(),tlsData:t.util.createBuffer(),data:t.util.createBuffer(),tlsDataReady:b.tlsDataReady,dataReady:b.dataReady,heartbeatReceived:b.heartbeatReceived,closed:b.closed,error:function($,ne){ne.origin=ne.origin||($.entity===a.ConnectionEnd.client?"client":"server"),ne.send&&(a.queue($,a.createAlert($,ne.alert)),a.flush($));var pe=ne.fatal!==!1;pe&&($.fail=!0),b.error($,ne),pe&&$.close(!1)},deflate:b.deflate||null,inflate:b.inflate||null};M.reset=function($){M.version={major:a.Version.major,minor:a.Version.minor},M.record=null,M.session=null,M.peerCertificate=null,M.state={pending:null,current:null},M.expect=M.entity===a.ConnectionEnd.client?h:l,M.fragmented=null,M.records=[],M.open=!1,M.handshakes=0,M.handshaking=!1,M.isConnected=!1,M.fail=!($||typeof $>"u"),M.input.clear(),M.tlsData.clear(),M.data.clear(),M.state.current=a.createConnectionState(M)},M.reset();var Q=function($,ne){var pe=ne.type-a.ContentType.change_cipher_spec,ve=q[$.entity][$.expect];pe in ve?ve[pe]($,ne):a.handleUnexpected($,ne)},ie=function($){var ne=0,pe=$.input,ve=pe.length();if(ve<5)ne=5-ve;else{$.record={type:pe.getByte(),version:{major:pe.getByte(),minor:pe.getByte()},length:pe.getInt16(),fragment:t.util.createBuffer(),ready:!1};var ye=$.record.version.major===$.version.major;ye&&$.session&&$.session.version&&(ye=$.record.version.minor===$.version.minor),ye||$.error($,{message:"Incompatible TLS version.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.protocol_version}})}return ne},oe=function($){var ne=0,pe=$.input,ve=pe.length();if(ve<$.record.length)ne=$.record.length-ve;else{$.record.fragment.putBytes(pe.getBytes($.record.length)),pe.compact();var ye=$.state.current.read;ye.update($,$.record)&&($.fragmented!==null&&($.fragmented.type===$.record.type?($.fragmented.fragment.putBuffer($.record.fragment),$.record=$.fragmented):$.error($,{message:"Invalid fragmented record.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unexpected_message}})),$.record.ready=!0)}return ne};return M.handshake=function($){if(M.entity!==a.ConnectionEnd.client)M.error(M,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(M.handshaking)M.error(M,{message:"Handshake already in progress.",fatal:!1});else{M.fail&&!M.open&&M.handshakes===0&&(M.fail=!1),M.handshaking=!0,$=$||"";var ne=null;$.length>0&&(M.sessionCache&&(ne=M.sessionCache.getSession($)),ne===null&&($="")),$.length===0&&M.sessionCache&&(ne=M.sessionCache.getSession(),ne!==null&&($=ne.id)),M.session={id:$,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:t.md.md5.create(),sha1:t.md.sha1.create()},ne&&(M.version=ne.version,M.session.sp=ne.sp),M.session.sp.client_random=a.createRandom().getBytes(),M.open=!0,a.queue(M,a.createRecord(M,{type:a.ContentType.handshake,data:a.createClientHello(M)})),a.flush(M)}},M.process=function($){var ne=0;return $&&M.input.putBytes($),M.fail||(M.record!==null&&M.record.ready&&M.record.fragment.isEmpty()&&(M.record=null),M.record===null&&(ne=ie(M)),!M.fail&&M.record!==null&&!M.record.ready&&(ne=oe(M)),!M.fail&&M.record!==null&&M.record.ready&&Q(M,M.record)),ne},M.prepare=function($){return a.queue(M,a.createRecord(M,{type:a.ContentType.application_data,data:t.util.createBuffer($)})),a.flush(M)},M.prepareHeartbeatRequest=function($,ne){return $ instanceof t.util.ByteBuffer&&($=$.bytes()),typeof ne>"u"&&(ne=$.length),M.expectedHeartbeatPayload=$,a.queue(M,a.createRecord(M,{type:a.ContentType.heartbeat,data:a.createHeartbeat(a.HeartbeatMessageType.heartbeat_request,$,ne)})),a.flush(M)},M.close=function($){if(!M.fail&&M.sessionCache&&M.session){var ne={id:M.session.id,version:M.session.version,sp:M.session.sp};ne.sp.keys=null,M.sessionCache.setSession(ne.id,ne)}M.open&&(M.open=!1,M.input.clear(),(M.isConnected||M.handshaking)&&(M.isConnected=M.handshaking=!1,a.queue(M,a.createAlert(M,{level:a.Alert.Level.warning,description:a.Alert.Description.close_notify})),a.flush(M)),M.closed(M)),M.reset($)},M},r.exports=t.tls=t.tls||{};for(ge in a)typeof a[ge]!="function"&&(t.tls[ge]=a[ge]);var ge;t.tls.prf_tls1=e,t.tls.hmac_sha1=n,t.tls.createSessionCache=a.createSessionCache,t.tls.createConnection=a.createConnection}),ip=he((i,r)=>{var t=me();sr(),Uc();var e=r.exports=t.tls;e.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(h){h.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,h.cipher_type=e.CipherType.block,h.enc_key_length=16,h.block_length=16,h.fixed_iv_length=16,h.record_iv_length=16,h.mac_algorithm=e.MACAlgorithm.hmac_sha1,h.mac_length=20,h.mac_key_length=20},initConnectionState:n},e.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(h){h.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,h.cipher_type=e.CipherType.block,h.enc_key_length=32,h.block_length=16,h.fixed_iv_length=16,h.record_iv_length=16,h.mac_algorithm=e.MACAlgorithm.hmac_sha1,h.mac_length=20,h.mac_key_length=20},initConnectionState:n};function n(h,p,T){var I=p.entity===t.tls.ConnectionEnd.client;h.read.cipherState={init:!1,cipher:t.cipher.createDecipher("AES-CBC",I?T.keys.server_write_key:T.keys.client_write_key),iv:I?T.keys.server_write_IV:T.keys.client_write_IV},h.write.cipherState={init:!1,cipher:t.cipher.createCipher("AES-CBC",I?T.keys.client_write_key:T.keys.server_write_key),iv:I?T.keys.client_write_IV:T.keys.server_write_IV},h.read.cipherFunction=c,h.write.cipherFunction=s,h.read.macLength=h.write.macLength=T.mac_length,h.read.macFunction=h.write.macFunction=e.hmac_sha1}function s(h,p){var T=!1,I=p.macFunction(p.macKey,p.sequenceNumber,h);h.fragment.putBytes(I),p.updateSequenceNumber();var A;h.version.minor===e.Versions.TLS_1_0.minor?A=p.cipherState.init?null:p.cipherState.iv:A=t.random.getBytesSync(16),p.cipherState.init=!0;var m=p.cipherState.cipher;return m.start({iv:A}),h.version.minor>=e.Versions.TLS_1_1.minor&&m.output.putBytes(A),m.update(h.fragment),m.finish(u)&&(h.fragment=m.output,h.length=h.fragment.length(),T=!0),T}function u(h,p,T){if(!T){var I=h-p.length()%h;p.fillWithByte(I-1,I)}return!0}function d(h,p,T){var I=!0;if(T){for(var A=p.length(),m=p.last(),S=A-1-m;S<A-1;++S)I=I&&p.at(S)==m;I&&p.truncate(m+1)}return I}function c(h,p){var T=!1,I;h.version.minor===e.Versions.TLS_1_0.minor?I=p.cipherState.init?null:p.cipherState.iv:I=h.fragment.getBytes(16),p.cipherState.init=!0;var A=p.cipherState.cipher;A.start({iv:I}),A.update(h.fragment),T=A.finish(d);var m=p.macLength,S=t.random.getBytesSync(m),C=A.output.length();C>=m?(h.fragment=A.output.getBytes(C-m),S=A.output.getBytes(m)):h.fragment=A.output.getBytes(),h.fragment=t.util.createBuffer(h.fragment),h.length=h.fragment.length();var E=p.macFunction(p.macKey,p.sequenceNumber,h);return p.updateSequenceNumber(),T=a(p.macKey,S,E)&&T,T}function a(h,p,T){var I=t.hmac.create();return I.start("SHA1",h),I.update(p),p=I.digest().getBytes(),I.start(null,null),I.update(T),T=I.digest().getBytes(),p===T}}),Dc=he((i,r)=>{var t=me();Ht(),Ce();var e=r.exports=t.sha512=t.sha512||{};t.md.sha512=t.md.algorithms.sha512=e;var n=t.sha384=t.sha512.sha384=t.sha512.sha384||{};n.create=function(){return e.create("SHA-384")},t.md.sha384=t.md.algorithms.sha384=n,t.sha512.sha256=t.sha512.sha256||{create:function(){return e.create("SHA-512/256")}},t.md["sha512/256"]=t.md.algorithms["sha512/256"]=t.sha512.sha256,t.sha512.sha224=t.sha512.sha224||{create:function(){return e.create("SHA-512/224")}},t.md["sha512/224"]=t.md.algorithms["sha512/224"]=t.sha512.sha224,e.create=function(p){if(u||a(),typeof p>"u"&&(p="SHA-512"),!(p in c))throw new Error("Invalid SHA-512 algorithm: "+p);for(var T=c[p],I=null,A=t.util.createBuffer(),m=new Array(80),S=0;S<80;++S)m[S]=new Array(2);var C=64;switch(p){case"SHA-384":C=48;break;case"SHA-512/256":C=32;break;case"SHA-512/224":C=28;break}var E={algorithm:p.replace("-","").toLowerCase(),blockLength:128,digestLength:C,messageLength:0,fullMessageLength:null,messageLengthSize:16};return E.start=function(){E.messageLength=0,E.fullMessageLength=E.messageLength128=[];for(var l=E.messageLengthSize/4,v=0;v<l;++v)E.fullMessageLength.push(0);A=t.util.createBuffer(),I=new Array(T.length);for(var v=0;v<T.length;++v)I[v]=T[v].slice(0);return E},E.start(),E.update=function(l,v){v==="utf8"&&(l=t.util.encodeUtf8(l));var _=l.length;E.messageLength+=_,_=[_/4294967296>>>0,_>>>0];for(var B=E.fullMessageLength.length-1;B>=0;--B)E.fullMessageLength[B]+=_[1],_[1]=_[0]+(E.fullMessageLength[B]/4294967296>>>0),E.fullMessageLength[B]=E.fullMessageLength[B]>>>0,_[0]=_[1]/4294967296>>>0;return A.putBytes(l),h(I,m,A),(A.read>2048||A.length()===0)&&A.compact(),E},E.digest=function(){var l=t.util.createBuffer();l.putBytes(A.bytes());var v=E.fullMessageLength[E.fullMessageLength.length-1]+E.messageLengthSize,_=v&E.blockLength-1;l.putBytes(s.substr(0,E.blockLength-_));for(var B,L,g=E.fullMessageLength[0]*8,f=0;f<E.fullMessageLength.length-1;++f)B=E.fullMessageLength[f+1]*8,L=B/4294967296>>>0,g+=L,l.putInt32(g>>>0),g=B>>>0;l.putInt32(g);for(var o=new Array(I.length),f=0;f<I.length;++f)o[f]=I[f].slice(0);h(o,m,l);var w=t.util.createBuffer(),U;p==="SHA-512"?U=o.length:p==="SHA-384"?U=o.length-2:U=o.length-4;for(var f=0;f<U;++f)w.putInt32(o[f][0]),(f!==U-1||p!=="SHA-512/224")&&w.putInt32(o[f][1]);return w},E};var s=null,u=!1,d=null,c=null;function a(){s="\x80",s+=t.util.fillString("\0",128),d=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],c={},c["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],c["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],c["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],c["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],u=!0}function h(p,T,I){for(var A,m,S,C,E,l,v,_,B,L,g,f,o,w,U,K,D,H,q,G,z,Y,Z,te,se,de,be,we,J,Ee,ee,Le,ge,b,P,R=I.length();R>=128;){for(J=0;J<16;++J)T[J][0]=I.getInt32()>>>0,T[J][1]=I.getInt32()>>>0;for(;J<80;++J)Le=T[J-2],Ee=Le[0],ee=Le[1],A=((Ee>>>19|ee<<13)^(ee>>>29|Ee<<3)^Ee>>>6)>>>0,m=((Ee<<13|ee>>>19)^(ee<<3|Ee>>>29)^(Ee<<26|ee>>>6))>>>0,b=T[J-15],Ee=b[0],ee=b[1],S=((Ee>>>1|ee<<31)^(Ee>>>8|ee<<24)^Ee>>>7)>>>0,C=((Ee<<31|ee>>>1)^(Ee<<24|ee>>>8)^(Ee<<25|ee>>>7))>>>0,ge=T[J-7],P=T[J-16],ee=m+ge[1]+C+P[1],T[J][0]=A+ge[0]+S+P[0]+(ee/4294967296>>>0)>>>0,T[J][1]=ee>>>0;for(o=p[0][0],w=p[0][1],U=p[1][0],K=p[1][1],D=p[2][0],H=p[2][1],q=p[3][0],G=p[3][1],z=p[4][0],Y=p[4][1],Z=p[5][0],te=p[5][1],se=p[6][0],de=p[6][1],be=p[7][0],we=p[7][1],J=0;J<80;++J)v=((z>>>14|Y<<18)^(z>>>18|Y<<14)^(Y>>>9|z<<23))>>>0,_=((z<<18|Y>>>14)^(z<<14|Y>>>18)^(Y<<23|z>>>9))>>>0,B=(se^z&(Z^se))>>>0,L=(de^Y&(te^de))>>>0,E=((o>>>28|w<<4)^(w>>>2|o<<30)^(w>>>7|o<<25))>>>0,l=((o<<4|w>>>28)^(w<<30|o>>>2)^(w<<25|o>>>7))>>>0,g=(o&U|D&(o^U))>>>0,f=(w&K|H&(w^K))>>>0,ee=we+_+L+d[J][1]+T[J][1],A=be+v+B+d[J][0]+T[J][0]+(ee/4294967296>>>0)>>>0,m=ee>>>0,ee=l+f,S=E+g+(ee/4294967296>>>0)>>>0,C=ee>>>0,be=se,we=de,se=Z,de=te,Z=z,te=Y,ee=G+m,z=q+A+(ee/4294967296>>>0)>>>0,Y=ee>>>0,q=D,G=H,D=U,H=K,U=o,K=w,ee=m+C,o=A+S+(ee/4294967296>>>0)>>>0,w=ee>>>0;ee=p[0][1]+w,p[0][0]=p[0][0]+o+(ee/4294967296>>>0)>>>0,p[0][1]=ee>>>0,ee=p[1][1]+K,p[1][0]=p[1][0]+U+(ee/4294967296>>>0)>>>0,p[1][1]=ee>>>0,ee=p[2][1]+H,p[2][0]=p[2][0]+D+(ee/4294967296>>>0)>>>0,p[2][1]=ee>>>0,ee=p[3][1]+G,p[3][0]=p[3][0]+q+(ee/4294967296>>>0)>>>0,p[3][1]=ee>>>0,ee=p[4][1]+Y,p[4][0]=p[4][0]+z+(ee/4294967296>>>0)>>>0,p[4][1]=ee>>>0,ee=p[5][1]+te,p[5][0]=p[5][0]+Z+(ee/4294967296>>>0)>>>0,p[5][1]=ee>>>0,ee=p[6][1]+de,p[6][0]=p[6][0]+se+(ee/4294967296>>>0)>>>0,p[6][1]=ee>>>0,ee=p[7][1]+we,p[7][0]=p[7][0]+be+(ee/4294967296>>>0)>>>0,p[7][1]=ee>>>0,R-=128}}}),sp=he(i=>{var r=me();Pt();var t=r.asn1;i.privateKeyValidator={name:"PrivateKeyInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},i.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:t.Class.UNIVERSAL,type:t.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}}),op=he((i,r)=>{var t=me();Nn(),It(),Dc(),Ce();var e=sp(),n=e.publicKeyValidator,s=e.privateKeyValidator;typeof u>"u"&&(u=t.jsbn.BigInteger);var u,d=t.util.ByteBuffer,c=typeof __Buffer$>"u"?Uint8Array:__Buffer$;t.pki=t.pki||{},r.exports=t.pki.ed25519=t.ed25519=t.ed25519||{};var a=t.ed25519;a.constants={},a.constants.PUBLIC_KEY_BYTE_LENGTH=32,a.constants.PRIVATE_KEY_BYTE_LENGTH=64,a.constants.SEED_BYTE_LENGTH=32,a.constants.SIGN_BYTE_LENGTH=64,a.constants.HASH_BYTE_LENGTH=64,a.generateKeyPair=function(b){b=b||{};var P=b.seed;if(P===void 0)P=t.random.getBytesSync(a.constants.SEED_BYTE_LENGTH);else if(typeof P=="string"){if(P.length!==a.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+a.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(P instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');P=h({message:P,encoding:"binary"});for(var R=new c(a.constants.PUBLIC_KEY_BYTE_LENGTH),y=new c(a.constants.PRIVATE_KEY_BYTE_LENGTH),x=0;x<32;++x)y[x]=P[x];return v(R,y),{publicKey:R,privateKey:y}},a.privateKeyFromAsn1=function(b){var P={},R=[],y=t.asn1.validate(b,s,P,R);if(!y){var x=new Error("Invalid Key.");throw x.errors=R,x}var F=t.asn1.derToOid(P.privateKeyOid),M=t.oids.EdDSA25519;if(F!==M)throw new Error('Invalid OID "'+F+'"; OID must be "'+M+'".');var Q=P.privateKey,ie=h({message:t.asn1.fromDer(Q).value,encoding:"binary"});return{privateKeyBytes:ie}},a.publicKeyFromAsn1=function(b){var P={},R=[],y=t.asn1.validate(b,n,P,R);if(!y){var x=new Error("Invalid Key.");throw x.errors=R,x}var F=t.asn1.derToOid(P.publicKeyOid),M=t.oids.EdDSA25519;if(F!==M)throw new Error('Invalid OID "'+F+'"; OID must be "'+M+'".');var Q=P.ed25519PublicKey;if(Q.length!==a.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return h({message:Q,encoding:"binary"})},a.publicKeyFromPrivateKey=function(b){b=b||{};var P=h({message:b.privateKey,encoding:"binary"});if(P.length!==a.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+a.constants.PRIVATE_KEY_BYTE_LENGTH);for(var R=new c(a.constants.PUBLIC_KEY_BYTE_LENGTH),y=0;y<R.length;++y)R[y]=P[32+y];return R},a.sign=function(b){b=b||{};var P=h(b),R=h({message:b.privateKey,encoding:"binary"});if(R.length===a.constants.SEED_BYTE_LENGTH){var y=a.generateKeyPair({seed:R});R=y.privateKey}else if(R.length!==a.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+a.constants.SEED_BYTE_LENGTH+" or "+a.constants.PRIVATE_KEY_BYTE_LENGTH);var x=new c(a.constants.SIGN_BYTE_LENGTH+P.length);_(x,P,P.length,R);for(var F=new c(a.constants.SIGN_BYTE_LENGTH),M=0;M<F.length;++M)F[M]=x[M];return F},a.verify=function(b){b=b||{};var P=h(b);if(b.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var R=h({message:b.signature,encoding:"binary"});if(R.length!==a.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+a.constants.SIGN_BYTE_LENGTH);var y=h({message:b.publicKey,encoding:"binary"});if(y.length!==a.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+a.constants.PUBLIC_KEY_BYTE_LENGTH);var x=new c(a.constants.SIGN_BYTE_LENGTH+P.length),F=new c(a.constants.SIGN_BYTE_LENGTH+P.length),M;for(M=0;M<a.constants.SIGN_BYTE_LENGTH;++M)x[M]=R[M];for(M=0;M<P.length;++M)x[M+a.constants.SIGN_BYTE_LENGTH]=P[M];return B(F,x,x.length,y)>=0};function h(b){var P=b.message;if(P instanceof Uint8Array||P instanceof c)return P;var R=b.encoding;if(P===void 0)if(b.md)P=b.md.digest().getBytes(),R="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof P=="string"&&!R)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof P=="string"){if(typeof __Buffer$<"u")return __Buffer$.from(P,R);P=new d(P,R)}else if(!(P instanceof d))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var y=new c(P.length()),x=0;x<y.length;++x)y[x]=P.at(x);return y}var p=J(),T=J([1]),I=J([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),A=J([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),m=J([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),S=J([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),C=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),E=J([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function l(b,P){var R=t.md.sha512.create(),y=new d(b);R.update(y.getBytes(P),"binary");var x=R.digest().getBytes();if(typeof __Buffer$<"u")return __Buffer$.from(x,"binary");for(var F=new c(a.constants.HASH_BYTE_LENGTH),M=0;M<64;++M)F[M]=x.charCodeAt(M);return F}function v(b,P){var R=[J(),J(),J(),J()],y,x=l(P,32);for(x[0]&=248,x[31]&=127,x[31]|=64,te(R,x),w(b,R),y=0;y<32;++y)P[y+32]=b[y];return 0}function _(b,P,R,y){var x,F,M=new Float64Array(64),Q=[J(),J(),J(),J()],ie=l(y,32);ie[0]&=248,ie[31]&=127,ie[31]|=64;var oe=R+64;for(x=0;x<R;++x)b[64+x]=P[x];for(x=0;x<32;++x)b[32+x]=ie[32+x];var $=l(b.subarray(32),R+32);for(g($),te(Q,$),w(b,Q),x=32;x<64;++x)b[x]=y[x];var ne=l(b,R+64);for(g(ne),x=32;x<64;++x)M[x]=0;for(x=0;x<32;++x)M[x]=$[x];for(x=0;x<32;++x)for(F=0;F<32;F++)M[x+F]+=ne[x]*ie[F];return L(b.subarray(32),M),oe}function B(b,P,R,y){var x,F,M=new c(32),Q=[J(),J(),J(),J()],ie=[J(),J(),J(),J()];if(F=-1,R<64||K(ie,y))return-1;for(x=0;x<R;++x)b[x]=P[x];for(x=0;x<32;++x)b[x+32]=y[x];var oe=l(b,R);if(g(oe),Z(Q,ie,oe),te(ie,P.subarray(32)),f(Q,ie),w(M,Q),R-=64,G(P,0,M,0)){for(x=0;x<R;++x)b[x]=0;return-1}for(x=0;x<R;++x)b[x]=P[x+64];return F=R,F}function L(b,P){var R,y,x,F;for(y=63;y>=32;--y){for(R=0,x=y-32,F=y-12;x<F;++x)P[x]+=R-16*P[y]*C[x-(y-32)],R=P[x]+128>>8,P[x]-=R*256;P[x]+=R,P[y]=0}for(R=0,x=0;x<32;++x)P[x]+=R-(P[31]>>4)*C[x],R=P[x]>>8,P[x]&=255;for(x=0;x<32;++x)P[x]-=R*C[x];for(y=0;y<32;++y)P[y+1]+=P[y]>>8,b[y]=P[y]&255}function g(b){for(var P=new Float64Array(64),R=0;R<64;++R)P[R]=b[R],b[R]=0;L(b,P)}function f(b,P){var R=J(),y=J(),x=J(),F=J(),M=J(),Q=J(),ie=J(),oe=J(),$=J();ee(R,b[1],b[0]),ee($,P[1],P[0]),ge(R,R,$),Ee(y,b[0],b[1]),Ee($,P[0],P[1]),ge(y,y,$),ge(x,b[3],P[3]),ge(x,x,A),ge(F,b[2],P[2]),Ee(F,F,F),ee(M,y,R),ee(Q,F,x),Ee(ie,F,x),Ee(oe,y,R),ge(b[0],M,Q),ge(b[1],oe,ie),ge(b[2],ie,Q),ge(b[3],M,oe)}function o(b,P,R){for(var y=0;y<4;++y)we(b[y],P[y],R)}function w(b,P){var R=J(),y=J(),x=J();de(x,P[2]),ge(R,P[0],x),ge(y,P[1],x),U(b,y),b[31]^=Y(R)<<7}function U(b,P){var R,y,x,F=J(),M=J();for(R=0;R<16;++R)M[R]=P[R];for(be(M),be(M),be(M),y=0;y<2;++y){for(F[0]=M[0]-65517,R=1;R<15;++R)F[R]=M[R]-65535-(F[R-1]>>16&1),F[R-1]&=65535;F[15]=M[15]-32767-(F[14]>>16&1),x=F[15]>>16&1,F[14]&=65535,we(M,F,1-x)}for(R=0;R<16;R++)b[2*R]=M[R]&255,b[2*R+1]=M[R]>>8}function K(b,P){var R=J(),y=J(),x=J(),F=J(),M=J(),Q=J(),ie=J();return se(b[2],T),D(b[1],P),Le(x,b[1]),ge(F,x,I),ee(x,x,b[2]),Ee(F,b[2],F),Le(M,F),Le(Q,M),ge(ie,Q,M),ge(R,ie,x),ge(R,R,F),H(R,R),ge(R,R,x),ge(R,R,F),ge(R,R,F),ge(b[0],R,F),Le(y,b[0]),ge(y,y,F),q(y,x)&&ge(b[0],b[0],E),Le(y,b[0]),ge(y,y,F),q(y,x)?-1:(Y(b[0])===P[31]>>7&&ee(b[0],p,b[0]),ge(b[3],b[0],b[1]),0)}function D(b,P){var R;for(R=0;R<16;++R)b[R]=P[2*R]+(P[2*R+1]<<8);b[15]&=32767}function H(b,P){var R=J(),y;for(y=0;y<16;++y)R[y]=P[y];for(y=250;y>=0;--y)Le(R,R),y!==1&&ge(R,R,P);for(y=0;y<16;++y)b[y]=R[y]}function q(b,P){var R=new c(32),y=new c(32);return U(R,b),U(y,P),G(R,0,y,0)}function G(b,P,R,y){return z(b,P,R,y,32)}function z(b,P,R,y,x){var F,M=0;for(F=0;F<x;++F)M|=b[P+F]^R[y+F];return(1&M-1>>>8)-1}function Y(b){var P=new c(32);return U(P,b),P[0]&1}function Z(b,P,R){var y,x;for(se(b[0],p),se(b[1],T),se(b[2],T),se(b[3],p),x=255;x>=0;--x)y=R[x/8|0]>>(x&7)&1,o(b,P,y),f(P,b),f(b,b),o(b,P,y)}function te(b,P){var R=[J(),J(),J(),J()];se(R[0],m),se(R[1],S),se(R[2],T),ge(R[3],m,S),Z(b,R,P)}function se(b,P){var R;for(R=0;R<16;R++)b[R]=P[R]|0}function de(b,P){var R=J(),y;for(y=0;y<16;++y)R[y]=P[y];for(y=253;y>=0;--y)Le(R,R),y!==2&&y!==4&&ge(R,R,P);for(y=0;y<16;++y)b[y]=R[y]}function be(b){var P,R,y=1;for(P=0;P<16;++P)R=b[P]+y+65535,y=Math.floor(R/65536),b[P]=R-y*65536;b[0]+=y-1+37*(y-1)}function we(b,P,R){for(var y,x=~(R-1),F=0;F<16;++F)y=x&(b[F]^P[F]),b[F]^=y,P[F]^=y}function J(b){var P,R=new Float64Array(16);if(b)for(P=0;P<b.length;++P)R[P]=b[P];return R}function Ee(b,P,R){for(var y=0;y<16;++y)b[y]=P[y]+R[y]}function ee(b,P,R){for(var y=0;y<16;++y)b[y]=P[y]-R[y]}function Le(b,P){ge(b,P,P)}function ge(b,P,R){var y,x,F=0,M=0,Q=0,ie=0,oe=0,$=0,ne=0,pe=0,ve=0,ye=0,Be=0,Ue=0,Pe=0,Ne=0,_e=0,Ae=0,Ve=0,rt=0,Me=0,at=0,it=0,ct=0,ut=0,Et=0,wt=0,Ut=0,jt=0,Wt=0,cr=0,Sr=0,en=0,Ke=R[0],He=R[1],Fe=R[2],je=R[3],qe=R[4],Ge=R[5],ze=R[6],$e=R[7],We=R[8],Qe=R[9],Ye=R[10],Xe=R[11],Je=R[12],Ze=R[13],xe=R[14],Oe=R[15];y=P[0],F+=y*Ke,M+=y*He,Q+=y*Fe,ie+=y*je,oe+=y*qe,$+=y*Ge,ne+=y*ze,pe+=y*$e,ve+=y*We,ye+=y*Qe,Be+=y*Ye,Ue+=y*Xe,Pe+=y*Je,Ne+=y*Ze,_e+=y*xe,Ae+=y*Oe,y=P[1],M+=y*Ke,Q+=y*He,ie+=y*Fe,oe+=y*je,$+=y*qe,ne+=y*Ge,pe+=y*ze,ve+=y*$e,ye+=y*We,Be+=y*Qe,Ue+=y*Ye,Pe+=y*Xe,Ne+=y*Je,_e+=y*Ze,Ae+=y*xe,Ve+=y*Oe,y=P[2],Q+=y*Ke,ie+=y*He,oe+=y*Fe,$+=y*je,ne+=y*qe,pe+=y*Ge,ve+=y*ze,ye+=y*$e,Be+=y*We,Ue+=y*Qe,Pe+=y*Ye,Ne+=y*Xe,_e+=y*Je,Ae+=y*Ze,Ve+=y*xe,rt+=y*Oe,y=P[3],ie+=y*Ke,oe+=y*He,$+=y*Fe,ne+=y*je,pe+=y*qe,ve+=y*Ge,ye+=y*ze,Be+=y*$e,Ue+=y*We,Pe+=y*Qe,Ne+=y*Ye,_e+=y*Xe,Ae+=y*Je,Ve+=y*Ze,rt+=y*xe,Me+=y*Oe,y=P[4],oe+=y*Ke,$+=y*He,ne+=y*Fe,pe+=y*je,ve+=y*qe,ye+=y*Ge,Be+=y*ze,Ue+=y*$e,Pe+=y*We,Ne+=y*Qe,_e+=y*Ye,Ae+=y*Xe,Ve+=y*Je,rt+=y*Ze,Me+=y*xe,at+=y*Oe,y=P[5],$+=y*Ke,ne+=y*He,pe+=y*Fe,ve+=y*je,ye+=y*qe,Be+=y*Ge,Ue+=y*ze,Pe+=y*$e,Ne+=y*We,_e+=y*Qe,Ae+=y*Ye,Ve+=y*Xe,rt+=y*Je,Me+=y*Ze,at+=y*xe,it+=y*Oe,y=P[6],ne+=y*Ke,pe+=y*He,ve+=y*Fe,ye+=y*je,Be+=y*qe,Ue+=y*Ge,Pe+=y*ze,Ne+=y*$e,_e+=y*We,Ae+=y*Qe,Ve+=y*Ye,rt+=y*Xe,Me+=y*Je,at+=y*Ze,it+=y*xe,ct+=y*Oe,y=P[7],pe+=y*Ke,ve+=y*He,ye+=y*Fe,Be+=y*je,Ue+=y*qe,Pe+=y*Ge,Ne+=y*ze,_e+=y*$e,Ae+=y*We,Ve+=y*Qe,rt+=y*Ye,Me+=y*Xe,at+=y*Je,it+=y*Ze,ct+=y*xe,ut+=y*Oe,y=P[8],ve+=y*Ke,ye+=y*He,Be+=y*Fe,Ue+=y*je,Pe+=y*qe,Ne+=y*Ge,_e+=y*ze,Ae+=y*$e,Ve+=y*We,rt+=y*Qe,Me+=y*Ye,at+=y*Xe,it+=y*Je,ct+=y*Ze,ut+=y*xe,Et+=y*Oe,y=P[9],ye+=y*Ke,Be+=y*He,Ue+=y*Fe,Pe+=y*je,Ne+=y*qe,_e+=y*Ge,Ae+=y*ze,Ve+=y*$e,rt+=y*We,Me+=y*Qe,at+=y*Ye,it+=y*Xe,ct+=y*Je,ut+=y*Ze,Et+=y*xe,wt+=y*Oe,y=P[10],Be+=y*Ke,Ue+=y*He,Pe+=y*Fe,Ne+=y*je,_e+=y*qe,Ae+=y*Ge,Ve+=y*ze,rt+=y*$e,Me+=y*We,at+=y*Qe,it+=y*Ye,ct+=y*Xe,ut+=y*Je,Et+=y*Ze,wt+=y*xe,Ut+=y*Oe,y=P[11],Ue+=y*Ke,Pe+=y*He,Ne+=y*Fe,_e+=y*je,Ae+=y*qe,Ve+=y*Ge,rt+=y*ze,Me+=y*$e,at+=y*We,it+=y*Qe,ct+=y*Ye,ut+=y*Xe,Et+=y*Je,wt+=y*Ze,Ut+=y*xe,jt+=y*Oe,y=P[12],Pe+=y*Ke,Ne+=y*He,_e+=y*Fe,Ae+=y*je,Ve+=y*qe,rt+=y*Ge,Me+=y*ze,at+=y*$e,it+=y*We,ct+=y*Qe,ut+=y*Ye,Et+=y*Xe,wt+=y*Je,Ut+=y*Ze,jt+=y*xe,Wt+=y*Oe,y=P[13],Ne+=y*Ke,_e+=y*He,Ae+=y*Fe,Ve+=y*je,rt+=y*qe,Me+=y*Ge,at+=y*ze,it+=y*$e,ct+=y*We,ut+=y*Qe,Et+=y*Ye,wt+=y*Xe,Ut+=y*Je,jt+=y*Ze,Wt+=y*xe,cr+=y*Oe,y=P[14],_e+=y*Ke,Ae+=y*He,Ve+=y*Fe,rt+=y*je,Me+=y*qe,at+=y*Ge,it+=y*ze,ct+=y*$e,ut+=y*We,Et+=y*Qe,wt+=y*Ye,Ut+=y*Xe,jt+=y*Je,Wt+=y*Ze,cr+=y*xe,Sr+=y*Oe,y=P[15],Ae+=y*Ke,Ve+=y*He,rt+=y*Fe,Me+=y*je,at+=y*qe,it+=y*Ge,ct+=y*ze,ut+=y*$e,Et+=y*We,wt+=y*Qe,Ut+=y*Ye,jt+=y*Xe,Wt+=y*Je,cr+=y*Ze,Sr+=y*xe,en+=y*Oe,F+=38*Ve,M+=38*rt,Q+=38*Me,ie+=38*at,oe+=38*it,$+=38*ct,ne+=38*ut,pe+=38*Et,ve+=38*wt,ye+=38*Ut,Be+=38*jt,Ue+=38*Wt,Pe+=38*cr,Ne+=38*Sr,_e+=38*en,x=1,y=F+x+65535,x=Math.floor(y/65536),F=y-x*65536,y=M+x+65535,x=Math.floor(y/65536),M=y-x*65536,y=Q+x+65535,x=Math.floor(y/65536),Q=y-x*65536,y=ie+x+65535,x=Math.floor(y/65536),ie=y-x*65536,y=oe+x+65535,x=Math.floor(y/65536),oe=y-x*65536,y=$+x+65535,x=Math.floor(y/65536),$=y-x*65536,y=ne+x+65535,x=Math.floor(y/65536),ne=y-x*65536,y=pe+x+65535,x=Math.floor(y/65536),pe=y-x*65536,y=ve+x+65535,x=Math.floor(y/65536),ve=y-x*65536,y=ye+x+65535,x=Math.floor(y/65536),ye=y-x*65536,y=Be+x+65535,x=Math.floor(y/65536),Be=y-x*65536,y=Ue+x+65535,x=Math.floor(y/65536),Ue=y-x*65536,y=Pe+x+65535,x=Math.floor(y/65536),Pe=y-x*65536,y=Ne+x+65535,x=Math.floor(y/65536),Ne=y-x*65536,y=_e+x+65535,x=Math.floor(y/65536),_e=y-x*65536,y=Ae+x+65535,x=Math.floor(y/65536),Ae=y-x*65536,F+=x-1+37*(x-1),x=1,y=F+x+65535,x=Math.floor(y/65536),F=y-x*65536,y=M+x+65535,x=Math.floor(y/65536),M=y-x*65536,y=Q+x+65535,x=Math.floor(y/65536),Q=y-x*65536,y=ie+x+65535,x=Math.floor(y/65536),ie=y-x*65536,y=oe+x+65535,x=Math.floor(y/65536),oe=y-x*65536,y=$+x+65535,x=Math.floor(y/65536),$=y-x*65536,y=ne+x+65535,x=Math.floor(y/65536),ne=y-x*65536,y=pe+x+65535,x=Math.floor(y/65536),pe=y-x*65536,y=ve+x+65535,x=Math.floor(y/65536),ve=y-x*65536,y=ye+x+65535,x=Math.floor(y/65536),ye=y-x*65536,y=Be+x+65535,x=Math.floor(y/65536),Be=y-x*65536,y=Ue+x+65535,x=Math.floor(y/65536),Ue=y-x*65536,y=Pe+x+65535,x=Math.floor(y/65536),Pe=y-x*65536,y=Ne+x+65535,x=Math.floor(y/65536),Ne=y-x*65536,y=_e+x+65535,x=Math.floor(y/65536),_e=y-x*65536,y=Ae+x+65535,x=Math.floor(y/65536),Ae=y-x*65536,F+=x-1+37*(x-1),b[0]=F,b[1]=M,b[2]=Q,b[3]=ie,b[4]=oe,b[5]=$,b[6]=ne,b[7]=pe,b[8]=ve,b[9]=ye,b[10]=Be,b[11]=Ue,b[12]=Pe,b[13]=Ne,b[14]=_e,b[15]=Ae}}),cp=he((i,r)=>{var t=me();Ce(),It(),Nn(),r.exports=t.kem=t.kem||{};var e=t.jsbn.BigInteger;t.kem.rsa={},t.kem.rsa.create=function(s,u){u=u||{};var d=u.prng||t.random,c={};return c.encrypt=function(a,h){var p=Math.ceil(a.n.bitLength()/8),T;do T=new e(t.util.bytesToHex(d.getBytesSync(p)),16).mod(a.n);while(T.compareTo(e.ONE)<=0);T=t.util.hexToBytes(T.toString(16));var I=p-T.length;I>0&&(T=t.util.fillString("\0",I)+T);var A=a.encrypt(T,"NONE"),m=s.generate(T,h);return{encapsulation:A,key:m}},c.decrypt=function(a,h,p){var T=a.decrypt(h,"NONE");return s.generate(T,p)},c},t.kem.kdf1=function(s,u){n(this,s,0,u||s.digestLength)},t.kem.kdf2=function(s,u){n(this,s,1,u||s.digestLength)};function n(s,u,d,c){s.generate=function(a,h){for(var p=new t.util.ByteBuffer,T=Math.ceil(h/c)+d,I=new t.util.ByteBuffer,A=d;A<T;++A){I.putInt32(A),u.start(),u.update(a+I.getBytes());var m=u.digest();p.putBytes(m.getBytes(c))}return p.truncate(p.length()-h),p.getBytes()}}}),up=he((i,r)=>{var t=me();Ce(),r.exports=t.log=t.log||{},t.log.levels=["none","error","warning","info","debug","verbose","max"];var e={},n=[],s=null;for(t.log.LEVEL_LOCKED=2,t.log.NO_LEVEL_CHECK=4,t.log.INTERPOLATE=8,c=0;c<t.log.levels.length;++c)u=t.log.levels[c],e[u]={index:c,name:u.toUpperCase()};var u,c;for(t.log.logMessage=function(A){for(var m=e[A.level].index,S=0;S<n.length;++S){var C=n[S];if(C.flags&t.log.NO_LEVEL_CHECK)C.f(A);else{var E=e[C.level].index;m<=E&&C.f(C,A)}}},t.log.prepareStandard=function(A){"standard"in A||(A.standard=e[A.level].name+" ["+A.category+"] "+A.message)},t.log.prepareFull=function(A){if(!("full"in A)){var m=[A.message];m=m.concat([]),A.full=t.util.format.apply(this,m)}},t.log.prepareStandardFull=function(A){"standardFull"in A||(t.log.prepareStandard(A),A.standardFull=A.standard)},d=["error","warning","info","debug","verbose"],c=0;c<d.length;++c)(function(A){t.log[A]=function(m,S){var C=Array.prototype.slice.call(arguments).slice(2),E={timestamp:new Date,level:A,category:m,message:S,arguments:C};t.log.logMessage(E)}})(d[c]);var d,c;t.log.makeLogger=function(A){var m={flags:0,f:A};return t.log.setLevel(m,"none"),m},t.log.setLevel=function(A,m){var S=!1;if(A&&!(A.flags&t.log.LEVEL_LOCKED))for(var C=0;C<t.log.levels.length;++C){var E=t.log.levels[C];if(m==E){A.level=m,S=!0;break}}return S},t.log.lock=function(A,m){typeof m>"u"||m?A.flags|=t.log.LEVEL_LOCKED:A.flags&=~t.log.LEVEL_LOCKED},t.log.addLogger=function(A){n.push(A)},typeof console<"u"&&"log"in console?(console.error&&console.warn&&console.info&&console.debug?(h={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},p=function(A,m){t.log.prepareStandard(m);var S=h[m.level],C=[m.standard];C=C.concat(m.arguments.slice()),S.apply(console,C)},a=t.log.makeLogger(p)):(p=function(A,m){t.log.prepareStandardFull(m),console.log(m.standardFull)},a=t.log.makeLogger(p)),t.log.setLevel(a,"debug"),t.log.addLogger(a),s=a):console={log:function(){}};var a,h,p;s!==null&&typeof window<"u"&&window.location&&(T=new URL(window.location.href).searchParams,T.has("console.level")&&t.log.setLevel(s,T.get("console.level").slice(-1)[0]),T.has("console.lock")&&(I=T.get("console.lock").slice(-1)[0],I=="true"&&t.log.lock(s)));var T,I;t.log.consoleLogger=s}),lp=he((i,r)=>{r.exports=Ht(),Ia(),Fr(),Ac(),Dc()}),pp=he((i,r)=>{var t=me();sr(),Pt(),Bn(),or(),Er(),kc(),It(),Ce(),Na();var e=t.asn1,n=r.exports=t.pkcs7=t.pkcs7||{};n.messageFromPem=function(m){var S=t.pem.decode(m)[0];if(S.type!=="PKCS7"){var C=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw C.headerType=S.type,C}if(S.procType&&S.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var E=e.fromDer(S.body);return n.messageFromAsn1(E)},n.messageToPem=function(m,S){var C={type:"PKCS7",body:e.toDer(m.toAsn1()).getBytes()};return t.pem.encode(C,{maxline:S})},n.messageFromAsn1=function(m){var S={},C=[];if(!e.validate(m,n.asn1.contentInfoValidator,S,C)){var E=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw E.errors=C,E}var l=e.derToOid(S.contentType),v;switch(l){case t.pki.oids.envelopedData:v=n.createEnvelopedData();break;case t.pki.oids.encryptedData:v=n.createEncryptedData();break;case t.pki.oids.signedData:v=n.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+l+" is not (yet) supported.")}return v.fromAsn1(S.content.value[0]),v},n.createSignedData=function(){var m=null;return m={type:t.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(E){if(I(m,E,n.asn1.signedDataValidator),m.certificates=[],m.crls=[],m.digestAlgorithmIdentifiers=[],m.contentInfo=null,m.signerInfos=[],m.rawCapture.certificates)for(var l=m.rawCapture.certificates.value,v=0;v<l.length;++v)m.certificates.push(t.pki.certificateFromAsn1(l[v]))},toAsn1:function(){m.contentInfo||m.sign();for(var E=[],l=0;l<m.certificates.length;++l)E.push(t.pki.certificateToAsn1(m.certificates[l]));var v=[],_=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(m.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,m.digestAlgorithmIdentifiers),m.contentInfo])]);return E.length>0&&_.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,E)),v.length>0&&_.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,v)),_.value[0].value.push(e.create(e.Class.UNIVERSAL,e.Type.SET,!0,m.signerInfos)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(m.type).getBytes()),_])},addSigner:function(E){var l=E.issuer,v=E.serialNumber;if(E.certificate){var _=E.certificate;typeof _=="string"&&(_=t.pki.certificateFromPem(_)),l=_.issuer.attributes,v=_.serialNumber}var B=E.key;if(!B)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof B=="string"&&(B=t.pki.privateKeyFromPem(B));var L=E.digestAlgorithm||t.pki.oids.sha1;switch(L){case t.pki.oids.sha1:case t.pki.oids.sha256:case t.pki.oids.sha384:case t.pki.oids.sha512:case t.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+L)}var g=E.authenticatedAttributes||[];if(g.length>0){for(var f=!1,o=!1,w=0;w<g.length;++w){var U=g[w];if(!f&&U.type===t.pki.oids.contentType){if(f=!0,o)break;continue}if(!o&&U.type===t.pki.oids.messageDigest){if(o=!0,f)break;continue}}if(!f||!o)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}m.signers.push({key:B,version:1,issuer:l,serialNumber:v,digestAlgorithm:L,signatureAlgorithm:t.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:g,unauthenticatedAttributes:[]})},sign:function(E){if(E=E||{},(typeof m.content!="object"||m.contentInfo===null)&&(m.contentInfo=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes())]),"content"in m)){var l;m.content instanceof t.util.ByteBuffer?l=m.content.bytes():typeof m.content=="string"&&(l=t.util.encodeUtf8(m.content)),E.detached?m.detachedContent=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,l):m.contentInfo.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,l)]))}if(m.signers.length!==0){var v=S();C(v)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(E){typeof E=="string"&&(E=t.pki.certificateFromPem(E)),m.certificates.push(E)},addCertificateRevokationList:function(E){throw new Error("PKCS#7 CRL support not yet implemented.")}},m;function S(){for(var E={},l=0;l<m.signers.length;++l){var v=m.signers[l],_=v.digestAlgorithm;_ in E||(E[_]=t.md[t.pki.oids[_]].create()),v.authenticatedAttributes.length===0?v.md=E[_]:v.md=t.md[t.pki.oids[_]].create()}m.digestAlgorithmIdentifiers=[];for(var _ in E)m.digestAlgorithmIdentifiers.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(_).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]));return E}function C(E){var l;if(m.detachedContent?l=m.detachedContent:(l=m.contentInfo.value[1],l=l.value[0]),!l)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var v=e.derToOid(m.contentInfo.value[0].value),_=e.toDer(l);_.getByte(),e.getBerValueLength(_),_=_.getBytes();for(var B in E)E[B].start().update(_);for(var L=new Date,g=0;g<m.signers.length;++g){var f=m.signers[g];if(f.authenticatedAttributes.length===0){if(v!==t.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{f.authenticatedAttributesAsn1=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var o=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[]),w=0;w<f.authenticatedAttributes.length;++w){var U=f.authenticatedAttributes[w];U.type===t.pki.oids.messageDigest?U.value=E[f.digestAlgorithm].digest():U.type===t.pki.oids.signingTime&&(U.value||(U.value=L)),o.value.push(p(U)),f.authenticatedAttributesAsn1.value.push(p(U))}_=e.toDer(o).getBytes(),f.md.start().update(_)}f.signature=f.key.sign(f.md,"RSASSA-PKCS1-V1_5")}m.signerInfos=h(m.signers)}},n.createEncryptedData=function(){var m=null;return m={type:t.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(S){I(m,S,n.asn1.encryptedDataValidator)},decrypt:function(S){S!==void 0&&(m.encryptedContent.key=S),A(m)}},m},n.createEnvelopedData=function(){var m=null;return m={type:t.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(S){var C=I(m,S,n.asn1.envelopedDataValidator);m.recipients=d(C.recipientInfos.value)},toAsn1:function(){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(m.type).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(m.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,c(m.recipients)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,T(m.encryptedContent))])])])},findRecipient:function(S){for(var C=S.issuer.attributes,E=0;E<m.recipients.length;++E){var l=m.recipients[E],v=l.issuer;if(l.serialNumber===S.serialNumber&&v.length===C.length){for(var _=!0,B=0;B<C.length;++B)if(v[B].type!==C[B].type||v[B].value!==C[B].value){_=!1;break}if(_)return l}}return null},decrypt:function(S,C){if(m.encryptedContent.key===void 0&&S!==void 0&&C!==void 0)switch(S.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:case t.pki.oids.desCBC:var E=C.decrypt(S.encryptedContent.content);m.encryptedContent.key=t.util.createBuffer(E);break;default:throw new Error("Unsupported asymmetric cipher, OID "+S.encryptedContent.algorithm)}A(m)},addRecipient:function(S){m.recipients.push({version:0,issuer:S.issuer.attributes,serialNumber:S.serialNumber,encryptedContent:{algorithm:t.pki.oids.rsaEncryption,key:S.publicKey}})},encrypt:function(S,C){if(m.encryptedContent.content===void 0){C=C||m.encryptedContent.algorithm,S=S||m.encryptedContent.key;var E,l,v;switch(C){case t.pki.oids["aes128-CBC"]:E=16,l=16,v=t.aes.createEncryptionCipher;break;case t.pki.oids["aes192-CBC"]:E=24,l=16,v=t.aes.createEncryptionCipher;break;case t.pki.oids["aes256-CBC"]:E=32,l=16,v=t.aes.createEncryptionCipher;break;case t.pki.oids["des-EDE3-CBC"]:E=24,l=8,v=t.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+C)}if(S===void 0)S=t.util.createBuffer(t.random.getBytes(E));else if(S.length()!=E)throw new Error("Symmetric key has wrong length; got "+S.length()+" bytes, expected "+E+".");m.encryptedContent.algorithm=C,m.encryptedContent.key=S,m.encryptedContent.parameter=t.util.createBuffer(t.random.getBytes(l));var _=v(S);if(_.start(m.encryptedContent.parameter.copy()),_.update(m.content),!_.finish())throw new Error("Symmetric encryption failed.");m.encryptedContent.content=_.output}for(var B=0;B<m.recipients.length;++B){var L=m.recipients[B];if(L.encryptedContent.content===void 0)switch(L.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:L.encryptedContent.content=L.encryptedContent.key.encrypt(m.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+L.encryptedContent.algorithm)}}}},m};function s(m){var S={},C=[];if(!e.validate(m,n.asn1.recipientInfoValidator,S,C)){var E=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw E.errors=C,E}return{version:S.version.charCodeAt(0),issuer:t.pki.RDNAttributesAsArray(S.issuer),serialNumber:t.util.createBuffer(S.serial).toHex(),encryptedContent:{algorithm:e.derToOid(S.encAlgorithm),parameter:S.encParameter?S.encParameter.value:void 0,content:S.encKey}}}function u(m){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(m.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:m.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(m.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(m.encryptedContent.algorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,m.encryptedContent.content)])}function d(m){for(var S=[],C=0;C<m.length;++C)S.push(s(m[C]));return S}function c(m){for(var S=[],C=0;C<m.length;++C)S.push(u(m[C]));return S}function a(m){var S=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(m.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:m.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(m.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(m.digestAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])]);if(m.authenticatedAttributesAsn1&&S.value.push(m.authenticatedAttributesAsn1),S.value.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(m.signatureAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])),S.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,m.signature)),m.unauthenticatedAttributes.length>0){for(var C=e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[]),E=0;E<m.unauthenticatedAttributes.length;++E){var l=m.unauthenticatedAttributes[E];C.values.push(p(l))}S.value.push(C)}return S}function h(m){for(var S=[],C=0;C<m.length;++C)S.push(a(m[C]));return S}function p(m){var S;if(m.type===t.pki.oids.contentType)S=e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(m.value).getBytes());else if(m.type===t.pki.oids.messageDigest)S=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,m.value.bytes());else if(m.type===t.pki.oids.signingTime){var C=new Date("1950-01-01T00:00:00Z"),E=new Date("2050-01-01T00:00:00Z"),l=m.value;if(typeof l=="string"){var v=Date.parse(l);isNaN(v)?l.length===13?l=e.utcTimeToDate(l):l=e.generalizedTimeToDate(l):l=new Date(v)}l>=C&&l<E?S=e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(l)):S=e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(l))}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(m.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[S])])}function T(m){return[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(m.algorithm).getBytes()),m.parameter?e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,m.parameter.getBytes()):void 0]),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,m.content.getBytes())])]}function I(m,S,C){var E={},l=[];if(!e.validate(S,C,E,l)){var v=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw v.errors=v,v}var _=e.derToOid(E.contentType);if(_!==t.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(E.encryptedContent){var B="";if(t.util.isArray(E.encryptedContent))for(var L=0;L<E.encryptedContent.length;++L){if(E.encryptedContent[L].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");B+=E.encryptedContent[L].value}else B=E.encryptedContent;m.encryptedContent={algorithm:e.derToOid(E.encAlgorithm),parameter:t.util.createBuffer(E.encParameter.value),content:t.util.createBuffer(B)}}if(E.content){var B="";if(t.util.isArray(E.content))for(var L=0;L<E.content.length;++L){if(E.content[L].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");B+=E.content[L].value}else B=E.content;m.content=t.util.createBuffer(B)}return m.version=E.version.charCodeAt(0),m.rawCapture=E,E}function A(m){if(m.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(m.content===void 0){var S;switch(m.encryptedContent.algorithm){case t.pki.oids["aes128-CBC"]:case t.pki.oids["aes192-CBC"]:case t.pki.oids["aes256-CBC"]:S=t.aes.createDecryptionCipher(m.encryptedContent.key);break;case t.pki.oids.desCBC:case t.pki.oids["des-EDE3-CBC"]:S=t.des.createDecryptionCipher(m.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+m.encryptedContent.algorithm)}if(S.start(m.encryptedContent.parameter),S.update(m.encryptedContent.content),!S.finish())throw new Error("Symmetric decryption failed.");m.content=S.output}}}),fp=he((i,r)=>{var t=me();sr(),Hr(),Ia(),Fr(),Ce();var e=r.exports=t.ssh=t.ssh||{};e.privateKeyToPutty=function(d,c,a){a=a||"",c=c||"";var h="ssh-rsa",p=c===""?"none":"aes256-cbc",T="PuTTY-User-Key-File-2: "+h+`\r
`;T+="Encryption: "+p+`\r
`,T+="Comment: "+a+`\r
`;var I=t.util.createBuffer();s(I,h),n(I,d.e),n(I,d.n);var A=t.util.encode64(I.bytes(),64),m=Math.floor(A.length/66)+1;T+="Public-Lines: "+m+`\r
`,T+=A;var S=t.util.createBuffer();n(S,d.d),n(S,d.p),n(S,d.q),n(S,d.qInv);var C;if(!c)C=t.util.encode64(S.bytes(),64);else{var E=S.length()+16-1;E-=E%16;var l=u(S.bytes());l.truncate(l.length()-E+S.length()),S.putBuffer(l);var v=t.util.createBuffer();v.putBuffer(u("\0\0\0\0",c)),v.putBuffer(u("\0\0\0",c));var _=t.aes.createEncryptionCipher(v.truncate(8),"CBC");_.start(t.util.createBuffer().fillWithByte(0,16)),_.update(S.copy()),_.finish();var B=_.output;B.truncate(16),C=t.util.encode64(B.bytes(),64)}m=Math.floor(C.length/66)+1,T+=`\r
Private-Lines: `+m+`\r
`,T+=C;var L=u("putty-private-key-file-mac-key",c),g=t.util.createBuffer();s(g,h),s(g,p),s(g,a),g.putInt32(I.length()),g.putBuffer(I),g.putInt32(S.length()),g.putBuffer(S);var f=t.hmac.create();return f.start("sha1",L),f.update(g.bytes()),T+=`\r
Private-MAC: `+f.digest().toHex()+`\r
`,T},e.publicKeyToOpenSSH=function(d,c){var a="ssh-rsa";c=c||"";var h=t.util.createBuffer();return s(h,a),n(h,d.e),n(h,d.n),a+" "+t.util.encode64(h.bytes())+" "+c},e.privateKeyToOpenSSH=function(d,c){return c?t.pki.encryptRsaPrivateKey(d,c,{legacy:!0,algorithm:"aes128"}):t.pki.privateKeyToPem(d)},e.getPublicKeyFingerprint=function(d,c){c=c||{};var a=c.md||t.md.md5.create(),h="ssh-rsa",p=t.util.createBuffer();s(p,h),n(p,d.e),n(p,d.n),a.start(),a.update(p.getBytes());var T=a.digest();if(c.encoding==="hex"){var I=T.toHex();return c.delimiter?I.match(/.{2}/g).join(c.delimiter):I}else{if(c.encoding==="binary")return T.getBytes();if(c.encoding)throw new Error('Unknown encoding "'+c.encoding+'".')}return T};function n(d,c){var a=c.toString(16);a[0]>="8"&&(a="00"+a);var h=t.util.hexToBytes(a);d.putInt32(h.length),d.putBytes(h)}function s(d,c){d.putInt32(c.length),d.putString(c)}function u(){for(var d=t.md.sha1.create(),c=arguments.length,a=0;a<c;++a)d.update(arguments[a]);return d.digest()}}),dp=he((i,r)=>{r.exports=me(),sr(),ip(),Pt(),Aa(),Bn(),op(),Hr(),cp(),up(),lp(),Rc(),wa(),Er(),Bc(),Lc(),pp(),Pc(),Nc(),Ic(),Ba(),It(),wc(),fp(),Uc(),Ce()}),Sa=rp(dp()),{options:hp}=Sa,Oc=Sa.default??Sa});var jr={};Wa(jr,{default:()=>Oc,options:()=>hp});var qr=Kn(()=>{Ta();xa();xa()});var on,fe,Ja,Au,Qt,Qa,Za,ei,ti,Gn,Fn,jn,ri,_r={},ni=[],Iu=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Ar=Array.isArray;function Ot(i,r){for(var t in r)i[t]=r[t];return i}function zn(i){i&&i.parentNode&&i.parentNode.removeChild(i)}function Yt(i,r,t){var e,n,s,u={};for(s in r)s=="key"?e=r[s]:s=="ref"?n=r[s]:u[s]=r[s];if(arguments.length>2&&(u.children=arguments.length>3?on.call(arguments,2):t),typeof i=="function"&&i.defaultProps!=null)for(s in i.defaultProps)u[s]===void 0&&(u[s]=i.defaultProps[s]);return an(i,u,e,n,null)}function an(i,r,t,e,n){var s={type:i,props:r,key:t,ref:e,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:n??++Ja,__i:-1,__u:0};return n==null&&fe.vnode!=null&&fe.vnode(s),s}function dt(i){return i.children}function _t(i,r){this.props=i,this.context=r}function lr(i,r){if(r==null)return i.__?lr(i.__,i.__i+1):null;for(var t;r<i.__k.length;r++)if((t=i.__k[r])!=null&&t.__e!=null)return t.__e;return typeof i.type=="function"?lr(i):null}function ai(i){var r,t;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,r=0;r<i.__k.length;r++)if((t=i.__k[r])!=null&&t.__e!=null){i.__e=i.__c.base=t.__e;break}return ai(i)}}function qn(i){(!i.__d&&(i.__d=!0)&&Qt.push(i)&&!sn.__r++||Qa!=fe.debounceRendering)&&((Qa=fe.debounceRendering)||Za)(sn)}function sn(){for(var i,r,t,e,n,s,u,d=1;Qt.length;)Qt.length>d&&Qt.sort(ei),i=Qt.shift(),d=Qt.length,i.__d&&(t=void 0,n=(e=(r=i).__v).__e,s=[],u=[],r.__P&&((t=Ot({},e)).__v=e.__v+1,fe.vnode&&fe.vnode(t),$n(r.__P,t,e,r.__n,r.__P.namespaceURI,32&e.__u?[n]:null,s,n??lr(e),!!(32&e.__u),u),t.__v=e.__v,t.__.__k[t.__i]=t,oi(s,t,u),t.__e!=n&&ai(t)));sn.__r=0}function ii(i,r,t,e,n,s,u,d,c,a,h){var p,T,I,A,m,S,C=e&&e.__k||ni,E=r.length;for(c=wu(t,r,C,c,E),p=0;p<E;p++)(I=t.__k[p])!=null&&(T=I.__i==-1?_r:C[I.__i]||_r,I.__i=p,S=$n(i,I,T,n,s,u,d,c,a,h),A=I.__e,I.ref&&T.ref!=I.ref&&(T.ref&&Wn(T.ref,null,I),h.push(I.ref,I.__c||A,I)),m==null&&A!=null&&(m=A),4&I.__u||T.__k===I.__k?c=si(I,c,i):typeof I.type=="function"&&S!==void 0?c=S:A&&(c=A.nextSibling),I.__u&=-7);return t.__e=m,c}function wu(i,r,t,e,n){var s,u,d,c,a,h=t.length,p=h,T=0;for(i.__k=new Array(n),s=0;s<n;s++)(u=r[s])!=null&&typeof u!="boolean"&&typeof u!="function"?(c=s+T,(u=i.__k[s]=typeof u=="string"||typeof u=="number"||typeof u=="bigint"||u.constructor==String?an(null,u,null,null,null):Ar(u)?an(dt,{children:u},null,null,null):u.constructor==null&&u.__b>0?an(u.type,u.props,u.key,u.ref?u.ref:null,u.__v):u).__=i,u.__b=i.__b+1,d=null,(a=u.__i=Bu(u,t,c,p))!=-1&&(p--,(d=t[a])&&(d.__u|=2)),d==null||d.__v==null?(a==-1&&(n>h?T--:n<h&&T++),typeof u.type!="function"&&(u.__u|=4)):a!=c&&(a==c-1?T--:a==c+1?T++:(a>c?T--:T++,u.__u|=4))):i.__k[s]=null;if(p)for(s=0;s<h;s++)(d=t[s])!=null&&!(2&d.__u)&&(d.__e==e&&(e=lr(d)),ui(d,d));return e}function si(i,r,t){var e,n;if(typeof i.type=="function"){for(e=i.__k,n=0;e&&n<e.length;n++)e[n]&&(e[n].__=i,r=si(e[n],r,t));return r}i.__e!=r&&(r&&i.type&&!t.contains(r)&&(r=lr(i)),t.insertBefore(i.__e,r||null),r=i.__e);do r=r&&r.nextSibling;while(r!=null&&r.nodeType==8);return r}function Ir(i,r){return r=r||[],i==null||typeof i=="boolean"||(Ar(i)?i.some(function(t){Ir(t,r)}):r.push(i)),r}function Bu(i,r,t,e){var n,s,u=i.key,d=i.type,c=r[t];if(c===null&&i.key==null||c&&u==c.key&&d==c.type&&!(2&c.__u))return t;if(e>(c!=null&&!(2&c.__u)?1:0))for(n=t-1,s=t+1;n>=0||s<r.length;){if(n>=0){if((c=r[n])&&!(2&c.__u)&&u==c.key&&d==c.type)return n;n--}if(s<r.length){if((c=r[s])&&!(2&c.__u)&&u==c.key&&d==c.type)return s;s++}}return-1}function Ya(i,r,t){r[0]=="-"?i.setProperty(r,t??""):i[r]=t==null?"":typeof t!="number"||Iu.test(r)?t:t+"px"}function nn(i,r,t,e,n){var s,u;e:if(r=="style")if(typeof t=="string")i.style.cssText=t;else{if(typeof e=="string"&&(i.style.cssText=e=""),e)for(r in e)t&&r in t||Ya(i.style,r,"");if(t)for(r in t)e&&t[r]==e[r]||Ya(i.style,r,t[r])}else if(r[0]=="o"&&r[1]=="n")s=r!=(r=r.replace(ti,"$1")),u=r.toLowerCase(),r=u in i||r=="onFocusOut"||r=="onFocusIn"?u.slice(2):r.slice(2),i.l||(i.l={}),i.l[r+s]=t,t?e?t.u=e.u:(t.u=Gn,i.addEventListener(r,s?jn:Fn,s)):i.removeEventListener(r,s?jn:Fn,s);else{if(n=="http://www.w3.org/2000/svg")r=r.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(r!="width"&&r!="height"&&r!="href"&&r!="list"&&r!="form"&&r!="tabIndex"&&r!="download"&&r!="rowSpan"&&r!="colSpan"&&r!="role"&&r!="popover"&&r in i)try{i[r]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&r[4]!="-"?i.removeAttribute(r):i.setAttribute(r,r=="popover"&&t==1?"":t))}}function Xa(i){return function(r){if(this.l){var t=this.l[r.type+i];if(r.t==null)r.t=Gn++;else if(r.t<t.u)return;return t(fe.event?fe.event(r):r)}}}function $n(i,r,t,e,n,s,u,d,c,a){var h,p,T,I,A,m,S,C,E,l,v,_,B,L,g,f,o,w=r.type;if(r.constructor!=null)return null;128&t.__u&&(c=!!(32&t.__u),s=[d=r.__e=t.__e]),(h=fe.__b)&&h(r);e:if(typeof w=="function")try{if(C=r.props,E="prototype"in w&&w.prototype.render,l=(h=w.contextType)&&e[h.__c],v=h?l?l.props.value:h.__:e,t.__c?S=(p=r.__c=t.__c).__=p.__E:(E?r.__c=p=new w(C,v):(r.__c=p=new _t(C,v),p.constructor=w,p.render=xu),l&&l.sub(p),p.props=C,p.state||(p.state={}),p.context=v,p.__n=e,T=p.__d=!0,p.__h=[],p._sb=[]),E&&p.__s==null&&(p.__s=p.state),E&&w.getDerivedStateFromProps!=null&&(p.__s==p.state&&(p.__s=Ot({},p.__s)),Ot(p.__s,w.getDerivedStateFromProps(C,p.__s))),I=p.props,A=p.state,p.__v=r,T)E&&w.getDerivedStateFromProps==null&&p.componentWillMount!=null&&p.componentWillMount(),E&&p.componentDidMount!=null&&p.__h.push(p.componentDidMount);else{if(E&&w.getDerivedStateFromProps==null&&C!==I&&p.componentWillReceiveProps!=null&&p.componentWillReceiveProps(C,v),!p.__e&&p.shouldComponentUpdate!=null&&p.shouldComponentUpdate(C,p.__s,v)===!1||r.__v==t.__v){for(r.__v!=t.__v&&(p.props=C,p.state=p.__s,p.__d=!1),r.__e=t.__e,r.__k=t.__k,r.__k.some(function(U){U&&(U.__=r)}),_=0;_<p._sb.length;_++)p.__h.push(p._sb[_]);p._sb=[],p.__h.length&&u.push(p);break e}p.componentWillUpdate!=null&&p.componentWillUpdate(C,p.__s,v),E&&p.componentDidUpdate!=null&&p.__h.push(function(){p.componentDidUpdate(I,A,m)})}if(p.context=v,p.props=C,p.__P=i,p.__e=!1,B=fe.__r,L=0,E){for(p.state=p.__s,p.__d=!1,B&&B(r),h=p.render(p.props,p.state,p.context),g=0;g<p._sb.length;g++)p.__h.push(p._sb[g]);p._sb=[]}else do p.__d=!1,B&&B(r),h=p.render(p.props,p.state,p.context),p.state=p.__s;while(p.__d&&++L<25);p.state=p.__s,p.getChildContext!=null&&(e=Ot(Ot({},e),p.getChildContext())),E&&!T&&p.getSnapshotBeforeUpdate!=null&&(m=p.getSnapshotBeforeUpdate(I,A)),f=h,h!=null&&h.type===dt&&h.key==null&&(f=ci(h.props.children)),d=ii(i,Ar(f)?f:[f],r,t,e,n,s,u,d,c,a),p.base=r.__e,r.__u&=-161,p.__h.length&&u.push(p),S&&(p.__E=p.__=null)}catch(U){if(r.__v=null,c||s!=null)if(U.then){for(r.__u|=c?160:128;d&&d.nodeType==8&&d.nextSibling;)d=d.nextSibling;s[s.indexOf(d)]=null,r.__e=d}else for(o=s.length;o--;)zn(s[o]);else r.__e=t.__e,r.__k=t.__k;fe.__e(U,r,t)}else s==null&&r.__v==t.__v?(r.__k=t.__k,r.__e=t.__e):d=r.__e=Nu(t.__e,r,t,e,n,s,u,c,a);return(h=fe.diffed)&&h(r),128&r.__u?void 0:d}function oi(i,r,t){for(var e=0;e<t.length;e++)Wn(t[e],t[++e],t[++e]);fe.__c&&fe.__c(r,i),i.some(function(n){try{i=n.__h,n.__h=[],i.some(function(s){s.call(n)})}catch(s){fe.__e(s,n.__v)}})}function ci(i){return typeof i!="object"||i==null||i.__b&&i.__b>0?i:Ar(i)?i.map(ci):Ot({},i)}function Nu(i,r,t,e,n,s,u,d,c){var a,h,p,T,I,A,m,S=t.props,C=r.props,E=r.type;if(E=="svg"?n="http://www.w3.org/2000/svg":E=="math"?n="http://www.w3.org/1998/Math/MathML":n||(n="http://www.w3.org/1999/xhtml"),s!=null){for(a=0;a<s.length;a++)if((I=s[a])&&"setAttribute"in I==!!E&&(E?I.localName==E:I.nodeType==3)){i=I,s[a]=null;break}}if(i==null){if(E==null)return document.createTextNode(C);i=document.createElementNS(n,E,C.is&&C),d&&(fe.__m&&fe.__m(r,s),d=!1),s=null}if(E==null)S===C||d&&i.data==C||(i.data=C);else{if(s=s&&on.call(i.childNodes),S=t.props||_r,!d&&s!=null)for(S={},a=0;a<i.attributes.length;a++)S[(I=i.attributes[a]).name]=I.value;for(a in S)if(I=S[a],a!="children"){if(a=="dangerouslySetInnerHTML")p=I;else if(!(a in C)){if(a=="value"&&"defaultValue"in C||a=="checked"&&"defaultChecked"in C)continue;nn(i,a,null,I,n)}}for(a in C)I=C[a],a=="children"?T=I:a=="dangerouslySetInnerHTML"?h=I:a=="value"?A=I:a=="checked"?m=I:d&&typeof I!="function"||S[a]===I||nn(i,a,I,S[a],n);if(h)d||p&&(h.__html==p.__html||h.__html==i.innerHTML)||(i.innerHTML=h.__html),r.__k=[];else if(p&&(i.innerHTML=""),ii(r.type=="template"?i.content:i,Ar(T)?T:[T],r,t,e,E=="foreignObject"?"http://www.w3.org/1999/xhtml":n,s,u,s?s[0]:t.__k&&lr(t,0),d,c),s!=null)for(a=s.length;a--;)zn(s[a]);d||(a="value",E=="progress"&&A==null?i.removeAttribute("value"):A!=null&&(A!==i[a]||E=="progress"&&!A||E=="option"&&A!=S[a])&&nn(i,a,A,S[a],n),a="checked",m!=null&&m!=i[a]&&nn(i,a,m,S[a],n))}return i}function Wn(i,r,t){try{if(typeof i=="function"){var e=typeof i.__u=="function";e&&i.__u(),e&&r==null||(i.__u=i(r))}else i.current=r}catch(n){fe.__e(n,t)}}function ui(i,r,t){var e,n;if(fe.unmount&&fe.unmount(i),(e=i.ref)&&(e.current&&e.current!=i.__e||Wn(e,null,r)),(e=i.__c)!=null){if(e.componentWillUnmount)try{e.componentWillUnmount()}catch(s){fe.__e(s,r)}e.base=e.__P=null}if(e=i.__k)for(n=0;n<e.length;n++)e[n]&&ui(e[n],r,t||typeof i.type!="function");t||zn(i.__e),i.__c=i.__=i.__e=void 0}function xu(i,r,t){return this.constructor(i,t)}function wr(i,r,t){var e,n,s,u;r==document&&(r=document.documentElement),fe.__&&fe.__(i,r),n=(e=typeof t=="function")?null:t&&t.__k||r.__k,s=[],u=[],$n(r,i=(!e&&t||r).__k=Yt(dt,null,[i]),n||_r,_r,r.namespaceURI,!e&&t?[t]:n?null:r.firstChild?on.call(r.childNodes):null,s,!e&&t?t:n?n.__e:r.firstChild,e,u),oi(s,i,u)}function ke(i){function r(t){var e,n;return this.getChildContext||(e=new Set,(n={})[r.__c]=this,this.getChildContext=function(){return n},this.componentWillUnmount=function(){e=null},this.shouldComponentUpdate=function(s){this.props.value!=s.value&&e.forEach(function(u){u.__e=!0,qn(u)})},this.sub=function(s){e.add(s);var u=s.componentWillUnmount;s.componentWillUnmount=function(){e&&e.delete(s),u&&u.call(s)}}),t.children}return r.__c="__cC"+ri++,r.__=i,r.Provider=r.__l=(r.Consumer=function(t,e){return t.children(e)}).contextType=r,r}on=ni.slice,fe={__e:function(i,r,t,e){for(var n,s,u;r=r.__;)if((n=r.__c)&&!n.__)try{if((s=n.constructor)&&s.getDerivedStateFromError!=null&&(n.setState(s.getDerivedStateFromError(i)),u=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(i,e||{}),u=n.__d),u)return n.__E=n}catch(d){i=d}throw i}},Ja=0,Au=function(i){return i!=null&&i.constructor==null},_t.prototype.setState=function(i,r){var t;t=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Ot({},this.state),typeof i=="function"&&(i=i(Ot({},t),this.props)),i&&Ot(t,i),i!=null&&this.__v&&(r&&this._sb.push(r),qn(this))},_t.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),qn(this))},_t.prototype.render=dt,Qt=[],Za=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,ei=function(i,r){return i.__v.__b-r.__v.__b},sn.__r=0,ti=/(PointerCapture)$|Capture$/i,Gn=0,Fn=Xa(!1),jn=Xa(!0),ri=0;var pr,Ie,Qn,li,un=0,vi=[],De=fe,pi=De.__b,fi=De.__r,di=De.diffed,hi=De.__c,yi=De.unmount,mi=De.__;function ln(i,r){De.__h&&De.__h(Ie,i,un||r),un=0;var t=Ie.__H||(Ie.__H={__:[],__h:[]});return i>=t.__.length&&t.__.push({}),t.__[i]}function ue(i){return un=1,bi(Ti,i)}function bi(i,r,t){var e=ln(pr++,2);if(e.t=i,!e.__c&&(e.__=[t?t(r):Ti(void 0,r),function(d){var c=e.__N?e.__N[0]:e.__[0],a=e.t(c,d);c!==a&&(e.__N=[a,e.__[1]],e.__c.setState({}))}],e.__c=Ie,!Ie.__f)){var n=function(d,c,a){if(!e.__c.__H)return!0;var h=e.__c.__H.__.filter(function(T){return!!T.__c});if(h.every(function(T){return!T.__N}))return!s||s.call(this,d,c,a);var p=e.__c.props!==d;return h.forEach(function(T){if(T.__N){var I=T.__[0];T.__=T.__N,T.__N=void 0,I!==T.__[0]&&(p=!0)}}),s&&s.call(this,d,c,a)||p};Ie.__f=!0;var s=Ie.shouldComponentUpdate,u=Ie.componentWillUpdate;Ie.componentWillUpdate=function(d,c,a){if(this.__e){var h=s;s=void 0,n(d,c,a),s=h}u&&u.call(this,d,c,a)},Ie.shouldComponentUpdate=n}return e.__N||e.__}function ht(i,r){var t=ln(pr++,3);!De.__s&&Ci(t.__H,r)&&(t.__=i,t.u=r,Ie.__H.__h.push(t))}function Xn(i){return un=5,Ei(function(){return{current:i}},[])}function Ei(i,r){var t=ln(pr++,7);return Ci(t.__H,r)&&(t.__=i(),t.__H=r,t.__h=i),t.__}function At(i){var r=Ie.context[i.__c],t=ln(pr++,9);return t.c=i,r?(t.__==null&&(t.__=!0,r.sub(Ie)),r.props.value):i.__}function ku(){for(var i;i=vi.shift();)if(i.__P&&i.__H)try{i.__H.__h.forEach(cn),i.__H.__h.forEach(Yn),i.__H.__h=[]}catch(r){i.__H.__h=[],De.__e(r,i.__v)}}De.__b=function(i){Ie=null,pi&&pi(i)},De.__=function(i,r){i&&r.__k&&r.__k.__m&&(i.__m=r.__k.__m),mi&&mi(i,r)},De.__r=function(i){fi&&fi(i),pr=0;var r=(Ie=i.__c).__H;r&&(Qn===Ie?(r.__h=[],Ie.__h=[],r.__.forEach(function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0})):(r.__h.forEach(cn),r.__h.forEach(Yn),r.__h=[],pr=0)),Qn=Ie},De.diffed=function(i){di&&di(i);var r=i.__c;r&&r.__H&&(r.__H.__h.length&&(vi.push(r)!==1&&li===De.requestAnimationFrame||((li=De.requestAnimationFrame)||Ru)(ku)),r.__H.__.forEach(function(t){t.u&&(t.__H=t.u),t.u=void 0})),Qn=Ie=null},De.__c=function(i,r){r.some(function(t){try{t.__h.forEach(cn),t.__h=t.__h.filter(function(e){return!e.__||Yn(e)})}catch(e){r.some(function(n){n.__h&&(n.__h=[])}),r=[],De.__e(e,t.__v)}}),hi&&hi(i,r)},De.unmount=function(i){yi&&yi(i);var r,t=i.__c;t&&t.__H&&(t.__H.__.forEach(function(e){try{cn(e)}catch(n){r=n}}),t.__H=void 0,r&&De.__e(r,t.__v))};var gi=typeof requestAnimationFrame=="function";function Ru(i){var r,t=function(){clearTimeout(e),gi&&cancelAnimationFrame(r),setTimeout(i)},e=setTimeout(t,35);gi&&(r=requestAnimationFrame(t))}function cn(i){var r=Ie,t=i.__c;typeof t=="function"&&(i.__c=void 0,t()),Ie=r}function Yn(i){var r=Ie;i.__c=i.__(),Ie=r}function Ci(i,r){return!i||i.length!==r.length||r.some(function(t,e){return t!==i[e]})}function Ti(i,r){return typeof r=="function"?r(i):r}function Si(i,r=2){let t=Number(i);if(isNaN(t)||t===0)return"0";let e=Math.abs(t),n=t<0?"-":"";return e>=1e12?n+(e/1e12).toFixed(r)+"T":e>=1e9?n+(e/1e9).toFixed(r)+"B":e>=1e6?n+(e/1e6).toFixed(r)+"M":e>=1e3?n+(e/1e3).toFixed(r)+"K":n+e.toFixed(r)}function Jn(i,r,t=4){let e=Number(i),n=Number(r);if(isNaN(e)||isNaN(n))return"0";let s=e/Math.pow(10,n);return s<1e-4&&s>0?s.toExponential(2):s<1?s.toFixed(6).replace(/\.?0+$/,""):s.toFixed(t).replace(/\.?0+$/,"")}function _i(i,r,t=!1){let e=Number(Jn(i,r));return isNaN(e)?"$0.00":t&&Math.abs(e)>=1e6?"$"+Si(e,0):new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:e<1?4:2,maximumFractionDigits:e<1?6:2}).format(e)}function Ai(i,r=18){let t=Number(i),e=Number(r);if(isNaN(t)||isNaN(e))return"0";let n=t/Math.pow(10,e);return Si(n,1)}function Lu(i){let r=Date.now(),t=i instanceof Date?i.getTime():i,e=r-t;if(e<0)return"future";let n=Math.floor(e/1e3),s=Math.floor(n/60),u=Math.floor(s/60),d=Math.floor(u/24),c=Math.floor(d/7),a=Math.floor(d/30),h=Math.floor(d/365);return n<30?"now":n<60?`${n}s`:s<60?`${s}m`:u<24?`${u}h`:d<7?`${d}d`:c<4?`${c}w`:a<12?`${a}mo`:`${h}y`}function Ii(i){let r=Date.now(),t=i instanceof Date?i.getTime():i,e=r-t;return e<36e5?Lu(i):e<864e5?new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"2-digit"}).format(new Date(t)):e<6048e5?new Intl.DateTimeFormat("en-US",{weekday:"short",hour:"numeric",minute:"2-digit"}).format(new Date(t)):new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}).format(new Date(t))}var Pu=0,Lp=Array.isArray;function V(i,r,t,e,n,s){r||(r={});var u,d,c=r;if("ref"in c)for(d in c={},r)d=="ref"?u=r[d]:c[d]=r[d];var a={type:i,props:c,key:t,ref:u,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Pu,__i:-1,__u:0,__source:n,__self:s};if(typeof i=="function"&&(u=i.defaultProps))for(d in u)c[d]===void 0&&(c[d]=u[d]);return fe.vnode&&fe.vnode(a),a}var wi=({balance:i,currency:r="USD",changePercent:t=null,changeAmount:e=null,className:n=""})=>{let[s,u]=ue(!0),d=h=>typeof h!="number"?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:r,minimumFractionDigits:2,maximumFractionDigits:2}).format(h),c=h=>{if(typeof h!="number")return"$0.00";let p=new Intl.NumberFormat("en-US",{style:"currency",currency:r,minimumFractionDigits:2,maximumFractionDigits:2}).format(Math.abs(h));return h>=0?`+${p}`:`-${p}`},a=t!==null?t>=0:!1;return V("div",{className:`relative w-full max-w-xl ${n}`,children:V("div",{className:"card bg-base-100 shadow-xl border border-base-300 relative overflow-hidden rounded-2xl p-6 mb-1",children:[V("div",{className:"absolute inset-0 bg-gradient-to-br from-base-content/5 to-transparent"}),V("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-base-content/5 rounded-full blur-xl"}),V("div",{className:"absolute -bottom-4 -left-4 w-32 h-32 bg-base-content/5 rounded-full blur-xl"}),V("div",{className:"relative z-10 space-y-4 flex flex-col justify-center items-center",children:[V("div",{className:"bg-base-content/10 backdrop-blur-sm rounded-lg p-3 space-y-2 w-full",children:[V("div",{className:"flex items-center justify-between",children:[V("span",{className:"text-sm text-base-content font-medium",children:"Balance"}),V("button",{onClick:()=>u(!s),className:"text-xs text-base-content/50 hover:text-base-content/70 transition-colors duration-200 p-1 rounded hover:bg-base-content/5",title:s?"Ocultar balance":"Mostrar balance",type:"button",children:s?"\u{1F441}\uFE0F":"\u{1F648}"})]}),V("div",{className:"flex items-center justify-center py-2",children:V("span",{className:"text-3xl font-bold text-base-content font-mono",children:s?d(i):"\u2022\u2022\u2022\u2022\u2022\u2022"})}),(t!==null||e!==null)&&s&&V("div",{className:"flex items-center justify-between",children:[V("span",{className:"text-sm text-base-content font-medium",children:"Cambio"}),V("div",{className:"flex items-center space-x-2",children:[e!==null&&V("span",{className:`text-sm font-mono ${a?"text-green-600":"text-red-600"}`,children:c(e)}),t!==null&&V("span",{className:`text-xs px-2 py-1 rounded-full ${a?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[a?"+":"",t.toFixed(2),"%"]})]})]}),!s&&V("div",{className:"flex items-center justify-center py-2",children:V("span",{className:"text-sm text-base-content/50",children:"Balance oculto"})})]}),V("div",{className:"w-full flex justify-center",children:V("span",{className:"text-xs text-base-content/50",children:["Actualizado: ",new Date().toLocaleTimeString()]})})]})]})})};var Bi=({userName:i,type:r,logout:t})=>{let{portfolio:e,refToken:n,update:s}=pn(),{account:u}=yt();return ht(()=>{s(e.trackedTokens)},[u]),V("div",{className:"flex flex-col gap-2 p-4 rounded-xl bg-base-100 w-full justify-center items-center max-w-xl",children:[V("div",{className:"flex items-center justify-between w-full",children:[V("h2",{className:"text-xl font-bold text-base-content",children:i}),V("button",{type:"button",className:"btn badge badge-outline capitalize text-sm",children:r=="free"?"Upgrade":"Premium"}),V("button",{type:"button",className:"btn btn-ghost text-sm text-base-content/60 hover:text-error transition-colors",onClick:()=>t(),children:"Cerrar sesi\xF3n"})]}),V(wi,{balance:Number(Jn(e.tokenData[n.address]?.balance??0,n.decimals))})]})};var Ni=({tabs:i})=>{let[r,t]=ue(0),[e,n]=ue(!1),{render:s}=fr(),u=d=>{d!==r&&(n(!0),setTimeout(()=>{t(d),n(!1)},150))};return V("div",{className:"w-full max-w-xl flex flex-col justify-center items-center",children:[V("div",{role:"tablist",className:"tabs tabs-border w-full",children:i.map((d,c)=>V("a",{role:"tab",className:`tab transition-all duration-200 ${r===c?"tab-active":""}`,onClick:()=>u(c),"aria-selected":r===c,children:d},c))}),V("div",{className:`flex justify-center mt-1 w-11/12 transition-all duration-300 ${e?"opacity-0 translate-y-2":"opacity-100 translate-y-0"}`,children:s(i[r])})]})};function xi({setSession:i}){let{login:r,register:t}=yt(),[e,n]=ue(!0),[s,u]=ue(""),[d,c]=ue(""),[a,h]=ue(""),[p,T]=ue(null),[I,A]=ue(null),[m,S]=ue(!1),[C,E]=ue(null);return V("div",{className:"max-w-md mx-auto mt-10 bg-base-100 p-6 rounded-xl shadow-lg space-y-4",children:[V("h2",{className:"text-lg font-bold text-center",children:e?"Iniciar sesi\xF3n":"Registro de nuevo usuario"}),V("form",{onSubmit:async v=>{v.preventDefault(),S(!0),E(null);try{if(e)await r(s,a);else{if(!p||!I)throw new Error("Debes subir ambos archivos .cer y .key");await t(d,p,I,a)}i(!0)}catch(_){E(_.message||"Ocurri\xF3 un error")}finally{S(!1)}},className:"space-y-4",children:[V("label",{className:"form-control w-full",children:[V("div",{className:"label",children:V("span",{className:"label-text",children:[" ",e?"RFC":"Nombre de usuario"]})}),V("input",{type:"text",className:"input input-bordered w-full",value:e?s:d,onInput:v=>e?u(v.target.value):c(v.target.value),required:!0})]}),V("label",{className:"form-control w-full",children:[V("div",{className:"label",children:V("span",{className:"label-text",children:"Contrase\xF1a"})}),V("input",{type:"password",className:"input input-bordered w-full",value:a,onInput:v=>h(v.target.value),required:!0})]}),!e&&V(dt,{children:[V("label",{className:"form-control w-full",children:[V("div",{className:"label",children:V("span",{className:"label-text",children:"Archivo .cer"})}),V("input",{type:"file",accept:".cer",className:"file-input file-input-bordered w-full",onChange:v=>T(v.target.files?.[0]||null),required:!0})]}),V("label",{className:"form-control w-full",children:[V("div",{className:"label",children:V("span",{className:"label-text",children:"Archivo .key"})}),V("input",{type:"file",accept:".key",className:"file-input file-input-bordered w-full",onChange:v=>A(v.target.files?.[0]||null),required:!0})]})]}),C&&V("div",{className:"text-error text-sm text-center",children:C}),V("button",{type:"submit",className:"btn btn-primary w-full mt-2",disabled:m,children:m?"Procesando...":e?"Iniciar sesi\xF3n":"Registrarse"})]}),V("div",{className:"text-center text-sm",children:[e?"\xBFNo tienes cuenta?":"\xBFYa tienes cuenta?"," ",V("button",{type:"button",onClick:()=>n(!e),className:"text-primary underline hover:text-primary-focus",children:e?"Reg\xEDstrate aqu\xED":"Inicia sesi\xF3n aqu\xED"})]})]})}var fn=()=>{let{account:i,getSession:r,logout:t}=yt(),{userName:e,type:n}=i,[s,u]=ue(!0),[d,c]=ue(null);return ht(()=>{d===null&&r().then(a=>c(a)).catch(a=>{console.warn("[Session]","No activa o inv\xE1lida:",a)}).finally(()=>{u(!1)})},[d]),s?V("div",{className:"w-full h-screen flex items-center justify-center",children:V("span",{className:"loading loading-spinner loading-lg text-primary"})}):d?V("div",{className:"w-full flex flex-col justify-center items-center",children:[V(Bi,{userName:e,type:n,logout:()=>{t(),c(null)}}),V(Ni,{tabs:["Cuenta","Portafolio"]})]}):V("div",{className:"w-full flex flex-col justify-center items-center",children:V(xi,{setSession:c})})};var ki=[{role:"system",content:`Eres un ingeniero de prompts.

Tu tarea es transformar entradas del usuario en un prompt estructurado para que otro modelo de lenguaje las procese.

Debes seguir estas reglas:

1. No interpretes el contenido ni inventes detalles adicionales.
2. Usa los siguientes valores fijos por defecto:
   - context: "Asistente especializado en automatizaci\xF3n de tareas t\xE9cnicas en el navegador, firma digital, control seguro de acciones del usuario, blockchains EVM, Web3 y asistencia basada en modelos de lenguaje."
   - constraints: "Responder de forma clara, sin inventar informaci\xF3n, y sin salirse del tema."

3. El campo "task" debe describir con claridad lo que el modelo debe hacer.
4. El campo "format" debe deducirse si es evidente (ej: lista, texto explicativo, tabla, JSON...).
5. Devuelve \xFAnicamente el JSON como bloque Markdown, sin texto antes ni despu\xE9s.

Formato de salida:
\`\`\`json
{
  "context": "...",
  "task": "...",
  "format": "...",
  "constraints": "...",
  "input": "..."
}
\`\`\``},{role:"user",content:"Expl\xEDcame c\xF3mo funciona la firma electr\xF3nica en M\xE9xico"},{role:"assistant",content:`\`\`\`json
{
  "context": "Asistente especializado en automatizaci\xF3n de tareas t\xE9cnicas en el navegador, firma digital, control seguro de acciones del usuario, blockchains EVM, Web3 y asistencia basada en modelos de lenguaje.",
  "task": "Explicar c\xF3mo funciona la firma electr\xF3nica en M\xE9xico.",
  "format": "Texto explicativo estructurado.",
  "constraints": "Responder de forma clara, sin inventar informaci\xF3n, y sin salirse del tema.",
  "input": "Expl\xEDcame c\xF3mo funciona la firma electr\xF3nica en M\xE9xico"
}
\`\`\``},{role:"user",content:"Hazme un resumen en bullets de los beneficios de usar Deno"},{role:"assistant",content:`\`\`\`json
{
  "context": "Asistente especializado en automatizaci\xF3n de tareas t\xE9cnicas en el navegador, firma digital, control seguro de acciones del usuario, blockchains EVM, Web3 y asistencia basada en modelos de lenguaje.",
  "task": "Resumir los beneficios de usar Deno.",
  "format": "Lista con vi\xF1etas.",
  "constraints": "Responder de forma clara, sin inventar informaci\xF3n, y sin salirse del tema.",
  "input": "Hazme un resumen en bullets de los beneficios de usar Deno"
}
\`\`\``}];var Ri=[{role:"system",content:`Eres un asistente experto en tareas t\xE9cnicas, automatizaci\xF3n y control de acciones.

Tu comportamiento debe ser el siguiente:

1. Si el usuario solo busca informaci\xF3n, responde normalmente.
2. Si detectas una solicitud que requiere acci\xF3n (como abrir una URL, firmar un documento, leer un archivo), **no ejecutes la acci\xF3n ni des un resultado completo**, sino:
   - Detecta claramente la intenci\xF3n (accionable).
   - Extrae los datos relevantes (URL, ID de documento, ruta de archivo, etc).
   - Devuelve \xFAnicamente un prompt limpio y expl\xEDcito que ser\xE1 usado por el gestor de acciones.

Formato de respuesta:
- Primero, una breve confirmaci\xF3n textual si aplica.
- En una nueva l\xEDnea, escribe:

Prompt para acci\xF3n:
"Abre el sitio web de https://..."
"Firma el documento con ID ..."
"Lee el archivo en la ruta ..."

**Nunca generes el JSON t\xFA mismo. Nunca ejecutes la acci\xF3n t\xFA mismo.**
**Valida urls**

Aseg\xFArate de que el texto del prompt siga el mismo formato que los ejemplos anteriores.`},{role:"user",content:"Quiero abrir el sitio camax.dev"},{role:"assistant",content:`Claro, puedo ayudarte con eso.

Prompt para acci\xF3n:
"Abre el sitio web de https://camax.dev"`},{role:"user",content:"Necesito firmar el contrato con ID abc123"},{role:"assistant",content:`Perfecto. Generar\xE9 una instrucci\xF3n para eso.

Prompt para acci\xF3n:
"Firma el documento con ID abc123"`},{role:"user",content:"Mu\xE9strame el archivo que est\xE1 en /home/user/test.txt"},{role:"assistant",content:`Entendido, eso requiere leer un archivo.

Prompt para acci\xF3n:
"Lee el archivo en la ruta /home/user/test.txt"`}];var Li=[{role:"system",content:`Eres un agente que responde \xFAnicamente con una acci\xF3n en formato JSON. Las acciones posibles son:
- open_url
- read_file
- sign_document
- search_query

Formato:
{
  "action": "action_name",
  "params": {
    // par\xE1metros espec\xEDficos
  }
}

**Mantente dentro de las acciones implementadas**

Si la acci\xF3n involucra abrir una URL (por ejemplo, de YouTube), **no inventes enlaces**. 
En su lugar, genera una acci\xF3n con tipo "search_query" y proporciona el motor ("youtube", "google", etc.) y la frase exacta de b\xFAsqueda.

Ejemplo:
{
  "action": "search_query",
  "params": {
    "engine": "youtube",
    "query": "no pasa nada de RIA"
  }
}

No incluyas texto adicional. Solo responde con el JSON.`},{role:"user",content:"Abre el sitio web de camax.dev"},{role:"assistant",content:`{
  "action": "open_url",
  "params": {
    "url": "https://camax.dev"
  }
}`},{role:"user",content:"Firma el documento con el ID 12345"},{role:"assistant",content:`{
  "action": "sign_document",
  "params": {
    "document": "12345"
  }
}`}];function Pi(i){let r=i.match(/Prompt para acción:\s*["“](.+?)["”]/);return r?r[1]:null}var Ui=()=>{let[i,r]=ue(!1),[t,e]=ue([]),[n,s]=ue(""),[u,d]=ue(!1),c=Xn(null),a=dn();ht(()=>{globalThis.Jaime=async(T,I=[])=>{let A=await LanguageModel.create({temperature:1,topK:5,initialPrompts:ki}),m=await LanguageModel.create({temperature:.1,topK:2,initialPrompts:[...Ri,...I]}),S=await LanguageModel.create({temperature:.1,topK:2,initialPrompts:Li}),C=await A.prompt(T);console.log(C);let E=await m.prompt(C);console.log(E);let l=Pi(E);if(console.log(l),l){let v=JSON.parse(await S.prompt(E));a.request("model_action",v)}return E},r(!0)},[]),ht(()=>{c.current?.scrollIntoView({behavior:"smooth"})},[t]);let h=async()=>{if(!n.trim()||u)return;let T={role:"user",content:n};e(m=>[...m,T]),s(""),d(!0);let A={role:"assistant",content:await globalThis.Jaime(n,t)};e(m=>[...m,A]),d(!1)},p=T=>{T.key==="Enter"&&h()};return V("div",{className:"h-full w-full bg-base-200 p-4 flex flex-col",children:[V("div",{className:"card bg-base-100 shadow-lg mb-4",children:V("div",{className:"card-body p-4",children:[V("h2",{className:"card-title text-lg mb-2",children:"Jaime"}),V("div",{className:"flex items-center gap-2 text-sm opacity-70",children:[V("div",{className:`w-2 h-2 rounded-full ${i?"bg-success":"bg-error"}`}),V("span",{children:i?"Connected":"Connecting..."})]})]})}),V("div",{className:"card bg-base-100 shadow-lg flex-1 flex flex-col overflow-hidden",children:[V("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[t.map((T,I)=>V("div",{className:`flex ${T.role==="user"?"justify-end":T.role==="system"?"justify-center":"justify-start"}`,children:V("div",{className:`max-w-xs md:max-w-md lg:max-w-lg xl:max-w-xl px-4 py-2 rounded-2xl text-sm ${T.role==="user"?"bg-primary text-primary-content":T.role==="assistant"?"bg-base-200 text-base-content":"bg-warning text-warning-content text-center text-xs"}`,children:T.content})},I)),u&&V("div",{className:"flex justify-start",children:V("div",{className:"bg-base-200 text-base-content px-4 py-2 rounded-2xl flex items-center gap-2",children:[V("span",{className:"text-sm",children:"Thinking"}),V("div",{className:"flex gap-1",children:[V("div",{className:"w-1 h-1 bg-current rounded-full animate-bounce"}),V("div",{className:"w-1 h-1 bg-current rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),V("div",{className:"w-1 h-1 bg-current rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})}),V("div",{ref:c})]}),V("div",{className:"border-t border-base-300 p-4",children:V("div",{className:"flex gap-2",children:[V("input",{type:"text",placeholder:"Preg\xFAntame cualquier cosa sobre esta p\xE1gina o dame una tarea...",className:"input input-bordered flex-1 rounded-full text-sm",value:n,onInput:T=>s(T.target.value),onKeyPress:p,disabled:u}),V("button",{type:"button",className:"btn btn-primary rounded-full px-6",onClick:h,disabled:u||!n.trim(),children:"Enviar"})]})})]})]})};var Di="test";var Uu=[{id:"0x66eee",name:"Arbitrum Sepolia",nativeCurrency:{name:"Arbitrum Sepolia Ether",symbol:"ETH",decimals:18},rpcUrl:"https://sepolia-rollup.arbitrum.io/rpc"},{id:"0x14a34",name:"Base Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrl:"https://sepolia.base.org"},{id:"0xaa36a7",name:"Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrl:"https://sepolia.drpc.org"},{id:"0xaa37dc",name:"OP Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrl:"https://sepolia.optimism.io"}],Bt=Di=="test"?Uu:[{id:"0xa4b1",name:"Arbitrum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrl:"https://arb1.arbitrum.io/rpc",tokens:{link:"0xf97f4df75117a78c1A5a0DBb814Af92458539FB4"},contracts:{CCIPDirectory:{router:"0x141fa059441E0ca23ce184B6A78bafD2A517DdE8"},AutomationDirectory:{registry:"0x37D9dC70bfcd8BC77Ec2858836B923c560E891D1",registrar:"0x86EFBD0b6736Bed994962f9797049422A3A8E8Ad"}}},{id:"0x2105",name:"Base",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrl:"https://mainnet.base.org",tokens:{link:"0x88Fb150BDc53A65fe94Dea0c9BA0a6dAf8C6e196"},contracts:{CCIPDirectory:{router:"0x881e3A65B4d4a04dD529061dd0071cf975F58bCD"},AutomationDirectory:{registry:"0xf4bAb6A129164aBa9B113cB96BA4266dF49f8743",registrar:"0xE28Adc50c7551CFf69FCF32D45d037e5F6554264"}}},{id:"0xa",name:"OP Mainnet",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrl:"https://mainnet.optimism.io",tokens:{link:"0x350a791Bfc2C21F9Ed5d10980Dad2e2638ffa7f6",WETH:"0x4200000000000000000000000000000000000006"},contracts:{CCIPDirectory:{router:"0x3206695CaE29952f4b0c22a169725a865bc8Ce0f"},AutomationDirectory:{registry:"0x4F70c323b8B72AeffAF633Aa4D5e8B6Be5df4AEf",registrar:"0xe96057F85510292231e2C759752f012C87A8c8dd"}}}],Du=Di=="test"?"0x14a34":"0x2105",Sf=Bt.find(i=>i.id==Du)??{name:"base",id:"0x2105",rpcUrl:"https://mainnet.base.org"};function Vu(i,r){for(var t in r)i[t]=r[t];return i}function Oi(i,r){for(var t in i)if(t!=="__source"&&!(t in r))return!0;for(var e in r)if(e!=="__source"&&i[e]!==r[e])return!0;return!1}function Vi(i,r){this.props=i,this.context=r}(Vi.prototype=new _t).isPureReactComponent=!0,Vi.prototype.shouldComponentUpdate=function(i,r){return Oi(this.props,i)||Oi(this.state,r)};var Mi=fe.__b;fe.__b=function(i){i.type&&i.type.__f&&i.ref&&(i.props.ref=i.ref,i.ref=null),Mi&&Mi(i)};var Uf=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;var Mu=fe.__e;fe.__e=function(i,r,t,e){if(i.then){for(var n,s=r;s=s.__;)if((n=s.__c)&&n.__c)return r.__e==null&&(r.__e=t.__e,r.__k=t.__k),n.__c(i,r)}Mu(i,r,t,e)};var Ki=fe.unmount;function zi(i,r,t){return i&&(i.__c&&i.__c.__H&&(i.__c.__H.__.forEach(function(e){typeof e.__c=="function"&&e.__c()}),i.__c.__H=null),(i=Vu({},i)).__c!=null&&(i.__c.__P===t&&(i.__c.__P=r),i.__c.__e=!0,i.__c=null),i.__k=i.__k&&i.__k.map(function(e){return zi(e,r,t)})),i}function $i(i,r,t){return i&&t&&(i.__v=null,i.__k=i.__k&&i.__k.map(function(e){return $i(e,r,t)}),i.__c&&i.__c.__P===r&&(i.__e&&t.appendChild(i.__e),i.__c.__e=!0,i.__c.__P=t)),i}function Zn(){this.__u=0,this.o=null,this.__b=null}function Wi(i){var r=i.__.__c;return r&&r.__a&&r.__a(i)}function hn(){this.i=null,this.l=null}fe.unmount=function(i){var r=i.__c;r&&r.__R&&r.__R(),r&&32&i.__u&&(i.type=null),Ki&&Ki(i)},(Zn.prototype=new _t).__c=function(i,r){var t=r.__c,e=this;e.o==null&&(e.o=[]),e.o.push(t);var n=Wi(e.__v),s=!1,u=function(){s||(s=!0,t.__R=null,n?n(d):d())};t.__R=u;var d=function(){if(!--e.__u){if(e.state.__a){var c=e.state.__a;e.__v.__k[0]=$i(c,c.__c.__P,c.__c.__O)}var a;for(e.setState({__a:e.__b=null});a=e.o.pop();)a.forceUpdate()}};e.__u++||32&r.__u||e.setState({__a:e.__b=e.__v.__k[0]}),i.then(u,u)},Zn.prototype.componentWillUnmount=function(){this.o=[]},Zn.prototype.render=function(i,r){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),e=this.__v.__k[0].__c;this.__v.__k[0]=zi(this.__b,t,e.__O=e.__P)}this.__b=null}var n=r.__a&&Yt(dt,null,i.fallback);return n&&(n.__u&=-33),[Yt(dt,null,r.__a?null:i.children),n]};var Hi=function(i,r,t){if(++t[1]===t[0]&&i.l.delete(r),i.props.revealOrder&&(i.props.revealOrder[0]!=="t"||!i.l.size))for(t=i.i;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;i.i=t=t[2]}};function Ku(i){return this.getChildContext=function(){return i.context},i.children}function Hu(i){var r=this,t=i.h;if(r.componentWillUnmount=function(){wr(null,r.v),r.v=null,r.h=null},r.h&&r.h!==t&&r.componentWillUnmount(),!r.v){for(var e=r.__v;e!==null&&!e.__m&&e.__!==null;)e=e.__;r.h=t,r.v={nodeType:1,parentNode:t,childNodes:[],__k:{__m:e.__m},contains:function(){return!0},insertBefore:function(n,s){this.childNodes.push(n),r.h.insertBefore(n,s)},removeChild:function(n){this.childNodes.splice(this.childNodes.indexOf(n)>>>1,1),r.h.removeChild(n)}}}wr(Yt(Ku,{context:r.context},i.__v),r.v)}function Qi(i,r){var t=Yt(Hu,{__v:i,h:r});return t.containerInfo=r,t}(hn.prototype=new _t).__a=function(i){var r=this,t=Wi(r.__v),e=r.l.get(i);return e[0]++,function(n){var s=function(){r.props.revealOrder?(e.push(n),Hi(r,i,e)):n()};t?t(s):s()}},hn.prototype.render=function(i){this.i=null,this.l=new Map;var r=Ir(i.children);i.revealOrder&&i.revealOrder[0]==="b"&&r.reverse();for(var t=r.length;t--;)this.l.set(r[t],this.i=[1,0,this.i]);return i.children},hn.prototype.componentDidUpdate=hn.prototype.componentDidMount=function(){var i=this;this.l.forEach(function(r,t){Hi(i,t,r)})};var Fu=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,ju=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,qu=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Gu=/[A-Z0-9]/g,zu=typeof document<"u",$u=function(i){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(i)};_t.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(i){Object.defineProperty(_t.prototype,i,{configurable:!0,get:function(){return this["UNSAFE_"+i]},set:function(r){Object.defineProperty(this,i,{configurable:!0,writable:!0,value:r})}})});var Fi=fe.event;function Wu(){}function Qu(){return this.cancelBubble}function Yu(){return this.defaultPrevented}fe.event=function(i){return Fi&&(i=Fi(i)),i.persist=Wu,i.isPropagationStopped=Qu,i.isDefaultPrevented=Yu,i.nativeEvent=i};var Yi,Xu={enumerable:!1,configurable:!0,get:function(){return this.class}},ji=fe.vnode;fe.vnode=function(i){typeof i.type=="string"&&function(r){var t=r.props,e=r.type,n={},s=e.indexOf("-")===-1;for(var u in t){var d=t[u];if(!(u==="value"&&"defaultValue"in t&&d==null||zu&&u==="children"&&e==="noscript"||u==="class"||u==="className")){var c=u.toLowerCase();u==="defaultValue"&&"value"in t&&t.value==null?u="value":u==="download"&&d===!0?d="":c==="translate"&&d==="no"?d=!1:c[0]==="o"&&c[1]==="n"?c==="ondoubleclick"?u="ondblclick":c!=="onchange"||e!=="input"&&e!=="textarea"||$u(t.type)?c==="onfocus"?u="onfocusin":c==="onblur"?u="onfocusout":qu.test(u)&&(u=c):c=u="oninput":s&&ju.test(u)?u=u.replace(Gu,"-$&").toLowerCase():d===null&&(d=void 0),c==="oninput"&&n[u=c]&&(u="oninputCapture"),n[u]=d}}e=="select"&&n.multiple&&Array.isArray(n.value)&&(n.value=Ir(t.children).forEach(function(a){a.props.selected=n.value.indexOf(a.props.value)!=-1})),e=="select"&&n.defaultValue!=null&&(n.value=Ir(t.children).forEach(function(a){a.props.selected=n.multiple?n.defaultValue.indexOf(a.props.value)!=-1:n.defaultValue==a.props.value})),t.class&&!t.className?(n.class=t.class,Object.defineProperty(n,"className",Xu)):(t.className&&!t.class||t.class&&t.className)&&(n.class=n.className=t.className),r.props=n}(i),i.$$typeof=Fu,ji&&ji(i)};var qi=fe.__r;fe.__r=function(i){qi&&qi(i),Yi=i.__c};var Gi=fe.diffed;fe.diffed=function(i){Gi&&Gi(i);var r=i.props,t=i.__e;t!=null&&i.type==="textarea"&&"value"in r&&r.value!==t.value&&(t.value=r.value==null?"":r.value),Yi=null};var Xi=({children:i})=>{let r=document.getElementById("root");return r?Qi(i,r):(console.warn("No se encontr\xF3 #root"),null)};var Ji=({className:i})=>{let{account:r,select:t,create:e}=yt(),{activeAccount:n,keys:s,efirma:u}=r,{ensName:d,public:c}=n,a=Bt.map(g=>g.name).join(", "),[h,p]=ue(!1),[T,I]=ue(!1),A=`${c.slice(0,10)}...${c.slice(-10)}`,[m,S]=ue(""),[C,E]=ue(""),[l,v]=ue(!1),[_,B]=ue(""),L=async()=>{try{await navigator.clipboard.writeText(d||c),I(!0),setTimeout(()=>I(!1),2e3)}catch(g){console.error("Error al copiar:",g)}};return V("div",{className:`relative w-full max-w-xl ${i??""}`,children:[V("div",{className:"w-full relative z-10 p-1 gap-2 flex justify-between",children:[s.length>0&&V("select",{className:"select select-bordered",onChange:g=>{let f=s.find(o=>o.public===g.currentTarget.value);f&&t(f.public)},value:n.public,children:s.map(g=>V("option",{value:g.public,children:g.tag??g.public.slice(0,12)+"..."},g.public))}),V("button",{type:"button",className:"btn btn-sm btn-outline",onClick:()=>v(!0),children:"\uFF0B"})]}),l&&V(Xi,{children:V("div",{className:"modal modal-open fixed z-[9999] overflow-hidden",role:"dialog",style:"scrollbar-width: none;",children:[V("div",{className:"modal-box",children:[V("h3",{className:"font-bold text-lg",children:"Crear nueva llave"}),V("p",{className:"py-2 text-sm text-base-content/70",children:"Confirma tu contrase\xF1a y etiqueta para generar una nueva clave."}),V("form",{className:"space-y-3",onSubmit:g=>{g.preventDefault(),e(C,m.trim()).then(()=>{S(""),E(""),v(!1)}).catch(f=>{B(f.message),E("")})},children:[V("input",{type:"text",placeholder:"Etiqueta (opcional)",value:m,onInput:g=>S(g.target.value),className:"input input-bordered w-full"}),V("input",{type:"password",placeholder:"Contrase\xF1a",required:!0,value:C,onInput:g=>E(g.target.value),className:"input input-bordered w-full"}),_&&V("div",{className:"text-error text-sm text-center",children:_}),V("div",{className:"modal-action",children:[V("button",{type:"button",className:"btn btn-ghost",onClick:()=>v(!1),children:"Cancelar"}),V("button",{type:"submit",className:"btn btn-primary",children:"Crear"})]})]})]}),V("div",{className:"modal-backdrop",onClick:()=>v(!1)})]})}),V("div",{className:"card bg-base-100 shadow-xl border border-base-300 relative overflow-hidden rounded-2xl p-6",children:[V("div",{className:"absolute inset-0 bg-gradient-to-br from-base-content/5 to-transparent"}),V("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-base-content/5 rounded-full blur-xl"}),V("div",{className:"absolute -bottom-4 -left-4 w-32 h-32 bg-base-content/5 rounded-full blur-xl"}),V("div",{className:"relative z-10 space-y-4 flex flex-col justify-center items-center",children:[V("div",{className:"bg-base-content/10 backdrop-blur-sm rounded-lg p-3 space-y-2 w-full",children:[V("div",{className:"flex items-center justify-between",children:[V("span",{className:"text-sm text-base-content font-medium",children:"Cuenta"}),V("div",{className:"flex items-center space-x-2",children:[V("button",{type:"button",className:"text-xs text-base-content/50 hover:text-base-content/70 transition-colors duration-200 p-1 rounded hover:bg-base-content/5",title:T?"\xA1Copiado!":"Copiar direcci\xF3n",onClick:L,children:T?"\u2714\uFE0F":"\u{1F4C4}"}),V("span",{className:`text-sm font-mono transition-colors duration-200 ${T?"text-green-600 font-semibold":"text-base-content/70"}`,children:d||A})]})]}),V("div",{className:"flex items-center justify-between",children:[V("span",{className:"text-sm text-base-content font-medium",children:"Redes"}),V("span",{className:"text-sm text-base-content/70",children:a})]})]}),u&&h&&V("div",{className:"bg-base-content/5 backdrop-blur-sm rounded-lg p-3 space-y-2 border border-base-content/10 w-full",children:[V("div",{className:"flex items-center justify-between",children:[V("span",{className:"text-sm text-base-content font-medium",children:"Nombre"}),V("span",{className:"text-xs text-base-content/70 font-mono break-all",children:u.certificate.subject.commonName})]}),V("div",{className:"flex items-center justify-between",children:[V("span",{className:"text-sm text-base-content font-medium",children:"RFC"}),V("span",{className:"text-xs text-base-content/70 font-mono overflow-auto",children:u.certificate.subject.RFC})]}),V("div",{className:"flex items-center justify-between",children:[V("span",{className:"text-sm text-base-content font-medium",children:"email"}),V("span",{className:"text-xs text-base-content/70 font-mono overflow-auto",children:u.certificate.subject.emailAddress})]}),V("div",{className:"flex flex-col",children:[V("span",{className:"text-sm text-base-content font-medium mb-1",children:"Emisor"}),V("span",{className:"text-xs text-base-content/70 break-all",children:u.certificate.issuer.commonName})]}),V("div",{className:"flex flex-col",children:[V("span",{className:"text-sm text-base-content font-medium mb-1",children:"Vigencia"}),V("span",{className:"text-xs text-base-content/70",children:[new Date(u.certificate.validity.notBefore).toLocaleString("es-MX")," ","\u2192"," ",new Date(u.certificate.validity.notAfter).toLocaleString("es-MX")]})]})]}),u&&V("div",{className:"w-full flex justify-center",children:V("button",{type:"button",className:"text-xs text-base-content/50 hover:text-base-content/70 transition-colors duration-200 underline decoration-dotted underline-offset-2",onClick:()=>p(!h),children:h?"Ocultar detalles":"M\xE1s informaci\xF3n"})})]})]})]})};var Zi=()=>{let{trackedTokens:i,add:r,remove:t,portfolio:e,update:n}=pn(),[s,u]=ue(""),[d,c]=ue(""),[a,h]=ue(""),[p,T]=ue(!1),[I,A]=ue(!1),[m,S]=ue(!1),C=o=>/^0x[a-fA-F0-9]{40}$/.test(o),E=()=>{A(!0),n(i).then(()=>A(!1))},l=async()=>{let o=s.trim();if(!o){h("Por favor ingresa una direcci\xF3n de token");return}if(!C(o)){h("Por favor ingresa una direcci\xF3n EVM v\xE1lida (0x...)");return}if(i.some(w=>w.address===o)){h("Ya existe un token con esta direcci\xF3n");return}A(!0),h("");try{await r(o,d),u(""),T(!1)}catch(w){h("Error al obtener informaci\xF3n del token. Verifica la direcci\xF3n."),console.error(w)}finally{A(!1)}},v=o=>{t(o)},_=o=>{let w=o.target;u(w.value),a&&h("")},B=()=>{T(!0),h(""),u("")},L=()=>{T(!1),h(""),u("")},g=o=>{o.key==="Enter"&&!I&&l(),o.key==="Escape"&&L()},f=async o=>{try{await navigator.clipboard.writeText(o)}catch(w){console.error("Error al copiar:",w)}};return V("div",{className:"flex flex-col justify-center items-center w-full max-w-xl",children:[V("div",{className:"w-full relative z-10 p-1 gap-2 flex justify-end",children:[V("button",{type:"button",onClick:()=>E(),className:"px-3 py-1.5 bg-base-content/10 hover:bg-base-content/20 text-base-content rounded-lg transition-colors duration-200 text-sm",title:"Actualizar",children:"\u27F3"}),V("button",{type:"button",onClick:B,className:"px-3 py-1.5 bg-base-content/10 hover:bg-base-content/20 text-base-content rounded-lg transition-colors duration-200 text-sm",title:"Agregar nuevo token",children:"+"}),V("button",{type:"button",onClick:()=>S(!m),className:"px-3 py-1.5 bg-base-content/10 hover:bg-base-content/20 text-base-content rounded-lg transition-colors duration-200 text-sm",title:m?"Ocultar opciones de eliminar":"Mostrar opciones de eliminar",children:m?"\u2715":"\u{1F4DD}"})]}),V("div",{className:"w-full space-y-4",children:i.length===0?V("div",{className:"card bg-base-100 shadow-xl border border-base-300 relative overflow-hidden rounded-2xl p-8",children:[V("div",{className:"absolute inset-0 bg-gradient-to-br from-base-content/5 to-transparent"}),V("div",{className:"relative z-10 text-center text-base-content/70",children:[V("p",{className:"text-lg",children:"No hay tokens agregados a\xFAn."}),V("p",{className:"text-sm mt-2",children:"Agrega tu primer token para comenzar a rastrear tu portafolio."})]})]}):V("div",{className:"card bg-base-100 shadow-xl border border-base-300 relative overflow-hidden rounded-2xl p-4",children:[V("div",{className:"absolute inset-0 bg-gradient-to-br from-base-content/5 to-transparent"}),V("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-base-content/5 rounded-full blur-xl"}),V("div",{className:"absolute -bottom-4 -left-4 w-32 h-32 bg-base-content/5 rounded-full blur-xl"}),V("div",{className:"relative z-10",children:[V("div",{className:"flex items-center justify-between p-3 mb-2 border-b border-base-content/10",children:[V("div",{className:"text-sm font-medium text-base-content/70",children:"Token"}),V("div",{className:"text-sm font-medium text-base-content/70",children:"Balance"})]}),V("div",{className:"space-y-3",children:i.map((o,w)=>V("div",{className:`flex items-center justify-between p-3 rounded-lg bg-base-content/5 hover:bg-base-content/10 transition-colors duration-200 ${w!==i.length-1?"border-b border-base-content/10":""}`,children:[V("div",{className:"flex-1 flex justify-between items-center group",children:[V("div",{className:"flex items-center gap-2",children:V("div",{className:"flex flex-col",children:[V("div",{className:"flex items-center gap-2",children:[V("h4",{className:"font-semibold text-base-content",children:o.symbol===""?o.name||"Token "+w:o.symbol}),V("button",{type:"button",className:"text-xs text-base-content/50 hover:text-base-content/70 transition-colors duration-200 p-1 rounded hover:bg-base-content/5",title:"Copiar direcci\xF3n",onClick:()=>f(o.address),children:"\u{1F4C4}"}),V("div",{className:"badge badge-outline badge-xs text-base-content/60 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:Bt.find(U=>U.id===o.chain)?.name??o.chain})]}),V("span",{className:"text-xs text-base-content/50 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:["Supply:"," ",Ai(o.totalSupply,o.decimals)]})]})}),V("div",{className:"text-sm text-base-content/70 text-right",children:V("div",{className:"flex flex-col items-end",children:[V("span",{className:"font-semibold",children:I?V("span",{className:"animate-pulse",children:V("span",{className:"animate-ping",children:". . ."})}):_i(e.tokenData[o.address]?.balance,o.decimals)??"-"}),V("span",{className:"text-xs text-base-content/50 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:["Ultima Actualizaci\xF3n:"," ",e.tokenData&&e.tokenData[o.address]?Ii(e.tokenData[o.address].lastUpdate):"-"]})]})})]}),m&&V("button",{type:"button",onClick:()=>v(o.address),className:"ml-4 px-3 py-1 bg-red-500/10 hover:bg-red-500/20 text-red-500 rounded-lg transition-colors duration-200 backdrop-blur-sm border border-red-500/20 text-sm",children:"Eliminar"})]},o.address))})]})]})}),p&&V("div",{className:"fixed inset-0 backdrop-blur-sm flex items-center justify-center z-50",children:V("div",{className:"card bg-base-100 shadow-xl border border-base-300 relative overflow-hidden rounded-2xl p-6 w-full max-w-md mx-4",children:[V("div",{className:"absolute inset-0 bg-gradient-to-br from-base-content/5 to-transparent"}),V("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-base-content/5 rounded-full blur-xl"}),V("div",{className:"relative z-10",children:[V("div",{className:"flex items-center justify-between mb-4",children:[V("h3",{className:"text-lg font-semibold text-base-content",children:"Agregar Token"}),V("button",{type:"button",onClick:L,className:"text-base-content/50 hover:text-base-content/70 focus:outline-none",children:V("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:V("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),V("div",{className:"mb-4",children:[V("label",{className:"block text-sm font-medium text-base-content mb-2",children:"Direcci\xF3n del Token"}),V("input",{type:"text",value:s,onChange:_,onKeyPress:g,placeholder:"Ingresa la direcci\xF3n del token (0x...)",className:"w-full px-4 py-2 bg-base-content/10 border border-base-content/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-base-content/30 focus:border-transparent text-base-content placeholder:text-base-content/50",disabled:I}),V("label",{className:"block text-sm font-medium text-base-content mb-2",children:"Chain"}),V("select",{value:d,onChange:o=>c(o.currentTarget.value),disabled:I,className:"w-full px-4 py-2 bg-base-content/10 border border-base-content/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-base-content/30 focus:border-transparent text-base-content placeholder:text-base-content/50",children:[V("option",{value:"",children:"Selecciona una cadena"}),Bt.map(o=>V("option",{value:o.id,children:o.name},o.id))]}),a&&V("p",{className:"text-red-500 text-sm mt-2",children:a})]}),V("div",{className:"flex gap-3",children:[V("button",{type:"button",onClick:L,className:"flex-1 px-4 py-2 bg-base-content/10 hover:bg-base-content/20 text-base-content rounded-lg transition-colors duration-200 border border-base-content/20",disabled:I,children:"Cancelar"}),V("button",{type:"button",onClick:l,className:"flex-1 px-4 py-2 bg-base-content text-base-100 rounded-lg hover:bg-base-content/90 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",disabled:I,children:I?"Agregando...":"Agregar Token"})]})]})]})})]})};var es=()=>{let[i,r]=ue(null),[t,e]=ue(null),[n,s]=ue(""),[u,d]=ue(""),{register:c}=yt();return V("div",{className:"card bg-base-100 shadow-md max-w-md mx-auto",children:V("div",{className:"card-body space-y-4",children:[V("h2",{className:"card-title text-lg",children:"Importar e-firma"}),V("form",{onSubmit:async h=>{h.preventDefault(),i&&t&&n&&u&&(c(u,t,i,n),e(null),r(null),s(""))},className:"space-y-3",children:[V("div",{className:"form-control",children:[V("label",{className:"label font-medium",children:"Archivo .key"}),V("input",{type:"file",accept:".key",className:"file-input file-input-bordered w-full",onChange:h=>r(h.target.files?.[0]||null),required:!0})]}),V("div",{className:"form-control",children:[V("label",{className:"label font-medium",children:"Archivo .cer"}),V("input",{type:"file",accept:".cer",className:"file-input file-input-bordered w-full",onChange:h=>e(h.target.files?.[0]||null),required:!0})]}),V("div",{className:"form-control",children:[V("label",{className:"label font-medium",children:"Nombre de usuario"}),V("input",{type:"text",className:"input input-bordered w-full",onChange:h=>d(h.target.value||""),required:!0})]}),V("div",{className:"form-control",children:[V("label",{className:"label font-medium",children:"Contrase\xF1a"}),V("input",{type:"password",className:"input input-bordered w-full",onChange:h=>s(h.target.value||""),required:!0})]}),V("button",{type:"submit",className:"btn btn-primary w-full",disabled:!i||!t,children:"Registrar"})]})]})})};function ts({request:i,onApprove:r,onReject:t}){let[e,n]=ue(""),[s,u]=ue(""),d=()=>{if(!e){u("Password is required to approve.");return}u(""),r(e)};return V("div",{className:"p-4 space-y-4",children:[V("h2",{className:"text-lg font-bold",children:"Signature Request"}),V("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[V("div",{children:[V("span",{className:"font-semibold",children:"Type:"})," ",i.type]}),V("div",{children:[V("span",{className:"font-semibold",children:"Sender:"})," ",i.sender]}),V("div",{children:[V("span",{className:"font-semibold",children:"Timestamp:"})," ",i.timestamp]}),i.payload&&V("div",{className:"break-all",children:[V("span",{className:"font-semibold",children:"Payload:"}),V("pre",{className:"bg-base-200 p-2 rounded overflow-x-auto max-h-40",children:JSON.stringify(i.payload,null,2)})]})]}),V("div",{className:"form-control",children:[V("label",{className:"label",children:V("span",{className:"label-text",children:"Confirm with password"})}),V("input",{type:"password",className:"input input-bordered",placeholder:"Enter your password",value:e,onInput:c=>n(c.target.value)}),s&&V("p",{className:"text-error text-sm mt-1",children:s})]}),V("div",{className:"flex justify-end gap-2",children:[V("button",{type:"button",onClick:t,className:"btn btn-outline btn-error",children:"Reject"}),V("button",{type:"button",onClick:d,className:"btn btn-primary",children:"Approve"})]})]})}var ea=ke({goTo:(i,r,t)=>{},popupView:"home",sidepanelView:"home",render:i=>V(fn,{})}),rs=({children:i})=>{let[r,t]=ue("home"),[e,n]=ue("home"),[s,u]=ue({});function d(a,h,p){h?n(a):t(a),p&&u(p)}function c(a){switch(a=a.toLocaleLowerCase(),a){case"home":return V(fn,{});case"aichat":return V(Ui,{});case"cuenta":return V(Ji,{});case"portafolio":return V(Zi,{});case"import":return V(es,{});case"approval":return V(ts,{...s});default:return V(fn,{})}}return V(ea.Provider,{value:{goTo:d,popupView:r,sidepanelView:e,render:c},children:i})};var ta=ke({theme:!0,changeTheme:i=>{}}),ns=({children:i})=>{let[r,t]=ue(!0),e=n=>{t(n),n?document.getElementById("html").setAttribute("data-theme","dim"):document.getElementById("html").setAttribute("data-theme","nord")};return V(ta.Provider,{value:{theme:r,changeTheme:e},children:i})};var as=(i="local")=>{let r=chrome.storage[i],t=(n,s)=>u=>{chrome.runtime.lastError?(console.error(`[${ra(i)}Storage] Error:`,chrome.runtime.lastError),s(chrome.runtime.lastError)):n(u)},e=n=>n&&typeof n=="object"&&!Array.isArray(n);return{create:(n,s)=>new Promise((u,d)=>{r.set({[n]:s},t(()=>{console.log(`[${ra(i)}Storage] Namespace ${n} created`),u()},d))}),read:n=>new Promise((s,u)=>{r.get([n],t(s,u))}),update:(n,s)=>new Promise((u,d)=>{r.get([n],t(c=>{let a=c[n],h;e(a)&&e(s)?h={...a,...s}:s==null?h=a:h=s,r.set({[n]:h},t(()=>{console.log(`[${ra(i)}Storage] Namespace ${n} updated`),u()},d))},d))}),delete:n=>new Promise((s,u)=>{Array.isArray(n)||(n=[n]),r.remove(n,t(s,u))}),clear:()=>new Promise((n,s)=>{r.clear(t(n,s))})}};function ra(i){return i.charAt(0).toUpperCase()+i.slice(1)}var is=as("local"),ss=as("session");var os=ke(is);var Ju=ke(ss);var dr=class extends EventTarget{id=0;chains=new Map;current={id:"",name:"",rpcUrl:""};constructor(r){super(),r.forEach(t=>this.chains.set(t.id,t)),this.current=r[0]}changeChain(r){let t=this.chains.get(r);if(!t)throw new Error(`Chain not supported: ${r}`);this.current=t}addChain(r){this.chains.set(r.id,r)}url(){return this.current.rpcUrl}on(r,t){this.addEventListener(r,t)}off(r,t){this.removeEventListener(r,t)}emit(r,t){this.dispatchEvent(new CustomEvent(r,{detail:t}))}async request(r,t=[]){let e={jsonrpc:"2.0",method:r,params:t,id:this.id++},s=await(await fetch(this.url(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(s.error)throw new Error(`[${s.error.code}] ${s.error.message}`);return s.result}web3_sha3(r){return this.request("web3_sha3",[r])}net_version(){return this.request("net_version")}net_listening(){return this.request("net_listening")}net_peerCount(){return this.request("net_peerCount")}eth_protocolVersion(){return this.request("eth_protocolVersion")}eth_syncing(){return this.request("eth_syncing")}eth_coinbase(){return this.request("eth_coinbase")}eth_mining(){return this.request("eth_mining")}eth_hashrate(){return this.request("eth_hashrate")}eth_gasPrice(){return this.request("eth_gasPrice")}eth_accounts(){return this.request("eth_accounts")}eth_blockNumber(){return this.request("eth_blockNumber")}eth_getBalance(r,t="latest"){return this.request("eth_getBalance",[r,t])}eth_getStorageAt(r,t,e="latest"){return this.request("eth_getStorageAt",[r,t,e])}eth_getTransactionCount(r,t="latest"){return this.request("eth_getTransactionCount",[r,t])}eth_getBlockTransactionCountByHash(r){return this.request("eth_getBlockTransactionCountByHash",[r])}eth_getBlockTransactionCountByNumber(r){return this.request("eth_getBlockTransactionCountByNumber",[r])}eth_getCode(r,t="latest"){return this.request("eth_getCode",[r,t])}eth_sendRawTransaction(r){return this.request("eth_sendRawTransaction",[r])}eth_call(r,t="latest"){return this.request("eth_call",[r,t])}eth_estimateGas(r){return this.request("eth_estimateGas",[r])}eth_feeHistory(r="0xa",t="latest",e=[50]){return this.request("eth_feeHistory",[r,t,e])}eth_getBlockByHash(r,t=!1){return this.request("eth_getBlockByHash",[r,t])}eth_getBlockByNumber(r,t=!1){return this.request("eth_getBlockByNumber",[r,t])}eth_getTransactionByHash(r){return this.request("eth_getTransactionByHash",[r])}eth_getTransactionByBlockHashAndIndex(r,t){return this.request("eth_getTransactionByBlockHashAndIndex",[r,t])}eth_getTransactionByBlockNumberAndIndex(r,t){return this.request("eth_getTransactionByBlockNumberAndIndex",[r,t])}eth_getTransactionReceipt(r){return this.request("eth_getTransactionReceipt",[r])}eth_getLogs(r){return this.request("eth_getLogs",[r])}eth_newFilter(r){return this.request("eth_newFilter",[r])}eth_newBlockFilter(){return this.request("eth_newBlockFilter")}eth_newPendingTransactionFilter(){return this.request("eth_newPendingTransactionFilter")}eth_uninstallFilter(r){return this.request("eth_uninstallFilter",[r])}eth_getFilterChanges(r){return this.request("eth_getFilterChanges",[r])}eth_getFilterLogs(r){return this.request("eth_getFilterLogs",[r])}eth_createAccessList(r,t="latest"){return this.request("eth_createAccessList",[r,t])}async populateTransaction(r,t){let e,n=[],s=r.type??"0x0";if(t&&(r.from=t),s==="0x0"||s==="0x1"){let{gasLimit:d,gasPrice:c}=await this.estimateGas(r);e={gasLimit:d,gasPrice:c}}else if(s==="0x2")r.accessList=(await this.eth_createAccessList(r)).accessList;else{let{gasLimit:d,maxFeePerGas:c,maxPriorityFeePerGas:a}=await this.estimateGas(r);e={gasLimit:d,maxFeePerGas:c,maxPriorityFeePerGas:a}}let u=await this.eth_getTransactionCount(r.from);return{...r,...e,accessList:n,nonce:u=="0x0"?"":u}}async estimateGas(r){let t=await this.eth_estimateGas(r),e=BigInt(t);e=e+e/5n;let n,s,u;try{let d=await this.eth_feeHistory(),c=d&&d.baseFeePerGas&&d.baseFeePerGas.length>0?BigInt(d.baseFeePerGas[0]):0n,a=d&&d.reward&&d.reward.length>0&&d.reward[0].length>0?BigInt(d.reward[0][0]):1500000000n;u=await this.eth_gasPrice(),s="0x"+a.toString(16),n="0x"+(c+a*2n).toString(16)}catch{n=await this.eth_gasPrice(),s="0x59682f00"}return{gasPrice:u,gasLimit:"0x"+e.toString(16),maxFeePerGas:n,maxPriorityFeePerGas:s}}};var cs=ke(new dr(Bt));async function yn(){let i={active:!0,lastFocusedWindow:!0},[r]=await chrome.tabs.query(i);return r.id}var mn=class{source;listeners;constructor(r){this.source=r,this.listeners=new Map,globalThis.addEventListener("message",this._internalHandler)}log(...r){console.log(`[${this.source}]`,...r)}listen=(r,t)=>{this.listeners.set(r,t)};unlisten=r=>{this.listeners.delete(r)};send=(r,t={},e,n="*",s={})=>{let u={__mailbox__:!0,type:r,payload:t,source:this.source,dest:e,...s};this.source==="DOM"||this.source==="CONTENT SCRIPT"&&e!=="BACKGROUND"?globalThis.postMessage(u,n):e==="CONTENT SCRIPT"&&this.source!=="DOM"?yn().then(d=>chrome.tabs.sendMessage(d,u,()=>this.log(`${r} send`))):chrome.runtime.sendMessage(u)};_internalHandler=r=>{if(!r.data||r.data.__mailbox__!==!0||r.data.source===this.source||r.data.dest!==this.source)return;this.log("Message accepted");let t=this.listeners.get(r.data.type);typeof t=="function"&&t(r.data.payload,r)}};var gn=class extends mn{pending;handlers;constructor(r){super(r),this.source=r,this.pending=new Map,this.handlers=new Map,globalThis.addEventListener("message",this._onglobalThisMessage.bind(this)),(r==="CONTENT SCRIPT"||r==="BACKGROUND"||r==="EXTENSION")&&chrome.runtime.onMessage.addListener((t,e,n)=>this._onRuntimeMessage(t,e,n))}_onglobalThisMessage(r){if(r.data.source===this.source||!r.data?.__mailbox__)return;this.log(r);let{source:t,type:e,payload:n,dest:s,requestId:u}=r.data,{data:d}=n;if(!(t===this.source||s!==this.source)){if(e?.startsWith("RESPONSE_")&&this.pending.has(u)){let c=this.pending.get(u);c&&(c.resolve(d),this.pending.delete(u));return}if(e?.startsWith("REQUEST_")){let c=e.replace("REQUEST_",""),a=this.handlers.get(c);if(!a){this.log(`No handler for request: ${c}`);return}Promise.resolve(a(n,r)).then(h=>{this.send(`RESPONSE_${e}`,h,"DOM","*",{requestId:u})})}if(e?.startsWith("NOTIFY_")){let c=e.replace("NOTIFY_",""),a=this.handlers.get(c);if(!a){this.log("No handler for this");return}a(n,c)}}}_onRuntimeMessage(r,t,e){if(!r?.__mailbox__||r.dest!==this.source)return this.log("Ignored runtime message"),!1;let{type:n,requestId:s,payload:u}=r;if(n?.startsWith("REQUEST_")){let d=n.replace("REQUEST_",""),c=this.handlers.get(d);if(!c)return e({ok:!1,error:`No handler for ${d}`}),!1;try{let a=c(u,t,e);return a&&typeof a.then=="function"?(a.then(h=>{this.log("Handler resolved with:",h),e({__mailbox__:!0,source:this.source,dest:r.source,requestId:s,type:`RESPONSE_${d}`,payload:h,ok:!0})}).catch(h=>{this.log("Handler rejected with:",h.message),e({ok:!1,error:h?.message||String(h)})}),!0):!1}catch(a){let h=a;return e({ok:!1,error:h?.message||String(h)}),!1}}return n?.startsWith("NOTIFY_")&&this.source==="CONTENT SCRIPT"?(this.send(n,u,"DOM"),!1):!0}request(r,t,e){let n=t?.method+"_"+crypto.randomUUID();return new Promise(s=>{this.pending.set(n,{resolve:s});let u={__mailbox__:!0,type:`REQUEST_${r}`,payload:t,requestId:n,source:this.source,dest:e};e==="BACKGROUND"||e==="EXTENSION"?chrome.runtime.sendMessage(u,d=>{if(chrome.runtime.lastError){console.error("No extension page open:",chrome.runtime.lastError.message);return}let c=this.pending.get(n);c&&(c.resolve(d),this.pending.delete(n))}):this.send(`REQUEST_${r}`,t,e,"*",{requestId:n})})}on(r,t){this.handlers.set(r,t),this.log("Registered handler for",r)}off(r){this.handlers.delete(r),this.log("Removed handler for",r)}};var Nt=new gn("EXTENSION"),na=ke({request:async(i,r)=>await Nt.request(i,{...r,method:i},"BACKGROUND"),notify:(i,r)=>Nt.send(`NOTIFY_${i}`,r,"CONTENT SCRIPT")}),us=({children:i})=>{let{goTo:r}=fr();return ht(()=>{Nt.on("APPROVAL",async t=>{let e=crypto.randomUUID(),n=new Promise(c=>{Nt.pending.set(e,{resolve:c})}),s=c=>{let a=Nt.pending.get(e);a&&(a.resolve(c),Nt.pending.delete(e),r("home",!0))},u=()=>{let c=Nt.pending.get(e);c&&(c.resolve(null),Nt.pending.delete(e),r("home",!0))};return chrome.sidePanel.open({tabId:await yn()}),r("approval",!0,{request:t,onApprove:s,onReject:u}),await n})},[]),V(na.Provider,{value:{request:async(t,e)=>await Nt.request(t,{...e,method:t},"BACKGROUND"),notify:(t,e)=>Nt.send(`NOTIFY_${t}`,e,"CONTENT SCRIPT")},children:i})};var Zu={p:0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2fn,n:0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141n,h:1n,a:0n,b:7n,Gx:0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798n,Gy:0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8n},{p:Jt,n:Rt,Gx:el,Gy:tl,b:ys}=Zu,pt=32,Zt=64,Re=(i="")=>{throw new Error(i)},ms=i=>typeof i=="bigint",gs=i=>typeof i=="string",rl=i=>i instanceof Uint8Array||ArrayBuffer.isView(i)&&i.constructor.name==="Uint8Array",tr=(i,r)=>!rl(i)||typeof r=="number"&&r>0&&i.length!==r?Re("Uint8Array expected"):i,er=i=>new Uint8Array(i),nl=i=>Uint8Array.from(i),vs=(i,r)=>i.toString(16).padStart(r,"0"),Cn=i=>Array.from(tr(i)).map(r=>vs(r,2)).join(""),Vt={_0:48,_9:57,A:65,F:70,a:97,f:102},ls=i=>{if(i>=Vt._0&&i<=Vt._9)return i-Vt._0;if(i>=Vt.A&&i<=Vt.F)return i-(Vt.A-10);if(i>=Vt.a&&i<=Vt.f)return i-(Vt.a-10)},ca=i=>{let r="hex invalid";if(!gs(i))return Re(r);let t=i.length,e=t/2;if(t%2)return Re(r);let n=er(e);for(let s=0,u=0;s<e;s++,u+=2){let d=ls(i.charCodeAt(u)),c=ls(i.charCodeAt(u+1));if(d===void 0||c===void 0)return Re(r);n[s]=d*16+c}return n},xt=(i,r)=>tr(gs(i)?ca(i):nl(tr(i)),r),bs=()=>globalThis?.crypto,al=()=>bs()?.subtle??Re("crypto.subtle must be defined"),rr=(...i)=>{let r=er(i.reduce((e,n)=>e+tr(n).length,0)),t=0;return i.forEach(e=>{r.set(e,t),t+=e.length}),r},ua=(i=pt)=>bs().getRandomValues(er(i)),yr=BigInt,kr=(i,r,t,e="bad number: out of range")=>ms(i)&&r<=i&&i<t?i:Re(e),ce=(i,r=Jt)=>{let t=i%r;return t>=0n?t:r+t},gt=i=>ce(i,Rt),Rr=(i,r)=>{(i===0n||r<=0n)&&Re("no inverse n="+i+" mod="+r);let t=ce(i,r),e=r,n=0n,s=1n,u=1n,d=0n;for(;t!==0n;){let c=e/t,a=e%t,h=n-u*c,p=s-d*c;e=t,t=a,n=u,s=d,u=h,d=p}return e===1n?ce(n,r):Re("no inverse")},il=i=>{let r=Pr[i];return typeof r!="function"&&Re("hashes."+i+" not set"),r},ps=i=>i instanceof nr?i:Re("Point expected"),Es=i=>ce(ce(i*i)*i+ys),fs=i=>kr(i,0n,Jt),Nr=i=>kr(i,1n,Jt),aa=i=>kr(i,1n,Rt),ia=i=>(i&1n)===0n,hr=i=>Uint8Array.of(i),Cs=i=>hr(ia(i)?2:3),sl=i=>{let r=Es(Nr(i)),t=1n;for(let e=r,n=(Jt+1n)/4n;n>0n;n>>=1n)n&1n&&(t=t*e%Jt),e=e*e%Jt;return ce(t*t)===r?t:Re("sqrt invalid")},mt,nr=(mt=class{px;py;pz;constructor(r,t,e){this.px=fs(r),this.py=Nr(t),this.pz=fs(e),Object.freeze(this)}static fromBytes(r){tr(r);let t,e=r[0],n=r.subarray(1),s=vn(n,0,pt),u=r.length;if(u===pt+1&&[2,3].includes(e)){let d=sl(s),c=ia(d);ia(yr(e))!==c&&(d=ce(-d)),t=new mt(s,d,1n)}return u===Zt+1&&e===4&&(t=new mt(s,vn(n,pt,Zt),1n)),t?t.assertValidity():Re("bad point: not on curve")}equals(r){let{px:t,py:e,pz:n}=this,{px:s,py:u,pz:d}=ps(r),c=ce(t*d),a=ce(s*n),h=ce(e*d),p=ce(u*n);return c===a&&h===p}is0(){return this.equals(Xt)}negate(){return new mt(this.px,ce(-this.py),this.pz)}double(){return this.add(this)}add(r){let{px:t,py:e,pz:n}=this,{px:s,py:u,pz:d}=ps(r),c=0n,a=ys,h=0n,p=0n,T=0n,I=ce(a*3n),A=ce(t*s),m=ce(e*u),S=ce(n*d),C=ce(t+e),E=ce(s+u);C=ce(C*E),E=ce(A+m),C=ce(C-E),E=ce(t+n);let l=ce(s+d);return E=ce(E*l),l=ce(A+S),E=ce(E-l),l=ce(e+n),h=ce(u+d),l=ce(l*h),h=ce(m+S),l=ce(l-h),T=ce(c*E),h=ce(I*S),T=ce(h+T),h=ce(m-T),T=ce(m+T),p=ce(h*T),m=ce(A+A),m=ce(m+A),S=ce(c*S),E=ce(I*E),m=ce(m+S),S=ce(A-S),S=ce(c*S),E=ce(E+S),A=ce(m*E),p=ce(p+A),A=ce(l*E),h=ce(C*h),h=ce(h-A),A=ce(C*m),T=ce(l*T),T=ce(T+A),new mt(h,p,T)}multiply(r,t=!0){if(!t&&r===0n)return Xt;if(aa(r),r===1n)return this;if(this.equals(kt))return ml(r).p;let e=Xt,n=kt;for(let s=this;r>0n;s=s.double(),r>>=1n)r&1n?e=e.add(s):t&&(n=n.add(s));return e}toAffine(){let{px:r,py:t,pz:e}=this;if(this.equals(Xt))return{x:0n,y:0n};if(e===1n)return{x:r,y:t};let n=Rr(e,Jt);return ce(e*n)!==1n&&Re("inverse invalid"),{x:ce(r*n),y:ce(t*n)}}assertValidity(){let{x:r,y:t}=this.toAffine();return Nr(r),Nr(t),ce(t*t)===Es(r)?this:Re("bad point: not on curve")}toBytes(r=!0){let{x:t,y:e}=this.assertValidity().toAffine(),n=Gt(t);return r?rr(Cs(e),n):rr(hr(4),n,Gt(e))}static fromAffine(r){let{x:t,y:e}=r;return t===0n&&e===0n?Xt:new mt(t,e,1n)}toHex(r){return Cn(this.toBytes(r))}static fromPrivateKey(r){return kt.multiply(xr(r))}static fromHex(r){return mt.fromBytes(xt(r))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}toRawBytes(r){return this.toBytes(r)}},Hn(mt,"BASE"),Hn(mt,"ZERO"),mt),kt=new nr(el,tl,1n),Xt=new nr(0n,1n,0n);nr.BASE=kt;nr.ZERO=Xt;var Ts=(i,r,t)=>kt.multiply(r,!1).add(i.multiply(t,!1)).assertValidity(),Lr=i=>yr("0x"+(Cn(i)||"0")),vn=(i,r,t)=>Lr(i.subarray(r,t)),ol=2n**256n,Gt=i=>ca(vs(kr(i,0n,ol),Zt)),xr=i=>{let r=ms(i)?i:Lr(xt(i,pt));return kr(r,1n,Rt,"private key invalid 3")},bn=i=>i>Rt>>1n,ar=(i,r=!0)=>kt.multiply(xr(i)).toBytes(r),sa=class Br{r;s;recovery;constructor(r,t,e){this.r=aa(r),this.s=aa(t),e!=null&&(this.recovery=e),Object.freeze(this)}static fromBytes(r){tr(r,Zt);let t=vn(r,0,pt),e=vn(r,pt,Zt);return new Br(t,e)}toBytes(){let{r,s:t}=this;return rr(Gt(r),Gt(t))}addRecoveryBit(r){return new Br(this.r,this.s,r)}hasHighS(){return bn(this.s)}toCompactRawBytes(){return this.toBytes()}toCompactHex(){return Cn(this.toBytes())}recoverPublicKey(r){return pl(this,r)}static fromCompact(r){return Br.fromBytes(xt(r,Zt))}assertValidity(){return this}normalizeS(){let{r,s:t,recovery:e}=this;return bn(t)?new Br(r,gt(-t),e):this}},Ss=i=>{let r=i.length*8-256;r>1024&&Re("msg invalid");let t=Lr(i);return r>0?t>>yr(r):t},la=i=>gt(Ss(tr(i))),_s={lowS:!0},cl={lowS:!0},ul=(i,r,t=_s)=>{["der","recovered","canonical"].some(T=>T in t)&&Re("option not supported");let{lowS:e,extraEntropy:n}=t;e==null&&(e=!0);let s=Gt,u=la(xt(i)),d=s(u),c=xr(r),a=[s(c),d];n&&a.push(n===!0?ua(pt):xt(n));let h=u,p=T=>{let I=Ss(T);if(!(1n<=I&&I<Rt))return;let A=kt.multiply(I).toAffine(),m=gt(A.x);if(m===0n)return;let S=Rr(I,Rt),C=gt(S*gt(h+gt(c*m)));if(C===0n)return;let E=C,l=(A.x===m?0:2)|Number(A.y&1n);return e&&bn(C)&&(E=gt(-C),l^=1),new sa(m,E,l)};return{seed:rr(...a),k2sig:p}},ll=i=>{let r=er(pt),t=er(pt),e=0,n=er(0),s=()=>{r.fill(1),t.fill(0),e=0},u=1e3,d="drbg: tried 1000 values";if(i){let c=(...p)=>Pr.hmacSha256Async(t,r,...p),a=async(p=n)=>{t=await c(hr(0),p),r=await c(),p.length!==0&&(t=await c(hr(1),p),r=await c())},h=async()=>(e++>=u&&Re(d),r=await c(),r);return async(p,T)=>{s(),await a(p);let I;for(;!(I=T(await h()));)await a();return s(),I}}else{let c=(...p)=>il("hmacSha256Sync")(t,r,...p),a=(p=n)=>{t=c(hr(0),p),r=c(),p.length!==0&&(t=c(hr(1),p),r=c())},h=()=>(e++>=u&&Re(d),r=c(),r);return(p,T)=>{s(),a(p);let I;for(;!(I=T(h()));)a();return s(),I}}};var pa=(i,r,t=_s)=>{let{seed:e,k2sig:n}=ul(i,r,t);return ll(!1)(e,n)},Tn=(i,r,t,e=cl)=>{let{lowS:n}=e;n==null&&(n=!0),"strict"in e&&Re("option not supported");let s,u=i&&typeof i=="object"&&"r"in i;!u&&xt(i).length!==Zt&&Re("signature must be 64 bytes");try{s=u?new sa(i.r,i.s):sa.fromCompact(i);let d=la(xt(r)),c=nr.fromBytes(xt(t)),{r:a,s:h}=s;if(n&&bn(h))return!1;let p=Rr(h,Rt),T=gt(d*p),I=gt(a*p),A=Ts(c,T,I).toAffine();return gt(A.x)===a}catch{return!1}},pl=(i,r)=>{let{r:t,s:e,recovery:n}=i;[0,1,2,3].includes(n)||Re("recovery id invalid");let s=la(xt(r,pt)),u=n===2||n===3?t+Rt:t;Nr(u);let d=Cs(yr(n)),c=rr(d,Gt(u)),a=nr.fromBytes(c),h=Rr(u,Rt),p=gt(-s*h),T=gt(e*h);return Ts(a,p,T)};var As=i=>{i=xt(i),(i.length<pt+8||i.length>1024)&&Re("expected 40-1024b");let r=ce(Lr(i),Rt-1n);return Gt(r+1n)},fl=()=>As(ua(pt+16)),dl="SHA-256",Pr={hexToBytes:ca,bytesToHex:Cn,concatBytes:rr,bytesToNumberBE:Lr,numberToBytesBE:Gt,mod:ce,invert:Rr,hmacSha256Async:async(i,...r)=>{let t=al(),e="HMAC",n=await t.importKey("raw",i,{name:e,hash:{name:dl}},!1,["sign"]);return er(await t.sign(e,n,rr(...r)))},hmacSha256Sync:void 0,hashToPrivateKey:As,randomBytes:ua},Is={normPrivateKeyToScalar:xr,isValidPrivateKey:i=>{try{return!!xr(i)}catch{return!1}},randomPrivateKey:fl,precompute:(i=8,r=kt)=>(r.multiply(3n),r)},En=8,hl=256,ws=Math.ceil(hl/En)+1,oa=2**(En-1),yl=()=>{let i=[],r=kt,t=r;for(let e=0;e<ws;e++){t=r,i.push(t);for(let n=1;n<oa;n++)t=t.add(r),i.push(t);r=t.double()}return i},ds,hs=(i,r)=>{let t=r.negate();return i?t:r},ml=i=>{let r=ds||(ds=yl()),t=Xt,e=kt,n=2**En,s=n,u=yr(n-1),d=yr(En);for(let c=0;c<ws;c++){let a=Number(i&u);i>>=d,a>oa&&(a-=s,i+=1n);let h=c*oa,p=h,T=h+Math.abs(a)-1,I=c%2!==0,A=a<0;a===0?e=e.add(hs(I,r[p])):t=t.add(hs(A,r[T]))}return{p:t,f:e}};var gl=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function vl(i){return i instanceof Uint8Array||ArrayBuffer.isView(i)&&i.constructor.name==="Uint8Array"}function mr(i){if(!Number.isSafeInteger(i)||i<0)throw new Error("positive integer expected, got "+i)}function Lt(i,...r){if(!vl(i))throw new Error("Uint8Array expected");if(r.length>0&&!r.includes(i.length))throw new Error("Uint8Array expected of length "+r+", got length="+i.length)}function Bs(i){if(typeof i!="function"||typeof i.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");mr(i.outputLen),mr(i.blockLen)}function ir(i,r=!0){if(i.destroyed)throw new Error("Hash instance has been destroyed");if(r&&i.finished)throw new Error("Hash#digest() has already been called")}function fa(i,r){Lt(i);let t=r.outputLen;if(i.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function Ns(i){return new Uint32Array(i.buffer,i.byteOffset,Math.floor(i.byteLength/4))}function Ur(...i){for(let r=0;r<i.length;r++)i[r].fill(0)}var bl=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function El(i){return i<<24&4278190080|i<<8&16711680|i>>>8&65280|i>>>24&255}function Cl(i){for(let r=0;r<i.length;r++)i[r]=El(i[r]);return i}var da=bl?i=>i:Cl,ah=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",ih=Array.from({length:256},(i,r)=>r.toString(16).padStart(2,"0"));function ha(i){if(typeof i!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(i))}function gr(i){return typeof i=="string"&&(i=ha(i)),Lt(i),i}function ya(...i){let r=0;for(let e=0;e<i.length;e++){let n=i[e];Lt(n),r+=n.length}let t=new Uint8Array(r);for(let e=0,n=0;e<i.length;e++){let s=i[e];t.set(s,n),n+=s.length}return t}var Sn=class{};function xs(i){let r=e=>i().update(gr(e)).digest(),t=i();return r.outputLen=t.outputLen,r.blockLen=t.blockLen,r.create=()=>i(),r}function ks(i){let r=(e,n)=>i(n).update(gr(e)).digest(),t=i({});return r.outputLen=t.outputLen,r.blockLen=t.blockLen,r.create=e=>i(e),r}var Rs=class extends Sn{constructor(i,r){super(),this.finished=!1,this.destroyed=!1,Bs(i);let t=gr(r);if(this.iHash=i.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let e=this.blockLen,n=new Uint8Array(e);n.set(t.length>e?i.create().update(t).digest():t);for(let s=0;s<n.length;s++)n[s]^=54;this.iHash.update(n),this.oHash=i.create();for(let s=0;s<n.length;s++)n[s]^=106;this.oHash.update(n),Ur(n)}update(i){return ir(this),this.iHash.update(i),this}digestInto(i){ir(this),Lt(i,this.outputLen),this.finished=!0,this.iHash.digestInto(i),this.oHash.update(i),this.oHash.digestInto(i),this.destroy()}digest(){let i=new Uint8Array(this.oHash.outputLen);return this.digestInto(i),i}_cloneInto(i){i||(i=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:t,finished:e,destroyed:n,blockLen:s,outputLen:u}=this;return i=i,i.finished=e,i.destroyed=n,i.blockLen=s,i.outputLen=u,i.oHash=r._cloneInto(i.oHash),i.iHash=t._cloneInto(i.iHash),i}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},ma=(i,r,t)=>new Rs(i,r).update(t).digest();ma.create=(i,r)=>new Rs(i,r);var _n=BigInt(4294967295),Ls=BigInt(32);function Tl(i,r=!1){return r?{h:Number(i&_n),l:Number(i>>Ls&_n)}:{h:Number(i>>Ls&_n)|0,l:Number(i&_n)|0}}function Sl(i,r=!1){let t=i.length,e=new Uint32Array(t),n=new Uint32Array(t);for(let s=0;s<t;s++){let{h:u,l:d}=Tl(i[s],r);[e[s],n[s]]=[u,d]}return[e,n]}var _l=(i,r,t)=>i<<t|r>>>32-t,Al=(i,r,t)=>r<<t|i>>>32-t,Il=(i,r,t)=>r<<t-32|i>>>64-t,wl=(i,r,t)=>i<<t-32|r>>>64-t,Bl=BigInt(0),Dr=BigInt(1),Nl=BigInt(2),xl=BigInt(7),kl=BigInt(256),Rl=BigInt(113),Ds=[],Os=[],Vs=[];for(let i=0,r=Dr,t=1,e=0;i<24;i++){[t,e]=[e,(2*t+3*e)%5],Ds.push(2*(5*e+t)),Os.push((i+1)*(i+2)/2%64);let n=Bl;for(let s=0;s<7;s++)r=(r<<Dr^(r>>xl)*Rl)%kl,r&Nl&&(n^=Dr<<(Dr<<BigInt(s))-Dr);Vs.push(n)}var Ms=Sl(Vs,!0),Ll=Ms[0],Pl=Ms[1],Ps=(i,r,t)=>t>32?Il(i,r,t):_l(i,r,t),Us=(i,r,t)=>t>32?wl(i,r,t):Al(i,r,t);function Ul(i,r=24){let t=new Uint32Array(10);for(let e=24-r;e<24;e++){for(let u=0;u<10;u++)t[u]=i[u]^i[u+10]^i[u+20]^i[u+30]^i[u+40];for(let u=0;u<10;u+=2){let d=(u+8)%10,c=(u+2)%10,a=t[c],h=t[c+1],p=Ps(a,h,1)^t[d],T=Us(a,h,1)^t[d+1];for(let I=0;I<50;I+=10)i[u+I]^=p,i[u+I+1]^=T}let n=i[2],s=i[3];for(let u=0;u<24;u++){let d=Os[u],c=Ps(n,s,d),a=Us(n,s,d),h=Ds[u];n=i[h],s=i[h+1],i[h]=c,i[h+1]=a}for(let u=0;u<50;u+=10){for(let d=0;d<10;d++)t[d]=i[u+d];for(let d=0;d<10;d++)i[u+d]^=~t[(d+2)%10]&t[(d+4)%10]}i[0]^=Ll[e],i[1]^=Pl[e]}Ur(t)}var Ks=class Hs extends Sn{constructor(r,t,e,n=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=r,this.suffix=t,this.outputLen=e,this.enableXOF=n,this.rounds=s,mr(e),!(0<r&&r<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Ns(this.state)}clone(){return this._cloneInto()}keccak(){da(this.state32),Ul(this.state32,this.rounds),da(this.state32),this.posOut=0,this.pos=0}update(r){ir(this),r=gr(r),Lt(r);let{blockLen:t,state:e}=this,n=r.length;for(let s=0;s<n;){let u=Math.min(t-this.pos,n-s);for(let d=0;d<u;d++)e[this.pos++]^=r[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:r,suffix:t,pos:e,blockLen:n}=this;r[e]^=t,t&128&&e===n-1&&this.keccak(),r[n-1]^=128,this.keccak()}writeInto(r){ir(this,!1),Lt(r),this.finish();let t=this.state,{blockLen:e}=this;for(let n=0,s=r.length;n<s;){this.posOut>=e&&this.keccak();let u=Math.min(e-this.posOut,s-n);r.set(t.subarray(this.posOut,this.posOut+u),n),this.posOut+=u,n+=u}return r}xofInto(r){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(r)}xof(r){return mr(r),this.xofInto(new Uint8Array(r))}digestInto(r){if(fa(r,this),this.finished)throw new Error("digest() was already called");return this.writeInto(r),this.destroy(),r}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Ur(this.state)}_cloneInto(r){let{blockLen:t,suffix:e,outputLen:n,rounds:s,enableXOF:u}=this;return r||(r=new Hs(t,e,n,u,s)),r.state32.set(this.state32),r.pos=this.pos,r.posOut=this.posOut,r.finished=this.finished,r.rounds=s,r.suffix=e,r.outputLen=n,r.enableXOF=u,r.destroyed=this.destroyed,r}},zt=(i,r,t)=>xs(()=>new Ks(r,i,t)),yh=zt(6,144,224/8),mh=zt(6,136,256/8),gh=zt(6,104,384/8),vh=zt(6,72,512/8),Fs=zt(1,144,224/8),Or=zt(1,136,256/8),js=zt(1,104,384/8),qs=zt(1,72,512/8),Gs=(i,r,t)=>ks((e={})=>new Ks(r,i,e.dkLen===void 0?t:e.dkLen,!0)),bh=Gs(31,168,128/8),Eh=Gs(31,136,256/8);var Dl="ETHEREUMJS_DEFAULT_ERROR_CODE",Ol=class extends Error{constructor(i,r,t){super(r??i.code),this.type=i,t!==void 0&&(this.stack=t)}getMetadata(){return this.type}toObject(){return{type:this.getMetadata(),message:this.message??"",stack:this.stack??"",className:this.constructor.name}}};function st(i,r){return new Ol({code:Dl},i,r)}function zs(i){if(i[0]===0)throw st("invalid RLP: extra zeros");return Kl(Ml(i))}function $s(i,r){if(i<56)return Uint8Array.from([i+r]);let t=ba(i),e=t.length/2,n=ba(r+55+e);return Uint8Array.from(va(n+t))}function vr(i,r,t){if(t>i.length)throw st("invalid RLP (safeSlice): end slice of Uint8Array out-of-bounds");return i.slice(r,t)}function ga(i){let r,t,e,n,s,u=[],d=i[0];if(d<=127)return{data:i.slice(0,1),remainder:i.subarray(1)};if(d<=183){if(r=d-127,d===128?e=Uint8Array.from([]):e=vr(i,1,r),r===2&&e[0]<128)throw st("invalid RLP encoding: invalid prefix, single byte < 0x80 are not prefixed");return{data:e,remainder:i.subarray(r)}}else if(d<=191){if(t=d-182,i.length-1<t)throw st("invalid RLP: not enough bytes for string length");if(r=zs(vr(i,1,t)),r<=55)throw st("invalid RLP: expected string length to be greater than 55");return e=vr(i,t,r+t),{data:e,remainder:i.subarray(r+t)}}else if(d<=247){for(r=d-191,n=vr(i,1,r);n.length;)s=ga(n),u.push(s.data),n=s.remainder;return{data:u,remainder:i.subarray(r)}}else{if(t=d-246,r=zs(vr(i,1,t)),r<56)throw st("invalid RLP: encoded list too short");let c=t+r;if(c>i.length)throw st("invalid RLP: total length is larger than the data");for(n=vr(i,t,c);n.length;)s=ga(n),u.push(s.data),n=s.remainder;return{data:u,remainder:i.subarray(c)}}}var Vl=Array.from({length:256},(i,r)=>r.toString(16).padStart(2,"0"));function Ml(i){let r="";for(let t=0;t<i.length;t++)r+=Vl[i[t]];return r}function Kl(i){let r=Number.parseInt(i,16);if(Number.isNaN(r))throw st("Invalid byte sequence");return r}var Mt={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function Ws(i){if(i>=Mt._0&&i<=Mt._9)return i-Mt._0;if(i>=Mt._A&&i<=Mt._F)return i-(Mt._A-10);if(i>=Mt._a&&i<=Mt._f)return i-(Mt._a-10)}function va(i){if(i.slice(0,2)==="0x"&&(i=i.slice(0,2)),typeof i!="string")throw st("hex string expected, got "+typeof i);let r=i.length,t=r/2;if(r%2)throw st("padded hex string expected, got unpadded hex of length "+r);let e=new Uint8Array(t);for(let n=0,s=0;n<t;n++,s+=2){let u=Ws(i.charCodeAt(s)),d=Ws(i.charCodeAt(s+1));if(u===void 0||d===void 0){let c=i[s]+i[s+1];throw st('hex string expected, got non-hex character "'+c+'" at index '+s)}e[n]=u*16+d}return e}function Qs(...i){if(i.length===1)return i[0];let r=i.reduce((e,n)=>e+n.length,0),t=new Uint8Array(r);for(let e=0,n=0;e<i.length;e++){let s=i[e];t.set(s,n),n+=s.length}return t}function Hl(i){return new TextEncoder().encode(i)}function ba(i){if(i<0)throw st("Invalid integer as argument, must be unsigned!");let r=i.toString(16);return r.length%2?`0${r}`:r}function Fl(i){return i.length%2?`0${i}`:i}function Ys(i){return i.length>=2&&i[0]==="0"&&i[1]==="x"}function jl(i){return typeof i!="string"?i:Ys(i)?i.slice(2):i}function Xs(i){if(i instanceof Uint8Array)return i;if(typeof i=="string")return Ys(i)?va(Fl(jl(i))):Hl(i);if(typeof i=="number"||typeof i=="bigint")return i?va(ba(i)):Uint8Array.from([]);if(i==null)return Uint8Array.from([]);throw st("toBytes: received unsupported type "+typeof i)}function Js(i){if(Array.isArray(i)){let t=[],e=0;for(let n=0;n<i.length;n++){let s=Js(i[n]);t.push(s),e+=s.length}return Qs($s(e,192),...t)}let r=Xs(i);return r.length===1&&r[0]<128?r:Qs($s(r.length,128),r)}function ql(i,r=!1){if(typeof i>"u"||i===null||i.length===0)return Uint8Array.from([]);let t=Xs(i),e=ga(t);if(r)return{data:e.data,remainder:e.remainder.slice()};if(e.remainder.length!==0)throw st("invalid RLP: remainder must be zero");return e.data}var Kt={encode:Js,decode:ql};var Nh=BigInt(0),xh=BigInt(1);var kh=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Rh=Array.from({length:256},(i,r)=>r.toString(16).padStart(2,"0"));var Zs=Lt;function Vr(i){return r=>(Zs(r),i(r))}var zh=Vr(Fs),vt=(()=>{let i=Vr(Or);return i.create=Or.create,i})(),$h=Vr(js),Wh=Vr(qs);var{randomPrivateKey:Mr}=Is,{bytesToHex:An,hexToBytes:eo}=Pr;Pr.hmacSha256Sync=(i,...r)=>ma(Or,i,ya(...r));var{subtle:py}=crypto;var In=i=>btoa(String.fromCharCode(...i)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");var wn=class{sign(r,t){return pa(r,t)}verify(r,t,e){let n=this.publicKeyFromPrivateKey(e),s=new Uint8Array(65);s[0]=4,s.set(n,1);let u=Tn(r,t,s),d="0x"+An(vt(n).slice(-20));return{valid:u,address:d}}publicKeyFromPrivateKey(r){return ar(r,!1).slice(1)}jwk(r){let t=ar(r,!1).slice(1),e=t.slice(1,33),n=t.slice(33,65);return{kty:"EC",crv:"secp256k1",x:In(e),y:In(n),d:In(r),ext:!0,key_ops:["sign","verify"]}}};function ka(i){return btoa(String.fromCharCode(...i))}function yp(i){return ar(i,!1).slice(1)}function Vc(i){let r=yp(i);return"0x"+Se(vt(r)).slice(-40)}function Se(i){try{if(typeof i=="string")return i.startsWith("0x")?i.toLowerCase():"0x"+[...new TextEncoder().encode(i)].map(e=>e.toString(16).padStart(2,"0")).join("");if(typeof i=="number"){if(!Number.isSafeInteger(i)||i<0)throw new Error("Only safe positive integers are supported for hexlify.");return"0x"+(i===0?"0":i.toString(16))}if(typeof i=="bigint"){if(i<0n)throw new Error("Negative bigints are not supported.");return"0x"+(i===0n?"0":i.toString(16))}if(i instanceof Uint8Array){let r=Array.from(i).map(t=>t.toString(16).padStart(2,"0")).join("");return"0x"+(r==="00"?"0":r)}return typeof i=="boolean"?i?"0x1":"0x0":i==null?"0x":Array.isArray(i)?i.map(nt):"0x"}catch(r){throw new Error(`Unsupported type for hexlify: ${r}`)}}function nt(i){let r={};return Object.entries(i).forEach(([t,e])=>{r[t]=Se(e)}),r}function Mc(i,r){if(!i)throw new Error("chainId is required to compute v");let t=BigInt(r??"0x0");return"0x"+(BigInt(i)*2n+35n+t).toString(16)}async function Cr(i){let{encode64:r}=(await Promise.resolve().then(()=>(qr(),jr))).default.util;return r(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Gr(i){let{decode64:r}=(await Promise.resolve().then(()=>(qr(),jr))).default.util;return r(i.replace(/-/g,"+").replace(/_/g,"/").padEnd(i.length+(4-i.length%4)%4,"="))}var $t="0x"+"".padStart(40,"0");var Ra="0x73656c6673656c6673656c6673656c6673656c66";function tt(i){if(i.type==="string"||i.type==="bytes"||/\[\]$/.test(i.type))return!0;if(i.type==="tuple"){if(!i.components)throw new Error("Tuple must have components");return i.components.some(tt)}return!1}function La(i){if(!i||i.length===0)return new Uint8Array(32);let r=new Uint8Array(Math.ceil(i.length/32)*32);return r.set(i),r}function Ft(i){let r=i.reduce((n,s)=>n+s.length,0),t=new Uint8Array(r),e=0;for(let n of i)t.set(n,e),e+=n.length;return t}function Rn(i,r){let{type:t,components:e}=r;if(t==="string"){let s=i?new TextEncoder().encode(i):new Uint8Array(0),u=bt(s.length,{type:"uint256"});if(s.length==0)return u;let d=La(s);return Ft([u,d])}if(t==="bytes"){let s;if(i instanceof Uint8Array)s=i;else if(typeof i=="string"&&i.startsWith("0x"))s=Wr(i.slice(2));else if(i===""||i===0)s=new Uint8Array(0);else throw new Error("Invalid bytes value");let u=bt(s.length,{type:"uint256"});if(s.length==0)return u;let d=La(s);return Ft([u,d])}let n=t.match(/^(.*)\[(\d*)\]$/);if(n){let s=n[1],u=n[2],d=u==="";if(!Array.isArray(i))throw new Error(`Expected array value for type ${t}`);if(d)return Ua(i,r);{let c=parseInt(u,10);if(i.length!==c)throw new Error(`Array length mismatch: expected ${c}, got ${i.length}`);let a=i.map(h=>tt({type:s,components:e})?Rn(h,{type:s,components:e}):bt(h,{type:s,components:e}));return Ft(a)}}if(t.startsWith("tuple")){if(!e)throw new Error("Tuple type requires components");return Pa(i,e)}throw new Error(`Unsupported or unimplemented dynamic type: ${t}`)}function bt(i,r){if(r.type.startsWith("uint")||r.type.startsWith("int")||r.type==="address"||r.type==="bool"){let t;r.type==="bool"?t=i?1n:0n:(r.type,t=BigInt(i));let e=t.toString(16).padStart(64,"0");return Wr(e)}if(r.type.startsWith("bytes")){let t=r.type.match(/^bytes(\d+)$/);if(!t)throw new Error(`Invalid static bytes type: ${r.type}`);let e=Number(t[1]);if(e<1||e>32)throw new Error("bytesN must be between 1 and 32");let n;if(typeof i=="string"&&i.startsWith("0x"))n=Wr(i);else if(i instanceof Uint8Array)n=i;else throw new Error(`Invalid bytes input: ${i}`);if(n.length!==e)throw new Error(`Expected ${e} bytes, got ${n.length}`);let s=new Uint8Array(32);return s.set(n),s}if(r.type==="tuple"){if(!r.components||!Array.isArray(i))throw new Error("Invalid tuple input");if(!r.components.every(n=>!tt(n)))throw new Error("Tuple contains dynamic types \u2014 use parseDynamic instead");let e=r.components.map((n,s)=>bt(i[s],n));return Ft(e)}throw new Error(`Unsupported or dynamic type in encodeStatic: ${r.type}`)}function Pa(i,r,t=0){let e=[],n=[],s=0;for(let u of r)tt(u)?s+=32:s+=zr(u)*32;for(let u=0;u<r.length;u++){let d=r[u],c=i[u];if(tt(d)){e.push(bt(s,{type:"uint256"}));let a;if(d.type==="string"||d.type==="bytes")a=Rn(c,d);else if(d.type.endsWith("[]"))a=Ua(c,d);else if(d.type.startsWith("tuple"))a=Pa(c,d.components,t+s);else throw new Error(`Unsupported dynamic type in tuple: ${d.type}`);n.push(a),s+=a.length}else e.push(bt(c,d))}return Ft([...e,...n])}function Ua(i,r){if(!r.type.endsWith("[]"))throw new Error(`Type ${r.type} is not a dynamic array`);let t=r.type.slice(0,-2),e=r.components?{type:t,components:r.components}:{type:t},n=[],s=[],u=i.length*32;for(let c=0;c<i.length;c++){let a=i[c];if(tt(e)){n.push(bt(u,{type:"uint256"}));let h;if(e.type==="string"||e.type==="bytes"){let p=new TextEncoder().encode(a);h=Ft([bt(p.length,{type:"uint256"}),La(p)])}else if(e.type.startsWith("tuple"))h=Pa(a,e.components);else if(e.type.endsWith("[]"))h=Ua(a,e);else throw new Error(`Unsupported dynamic element type in array: ${e.type}`);s.push(h),u+=h.length}else{let h=bt(a,e);n.push(h)}}let d=bt(i.length,{type:"uint256"});return Ft([d,...n,...s])}function zr(i){if(tt(i))return 0;let{type:r,components:t}=i;if(r.startsWith("uint")||r.startsWith("int")||r==="bool"||r==="address"||/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])$/.test(r))return 1;if(r==="tuple")return!t||t.length===0?0:t.reduce((n,s)=>{if(tt(s))throw new Error(`Tuple has dynamic component: ${s.type}`);return n+zr(s)},0);let e=r.match(/^(.*)\[(\d+)\]$/);if(e){let n=e[1],s=parseInt(e[2],10);if(isNaN(s))throw new Error(`Invalid fixed array length in type: ${r}`);let u={type:n,components:i.components};if(tt(u))throw new Error(`Fixed array with dynamic base type: ${n}`);return s*zr(u)}throw new Error(`Unsupported or non-static type in staticSizeInWords: ${r}`)}function $r(i){return Array.from(i,r=>r.toString(16).padStart(2,"0")).join("")}function Wr(i){let r=new Uint8Array(i.length/2);for(let t=0;t<i.length;t+=2)r[t/2]=parseInt(i.substr(t,2),16);return r}function Qr(i,r,t){let{type:e,components:n}=t;if(e.startsWith("uint")||e.startsWith("int")||e==="address"||e==="bool"){let u=i.slice(r,r+32),d;if(e==="bool")d=u[31]!==0;else if(e==="address"){let c=u.slice(12,32);d="0x"+$r(c)}else{d=0n;for(let c=0;c<32;c++)d=d<<8n|BigInt(u[c]);if(e.startsWith("int")){let c=parseInt(e.slice(3))||256,a=(1n<<BigInt(c-1))-1n;d>a&&(d=d-(1n<<BigInt(c)))}}return{value:d,newOffset:r+32}}if(e.startsWith("bytes")&&/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])$/.test(e)){let u=e.match(/^bytes(\d+)$/),d=Number(u[1]),a=i.slice(r,r+32).slice(0,d);return{value:"0x"+$r(a),newOffset:r+32}}if(e==="tuple"){if(!n||n.length===0)return{value:[],newOffset:r};if(!n.every(a=>!tt(a)))throw new Error("Tuple contains dynamic types - use decodeDynamic instead");let d=[],c=r;for(let a of n){let h=Qr(i,c,a);d.push(h.value),c=h.newOffset}return{value:d,newOffset:c}}let s=e.match(/^(.*)\[(\d+)\]$/);if(s){let u=s[1],d=parseInt(s[2],10),c={type:u,components:n};if(tt(c))throw new Error(`Fixed array with dynamic base type: ${u}`);let a=[],h=r;for(let p=0;p<d;p++){let T=Qr(i,h,c);a.push(T.value),h=T.newOffset}return{value:a,newOffset:h}}throw new Error(`Unsupported static type: ${e}`)}function kn(i,r,t){let{type:e,components:n}=t;if(e==="string"){let u=i.slice(r,r+32),d=0;for(let p=0;p<32;p++)d=d<<8|u[p];if(d===0)return{value:"",newOffset:r+32};let c=i.slice(r+32,r+32+d),a=new TextDecoder().decode(c),h=Math.ceil(d/32)*32;return{value:a,newOffset:r+32+h}}if(e==="bytes"){let u=i.slice(r,r+32),d=0;for(let p=0;p<32;p++)d=d<<8|u[p];if(d===0)return{value:"0x",newOffset:r+32};let c=i.slice(r+32,r+32+d),a="0x"+$r(c),h=Math.ceil(d/32)*32;return{value:a,newOffset:r+32+h}}let s=e.match(/^(.*)\[(\d*)\]$/);if(s){let u=s[1];if(s[2]==="")return gp(i,r,t);throw new Error(`Fixed-size array should use decodeStatic: ${e}`)}if(e.startsWith("tuple")){if(!n)throw new Error("Tuple type requires components");return mp(i,r,n)}throw new Error(`Unsupported dynamic type: ${e}`)}function mp(i,r,t){let e=[],n=r,s=r,u=[];for(let a=0;a<t.length;a++){let h=t[a];if(tt(h)){let p=i.slice(n,n+32),T=0;for(let I=0;I<32;I++)T=T<<8|p[I];u.push(s+T),e.push(null),n+=32}else{let p=Qr(i,n,h);e[a]=p.value,n=p.newOffset}}let d=0;for(let a=0;a<t.length;a++){let h=t[a];if(tt(h)){let p=u[d],T=kn(i,p,h);e[a]=T.value,d++}}let c=n;if(u.length>0){let a=Math.max(...u),h=t.find((p,T)=>tt(p)&&u[u.length-1]===a);h&&(c=kn(i,a,h).newOffset)}return{value:e,newOffset:c}}function gp(i,r,t){if(!t.type.endsWith("[]"))throw new Error(`Type ${t.type} is not a dynamic array`);let e=i.slice(r,r+32),n=0;for(let h=0;h<32;h++)n=n<<8|e[h];if(n===0)return{value:[],newOffset:r+32};let s=t.type.slice(0,-2),u=t.components?{type:s,components:t.components}:{type:s},d=[],c=r+32,a=c;if(tt(u)){let h=[];for(let p=0;p<n;p++){let T=i.slice(c,c+32),I=0;for(let A=0;A<32;A++)I=I<<8|T[A];h.push(a+I),c+=32}for(let p=0;p<n;p++){let T=h[p],I=kn(i,T,u);d.push(I.value),p===n-1&&(c=I.newOffset)}}else for(let h=0;h<n;h++){let p=Qr(i,c,u);d.push(p.value),c=p.newOffset}return{value:d,newOffset:c}}function Kc(i,r){let t=[],e=0,n=[];for(let u=0;u<r.length;u++){let d=r[u];if(tt(d)){let c=i.slice(e,e+32),a=0;for(let h=0;h<32;h++)a=a<<8|c[h];n.push(a),t.push(null),e+=32}else{let c=Qr(i,e,d);t[u]=c.value,e=c.newOffset}}let s=0;for(let u=0;u<r.length;u++){let d=r[u];if(tt(d)){let c=n[s],a=kn(i,c,d);t[u]=a.value,s++}}return t}var Ln=class{dynamicParam(r,t){return Rn(r,t)}staticParam(r,t){return bt(r,t)}getHex(r){let t=r.length,e=Math.ceil(t/32)*32,n=r.slice(0,e);return"0x"+Array.from(n).map(s=>s.toString(16).padStart(2,"0")).join("")}ensureCapacity(r,t){if(t.length>=r)return t;let e=new Uint8Array(r);return e.set(t),e}isDynamicType(r){if(r.type==="string"||r.type==="bytes"||/\[\]$/.test(r.type))return!0;if(r.type==="tuple"){if(!r.components)throw new Error("Tuple must have components");return r.components.some(this.isDynamicType)}return!1}};var Pn=class extends Ln{buffer=new Uint8Array(0);abi;memory=new Map;constructor(r){super(),this.abi=r}save(r){this.memory.set(r,this.getHex(this.buffer))}delete(r){this.memory.set(r,"")}getCalldata(r){return this.encode(r)}encodeWithSelector(r){return this.getSelector()+this.encode(r).slice(2)}encode(r){let t=new Uint8Array(32*this.abi.inputs.length),e=new Uint8Array(0),n=0;for(let s of this.abi.inputs)this.isDynamicType(s)?n+=32:n+=zr(s)*32;for(let s=0;s<this.abi.inputs.length;s++){let u=r[s],d=this.abi.inputs[s];if(this.isDynamicType(d)){let c=this.staticParam(t.length+e.length,{type:"uint256"});t.set(c,s*32);let a=this.dynamicParam(u,d);e=this.ensureCapacity(e.length+a.length,e),e.set(a,e.length-a.length)}else{let c=this.staticParam(u,d);t.set(c,s*32)}}return this.buffer=Ft([t,e]),this.getHex(this.buffer)}decodeOutput(r,t=this.abi){let e=t.outputs??[];return e.length>0?Kc(Wr(r.slice(2)),e):["0x"]}getSelector(r=this.abi){let t=r.inputs.map(s=>this.encodeParameterType(s)).join(","),e=`${r.name}(${t})`;return Se(vt(new TextEncoder().encode(e))).slice(0,10)}printChunks32(r="Calldata",t=this.buffer){console.log(`
== ${r} (chunks of 32 bytes) ==`);for(let e=0;e<t.length;e+=32){let n=t.slice(e,e+32),s=Array.from(n).map(u=>u.toString(16).padStart(2,"0")).join("");console.log(`0x${e.toString(16).padStart(4,"0")}: ${s}`)}}encodeParameterType(r){if(r.type==="tuple")return`(${(r.components||[]).map(n=>this.encodeParameterType(n)).join(",")})`;let t=r.type.match(/(.*)(\[.*\])$/);if(t){let e=t[1],n=t[2];if(e==="tuple")return`(${(r.components||[]).map(u=>this.encodeParameterType(u)).join(",")})${n}`}return r.type}};var Tr=class{fn=new Map;constructor(r){r.forEach(t=>this.fn.set(t.name,new Pn(t)))}};var Hc=[{type:"fallback",stateMutability:"payable"},{type:"receive",stateMutability:"payable"},{type:"function",name:"UPKEEPS_ID_SLOT",inputs:[],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"ccipReceive",inputs:[{name:"",type:"tuple",internalType:"struct Client.Any2EVMMessage",components:[{name:"messageId",type:"bytes32",internalType:"bytes32"},{name:"sourceChainSelector",type:"uint64",internalType:"uint64"},{name:"sender",type:"bytes",internalType:"bytes"},{name:"data",type:"bytes",internalType:"bytes"},{name:"destTokenAmounts",type:"tuple[]",internalType:"struct Client.EVMTokenAmount[]",components:[{name:"token",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"}]}]}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"checkUpkeep",inputs:[{name:"checkData",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bool",internalType:"bool"},{name:"",type:"bytes",internalType:"bytes"}],stateMutability:"view"},{type:"function",name:"createCronJobFromSpec",inputs:[{name:"calls",type:"tuple[]",internalType:"struct Call[]",components:[{name:"target",type:"address",internalType:"address"},{name:"value",type:"uint256",internalType:"uint256"},{name:"data",type:"bytes",internalType:"bytes"}]},{name:"spec",type:"tuple",internalType:"struct Spec",components:[{name:"minute",type:"tuple",internalType:"struct Field",components:[{name:"fieldType",type:"uint8",internalType:"enum FieldType"},{name:"singleValue",type:"uint8",internalType:"uint8"},{name:"interval",type:"uint8",internalType:"uint8"},{name:"rangeStart",type:"uint8",internalType:"uint8"},{name:"rangeEnd",type:"uint8",internalType:"uint8"},{name:"listLength",type:"uint8",internalType:"uint8"},{name:"list",type:"uint8[26]",internalType:"uint8[26]"}]},{name:"hour",type:"tuple",internalType:"struct Field",components:[{name:"fieldType",type:"uint8",internalType:"enum FieldType"},{name:"singleValue",type:"uint8",internalType:"uint8"},{name:"interval",type:"uint8",internalType:"uint8"},{name:"rangeStart",type:"uint8",internalType:"uint8"},{name:"rangeEnd",type:"uint8",internalType:"uint8"},{name:"listLength",type:"uint8",internalType:"uint8"},{name:"list",type:"uint8[26]",internalType:"uint8[26]"}]},{name:"day",type:"tuple",internalType:"struct Field",components:[{name:"fieldType",type:"uint8",internalType:"enum FieldType"},{name:"singleValue",type:"uint8",internalType:"uint8"},{name:"interval",type:"uint8",internalType:"uint8"},{name:"rangeStart",type:"uint8",internalType:"uint8"},{name:"rangeEnd",type:"uint8",internalType:"uint8"},{name:"listLength",type:"uint8",internalType:"uint8"},{name:"list",type:"uint8[26]",internalType:"uint8[26]"}]},{name:"month",type:"tuple",internalType:"struct Field",components:[{name:"fieldType",type:"uint8",internalType:"enum FieldType"},{name:"singleValue",type:"uint8",internalType:"uint8"},{name:"interval",type:"uint8",internalType:"uint8"},{name:"rangeStart",type:"uint8",internalType:"uint8"},{name:"rangeEnd",type:"uint8",internalType:"uint8"},{name:"listLength",type:"uint8",internalType:"uint8"},{name:"list",type:"uint8[26]",internalType:"uint8[26]"}]},{name:"dayOfWeek",type:"tuple",internalType:"struct Field",components:[{name:"fieldType",type:"uint8",internalType:"enum FieldType"},{name:"singleValue",type:"uint8",internalType:"uint8"},{name:"interval",type:"uint8",internalType:"uint8"},{name:"rangeStart",type:"uint8",internalType:"uint8"},{name:"rangeEnd",type:"uint8",internalType:"uint8"},{name:"listLength",type:"uint8",internalType:"uint8"},{name:"list",type:"uint8[26]",internalType:"uint8[26]"}]}]}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"deleteCronJob",inputs:[{name:"id",type:"uint256",internalType:"uint256"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"entryPoint",inputs:[],outputs:[{name:"",type:"address",internalType:"contract IEntryPoint"}],stateMutability:"pure"},{type:"function",name:"execute",inputs:[{name:"target",type:"address",internalType:"address"},{name:"value",type:"uint256",internalType:"uint256"},{name:"data",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"executeBatch",inputs:[{name:"calls",type:"tuple[]",internalType:"struct BaseAccount.Call[]",components:[{name:"target",type:"address",internalType:"address"},{name:"value",type:"uint256",internalType:"uint256"},{name:"data",type:"bytes",internalType:"bytes"}]}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"executeCCIP",inputs:[{name:"",type:"tuple[]",internalType:"struct BaseAccount.Call[]",components:[{name:"target",type:"address",internalType:"address"},{name:"value",type:"uint256",internalType:"uint256"},{name:"data",type:"bytes",internalType:"bytes"}]},{name:"",type:"tuple",internalType:"struct Config",components:[{name:"chain",type:"uint64",internalType:"uint64"},{name:"feeToken",type:"address",internalType:"address"},{name:"transferTokens",type:"tuple[]",internalType:"struct Client.EVMTokenAmount[]",components:[{name:"token",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"}]},{name:"extraArgs",type:"tuple",internalType:"struct Client.GenericExtraArgsV2",components:[{name:"gasLimit",type:"uint256",internalType:"uint256"},{name:"allowOutOfOrderExecution",type:"bool",internalType:"bool"}]}]}],outputs:[{name:"messageId",type:"bytes32",internalType:"bytes32"}],stateMutability:"nonpayable"},{type:"function",name:"feeTokenInfo",inputs:[],outputs:[{name:"maxFee",type:"uint96",internalType:"uint96"},{name:"token",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"getActiveCronJobIDs",inputs:[],outputs:[{name:"",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"getCronJob",inputs:[{name:"id",type:"uint256",internalType:"uint256"}],outputs:[{name:"calls",type:"tuple[]",internalType:"struct Call[]",components:[{name:"target",type:"address",internalType:"address"},{name:"value",type:"uint256",internalType:"uint256"},{name:"data",type:"bytes",internalType:"bytes"}]},{name:"cronString",type:"string",internalType:"string"},{name:"nextTick",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"getNonce",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"isValidSignature",inputs:[{name:"hash",type:"bytes32",internalType:"bytes32"},{name:"signature",type:"bytes",internalType:"bytes"}],outputs:[{name:"magicValue",type:"bytes4",internalType:"bytes4"}],stateMutability:"view"},{type:"function",name:"keeperRegister",inputs:[],outputs:[{name:"",type:"address",internalType:"contract IKeeperRegistryUI"}],stateMutability:"view"},{type:"function",name:"onERC1155BatchReceived",inputs:[{name:"",type:"address",internalType:"address"},{name:"",type:"address",internalType:"address"},{name:"",type:"uint256[]",internalType:"uint256[]"},{name:"",type:"uint256[]",internalType:"uint256[]"},{name:"",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"nonpayable"},{type:"function",name:"onERC1155Received",inputs:[{name:"",type:"address",internalType:"address"},{name:"",type:"address",internalType:"address"},{name:"",type:"uint256",internalType:"uint256"},{name:"",type:"uint256",internalType:"uint256"},{name:"",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"nonpayable"},{type:"function",name:"onERC721Received",inputs:[{name:"",type:"address",internalType:"address"},{name:"",type:"address",internalType:"address"},{name:"",type:"uint256",internalType:"uint256"},{name:"",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"nonpayable"},{type:"function",name:"performUpkeep",inputs:[{name:"performData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"registerUpkeep",inputs:[{name:"name",type:"string",internalType:"string"},{name:"gasLimit",type:"uint32",internalType:"uint32"},{name:"offchainConfig",type:"bytes",internalType:"bytes"},{name:"checkData",type:"bytes",internalType:"bytes"},{name:"amount",type:"uint96",internalType:"uint96"}],outputs:[],stateMutability:"payable"},{type:"function",name:"setConditionDelegatee",inputs:[{name:"delegatee",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setFeeTokenInfo",inputs:[{name:"maxFee",type:"uint96",internalType:"uint96"},{name:"token",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setForwarder",inputs:[{name:"newForwarder",type:"address",internalType:"address"},{name:"allowed",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"supportsInterface",inputs:[{name:"id",type:"bytes4",internalType:"bytes4"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"pure"},{type:"function",name:"unlockCallback",inputs:[{name:"",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes",internalType:"bytes"}],stateMutability:"nonpayable"},{type:"function",name:"updateCronJob",inputs:[{name:"id",type:"uint256",internalType:"uint256"},{name:"newCall",type:"tuple[]",internalType:"struct Call[]",components:[{name:"target",type:"address",internalType:"address"},{name:"value",type:"uint256",internalType:"uint256"},{name:"data",type:"bytes",internalType:"bytes"}]},{name:"newEncodedCronSpec",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"upkeeps",inputs:[{name:"",type:"bytes32",internalType:"bytes32"},{name:"",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"validateUserOp",inputs:[{name:"userOp",type:"tuple",internalType:"struct PackedUserOperation",components:[{name:"sender",type:"address",internalType:"address"},{name:"nonce",type:"uint256",internalType:"uint256"},{name:"initCode",type:"bytes",internalType:"bytes"},{name:"callData",type:"bytes",internalType:"bytes"},{name:"accountGasLimits",type:"bytes32",internalType:"bytes32"},{name:"preVerificationGas",type:"uint256",internalType:"uint256"},{name:"gasFees",type:"bytes32",internalType:"bytes32"},{name:"paymasterAndData",type:"bytes",internalType:"bytes"},{name:"signature",type:"bytes",internalType:"bytes"}]},{name:"userOpHash",type:"bytes32",internalType:"bytes32"},{name:"missingAccountFunds",type:"uint256",internalType:"uint256"}],outputs:[{name:"validationData",type:"uint256",internalType:"uint256"}],stateMutability:"nonpayable"},{type:"error",name:"CheckUpkeepError",inputs:[]},{type:"error",name:"CronJobIDNotFound",inputs:[{name:"id",type:"uint256",internalType:"uint256"}]},{type:"error",name:"ECDSAInvalidSignature",inputs:[]},{type:"error",name:"ECDSAInvalidSignatureLength",inputs:[{name:"length",type:"uint256",internalType:"uint256"}]},{type:"error",name:"ECDSAInvalidSignatureS",inputs:[{name:"s",type:"bytes32",internalType:"bytes32"}]},{type:"error",name:"ExecuteCCIPError",inputs:[]},{type:"error",name:"ExecuteError",inputs:[{name:"index",type:"uint256",internalType:"uint256"},{name:"error",type:"bytes",internalType:"bytes"}]},{type:"error",name:"FeeTokenError",inputs:[]},{type:"error",name:"InvalidHandler",inputs:[]},{type:"error",name:"NotPoolManager",inputs:[]},{type:"error",name:"PerformError",inputs:[]},{type:"error",name:"PerformUpkeepError",inputs:[]},{type:"error",name:"ReceiveCCIPError",inputs:[]},{type:"error",name:"TickDoesntMatchSpec",inputs:[]},{type:"error",name:"TickInFuture",inputs:[]},{type:"error",name:"TickTooOld",inputs:[]},{type:"error",name:"Unknown",inputs:[{name:"",type:"bytes",internalType:"bytes"}]},{type:"error",name:"UnknownFieldType",inputs:[]}];var Da=class{encoder=new Tr(Hc.filter(r=>r.name?.includes("execute")));batch=new Map;newBatch(r){let t=Se(r.chainId),e=this.batch.get(t);e?(e.push(r),this.batch.set(t,e)):this.batch.set(t,[r])}setBatch(r,t){let e=Se(r.chainId),n=this.batch.get(e);if(n)n[t]=r,this.batch.set(e,n);else throw new Error("[Transaction]: Not found or not defined")}removeBatch(r,t){let e=Se(r),n=this.batch.get(e);if(!n)throw new Error(`[Transaction]: Batch for chainId ${e} not found`);if(t<0||t>=n.length)throw new Error(`[Transaction]: Index ${t} out of bounds`);return n.splice(t,1),this.batch.set(e,n),n}hasBatch(r){return this.batch.get(r)!=null}encodeBatch(r){let t=this.encoder.fn.get("executeBatch");if(!t)throw new Error("[Encoder]: Invalid encoder");return t.encodeWithSelector([this.batch.get(Se(r)).map(e=>[e.to,e.value,e.data])])}},Yr=class extends Da{transactions=[];history=[];constructor(r){super(),r&&this.new(r)}new(r){let t=this.toHex(r),e=this.transactions.findIndex(n=>n.chainId==t.chainId);e>=0?this.batch.has(t.chainId)?(this.newBatch(r),this.set({type:t.type,chainId:t.chainId,data:this.encodeBatch(t.chainId),to:$t},e)):(this.newBatch(this.transactions[e]),this.newBatch(r),this.set({type:t.type,chainId:t.chainId,data:this.encodeBatch(t.chainId),to:$t},e)):this.transactions.push(t)}set(r,t){if(t<0||t>=this.transactions.length)throw new Error(`[Transaction]: Index ${t} is out of bounds`);this.transactions[t]=this.toHex(r)}remove(r){r>=0&&r<this.transactions.length&&this.transactions.splice(r,1)}filter(r){return this.transactions.filter(t=>t.chainId==r)}prepareForSigning(r=this.transactions){return r.map(t=>{let e=t;if(this.hasSignature(e))throw new Error("Transaction is signed");return vt(this.rlp(t))})}rawTransaction(r=0,t=this.transactions){if(!this.hasSignature(t[r]))throw new Error("Transaction is missing signature fields: yParity, r, s");return Se(this.rlp(t[r],!0))}rlp(r,t=!1){switch(r.type){case"0x0":return Fc(r,t);case"0x1":{let e=r,n=[e.chainId,e.nonce,e.gasPrice,e.gasLimit,e.to,e.value=="0x0"?void 0:e.value,e.data,Un(e.chainId,e.accessList)];return t&&n.push(e.yParity=="0x0"?void 0:e.yParity,e.r,e.s),Uint8Array.from([1,...Kt.encode(n)])}case"0x2":{let e=r,n=[e.chainId,e.nonce,e.maxPriorityFeePerGas,e.maxFeePerGas,e.gasLimit,e.to,e.value=="0x0"?void 0:e.value,e.data,Un(e.chainId,e.accessList)];return t&&n.push(e.yParity=="0x0"?void 0:e.yParity,e.r,e.s),Uint8Array.from([2,...Kt.encode(n)])}case"0x3":{let e=r,n=[e.chainId,e.nonce,e.maxPriorityFeePerGas,e.maxFeePerGas,e.gasLimit,e.to,e.value=="0x0"?void 0:e.value,e.data,Un(e.chainId,e.accessList),e.maxFeePerBlobGas,e.blobVersionedHashes];return t&&n.push(e.yParity=="0x0"?void 0:e.yParity,e.r,e.s),Uint8Array.from([3,...Kt.encode(n)])}case"0x4":{let e=r,n=[e.chainId,e.nonce,e.maxPriorityFeePerGas,e.maxFeePerGas,e.gasLimit,e.to,e.value=="0x0"?void 0:e.value,e.data,Un(e.chainId,e.accessList),e.authorizationList.map(s=>[s.chainId,s.address,s.nonce,s.yParity=="0x0"?void 0:s.yParity,s.r,s.s])];return t&&n.push(e.yParity=="0x0"?void 0:e.yParity,e.r,e.s),console.log(n),Uint8Array.from([4,...Kt.encode(n)])}default:return Fc(r,t)}}toHex(r){return nt(r)}hasSignature(r){return typeof r.yParity=="string"&&typeof r.r=="string"&&typeof r.s=="string"&&r.yParity.startsWith("0x")&&r.r.startsWith("0x")&&r.s.startsWith("0x")}};function Fc(i,r){let t=i,e=Mc(t.chainId,t.yParity),n=r?[t.nonce,t.gasPrice,t.gasLimit,t.to,t.value=="0x0"?void 0:t.value,t.data,e,t.r,t.s]:[t.nonce,t.gasPrice,t.gasLimit,t.to,t.value=="0x0"?void 0:t.value,t.data,t.chainId,"0x","0x"];return Kt.encode(n)}function Un(i,r){return i==="0xa4b1"?[]:r.map(t=>[t.address,t.storageKeys])??[]}var Dn=class extends wn{provider;transactions=new Yr;constructor(r){super(),this.provider=new dr(r)}getAddress(r){let t=this.publicKeyFromPrivateKey(r);return"0x"+Se(vt(t)).slice(-40)}async upgradeAccount(r,t,e){this.provider.changeChain(Se(e));let n=this.getAddress(t),s=await this.provider.eth_getTransactionCount(n),u=Se(parseInt(s,16)+1),d=vt(Uint8Array.from([5,...Kt.encode([e,r,u])])),c=this.sign(d,t),{s:a,r:h,recovery:p}=c;return{chainId:e,address:r,nonce:u,r:h,s:a,yParity:p,v:p+27}}async signTransaction(r,t,e=0){let n=this.getAddress(r);t.to==Ra&&(t.to=n);let s=await this.provider.populateTransaction(nt(t),n),u=new Yr(s),d=u.prepareForSigning()[e],c=this.sign(d,r),{r:a,s:h,recovery:p}=c;return u.set({...s,r:a,s:h,yParity:p,v:p+27},e),console.log(u.transactions),u.rawTransaction(e)}async signAll(r,t){try{let e=this.getAddress(r);for(let u=0;u<t.transactions.length;u++){let d=t.transactions[u];d.to==Ra&&(d.to=e),this.provider.changeChain(d.chainId);let c=await this.provider.populateTransaction(nt(d),e);t.set(c,u)}let n=t.prepareForSigning();return n.map(u=>this.sign(u,r)).map((u,d)=>{let{r:c,s:a,recovery:h}=u;return t.set({...t.transactions[d],r:c,s:a,yParity:h,v:h+27},d),t.rawTransaction(d),{chain:t.transactions[d].chainId,raw:t.rawTransaction(d),signed:t.transactions[d],signature:u,hash:n[d]}})}catch(e){throw new Error(`[Signature error]: ${e.message}`)}}};var jc=ke(new Dn(Bt));var Xr=class{provider;target;abi=new Tr([{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"},{name:"_spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{payable:!0,stateMutability:"payable",type:"fallback"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"}]);constructor(r,t){this.provider=r,this.target=t}async name(r,t=this.provider.current.id){let e=this.abi.fn.get("name");if(!e)throw new Error("Function not defined");let n=e.encodeWithSelector([]);this.provider.changeChain(t);let s=nt({from:r,to:this.target,value:Se(0n),data:n}),u=e.decodeOutput(await this.provider.eth_call(s)),d=["arg0"],c=Object.fromEntries(d.map(a=>[a,""]));u.forEach((a,h)=>{c[d[h]]=a});try{return{tx:await this.provider.populateTransaction(s),output:c}}catch{return{tx:s,output:c}}}async approve(r,t,e,n=this.provider.current.id){let s=this.abi.fn.get("approve");if(!s)throw new Error("Function not defined");let u=s.encodeWithSelector([t,e]);this.provider.changeChain(n);let d=nt({from:r,to:this.target,value:Se(0n),data:u}),c=s.decodeOutput(await this.provider.eth_call(d)),a=["arg1"],h=Object.fromEntries(a.map(p=>[p,""]));c.forEach((p,T)=>{h[a[T]]=p});try{return{tx:await this.provider.populateTransaction(d),output:h}}catch{return{tx:d,output:h}}}async totalSupply(r,t=this.provider.current.id){let e=this.abi.fn.get("totalSupply");if(!e)throw new Error("Function not defined");let n=e.encodeWithSelector([]);this.provider.changeChain(t);let s=nt({from:r,to:this.target,value:Se(0n),data:n}),u=e.decodeOutput(await this.provider.eth_call(s)),d=["arg2"],c=Object.fromEntries(d.map(a=>[a,""]));u.forEach((a,h)=>{c[d[h]]=a});try{return{tx:await this.provider.populateTransaction(s),output:c}}catch{return{tx:s,output:c}}}async transferFrom(r,t,e,n,s=this.provider.current.id){let u=this.abi.fn.get("transferFrom");if(!u)throw new Error("Function not defined");let d=u.encodeWithSelector([t,e,n]);this.provider.changeChain(s);let c=nt({from:r,to:this.target,value:Se(0n),data:d}),a=u.decodeOutput(await this.provider.eth_call(c)),h=["arg3"],p=Object.fromEntries(h.map(T=>[T,""]));a.forEach((T,I)=>{p[h[I]]=T});try{return{tx:await this.provider.populateTransaction(c),output:p}}catch{return{tx:c,output:p}}}async decimals(r,t=this.provider.current.id){let e=this.abi.fn.get("decimals");if(!e)throw new Error("Function not defined");let n=e.encodeWithSelector([]);this.provider.changeChain(t);let s=nt({from:r,to:this.target,value:Se(0n),data:n}),u=e.decodeOutput(await this.provider.eth_call(s)),d=["arg4"],c=Object.fromEntries(d.map(a=>[a,""]));u.forEach((a,h)=>{c[d[h]]=a});try{return{tx:await this.provider.populateTransaction(s),output:c}}catch{return{tx:s,output:c}}}async balanceOf(r,t,e=this.provider.current.id){let n=this.abi.fn.get("balanceOf");if(!n)throw new Error("Function not defined");let s=n.encodeWithSelector([t]);this.provider.changeChain(e);let u=nt({from:r,to:this.target,value:Se(0n),data:s}),d=n.decodeOutput(await this.provider.eth_call(u)),c=["balance"],a=Object.fromEntries(c.map(h=>[h,""]));d.forEach((h,p)=>{a[c[p]]=h});try{return{tx:await this.provider.populateTransaction(u),output:a}}catch{return{tx:u,output:a}}}async symbol(r,t=this.provider.current.id){let e=this.abi.fn.get("symbol");if(!e)throw new Error("Function not defined");let n=e.encodeWithSelector([]);this.provider.changeChain(t);let s=nt({from:r,to:this.target,value:Se(0n),data:n}),u=e.decodeOutput(await this.provider.eth_call(s)),d=["arg5"],c=Object.fromEntries(d.map(a=>[a,""]));u.forEach((a,h)=>{c[d[h]]=a});try{return{tx:await this.provider.populateTransaction(s),output:c}}catch{return{tx:s,output:c}}}async transfer(r,t,e,n=this.provider.current.id){let s=this.abi.fn.get("transfer");if(!s)throw new Error("Function not defined");let u=s.encodeWithSelector([t,e]);this.provider.changeChain(n);let d=nt({from:r,to:this.target,value:Se(0n),data:u}),c=s.decodeOutput(await this.provider.eth_call(d)),a=["arg6"],h=Object.fromEntries(a.map(p=>[p,""]));c.forEach((p,T)=>{h[a[T]]=p});try{return{tx:await this.provider.populateTransaction(d),output:h}}catch{return{tx:d,output:h}}}async allowance(r,t,e,n=this.provider.current.id){let s=this.abi.fn.get("allowance");if(!s)throw new Error("Function not defined");let u=s.encodeWithSelector([t,e]);this.provider.changeChain(n);let d=nt({from:r,to:this.target,value:Se(0n),data:u}),c=s.decodeOutput(await this.provider.eth_call(d)),a=["arg7"],h=Object.fromEntries(a.map(p=>[p,""]));c.forEach((p,T)=>{h[a[T]]=p});try{return{tx:await this.provider.populateTransaction(d),output:h}}catch{return{tx:d,output:h}}}};var Oa=ke({trackedTokens:[],portfolio:{},add:(i,r)=>{},remove:i=>{},update:i=>Promise.resolve(),refToken:{address:"0x82B9e52b26A2954E113F94Ff26647754d5a4247D",name:"MXNB",symbol:"MXNB",decimals:6}}),qc=({children:i})=>{let{account:r}=yt(),[t,e]=ue([]),[n,s]=ue({}),u=Gc(),d=On(),c=r?.activeAccount?.public;ht(()=>{a()},[r]);let a=async()=>{let{portfolio:I}=await d.read("portfolio");I?(s(I),e(I.trackedTokens??[])):h("0x82B9e52b26A2954E113F94Ff26647754d5a4247D","0x66eee")},h=async(I,A)=>{if(!r||!c||t.some(E=>E.address===I))return;let m=new Xr(u,I),S={address:I,symbol:(await m.symbol($t,A)).output.arg5,name:(await m.name($t,A)).output.arg0,decimals:Number((await m.decimals($t,A)).output.arg4),totalSupply:Number((await m.totalSupply($t,A)).output.arg2),chain:A},C=[...t,S];T(C),e(C)},p=I=>{if(!r||!c)return;let A=t.filter(m=>m.address!==I);T(A),e(A)},T=async I=>{if(!c||I.length===0)return;let A=await Promise.all(I.map(async C=>{let l=await new Xr(u,C.address).balanceOf(c,c,C.chain),v={token:C,balance:Number(l.output.balance),lastUpdate:Date.now()};return{address:C.address,data:v}})),m={};for(let{address:C,data:E}of A)m[C]=E;let S={tokenData:m,trackedTokens:I};await d.create("portfolio",S),s(S)};return V(Oa.Provider,{value:{trackedTokens:t,add:h,remove:p,update:T,portfolio:n,refToken:{address:"0x82B9e52b26A2954E113F94Ff26647754d5a4247D",name:"MXNB",symbol:"MXNB",decimals:6}},children:i})};async function zc(i,r){let t=new TextEncoder,e=crypto.getRandomValues(new Uint8Array(12)),n=crypto.getRandomValues(new Uint8Array(16)),s=await vp(r),u=await bp(s,n),d=t.encode(JSON.stringify(i)),c=await crypto.subtle.encrypt({name:"AES-GCM",iv:e},u,d);return{iv:e,salt:n,ciphertext:new Uint8Array(c)}}async function vp(i){let r=new TextEncoder;return await crypto.subtle.importKey("raw",r.encode(i),{name:"PBKDF2"},!1,["deriveKey"])}async function bp(i,r){return await crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}function Ep(){return{certificate:{subject:{commonName:"Juan P\xE9rez",organizationName:"Ejemplo S.A. de C.V.",countryName:"MX",emailAddress:"juan.perez@example.com",RFC:"JUAP800101ABC",CURP:"JUAP800101HDFRRN09"},publicKey:{pem:`-----BEGIN PUBLIC KEY-----
FAKEPUBLICKEYBASE64==
-----END PUBLIC KEY-----`,der:"FAKE_PUBLIC_KEY_DER_BASE64=="},serialNumber:"1234567890ABCDEF",issuer:{commonName:"SAT",organizationName:"Servicio de Administraci\xF3n Tributaria",organizationalUnitName:"Unidad de Certificaci\xF3n",emailAddress:"certificados@sat.gob.mx",streetAddress:"Av. Hidalgo 77",postalCode:"06000",countryName:"MX",stateOrProvinceName:"Ciudad de M\xE9xico",localityName:"Centro",RFC:"SAT970701NN3",unstructuredName:"Autoridad Certificadora SAT"},validity:{notBefore:"2025-01-01T00:00:00Z",notAfter:"2026-01-01T00:00:00Z"},extensions:{keyUsage:{dataEncipherment:!1,digitalSignature:!0,keyAgreement:!1,keyEncipherment:!0,nonRepudiation:!0}},pem:`-----BEGIN CERTIFICATE-----
FAKEPUBLICKEYBASE64==
-----END CERTIFICATE-----`},privateKey:{pem:`-----BEGIN PRIVATE KEY-----
FAKEPRIVATEKEYBASE64==
-----END PRIVATE KEY-----`,der:"FAKE_PRIVATE_KEY_DER_BASE64=="},signatureHistory:[],pendingSignatures:[]}}function $c(){let i=["Kiko","Chavo","Don Ramon","Do\xF1a Clotilde","Chilindrina"],r=Mr(),e={type:"ECDSA-secp256k1",tag:"Key 1",public:Vc(r)};return{activeAccount:e,keys:[e],efirma:Ep(),type:"free",userName:i[Math.floor(Math.random()*i.length)]+`_${crypto.randomUUID().slice(0,8)}`}}function Va(i,r){let t=i.match(/.{1,64}/g),e=t?t.join(`
`):"";return`-----BEGIN ${r}-----
${e}
-----END ${r}-----
`}function Ma(i){return i.replace(/-----BEGIN [^-]+-----/,"").replace(/-----END [^-]+-----/,"").replace(/\s+/g,"")}async function Wc(i,r){let[t,e]=await Promise.all([r.arrayBuffer(),i.arrayBuffer()]),n=new Uint8Array(t),s=new Uint8Array(e),{pki:{certificateFromPem:u,publicKeyToPem:d}}=(await Promise.resolve().then(()=>(qr(),jr))).default,c=Va(ka(n),"ENCRYPTED PRIVATE KEY"),a=Va(ka(s),"CERTIFICATE"),h=u(a),p=h.extensions.find(g=>g.name==="keyUsage"),{issuer:T,subject:I,serialNumber:A,validity:m,publicKey:S}=h,{digitalSignature:C,nonRepudiation:E,keyEncipherment:l,dataEncipherment:v,keyAgreement:_}=p||{},B=g=>Object.fromEntries(g.map(({name:f,value:o})=>[f??"RFC",o]));return{certInfo:{publicKey:{pem:d(S),der:Ma(d(S))},serialNumber:A,issuer:B(T.attributes),subject:B(I.attributes),validity:m,extensions:{keyUsage:{digitalSignature:C,nonRepudiation:E,keyEncipherment:l,dataEncipherment:v,keyAgreement:_}},pem:a},privateKey:{pem:c,der:Ma(c)}}}var Ka;async function Ha(){return Ka||(Ka=(await Promise.resolve().then(()=>(qr(),jr))).default),Ka}async function Fa(i){let{sha256:r}=(await Ha()).md,t=r.create();return t.update(i,"utf8"),t}async function ja(i){let{publicKeyFromPem:r}=(await Ha()).pki;return r(i)}async function Jr(i,r){let{decryptRsaPrivateKey:t,privateKeyToPem:e}=(await Ha()).pki;try{let n=t(i,r);return{decryptedKey:n,pem:e(n)}}catch{return null}}var qa=class{async sign(r,t){return await Cr(r.sign(await Fa(t)))}async verify(r,t,e){let n=await ja(r),s=(await Fa(t)).digest().bytes();return n.verify(s,await Gr(e))}async encrypt(r,t){let e=await ja(r);return await Cr(e.encrypt(t,"RSAES-PKCS1-V1_5"))}async decrypt(r,t){let e=await Gr(t);return r.decrypt(e,"RSAES-PKCS1-V1_5")}},Ga=new qa;async function Qc(i,r){let e=await Cr(JSON.stringify({alg:"RS256",typ:"JWT"})),n=await Cr(JSON.stringify(i)),s=`${e}.${n}`,u=await Ga.sign(r,s);return`${s}.${u}`}async function Yc(i){let[r,t,e]=i.split(".");if(!r||!t||!e)return null;let n=`${r}.${t}`,s=JSON.parse(await Gr(t)),u=s.publicKey;if(!await Ga.verify(u,n,e))return null;let c=Math.floor(Date.now()/1e3);return s.exp<c?null:s}async function Vn(i,r){let t=i.efirma.privateKey.pem;return await Jr(t,r)}var Xc={ANNOUNCE_PROVIDER:"eip6963:announceProvider",WALLET_CONNECTED:"connect",WALLET_DISCONNECTED:"disconnect",CHAIN_CHANGED:"chainChanged",ACCOUNT_CHANGED:"accountsChanged",ERROR:"error"};var za=ke({create:async(i,r)=>{},remove:(i,r)=>{},select:i=>{},login:(i,r)=>{},logout:()=>{},register:(i,r,t,e)=>{},importAccount:(i,r,t)=>{},getSession:async()=>!1,account:{},manager:{}});function Jc({children:i}){let r=On(),{userDB:t,keysDB:e}=eu(),n=Zc(),[s,u]=ue(),{notify:d}=dn(),c=async(C,E,l)=>{try{let{iv:v,salt:_,ciphertext:B}=await zc({secret:E},l),L={iv:Array.from(v),salt:Array.from(_),ciphertext:Array.from(B)};await e.put({id:C,secret:L})}catch(v){throw console.error("Error al guardar clave cifrada:",v),v}},a=async(C,E)=>{try{let l=await t.get(C);if(!l)throw new Error("Cuenta no encontrada");let v=await Vn(l,E);if(!v)throw new Error("Contrase\xF1a incorrecta");let _=await Qc({sub:l.efirma.certificate.subject.RFC,publicKey:l.efirma.certificate.publicKey.pem,iss:globalThis.location.host,iat:Math.floor(Date.now()/1e3),exp:Math.floor(Date.now()/1e3)+86400,accountType:l.type},v.decryptedKey);await r.create("session",_),u(l)}catch(l){throw console.error("Login failed:",l),l}},h=()=>{r.delete("session")},p=async(C,E,l,v)=>{try{let _=Mr(),B=n.getAddress(_),{certInfo:L,privateKey:g}=await Wc(E,l),f=await Jr(g.pem,v);if(!f)throw new Error("Contrase\xF1a incorrecta. Debe ser la contrase\xF1a de la efirma");if(await t.get(L.subject.RFC))throw new Error("Efirma ya registrada");let w={type:"ECDSA-secp256k1",tag:"Key 1",public:B,ensName:"",signatureHistory:[],pendingSignatures:[]},U={efirma:{certificate:L,privateKey:g,pendingSignatures:[],signatureHistory:[]},keys:[w],userName:C,type:"free",activeAccount:w};await t.put({id:L.subject.RFC,...U}),await c(B,f.pem,v),await a(L.subject.RFC,v)}catch(_){throw console.error("Register failed:",_),_}},T=async()=>{try{let{session:C}=await r.read("session");if(!C)return console.error("[Session]","No active session"),!1;let E=await Yc(C);if(!E)return console.error("[Session]","Invalid session"),!1;let l=await t.get(E.sub);return l?(u(l),!0):(console.error("[Session]","Usuario no encontrado en base de datos"),!1)}catch(C){return console.error("Error loading session:",C),!1}},I=async(C,E)=>{if(!s)return;if(!await Vn(s,C))throw new Error("Contrase\xF1a incorrecta");let v=Mr(),_=n.getAddress(v),B={type:"ECDSA-secp256k1",tag:E??`Key ${s.keys.length+1}`,public:_,ensName:"",pendingSignatures:[],signatureHistory:[]},L={...s,activeAccount:B,keys:[...s.keys,B]};c(_,$r(v),C),u(L),await t.update(s.efirma.certificate.subject.RFC,{keys:[...s.keys,B]}),t.put({id:s.efirma.certificate.subject.RFC,...L})},A=async(C,E,l)=>{if(!s)return;let v=eo(C),_=n.getAddress(v),B=await Vn(s,E);if(!B)throw new Error("Contrase\xF1a incorrecta");let L={type:"ECDSA-secp256k1",tag:l??`Key ${s.keys.length}`,public:_,ensName:"",signatureHistory:[],pendingSignatures:[]},g={...s,keys:[...s.keys,L]};c(_,B.pem,E),u(g),t.put({id:s.efirma.certificate.subject.RFC,...g})},m=async(C,E)=>{if(!s)return;if(!await Jr(s.efirma.privateKey.pem,E))throw new Error("Wrong Password");let v=s.keys.filter((_,B)=>B!==C);u({...s,keys:v}),t.put({id:s.efirma.certificate.subject.RFC,...s,keys:v})},S=C=>{if(!s)return;let E=s.keys.find(l=>l.type==="ECDSA-secp256k1"&&l.public===C);if(E){let l={...s,activeAccount:E};u(l),t.put({id:s.efirma.certificate.subject.RFC,...l}),d(Xc.ACCOUNT_CHANGED,[l.activeAccount.public])}};return V(za.Provider,{value:{login:a,logout:h,register:p,create:I,remove:m,select:S,importAccount:A,getSession:T,account:s??$c(),manager:n},children:i})}var Zr=class{constructor(r){this.options=r}db=null;log(...r){console.log(`[db-${this.options.dbName}/${this.options.storeName}]`,...r)}async connect(){return this.db?(this.log("Using cached connection"),this.db):new Promise((r,t)=>{this.log("Opening database...");let e=indexedDB.open(this.options.dbName,this.options.version||1);e.onupgradeneeded=n=>{this.log("Upgrading database...");let s=n.target.result;s.objectStoreNames.contains(this.options.storeName)||(s.createObjectStore(this.options.storeName,{keyPath:this.options.keyPath}),this.log(`Object store "${this.options.storeName}" created`))},e.onsuccess=()=>{this.db=e.result,r(this.db)},e.onerror=()=>{this.log("Error opening database:",e.error),t(e.error)}})}async getStore(r){return(await this.connect()).transaction(this.options.storeName,r).objectStore(this.options.storeName)}async put(r){this.log("Saving record:",r);let t=await this.getStore("readwrite");return new Promise((e,n)=>{let s=t.put(r);s.onsuccess=()=>{this.log("Record saved"),e()},s.onerror=()=>{this.log("Error saving record:",s.error),n(s.error)}})}async get(r){this.log("Fetching record by key:",r);let t=await this.getStore("readonly");return new Promise((e,n)=>{let s=t.get(r);s.onsuccess=()=>{this.log("Record fetched"),e(s.result)},s.onerror=()=>{this.log("Error fetching record:",s.error),n(s.error)}})}async getAll(){this.log("Fetching all records");let r=await this.getStore("readonly");return new Promise((t,e)=>{let n=r.getAll();n.onsuccess=()=>{this.log("Fetched records"),t(n.result)},n.onerror=()=>{this.log("Error fetching all records:",n.error),e(n.error)}})}async delete(r){this.log("Deleting record with key:",r);let t=await this.getStore("readwrite");return new Promise((e,n)=>{let s=t.delete(r);s.onsuccess=()=>{this.log("Record deleted"),e()},s.onerror=()=>{this.log("Error deleting record:",s.error),n(s.error)}})}async clear(){this.log("Clearing object store...");let r=await this.getStore("readwrite");return new Promise((t,e)=>{let n=r.clear();n.onsuccess=()=>{this.log("All records cleared"),t()},n.onerror=()=>{this.log("Error clearing records:",n.error),e(n.error)}})}async update(r,t){this.log("Updating record:",r,t);let e=await this.getStore("readwrite");return new Promise((n,s)=>{let u=e.get(r);u.onsuccess=()=>{let d=u.result;if(!d){this.log("No record found to update"),s(new Error(`Record with key "${String(r)}" not found`));return}let c={...d,...t},a=e.put(c);a.onsuccess=()=>{this.log("Record updated"),n()},a.onerror=()=>{this.log("Error updating record:",a.error),s(a.error)}},u.onerror=()=>{this.log("Error fetching record for update:",u.error),s(u.error)}})}};var tu=ke({userDB:new Zr({dbName:"UserData",storeName:"account",keyPath:"id"}),keysDB:new Zr({dbName:"Keys",storeName:"secrets",keyPath:"id"})});var fr=()=>At(ea),ru=()=>At(ta),On=()=>At(os);var Gc=()=>At(cs),dn=()=>At(na),Zc=()=>At(jc),pn=()=>At(Oa),yt=()=>At(za),eu=()=>At(tu);var nu=()=>V("footer",{className:"bg-base-200 border-t border-base-300 h-full",children:V("div",{className:"container mx-auto px-4 py-6 flex justify-center",children:V("p",{className:"text-sm text-base-content/60",children:["\xA9 2025"," ",V("span",{className:"font-semibold text-base-content/80",children:"Mynter"})]})})});var au=()=>{let{changeTheme:i,theme:r}=ru();return V("header",{className:"flex items-center justify-between p-4 shadow-sm h-full",children:[V("div",{className:"flex items-baseline gap-2",children:[V("strong",{className:"text-xl font-bold text-primary",children:"Wey Wallet"}),V("span",{className:"text-sm",children:"v1.0"})]}),V("label",{className:"swap swap-rotate",children:[V("input",{type:"checkbox",checked:r,onChange:()=>i(!r)}),V("span",{className:"swap-on w-6 h-6 text-warning",children:"\u{1F319}"}),V("span",{className:"swap-off w-6 h-6 text-info",children:"\u{1F31E}"})]})]})};var iu=({sidepanel:i})=>{let{popupView:r,sidepanelView:t,render:e}=fr();return V("main",{className:"m-0 p-0 h-full flex flex-col justify-between overflow-x-hidden overflow-y-scroll",style:"-webkit-scrollbar: none;-ms-overflow-style: none;scrollbar-width: none;",children:[V("div",{className:"flex-[1]",children:V(au,{})}),V("div",{className:"flex justify-center flex-[8]",children:e(i?t:r)}),V("div",{className:"flex-[1] mt-5",children:V(nu,{})})]})};wr(V(ns,{children:V(rs,{children:V(Jc,{children:V(qc,{children:V(us,{children:V(iu,{sidepanel:!0})})})})})}),document.getElementById("root"));})();
/*! Bundled license information:

@noble/secp256k1/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
/*! Bundled license information:

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
